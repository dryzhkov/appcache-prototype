!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n=window.webPackBridgeJsonp;window.webPackBridgeJsonp=function(t,r,c){for(var i,a,s=0,u=[];s<t.length;s++)a=t[s],o[a]&&u.push(o[a][0]),o[a]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);for(n&&n(t,r,c);u.length;)u.shift()()};var r={},o={22:0};t.e=function(e){function n(){a.onerror=a.onload=null,clearTimeout(s);var t=o[e];0!==t&&(t&&t[1](new Error("Loading chunk "+e+" failed.")),o[e]=void 0)}var r=o[e];if(0===r)return new Promise(function(e){e()});if(r)return r[2];var c=new Promise(function(t,n){r=o[e]=[t,n]});r[2]=c;var i=document.getElementsByTagName("head")[0],a=document.createElement("script");a.type="text/javascript",a.charset="utf-8",a.async=!0,a.timeout=12e4,t.nc&&a.setAttribute("nonce",t.nc),a.src=t.p+"precompiled-"+({0:"default-css",2:"dependencies-msteams-web-bridge",4:"recent-files",5:"chat-list",6:"calendar-app"}[e]||e)+".min."+{0:"a41734be944cefa715a7",1:"8087a4d639d9acefa576",2:"6c7a73f4396d8da5397f",3:"c5b3d9a11b02f952edf7",4:"382a4d6558cd587a2ce2",5:"80181aa17442b6f7854d",6:"1cc51adfbcab16e72163",7:"05af93fc2afb44f05904",8:"0eb0c7d319e7b42bef78",9:"bb3485dc66f3009b928d",10:"13fa4592095edc5b4ba5",11:"f697494a8c8809116725",12:"209a73aa8bd40204428c",13:"0bb201c2a1e933cf30d7",14:"7583faf7c45013e2dc2e",15:"6c47a3a0a8141d89138c",16:"ce979f457632e398c8c6",17:"c2a33ef462bc2889f513",18:"1ff7aae95fc459337127",19:"fe4413cbb5116425dda4",20:"66d1c27c1dfeb427e7d1",21:"f6d07684bd85df6133dd"}[e]+".js";var s=setTimeout(n,12e4);return a.onerror=a.onload=n,i.appendChild(a),c},t.m=e,t.c=r,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t.p=window.webpack_runtime_public_path||t.p,t.oe=function(e){throw console.error(e),e},t(t.s="4c259643f4d55b331b73")}({"00522a646af1aaa449a1":function(e,t,n){"use strict";t.a=function(){}},"015f1a6e17a26e130212":function(e,t,n){"use strict";(function(e){var r=n("0bd0afb5c74547a322b4"),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,c=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=c&&c.exports===o?r.a.Buffer:void 0,a=i?i.allocUnsafe:void 0;t.a=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(t,n("044f282f6141fc605782")(e))},"03f2c9f483943a5aa073":function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(t,n("698d75b157f24ae829cc"))},"044f282f6141fc605782":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"05734458eb0608000d5e":function(e,t,n){"use strict";t.a=function(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var c=Array(o);++r<o;)c[r]=e[r+t];return c}},"09072e49d5f60505514c":function(e,t,n){"use strict";var r=n("bfb1279a823c8d2b12a9"),o=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=o(e,t);return Object(r.a)(n)?n:void 0}},"0a471ffa71996fbf3cd3":function(e,t,n){"use strict";var r=function(e,t){return null!=e&&t in Object(e)},o=n("a02fedbb74c57c0a899e");t.a=function(e,t){return null!=e&&Object(o.a)(e,t,r)}},"0a6cea76d35010940b71":function(e,t,n){"use strict";var r=n("e766c598676a77c10541");t.a=function(e,t){return!!(null==e?0:e.length)&&Object(r.a)(e,t,0)>-1}},"0bd0afb5c74547a322b4":function(e,t,n){"use strict";var r=n("03f2c9f483943a5aa073"),o="object"==typeof self&&self&&self.Object===Object&&self,c=r.a||o||Function("return this")();t.a=c},"0be451910340157220f5":function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},"0c2a4817447a620bf235":function(e,t,n){"use strict";t.a=function(e){return null==e}},"0d2a916b77eeb630f9fa":function(e,t,n){"use strict";t.errorObject={e:{}}},"12a991e89d71187bca1f":function(e,t,n){"use strict";function r(e,t){e[t]=e[t].replace(/([A-Z])/g,"-$1").toLowerCase()}function o(){if(!z){var e="undefined"!=typeof document?document:void 0,t="undefined"!=typeof navigator?navigator:void 0,n=t?t.userAgent.toLowerCase():void 0;z=e?{isWebkit:!!(e&&"WebkitAppearance"in e.documentElement.style),isMoz:!!(n&&n.indexOf("firefox")>-1),isOpera:!!(n&&n.indexOf("opera")>-1),isMs:!(!t||!/rv:11.0/i.test(t.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return z}function c(e,t){var n=o(),r=e[t];if(m[r]){var c=e[t+1];m[r]&&(n.isWebkit&&e.push("-webkit-"+r,c),n.isMoz&&e.push("-moz-"+r,c),n.isMs&&e.push("-ms-"+r,c),n.isOpera&&e.push("-o-"+r,c))}}function i(e,t){var n=e[t],r=e[t+1];if("number"==typeof r){var o=-1===L.indexOf(n)?"px":"";e[t+1]=""+r+o}}function a(e){var t=e&&e["&"];return t?t.displayName:void 0}function s(e,t,n){void 0===t&&(t={__order:[]}),void 0===n&&(n="&");var r=y.b.getInstance(),o=t[n];o||(o={},t[n]=o,t.__order.push(n));for(var c=0,i=e;c<i.length;c++){var a=i[c];if("string"==typeof a){var f=r.argsFromClassName(a);f&&s(f,t,n)}else if(Array.isArray(a))s(a,t,n);else for(var l in a)if("selectors"===l){var p=a.selectors;for(var b in p)if(p.hasOwnProperty(b)){var d=p[b];0===b.indexOf(":global(")?b=b.replace(/:global\(|\)$/g,""):0===b.indexOf("@media")?b=b+"{"+n:0===b.indexOf(":")?b=n+b:b.indexOf("&")<0&&(b=n+" "+b),s([d],t,b)}}else"margin"===l||"padding"===l?u(o,l,a[l]):o[l]=a[l]}return t}function u(e,t,n){var r="string"==typeof n?n.split(" "):[n];e[t+"Top"]=r[0],e[t+"Right"]=r[1]||r[0],e[t+"Bottom"]=r[2]||r[0],e[t+"Left"]=r[3]||r[1]||r[0]}function f(e){for(var t=[],n=!1,r=0,o=e.__order;r<o.length;r++){var c=o[r];t.push(c);var i=e[c];for(var a in i)i.hasOwnProperty(a)&&void 0!==i[a]&&(n=!0,t.push(a,i[a]))}return n?t.join(""):void 0}function l(e){if(!e)return"";var t=[];for(var n in e)e.hasOwnProperty(n)&&n!==N&&void 0!==e[n]&&t.push(n,e[n]);for(o=0;o<t.length;o+=2)r(t,o),i(t,o),Object(S.a)(t,o),c(t,o);for(var o=1;o<t.length;o+=4)t.splice(o,1,":",t[o],";");return t.join("")}function p(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=s(e),r=f(n);if(r){var o=y.b.getInstance(),c={className:o.classNameFromKey(r),key:r,args:e};if(!c.className){c.className=o.getClassName(a(n));for(var i=[],u=0,p=n.__order;u<p.length;u++){var b=p[u];i.push(b,l(n[b]))}c.rulesToInsert=i}return c}}function b(e,t){var n=y.b.getInstance(),r=e.className,o=e.key,c=e.args,i=e.rulesToInsert;if(i){for(var a=0;a<i.length;a+=2){var s=i[a+1];if(s){var u=i[a],f=(u=u.replace(/(&)|\$([\w-]+)\b/g,function(n,r,o){return r?"."+e.className:o?"."+(t&&t[o]||o):""}))+"{"+s+"}"+(0===u.indexOf("@media")?"}":"");n.insertRule(f)}}n.cacheClassName(r,o,c,i)}}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=p.apply(void 0,e);return n?(b(n),n.className):""}function M(){function e(t){for(var n=0,i=t;n<i.length;n++){var a=i[n];if(a)if("string"==typeof a)if(a.indexOf(" ")>=0)e(a.split(" "));else{var s=c.argsFromClassName(a);s?e(s):-1===r.indexOf(a)&&r.push(a)}else Array.isArray(a)?e(a):"object"==typeof a&&o.push(a)}}for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=[],o=[],c=y.b.getInstance();return e(t),{classes:r,objects:o}}function h(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=M(e),r=n.classes,o=n.objects;return o.length&&r.push(d(o)),r.join(" ")}function v(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},r=0,o=e;r<o.length;r++){var c=o[r];if(c)for(var i in c)if(c.hasOwnProperty(i)){var a=n[i],s=c[i];n[i]=void 0===a?s:(Array.isArray(a)?a:[a]).concat(Array.isArray(s)?s:[s])}}return n}function g(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={},r={},o=e[0];if(o){e.length>1&&(o=v.apply(void 0,e));var c=[];for(var i in o)if(o.hasOwnProperty(i)){var a=M(o[i]),s=a.classes,u=p({displayName:i},a.objects);c.push(u),u&&(r[i]=u.className,n[i]=s.concat([u.className]).join(" "))}for(var f=0,l=c;f<l.length;f++)(u=l[f])&&b(u,r)}return n}function A(e){y.b.getInstance().insertRule("@font-face{"+l(e)+"}")}function O(e){var t=y.b.getInstance(),n=t.getClassName(),r=[];for(var o in e)e.hasOwnProperty(o)&&r.push(o,"{",l(e[o]),"}");var c=r.join("");return t.insertRule("@keyframes "+n+"{"+c+"}"),t.cacheClassName(n,c,[],["keyframes",c]),n}var z,y=n("31e0f288ed038a50d3d3"),m={"user-select":1},L=["column-count","font-weight","flex-basis","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"],S=n("97f5caeed1a44c59fd0c"),N="displayName";n.d(t,"g",function(){return h}),n.d(t,"f",function(){return g}),n.d(t,"c",function(){return v}),n.d(t,"d",function(){return A}),n.d(t,"e",function(){return O}),n.d(t,"a",function(){return y.a}),n.d(t,"b",function(){return y.b})},"12ad4997381b52bb6668":function(e,t,n){"use strict";var r=n("6fb0743f2477864eee04"),o=n("26d635265766889bfb00"),c="[object Arguments]",i=function(e){return Object(o.a)(e)&&Object(r.a)(e)==c},a=Object.prototype,s=a.hasOwnProperty,u=a.propertyIsEnumerable,f=i(function(){return arguments}())?i:function(e){return Object(o.a)(e)&&s.call(e,"callee")&&!u.call(e,"callee")};t.a=f},"13a0a4d0580180405100":function(e,t,n){"use strict";t.a=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},"13c4ea9cb8ef42624470":function(e,t,n){"use strict";var r=n("c92d61b776700b40aa82"),o=n("4605ae836ca138d7eb59"),c=n("71d97e0a6ad15ad887dd"),i=Math.max;t.a=function(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var s=null==n?0:Object(c.a)(n);return s<0&&(s=i(a+s,0)),Object(r.a)(e,Object(o.a)(t,3),s)}},"14a2d3a77eb6ff2980ad":function(e,t,n){"use strict";t.a=function(e){return e!==e}},"14f3ae474ec63bc9b4d8":function(e,t,n){"use strict";var r=n("9809d144ff362f4032ae"),o=1/0,c=1.7976931348623157e308;t.a=function(e){return e?(e=Object(r.a)(e))===o||e===-o?(e<0?-1:1)*c:e===e?e:0:0===e?e:0}},"18abc8bf02b8e9156c7e":function(e,t,n){"use strict";(function(e,r){function o(e,t){function n(){this.constructor=e}Ot(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,c=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=c.next()).done;)i.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=c.return)&&n.call(c)}finally{if(o)throw o.error}}return i}function i(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}function a(e,t){var n=t?yt:mt;return n[e]||(n[e]={configurable:!0,enumerable:t,get:function(){return s(this),this[e]},set:function(t){s(this),this[e]=t}})}function s(e){if(!0!==e.__mobxDidRunLazyInitializers){var t=e.__mobxDecorators;if(t){Ce(e,"__mobxDidRunLazyInitializers",!0);for(var n in t){var r=t[n];r.propertyCreator(e,r.prop,r.descriptor,r.decoratorTarget,r.decoratorArguments)}}}}function u(e,t){return function(){var n,r=function(r,o,c,i){if(!0===i)return t(r,o,c,r,n),null;if(!Object.prototype.hasOwnProperty.call(r,"__mobxDecorators")){var s=r.__mobxDecorators;Ce(r,"__mobxDecorators",zt({},s))}return r.__mobxDecorators[o]={prop:o,propertyCreator:t,descriptor:c,decoratorTarget:r,decoratorArguments:n},a(o,e)};return f(arguments)?(n=an,r.apply(null,arguments)):(n=Array.prototype.slice.call(arguments),r)}}function f(e){return(2===e.length||3===e.length)&&"string"==typeof e[1]||4===e.length&&!0===e[3]}function l(){return!!ln.spyListeners.length}function p(e){if(ln.spyListeners.length)for(var t=ln.spyListeners,n=0,r=t.length;n<r;n++)t[n](e)}function b(e){p(zt({},e,{spyReportStart:!0}))}function d(e){p(e?zt({},e,{spyReportEnd:!0}):Lt)}function M(e){return ln.spyListeners.push(e),qe(function(){ln.spyListeners=ln.spyListeners.filter(function(t){return t!==e})})}function h(e,t){var n=function(){return v(e,t,this,arguments)};return n.isMobxAction=!0,n}function v(e,t,n,r){var o=g(e,t,n,r);try{return t.apply(n,r)}finally{A(o)}}function g(e,t,n,r){var o=l()&&!!e,c=0;if(o){c=Date.now();var i=r&&r.length||0,a=new Array(i);if(i>0)for(var s=0;s<i;s++)a[s]=r[s];b({type:"action",name:e,object:n,arguments:a})}var u=st();return Ge(),{prevDerivation:u,prevAllowStateChanges:z(!0),notifySpy:o,startTime:c}}function A(e){y(e.prevAllowStateChanges),Ke(),ut(e.prevDerivation),e.notifySpy&&d({time:Date.now()-e.startTime})}function O(e,t){var n,r=z(e);try{n=t()}finally{y(r)}return n}function z(e){var t=ln.allowStateChanges;return ln.allowStateChanges=e,t}function y(e){ln.allowStateChanges=e}function m(){Le(!1)}function L(e){return function(t,n,r){if(r){if(r.value)return{value:h(e,r.value),enumerable:!1,configurable:!0,writable:!0};var o=r.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return h(e,o.call(this))}}}return S(e).apply(this,arguments)}}function S(e){return function(t,n,r){Object.defineProperty(t,n,{configurable:!0,enumerable:!1,get:function(){},set:function(t){Ce(this,n,St(e,t))}})}}function N(e,t){var n="string"==typeof e?e:e.name||"<unnamed action>",r="function"==typeof e?e:t;return v(n,r,this,void 0)}function q(e,t,n){Ce(e,t,h(t,n.bind(e)))}function T(e,t){return W(e,t)}function W(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!==e)return t!==t;var o=typeof e;return("function"===o||"object"===o||"object"==typeof t)&&B(e,t,n,r)}function B(e,t,n,r){e=C(e),t=C(t);var o=Nt.call(e);if(o!==Nt.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t)}var c="[object Array]"===o;if(!c){if("object"!=typeof e||"object"!=typeof t)return!1;var i=e.constructor,a=t.constructor;if(i!==a&&!("function"==typeof i&&i instanceof i&&"function"==typeof a&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];for(var s=n.length;s--;)if(n[s]===e)return r[s]===t;if(n.push(e),r.push(t),c){if((s=e.length)!==t.length)return!1;for(;s--;)if(!W(e[s],t[s],n,r))return!1}else{var u,f=Object.keys(e);if(s=f.length,Object.keys(t).length!==s)return!1;for(;s--;)if(u=f[s],!w(t,u)||!W(e[u],t[u],n,r))return!1}return n.pop(),r.pop(),!0}function C(e){return ze(e)?e.peek():Ee(e)||Jt(e)?Re(e.entries()):e}function w(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function j(e,t){return e===t}function _(e,t){function n(){e(r)}void 0===t&&(t=sn);var r,o=t&&t.name||e.name||"Autorun@"+me();if(!t.scheduler&&!t.delay)r=new vn(o,function(){this.track(n)},t.onError);else{var c=X(t),i=!1;r=new vn(o,function(){i||(i=!0,c(function(){i=!1,r.isDisposed||r.track(n)}))},t.onError)}return r.schedule(),r.getDisposer()}function X(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:Tt}function E(e,t){return function(){try{return t.apply(this,arguments)}catch(t){e.call(this,t)}}}function k(e){return void 0!==e.interceptors&&e.interceptors.length>0}function R(e,t){var n=e.interceptors||(e.interceptors=[]);return n.push(t),qe(function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)})}function P(e,t){var n=st();try{var r=e.interceptors;if(r)for(var o=0,c=r.length;o<c&&(t=r[o](t),Se(!t||t.type,"Intercept handlers should return nothing or a change object"),t);o++);return t}finally{ut(n)}}function x(e){return void 0!==e.changeListeners&&e.changeListeners.length>0}function D(e,t){var n=e.changeListeners||(e.changeListeners=[]);return n.push(t),qe(function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)})}function I(e,t){var n=st(),r=e.changeListeners;if(r){for(var o=0,c=(r=r.slice()).length;o<c;o++)r[o](t);ut(n)}}function F(e,t,n){void 0===t&&(t=""),void 0===n&&(n=oe);var r=e.$mobx;return r||(Be(e)||(t=(e.constructor.name||"ObservableObject")+"@"+me()),t||(t="ObservableObject@"+me()),r=new jt(e,t,n),we(e,"$mobx",r),r)}function U(e,t,n,r){var o=F(e);if(je(e,t),k(o)){var c=P(o,{object:e,name:t,type:"add",newValue:n});if(!c)return;n=c.newValue}n=(o.values[t]=new wt(n,r,o.name+"."+t,!1)).value,Object.defineProperty(e,t,V(t)),o.keys&&o.keys.push(t),$(o,e,t,n)}function H(e,t,n){var r=F(e);n.name=r.name+"."+t,n.context=e,r.values[t]=new Wt(n),Object.defineProperty(e,t,K(t))}function V(e){return _t[e]||(_t[e]={configurable:!0,enumerable:!0,get:function(){return this.$mobx.read(this,e)},set:function(t){this.$mobx.write(this,e,t)}})}function G(e){var t=e.$mobx;return t||(s(e),e.$mobx)}function K(e){return Xt[e]||(Xt[e]={configurable:!0,enumerable:!1,get:function(){return G(this).read(this,e)},set:function(t){G(this).write(this,e,t)}})}function $(e,t,n,r){var o=x(e),c=l(),i=o||c?{type:"add",object:t,name:n,newValue:r}:null;c&&b(zt({},i,{name:e.name,key:n})),o&&I(e,i),c&&d()}function Q(e){return!!We(e)&&(s(e),Et(e.$mobx))}function J(t){var n=u(!0,function(e,n,r,o,c){U(e,n,r?r.initializer?r.initializer.call(e):r.value:void 0,t)}),r=(void 0!==e&&Object({NODE_ENV:"production"}),n);return r.enhancer=t,r}function Y(e,t){if(null===e||void 0===e)return!1;if(void 0!==t){if(Q(e)){var n=e.$mobx;return n.values&&!!n.values[t]}return!1}return Q(e)||!!e.$mobx||Qt(e)||On(e)||Bt(e)}function Z(e){return 1!==arguments.length&&Le(!1),Y(e)}function ee(e,t,n,r){var o=(r=te(r)).defaultDecorator||(!1===r.deep?Ft:Dt);F(e,r.name,o.enhancer),Ge();try{for(var c in t){var i=Object.getOwnPropertyDescriptor(t,c),a=n&&c in n?n[c]:i.get?kt:o,s=a(e,c,i,!0);s&&Object.defineProperty(e,c,s)}}finally{Ke()}return e}function te(e){return null===e||void 0===e?Pt:"string"==typeof e?{name:e,deep:!0}:e}function ne(e){return e.defaultDecorator?e.defaultDecorator.enhancer:!1===e.deep?ce:oe}function re(e){Le("Expected one or two arguments to observable."+e+". Did you accidentally try to use observable."+e+" as decorator?")}function oe(e,t,n){return Z(e)?e:Array.isArray(e)?Vt.array(e,{name:n}):Be(e)?Vt.object(e,void 0,{name:n}):Ee(e)?Vt.map(e,{name:n}):e}function ce(e){return e}function ie(){return"function"==typeof Symbol&&Symbol.iterator||"@@iterator"}function ae(e,t){we(e,ie(),t)}function se(e){return e[ie()]=ue,e}function ue(){return this}function fe(e,t){void 0===t&&(t=void 0),Ge();try{return e.apply(t)}finally{Ke()}}function le(e,t){if("object"==typeof e&&null!==e){if(ze(e))return void 0!==t&&Le(!1),e.$mobx.atom;if(Jt(e)){var n=e;return void 0===t?le(n._keys):((r=n._data.get(t)||n._hasMap.get(t))||Le(!1),r)}if(s(e),t&&!e.$mobx&&e[t],Q(e)){if(!t)return Le(!1);var r=e.$mobx.values[t];return r||Le(!1),r}if(Qt(e)||Bt(e)||On(e))return e}else if("function"==typeof e&&On(e.$mobx))return e.$mobx;return Le(!1)}function pe(e,t){return e||Le("Expecting some object"),void 0!==t?pe(le(e,t)):Qt(e)||Bt(e)||On(e)?e:Jt(e)?e:(s(e),e.$mobx?e.$mobx:void Le(!1))}function be(e,t){return(void 0!==t?le(e,t):Q(e)||Jt(e)?pe(e):le(e)).name}function de(e,t,n){return he("onBecomeObserved",e,t,n)}function Me(e,t,n){return he("onBecomeUnobserved",e,t,n)}function he(e,t,n,r){var o="string"==typeof n?le(t,n):le(t),c="string"==typeof n?r:n,i=o[e];return"function"!=typeof i?Le(!1):(o[e]=function(){i.call(this),c.call(this)},function(){o[e]=i})}function ve(e,t,n){void 0===t&&(t=un),void 0===n&&(n=un);var r=new $t(e);return de(r,t),Me(r,n),r}function ge(e){return{enumerable:!1,configurable:!1,get:function(){return this.get(e)},set:function(t){this.set(e,t)}}}function Ae(e){Object.defineProperty(nn.prototype,""+e,ge(e))}function Oe(e){for(var t=Zt;t<e;t++)Ae(t);Zt=e}function ze(e){return We(e)&&on(e.$mobx)}function ye(){return"undefined"!=typeof window?window:r}function me(){return++ln.mobxGuid}function Le(e){throw Se(!1,e),"X"}function Se(e,t){if(!e)throw new Error("[mobx] "+(t||cn))}function Ne(e,t){return!1}function qe(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}function Te(e){var t=[];return e.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),t}function We(e){return null!==e&&"object"==typeof e}function Be(e){if(null===e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}function Ce(e,t,n){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0,value:n})}function we(e,t,n){Object.defineProperty(e,t,{enumerable:!1,writable:!1,configurable:!0,value:n})}function je(e,t){}function _e(e,t){var n="isMobX"+e;return t.prototype[n]=!0,function(e){return We(e)&&!0===e[n]}}function Xe(e,t){return"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}function Ee(e){return void 0!==ye().Map&&e instanceof ye().Map}function ke(e){return Be(e)?Object.keys(e):Array.isArray(e)?e.map(function(e){return c(e,1)[0]}):Ee(e)||Jt(e)?Re(e.keys()):Le("Cannot get keys from '"+e+"'")}function Re(e){for(var t=[];;){var n=e.next();if(n.done)break;t.push(n.value)}return t}function Pe(){return"function"==typeof Symbol&&Symbol.toPrimitive||"@@toPrimitive"}function xe(e){return null===e?null:"object"==typeof e?""+e:e}function De(){pn=!0,ye().__mobxInstanceCount--}function Ie(e,t){return Fe(le(e,t))}function Fe(e){var t={name:e.name};return e.observing&&e.observing.length>0&&(t.dependencies=Te(e.observing).map(Fe)),t}function Ue(e,t){var n=e.observers.length;n&&(e.observersIndexes[t.__mapid]=n),e.observers[n]=t,e.lowestObserverState>t.dependenciesState&&(e.lowestObserverState=t.dependenciesState)}function He(e,t){if(1===e.observers.length)e.observers.length=0,Ve(e);else{var n=e.observers,r=e.observersIndexes,o=n.pop();if(o!==t){var c=r[t.__mapid]||0;c?r[o.__mapid]=c:delete r[o.__mapid],n[c]=o}delete r[t.__mapid]}}function Ve(e){!1===e.isPendingUnobservation&&(e.isPendingUnobservation=!0,ln.pendingUnobservations.push(e))}function Ge(){ln.inBatch++}function Ke(){if(0==--ln.inBatch){bt();for(var e=ln.pendingUnobservations,t=0;t<e.length;t++){var n=e[t];n.isPendingUnobservation=!1,0===n.observers.length&&(n.isBeingObserved&&(n.isBeingObserved=!1,n.onBecomeUnobserved()),n instanceof Wt&&n.suspend())}ln.pendingUnobservations=[]}}function $e(e){var t=ln.trackingDerivation;return null!==t?(t.runId!==e.lastAccessedBy&&(e.lastAccessedBy=t.runId,t.newObserving[t.unboundDepsCount++]=e,e.isBeingObserved||(e.isBeingObserved=!0,e.onBecomeObserved())),!0):(0===e.observers.length&&ln.inBatch>0&&Ve(e),!1)}function Qe(e){if(e.lowestObserverState!==dn.STALE){e.lowestObserverState=dn.STALE;for(var t=e.observers,n=t.length;n--;){var r=t[n];r.dependenciesState===dn.UP_TO_DATE&&(r.isTracing!==Mn.NONE&&Ze(r,e),r.onBecomeStale()),r.dependenciesState=dn.STALE}}}function Je(e){if(e.lowestObserverState!==dn.STALE){e.lowestObserverState=dn.STALE;for(var t=e.observers,n=t.length;n--;){var r=t[n];r.dependenciesState===dn.POSSIBLY_STALE?r.dependenciesState=dn.STALE:r.dependenciesState===dn.UP_TO_DATE&&(e.lowestObserverState=dn.UP_TO_DATE)}}}function Ye(e){if(e.lowestObserverState===dn.UP_TO_DATE){e.lowestObserverState=dn.POSSIBLY_STALE;for(var t=e.observers,n=t.length;n--;){var r=t[n];r.dependenciesState===dn.UP_TO_DATE&&(r.dependenciesState=dn.POSSIBLY_STALE,r.isTracing!==Mn.NONE&&Ze(r,e),r.onBecomeStale())}}}function Ze(e,t){if(console.log("[mobx.trace] '"+e.name+"' is invalidated due to a change in: '"+t.name+"'"),e.isTracing===Mn.BREAK){var n=[];et(Ie(e),n,1),new Function("debugger;\n/*\nTracing '"+e.name+"'\n\nYou are entering this break point because derivation '"+e.name+"' is being traced and '"+t.name+"' is now forcing it to update.\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\n\n"+(e instanceof Wt?e.derivation.toString():"")+"\n\nThe dependencies for this derivation are:\n\n"+n.join("\n")+"\n*/\n    ")()}}function et(e,t,n){t.length>=1e3?t.push("(and many more)"):(t.push(""+new Array(n).join("\t")+e.name),e.dependencies&&e.dependencies.forEach(function(e){return et(e,t,n+1)}))}function tt(e){return e instanceof hn}function nt(e){switch(e.dependenciesState){case dn.UP_TO_DATE:return!1;case dn.NOT_TRACKING:case dn.STALE:return!0;case dn.POSSIBLY_STALE:for(var t=st(),n=e.observing,r=n.length,o=0;o<r;o++){var c=n[o];if(Bt(c)){if(ln.disableErrorBoundaries)c.get();else try{c.get()}catch(e){return ut(t),!0}if(e.dependenciesState===dn.STALE)return ut(t),!0}}return ft(e),ut(t),!1}}function rt(e){var t=e.observers.length>0;ln.computationDepth>0&&t&&Le(!1),ln.allowStateChanges||!t&&"strict"!==ln.enforceActions||Le(!1)}function ot(e,t,n){ft(e),e.newObserving=new Array(e.observing.length+100),e.unboundDepsCount=0,e.runId=++ln.runId;var r=ln.trackingDerivation;ln.trackingDerivation=e;var o;if(!0===ln.disableErrorBoundaries)o=t.call(n);else try{o=t.call(n)}catch(e){o=new hn(e)}return ln.trackingDerivation=r,ct(e),o}function ct(e){for(var t=e.observing,n=e.observing=e.newObserving,r=dn.UP_TO_DATE,o=0,c=e.unboundDepsCount,i=0;i<c;i++)0===(a=n[i]).diffValue&&(a.diffValue=1,o!==i&&(n[o]=a),o++),a.dependenciesState>r&&(r=a.dependenciesState);for(n.length=o,e.newObserving=null,c=t.length;c--;)0===(a=t[c]).diffValue&&He(a,e),a.diffValue=0;for(;o--;){var a=n[o];1===a.diffValue&&(a.diffValue=0,Ue(a,e))}r!==dn.UP_TO_DATE&&(e.dependenciesState=r,e.onBecomeStale())}function it(e){var t=e.observing;e.observing=[];for(var n=t.length;n--;)He(t[n],e);e.dependenciesState=dn.NOT_TRACKING}function at(e){var t=st(),n=e();return ut(t),n}function st(){var e=ln.trackingDerivation;return ln.trackingDerivation=null,e}function ut(e){ln.trackingDerivation=e}function ft(e){if(e.dependenciesState!==dn.UP_TO_DATE){e.dependenciesState=dn.UP_TO_DATE;for(var t=e.observing,n=t.length;n--;)t[n].lowestObserverState=dn.UP_TO_DATE}}function lt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=!1;"boolean"==typeof e[e.length-1]&&(n=e.pop());var r=pt(e);if(!r)return Le(!1);r.isTracing===Mn.NONE&&console.log("[mobx.trace] '"+r.name+"' tracing enabled"),r.isTracing=n?Mn.BREAK:Mn.LOG}function pt(e){switch(e.length){case 0:return ln.trackingDerivation;case 1:return le(e[0]);case 2:return le(e[0],e[1])}}function bt(){ln.inBatch>0||ln.isRunningReactions||An(dt)}function dt(){ln.isRunningReactions=!0;for(var e=ln.pendingReactions,t=0;e.length>0;){++t===gn&&(console.error("Reaction doesn't converge to a stable state after "+gn+" iterations. Probably there is a cycle in the reactive function: "+e[0]),e.splice(0));for(var n=e.splice(0),r=0,o=n.length;r<o;r++)n[r].runReaction()}ln.isRunningReactions=!1}function Mt(e){var t=An;An=function(n){return e(function(){return t(n)})}}function ht(e){return Q(e)?e.$mobx.getKeys():Jt(e)?e._keys.slice():Le(!1)}function vt(e,t,n){if(2!==arguments.length)if(Q(e)){var r=e.$mobx;r.values[t]?r.write(e,t,n):U(e,t,n,r.defaultEnhancer)}else if(Jt(e))e.set(t,n);else{if(!ze(e))return Le(!1);"number"!=typeof t&&(t=parseInt(t,10)),Se(t>=0,"Not a valid index: '"+t+"'"),Ge(),t>=e.length&&(e.length=t+1),e[t]=n,Ke()}else{Ge();var o=t;try{for(var c in o)vt(e,c,o[c])}finally{Ke()}}}function gt(e,t){if(Q(e)){var n=pe(e);return n.getKeys(),n.values[t]instanceof wt}return Jt(e)?e.has(t):ze(e)?t>=0&&t<e.length:Le(!1)}function At(e){var t=e.enforceActions,n=e.computedRequiresReaction,r=e.disableErrorBoundaries,o=e.arrayBuffer,c=e.reactionScheduler;if(void 0!==t){if("boolean"!=typeof t&&"strict"!==t)return fail("Invalid configuration for 'enforceActions': "+t);ln.enforceActions=t,ln.allowStateChanges=!0!==t&&"strict"!==t}void 0!==n&&(ln.computedRequiresReaction=!!n),!0===e.isolateGlobalState&&De(),void 0!==r&&(!0===r&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on."),ln.disableErrorBoundaries=!!r),"number"==typeof o&&Oe(o),c&&Mt(c)}n.d(t,"a",function(){return vn}),n.d(t,"m",function(){return at}),n.d(t,"e",function(){return ve}),n.d(t,"l",function(){return M}),n.d(t,"i",function(){return Q}),n.d(t,"g",function(){return ze}),n.d(t,"h",function(){return Jt}),n.d(t,"j",function(){return Vt}),n.d(t,"c",function(){return St}),n.d(t,"k",function(){return N}),n.d(t,"d",function(){return At}),n.d(t,"f",function(){return be}),n.d(t,"b",function(){return O});var Ot=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},zt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},yt={},mt={},Lt={spyReportEnd:!0},St=function(e,t,n,r){return 1===arguments.length&&"function"==typeof e?h(e.name||"<unnamed action>",e):2===arguments.length&&"function"==typeof t?h(e,t):1===arguments.length&&"string"==typeof e?L(e):!0!==r?L(t).apply(null,arguments):void(e[t]=h(e.name||t,n.value))};St.bound=function(e,t,n,r){return!0===r?(q(e,t,n.value),null):n?{configurable:!0,enumerable:!1,get:function(){return q(this,t,n.value||n.initializer.call(this)),this[t]},set:m}:{enumerable:!1,configurable:!0,set:function(e){q(this,t,e)},get:function(){}}};var Nt=Object.prototype.toString,qt={identity:j,structural:function(e,t){return T(e,t)},default:function(e,t){return Xe(e,t)||j(e,t)}},Tt=function(e){return e()},Wt=function(){function e(e){var t=this;this.dependenciesState=dn.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=dn.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+me(),this.value=new hn(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=Mn.NONE,this.derivation=e.get,this.name=e.name||"ComputedValue@"+me(),e.set&&(this.setter=h(this.name+"-setter",e.set)),this.equals=e.equals||(e.compareStructural||e.struct?qt.structural:qt.default),this.scope=e.context,this.requiresReaction=!!e.requiresReaction,!0===e.keepAlive&&_(function(){return t.get()})}return e.prototype.onBecomeStale=function(){Ye(this)},e.prototype.onBecomeUnobserved=function(){},e.prototype.onBecomeObserved=function(){},e.prototype.get=function(){this.isComputing&&Le("Cycle detected in computation "+this.name+": "+this.derivation),0===ln.inBatch&&0===this.observers.length?nt(this)&&(this.warnAboutUntrackedRead(),Ge(),this.value=this.computeValue(!1),Ke()):($e(this),nt(this)&&this.trackAndCompute()&&Je(this));var e=this.value;if(tt(e))throw e.cause;return e},e.prototype.peek=function(){var e=this.computeValue(!1);if(tt(e))throw e.cause;return e},e.prototype.set=function(e){if(this.setter){Se(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,e)}finally{this.isRunningSetter=!1}}else Se(!1,!1)},e.prototype.trackAndCompute=function(){l()&&p({object:this.scope,type:"compute",name:this.name});var e=this.value,t=this.dependenciesState===dn.NOT_TRACKING,n=this.computeValue(!0),r=t||tt(e)||tt(n)||!this.equals(e,n);return r&&(this.value=n),r},e.prototype.computeValue=function(e){this.isComputing=!0,ln.computationDepth++;var t;if(e)t=ot(this,this.derivation,this.scope);else if(!0===ln.disableErrorBoundaries)t=this.derivation.call(this.scope);else try{t=this.derivation.call(this.scope)}catch(e){t=new hn(e)}return ln.computationDepth--,this.isComputing=!1,t},e.prototype.suspend=function(){it(this),this.value=void 0},e.prototype.observe=function(e,t){var n=this,r=!0,o=void 0;return _(function(){var c=n.get();if(!r||t){var i=st();e({type:"update",object:n,newValue:c,oldValue:o}),ut(i)}r=!1,o=c})},e.prototype.warnAboutUntrackedRead=function(){},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},e.prototype.valueOf=function(){return xe(this.get())},e}();Wt.prototype[Pe()]=Wt.prototype.valueOf;var Bt=_e("ComputedValue",Wt),Ct={};$t||($t=function(){function e(e){void 0===e&&(e="Atom@"+me()),this.name=e,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=dn.NOT_TRACKING}return e.prototype.onBecomeUnobserved=function(){},e.prototype.onBecomeObserved=function(){},e.prototype.reportObserved=function(){return $e(this)},e.prototype.reportChanged=function(){Ge(),Qe(this),Ke()},e.prototype.toString=function(){return this.name},e}(),Qt=_e("Atom",$t));var wt=function(e){function t(t,n,r,o){void 0===r&&(r="ObservableValue@"+me()),void 0===o&&(o=!0);var c=e.call(this,r)||this;return c.enhancer=n,c.hasUnreportedChange=!1,c.value=n(t,void 0,r),o&&l()&&p({type:"create",name:c.name,newValue:""+c.value}),c}return o(t,e),t.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.prototype.set=function(e){var t=this.value;if((e=this.prepareNewValue(e))!==Ct){var n=l();n&&b({type:"update",name:this.name,newValue:e,oldValue:t}),this.setNewValue(e),n&&d()}},t.prototype.prepareNewValue=function(e){if(rt(this),k(this)){var t=P(this,{object:this,type:"update",newValue:e});if(!t)return Ct;e=t.newValue}return e=this.enhancer(e,this.value,this.name),this.value!==e?e:Ct},t.prototype.setNewValue=function(e){var t=this.value;this.value=e,this.reportChanged(),x(this)&&I(this,{type:"update",object:this,newValue:e,oldValue:t})},t.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},t.prototype.intercept=function(e){return R(this,e)},t.prototype.observe=function(e,t){return t&&e({object:this,type:"update",newValue:this.value,oldValue:void 0}),D(this,e)},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.value+"]"},t.prototype.valueOf=function(){return xe(this.get())},t}($t);wt.prototype[Pe()]=wt.prototype.valueOf;_e("ObservableValue",wt);var jt=function(){function e(e,t,n){this.target=e,this.name=t,this.defaultEnhancer=n,this.values={}}return e.prototype.read=function(e,t){if(this.target===e||(this.illegalAccess(e,t),this.values[t]))return this.values[t].get()},e.prototype.write=function(e,t,n){var r=this.target;r!==e&&this.illegalAccess(e,t);var o=this.values[t];if(o instanceof Wt)o.set(n);else{if(k(this)){if(!(a=P(this,{type:"update",object:r,name:t,newValue:n})))return;n=a.newValue}if((n=o.prepareNewValue(n))!==Ct){var c=x(this),i=l(),a=c||i?{type:"update",object:r,oldValue:o.value,name:t,newValue:n}:null;i&&b(zt({},a,{name:this.name,key:t})),o.setNewValue(n),c&&I(this,a),i&&d()}}},e.prototype.remove=function(e){if(this.values[e]){var t=this.target;if(!k(this)||(c=P(this,{object:t,name:e,type:"remove"})))try{Ge();var n=x(this),r=l(),o=this.values[e].get();this.keys&&this.keys.remove(e),delete this.values[e],delete this.target[e];var c=n||r?{type:"remove",object:t,oldValue:o,name:e}:null;r&&b(zt({},c,{name:this.name,key:e})),n&&I(this,c),r&&d()}finally{Ke()}}},e.prototype.illegalAccess=function(e,t){console.warn("Property '"+t+"' of '"+e+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},e.prototype.observe=function(e,t){return D(this,e)},e.prototype.intercept=function(e){return R(this,e)},e.prototype.getKeys=function(){var e=this;return void 0===this.keys&&(this.keys=new nn(Object.keys(this.values).filter(function(t){return e.values[t]instanceof wt}),ce,"keys("+this.name+")",!0)),this.keys.slice()},e}(),_t={},Xt={},Et=_e("ObservableObjectAdministration",jt),kt=u(!1,function(e,t,n,r,o){var c=n.get,i=n.set,a=o[0]||{};H(e,t,zt({get:c,set:i},a))}),Rt=kt({equals:qt.structural});(function(e,t,n){if("string"==typeof t)return kt.apply(null,arguments);if(null!==e&&"object"==typeof e&&1===arguments.length)return kt.apply(null,arguments);var r="object"==typeof t?t:{};return r.get=e,r.set="function"==typeof t?t:r.set,r.name=r.name||e.name||"",new Wt(r)}).struct=Rt;var Pt={deep:!0,name:void 0,defaultDecorator:void 0},xt={deep:!1,name:void 0,defaultDecorator:void 0};Object.freeze(Pt),Object.freeze(xt);var Dt=J(oe),It=J(function(e,t,n){return void 0===e||null===e?e:Q(e)||ze(e)||Jt(e)?e:Array.isArray(e)?Vt.array(e,{name:n,deep:!1}):Be(e)?Vt.object(e,void 0,{name:n,deep:!1}):Ee(e)?Vt.map(e,{name:n,deep:!1}):Le(!1)}),Ft=J(ce),Ut=J(function(e,t,n){return T(e,t)?t:e}),Ht={box:function(e,t){arguments.length>2&&re("box");var n=te(t);return new wt(e,ne(n),n.name)},shallowBox:function(e,t){return arguments.length>2&&re("shallowBox"),Ne("observable.shallowBox","observable.box(value, { deep: false })"),Vt.box(e,{name:t,deep:!1})},array:function(e,t){arguments.length>2&&re("array");var n=te(t);return new nn(e,ne(n),n.name)},shallowArray:function(e,t){return arguments.length>2&&re("shallowArray"),Ne("observable.shallowArray","observable.array(values, { deep: false })"),Vt.array(e,{name:t,deep:!1})},map:function(e,t){arguments.length>2&&re("map");var n=te(t);return new Kt(e,ne(n),n.name)},shallowMap:function(e,t){return arguments.length>2&&re("shallowMap"),Ne("observable.shallowMap","observable.map(values, { deep: false })"),Vt.map(e,{name:t,deep:!1})},object:function(e,t,n){return"string"==typeof arguments[1]&&re("object"),ee({},e,t,te(n))},shallowObject:function(e,t){return"string"==typeof arguments[1]&&re("shallowObject"),Ne("observable.shallowObject","observable.object(values, {}, { deep: false })"),Vt.object(e,{},{name:t,deep:!1})},ref:Ft,shallow:It,deep:Dt,struct:Ut},Vt=function(e,t,n){if("string"==typeof arguments[1])return Dt.apply(null,arguments);if(Z(e))return e;var r=Be(e)?Vt.object(e,t,n):Array.isArray(e)?Vt.array(e,t):Ee(e)?Vt.map(e,t):e;if(r!==e)return r;Le(!1)};Object.keys(Ht).forEach(function(e){return Vt[e]=Ht[e]});var Gt={},Kt=function(){function e(e,t,n){if(void 0===t&&(t=oe),void 0===n&&(n="ObservableMap@"+me()),this.enhancer=t,this.name=n,this.$mobx=Gt,this._keys=new nn(void 0,ce,this.name+".keys()",!0),"function"!=typeof Map)throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(e)}return e.prototype._has=function(e){return this._data.has(e)},e.prototype.has=function(e){return this._hasMap.has(e)?this._hasMap.get(e).get():this._updateHasMapEntry(e,!1).get()},e.prototype.set=function(e,t){var n=this._has(e);if(k(this)){var r=P(this,{type:n?"update":"add",object:this,newValue:t,name:e});if(!r)return this;t=r.newValue}return n?this._updateValue(e,t):this._addValue(e,t),this},e.prototype.delete=function(e){var t=this;if(k(this)&&!(o=P(this,{type:"delete",object:this,name:e})))return!1;if(this._has(e)){var n=l(),r=x(this),o=r||n?{type:"delete",object:this,oldValue:this._data.get(e).value,name:e}:null;return n&&b(zt({},o,{name:this.name,key:e})),fe(function(){t._keys.remove(e),t._updateHasMapEntry(e,!1),t._data.get(e).setNewValue(void 0),t._data.delete(e)}),r&&I(this,o),n&&d(),!0}return!1},e.prototype._updateHasMapEntry=function(e,t){var n=this._hasMap.get(e);return n?n.setNewValue(t):(n=new wt(t,ce,this.name+"."+e+"?",!1),this._hasMap.set(e,n)),n},e.prototype._updateValue=function(e,t){var n=this._data.get(e);if((t=n.prepareNewValue(t))!==Ct){var r=l(),o=x(this),c=o||r?{type:"update",object:this,oldValue:n.value,name:e,newValue:t}:null;r&&b(zt({},c,{name:this.name,key:e})),n.setNewValue(t),o&&I(this,c),r&&d()}},e.prototype._addValue=function(e,t){var n=this;fe(function(){var r=new wt(t,n.enhancer,n.name+"."+e,!1);n._data.set(e,r),t=r.value,n._updateHasMapEntry(e,!0),n._keys.push(e)});var r=l(),o=x(this),c=o||r?{type:"add",object:this,name:e,newValue:t}:null;r&&b(zt({},c,{name:this.name,key:e})),o&&I(this,c),r&&d()},e.prototype.get=function(e){return this.has(e)?this.dehanceValue(this._data.get(e).get()):this.dehanceValue(void 0)},e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.keys=function(){return this._keys[ie()]()},e.prototype.values=function(){var e=this,t=0;return se({next:function(){return t<e._keys.length?{value:e.get(e._keys[t++]),done:!1}:{value:void 0,done:!0}}})},e.prototype.entries=function(){var e=this,t=0;return se({next:function(){if(t<e._keys.length){var n=e._keys[t++];return{value:[n,e.get(n)],done:!1}}return{done:!0}}})},e.prototype.forEach=function(e,t){var n=this;this._keys.forEach(function(r){return e.call(t,n.get(r),r,n)})},e.prototype.merge=function(e){var t=this;return Jt(e)&&(e=e.toJS()),fe(function(){Be(e)?Object.keys(e).forEach(function(n){return t.set(n,e[n])}):Array.isArray(e)?e.forEach(function(e){var n=c(e,2),r=n[0],o=n[1];return t.set(r,o)}):Ee(e)?e.forEach(function(e,n){return t.set(n,e)}):null!==e&&void 0!==e&&Le("Cannot initialize map from "+e)}),this},e.prototype.clear=function(){var e=this;fe(function(){at(function(){e._keys.slice().forEach(function(t){return e.delete(t)})})})},e.prototype.replace=function(e){var t=this;return fe(function(){var n=ke(e);t._keys.filter(function(e){return-1===n.indexOf(e)}).forEach(function(e){return t.delete(e)}),t.merge(e)}),this},Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.toPOJO=function(){var e=this,t={};return this._keys.forEach(function(n){return t[""+n]=e.get(n)}),t},e.prototype.toJS=function(){var e=this,t=new Map;return this._keys.forEach(function(n){return t.set(n,e.get(n))}),t},e.prototype.toJSON=function(){return this.toPOJO()},e.prototype.toString=function(){var e=this;return this.name+"[{ "+this._keys.map(function(t){return t+": "+e.get(t)}).join(", ")+" }]"},e.prototype.observe=function(e,t){return D(this,e)},e.prototype.intercept=function(e){return R(this,e)},e}();ae(Kt.prototype,function(){return this.entries()}),we(Kt.prototype,"undefined"!=typeof Symbol?Symbol.toStringTag:"@@toStringTag","Map");var $t,Qt,Jt=_e("ObservableMap",Kt),Yt=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)[0]=1,!1===e}(),Zt=0,en=function(){return function(){}}();!function(e,t){void 0!==Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,t):void 0!==e.prototype.__proto__?e.prototype.__proto__=t:e.prototype=t}(en,Array.prototype),Object.isFrozen(Array)&&["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach(function(e){Object.defineProperty(en.prototype,e,{configurable:!0,writable:!0,value:Array.prototype[e]})});var tn=function(){function e(e,t,n,r){this.array=n,this.owned=r,this.values=[],this.lastKnownLength=0,this.atom=new $t(e||"ObservableArray@"+me()),this.enhancer=function(n,r){return t(n,r,e+"[..]")}}return e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.dehanceValues=function(e){return void 0!==this.dehancer&&this.values.length>0?e.map(this.dehancer):e},e.prototype.intercept=function(e){return R(this,e)},e.prototype.observe=function(e,t){return void 0===t&&(t=!1),t&&e({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),D(this,e)},e.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},e.prototype.setArrayLength=function(e){if("number"!=typeof e||e<0)throw new Error("[mobx.array] Out of range: "+e);var t=this.values.length;if(e!==t)if(e>t){for(var n=new Array(e-t),r=0;r<e-t;r++)n[r]=void 0;this.spliceWithArray(t,0,n)}else this.spliceWithArray(e,t-e)},e.prototype.updateArrayLength=function(e,t){if(e!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=t,t>0&&e+t+1>Zt&&Oe(e+t+1)},e.prototype.spliceWithArray=function(e,t,n){var r=this;rt(this.atom);var o=this.values.length;if(void 0===e?e=0:e>o?e=o:e<0&&(e=Math.max(0,o+e)),t=1===arguments.length?o-e:void 0===t||null===t?0:Math.max(0,Math.min(t,o-e)),void 0===n&&(n=an),k(this)){var c=P(this,{object:this.array,type:"splice",index:e,removedCount:t,added:n});if(!c)return an;t=c.removedCount,n=c.added}var i=(n=0===n.length?n:n.map(function(e){return r.enhancer(e,void 0)})).length-t;this.updateArrayLength(o,i);var a=this.spliceItemsIntoValues(e,t,n);return 0===t&&0===n.length||this.notifyArraySplice(e,n,a),this.dehanceValues(a)},e.prototype.spliceItemsIntoValues=function(e,t,n){if(n.length<1e4)return(o=this.values).splice.apply(o,i([e,t],n));var r=this.values.slice(e,e+t);return this.values=this.values.slice(0,e).concat(n,this.values.slice(e+t)),r;var o},e.prototype.notifyArrayChildUpdate=function(e,t,n){var r=!this.owned&&l(),o=x(this),c=o||r?{object:this.array,type:"update",index:e,newValue:t,oldValue:n}:null;r&&b(zt({},c,{name:this.atom.name})),this.atom.reportChanged(),o&&I(this,c),r&&d()},e.prototype.notifyArraySplice=function(e,t,n){var r=!this.owned&&l(),o=x(this),c=o||r?{object:this.array,type:"splice",index:e,removed:n,added:t,removedCount:n.length,addedCount:t.length}:null;r&&b(zt({},c,{name:this.atom.name})),this.atom.reportChanged(),o&&I(this,c),r&&d()},e}(),nn=function(e){function t(t,n,r,o){void 0===r&&(r="ObservableArray@"+me()),void 0===o&&(o=!1);var c=e.call(this)||this,i=new tn(r,n,c,o);return we(c,"$mobx",i),t&&t.length&&c.spliceWithArray(0,0,t),Yt&&Object.defineProperty(i.array,"0",rn),c}return o(t,e),t.prototype.intercept=function(e){return this.$mobx.intercept(e)},t.prototype.observe=function(e,t){return void 0===t&&(t=!1),this.$mobx.observe(e,t)},t.prototype.clear=function(){return this.splice(0)},t.prototype.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.$mobx.atom.reportObserved(),Array.prototype.concat.apply(this.peek(),e.map(function(e){return ze(e)?e.peek():e}))},t.prototype.replace=function(e){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,e)},t.prototype.toJS=function(){return this.slice()},t.prototype.toJSON=function(){return this.toJS()},t.prototype.peek=function(){return this.$mobx.atom.reportObserved(),this.$mobx.dehanceValues(this.$mobx.values)},t.prototype.find=function(e,t,n){void 0===n&&(n=0),3===arguments.length&&Ne("The array.find fromIndex argument to find will not be supported anymore in the next major");var r=this.findIndex.apply(this,arguments);return-1===r?void 0:this.get(r)},t.prototype.findIndex=function(e,t,n){void 0===n&&(n=0),3===arguments.length&&Ne("The array.findIndex fromIndex argument to find will not be supported anymore in the next major");for(var r=this.peek(),o=r.length,c=n;c<o;c++)if(e.call(t,r[c],c,this))return c;return-1},t.prototype.splice=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(e);case 2:return this.$mobx.spliceWithArray(e,t)}return this.$mobx.spliceWithArray(e,t,n)},t.prototype.spliceWithArray=function(e,t,n){return this.$mobx.spliceWithArray(e,t,n)},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.$mobx;return n.spliceWithArray(n.values.length,0,e),n.values.length},t.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]},t.prototype.shift=function(){return this.splice(0,1)[0]},t.prototype.unshift=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.$mobx;return n.spliceWithArray(0,0,e),n.values.length},t.prototype.reverse=function(){var e=this.slice();return e.reverse.apply(e,arguments)},t.prototype.sort=function(e){var t=this.slice();return t.sort.apply(t,arguments)},t.prototype.remove=function(e){var t=this.$mobx.dehanceValues(this.$mobx.values).indexOf(e);return t>-1&&(this.splice(t,1),!0)},t.prototype.move=function(e,t){function n(e){if(e<0)throw new Error("[mobx.array] Index out of bounds: "+e+" is negative");var t=this.$mobx.values.length;if(e>=t)throw new Error("[mobx.array] Index out of bounds: "+e+" is not smaller than "+t)}if(Ne("observableArray.move is deprecated, use .slice() & .replace() instead"),n.call(this,e),n.call(this,t),e!==t){var r,o=this.$mobx.values;r=e<t?i(o.slice(0,e),o.slice(e+1,t+1),[o[e]],o.slice(t+1)):i(o.slice(0,t),[o[e]],o.slice(t,e),o.slice(e+1)),this.replace(r)}},t.prototype.get=function(e){var t=this.$mobx;if(t){if(e<t.values.length)return t.atom.reportObserved(),t.dehanceValue(t.values[e]);console.warn("[mobx.array] Attempt to read an array index ("+e+") that is out of bounds ("+t.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},t.prototype.set=function(e,t){var n=this.$mobx,r=n.values;if(e<r.length){rt(n.atom);var o=r[e];if(k(n)){var c=P(n,{type:"update",object:this,index:e,newValue:t});if(!c)return;t=c.newValue}(t=n.enhancer(t,o))!==o&&(r[e]=t,n.notifyArrayChildUpdate(e,t,o))}else{if(e!==r.length)throw new Error("[mobx.array] Index out of bounds, "+e+" is larger than "+r.length);n.spliceWithArray(e,0,[t])}},t}(en);ae(nn.prototype,function(){this.$mobx.atom.reportObserved();var e=this,t=0;return se({next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0,value:void 0}}})}),Object.defineProperty(nn.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobx.getArrayLength()},set:function(e){this.$mobx.setArrayLength(e)}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&Ce(nn.prototype,"undefined"!=typeof Symbol?Symbol.toStringTag:"@@toStringTag","Array"),["every","filter","forEach","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toString","toLocaleString"].forEach(function(e){var t=Array.prototype[e];Se("function"==typeof t,"Base function not defined on Array prototype: '"+e+"'"),Ce(nn.prototype,e,function(){return t.apply(this.peek(),arguments)})}),function(e,t){for(var n=0;n<t.length;n++)Ce(e,t[n],e[t[n]])}(nn.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var rn=ge(0);Oe(1e3);var on=_e("ObservableArrayAdministration",tn),cn="An invariant failed, however the error is obfuscated because this is an production build.",an=[];Object.freeze(an);var sn={};Object.freeze(sn);var un=function(){},fn=function(){return function(){this.version=5,this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.disableErrorBoundaries=!1}}(),ln=new fn,pn=!1,bn=ye();bn.__mobxInstanceCount?(bn.__mobxInstanceCount++,setTimeout(function(){pn||Le(!1)},1)):bn.__mobxInstanceCount=1;var dn;!function(e){e[e.NOT_TRACKING=-1]="NOT_TRACKING",e[e.UP_TO_DATE=0]="UP_TO_DATE",e[e.POSSIBLY_STALE=1]="POSSIBLY_STALE",e[e.STALE=2]="STALE"}(dn||(dn={}));var Mn;!function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"}(Mn||(Mn={}));var hn=function(){return function(e){this.cause=e}}(),vn=function(){function e(e,t,n){void 0===e&&(e="Reaction@"+me()),this.name=e,this.onInvalidate=t,this.errorHandler=n,this.observing=[],this.newObserving=[],this.dependenciesState=dn.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+me(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=Mn.NONE}return e.prototype.onBecomeStale=function(){this.schedule()},e.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,ln.pendingReactions.push(this),bt())},e.prototype.isScheduled=function(){return this._isScheduled},e.prototype.runReaction=function(){if(!this.isDisposed){if(Ge(),this._isScheduled=!1,nt(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&l()&&p({name:this.name,type:"scheduled-reaction"})}catch(e){this.reportExceptionInDerivation(e)}}Ke()}},e.prototype.track=function(e){Ge();var t,n=l();n&&(t=Date.now(),b({name:this.name,type:"reaction"})),this._isRunning=!0;var r=ot(this,e,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&it(this),tt(r)&&this.reportExceptionInDerivation(r.cause),n&&d({time:Date.now()-t}),Ke()},e.prototype.reportExceptionInDerivation=function(e){var t=this;if(this.errorHandler)this.errorHandler(e,this);else{if(ln.disableErrorBoundaries)throw e;var n="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this;console.error(n,e),l()&&p({type:"error",name:this.name,message:n,error:""+e}),ln.globalReactionErrorHandlers.forEach(function(n){return n(e,t)})}},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(Ge(),it(this),Ke()))},e.prototype.getDisposer=function(){var e=this.dispose.bind(this);return e.$mobx=this,e},e.prototype.toString=function(){return"Reaction["+this.name+"]"},e.prototype.trace=function(e){void 0===e&&(e=!1),lt(this,e)},e}(),gn=100,An=function(e){return e()},On=_e("Reaction",vn);"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:M,extras:{getDebugName:be}})}).call(t,n("26d59f808dff3e83c741"),n("698d75b157f24ae829cc"))},"19455a0e3b36c61ab3d4":function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},"19a031d4746b6ceaffc2":function(e,t,n){"use strict";t.noop=function(){}},"1ac3f0f0bc8d121416c3":function(e,t,n){"use strict";var r={};t.a=r},"1b51aaf361c9b5fe17ea":function(e,t,n){"use strict";var r=n("e762c53944e0ba53de07"),o=n("c460a4314000aba6b458"),c=n("0a471ffa71996fbf3cd3"),i=n("f0ecf12d5be0fc5eff7f"),a=n("8d1246b164f341c9a62f"),s=n("2a5ddf2bc8c2e65634a8"),u=n("241740b9bc448e1477af"),f=1,l=2;t.a=function(e,t){return Object(i.a)(e)&&Object(a.a)(t)?Object(s.a)(Object(u.a)(e),t):function(n){var i=Object(o.a)(n,e);return void 0===i&&i===t?Object(c.a)(n,e):Object(r.a)(t,i,f|l)}}},"1be4f739ec4db34492e4":function(e,t,n){"use strict";function r(e){if("string"==typeof e)return e;if(Object(i.a)(e))return Object(c.a)(e,r)+"";if(Object(a.a)(e))return f?f.call(e):"";var t=e+"";return"0"==t&&1/e==-s?"-0":t}var o=n("41d5bf03b3e7b6dc3b9b"),c=n("0be451910340157220f5"),i=n("517d6e3962b3db33796d"),a=n("eeb89c4dda5b564b5094"),s=1/0,u=o.a?o.a.prototype:void 0,f=u?u.toString:void 0;t.a=r},"1bf72e235ae56c1522e4":function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}var o=n("8759a32591ce105280f0");t.getSymbolObservable=r,t.observable=r(o.root),t.$$observable=t.observable},"1d99639b1edc9210398a":function(e,t,n){"use strict";var r=n("8759a32591ce105280f0").root.Symbol;t.rxSubscriber="function"==typeof r&&"function"==typeof r.for?r.for("rxSubscriber"):"@@rxSubscriber",t.$$rxSubscriber=t.rxSubscriber},"1dbba2e6ceb51d224ed6":function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=function(e){function t(t,n){e.call(this),this.subject=t,this.subscriber=n,this.closed=!1}return r(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(n("bcfe5642589c9dbfb15d").Subscription);t.SubjectSubscription=o},"1e1522e81ef082721174":function(e,t,n){"use strict";var r=n("8759a32591ce105280f0"),o=n("7f210f4f413cf9faca6e"),c=n("1bf72e235ae56c1522e4"),i=n("24b919fbb68aea707975"),a=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,c=o.toSubscriber(e,t,n);if(r?r.call(c,this.source):c.add(this.source||!c.syncErrorThrowable?this._subscribe(c):this._trySubscribe(c)),c.syncErrorThrowable&&(c.syncErrorThrowable=!1,c.syncErrorThrown))throw c.syncErrorValue;return c},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=!0,e.syncErrorValue=t,e.error(t)}},e.prototype.forEach=function(e,t){var n=this;if(t||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?t=r.root.Rx.config.Promise:r.root.Promise&&(t=r.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,r){var o;o=n.subscribe(function(t){if(o)try{e(t)}catch(e){r(e),o.unsubscribe()}else e(t)},r,t)})},e.prototype._subscribe=function(e){return this.source.subscribe(e)},e.prototype[c.observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return 0===e.length?this:i.pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;if(e||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?e=r.root.Rx.config.Promise:r.root.Promise&&(e=r.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();t.Observable=a},"1e577fef369aab55b563":function(e,t,n){"use strict";var r=n("354d70141729a36fe898"),o=n("25153e86102d7241054d"),c=n("4605ae836ca138d7eb59"),i=n("b773bc8dd8e5c3d71e12"),a=n("517d6e3962b3db33796d");t.a=function(e,t,n){var s=Object(a.a)(e)?r.a:i.a,u=arguments.length<3;return s(e,Object(c.a)(t,4),n,u,o.a)}},"2223bf3fd2b6372bfe7f":function(e,t,n){"use strict";var r=n("337b9e67dd20ada80fa5"),o=n("c946ac0dbdac302d1be3"),c=n("ce71aab72200cc3b4ad0"),i=n("f2401f53bf28e2b70eb3");t.a=function(e){var t=Object(c.a)(e),n=i.a[t];if("function"!=typeof n||!(t in r.a.prototype))return!1;if(e===n)return!0;var a=Object(o.a)(n);return!!a&&e===a[0]}},"241740b9bc448e1477af":function(e,t,n){"use strict";var r=n("eeb89c4dda5b564b5094"),o=1/0;t.a=function(e){if("string"==typeof e||Object(r.a)(e))return e;var t=e+"";return"0"==t&&1/e==-o?"-0":t}},"249cbff154ffd04c0412":function(e,t,n){"use strict";var r=n("09072e49d5f60505514c"),o=n("0bd0afb5c74547a322b4"),c=Object(r.a)(o.a,"WeakMap");t.a=c},"24b919fbb68aea707975":function(e,t,n){"use strict";function r(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}:o.noop}var o=n("19a031d4746b6ceaffc2");t.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return r(e)},t.pipeFromArray=r},"25153e86102d7241054d":function(e,t,n){"use strict";var r=n("fa11070de994a894b2a1"),o=n("a58909cb8ea1235789f0"),c=Object(o.a)(r.a);t.a=c},"25ca437399921be55963":function(e,t,n){"use strict";t.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},"26b9c59acec1595afa89":function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},"26d59f808dff3e83c741":function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(f===setTimeout)return setTimeout(e,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function c(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function i(){M&&b&&(M=!1,b.length?d=b.concat(d):h=-1,d.length&&a())}function a(){if(!M){var e=o(i);M=!0;for(var t=d.length;t;){for(b=d,d=[];++h<t;)b&&b[h].run();h=-1,t=d.length}b=null,M=!1,c(e)}}function s(e,t){this.fun=e,this.array=t}function u(){}var f,l,p=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(e){f=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var b,d=[],M=!1,h=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new s(e,t)),1!==d.length||M||o(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=u,p.addListener=u,p.once=u,p.off=u,p.removeListener=u,p.removeAllListeners=u,p.emit=u,p.prependListener=u,p.prependOnceListener=u,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},"26d635265766889bfb00":function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},"26e9318898852c9495dd":function(e,t,n){"use strict";var r=n("3b252cd5e0e6c3615b6d"),o=n("978b85f07cd53ebdd0f6");t.a=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Object(r.a)(e.prototype),c=e.apply(n,t);return Object(o.a)(c)?c:n}}},"275976081ce1abf67779":function(e,t){e.exports=React},"2898f5ca48f2d57df16d":function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n("98bae3dbabd51089d613"),o=n("8286379a454aee09d9d3"),c=n("67e970f548b29d701fa8"),i={settings:{},scopedSettings:{}},a=o.a.getValue("customizations",{settings:{},scopedSettings:{}}),s=new c.a(a),u=function(){function e(){}return e.reset=function(){a.settings={},a.scopedSettings={}},e.applySettings=function(t){a.settings=r.__assign({},a.settings,t),e._raiseChange()},e.applyScopedSettings=function(t,n){a.scopedSettings[t]=r.__assign({},a.scopedSettings[t],n),e._raiseChange()},e.getSettings=function(e,t,n){void 0===n&&(n=i);for(var r={},o=t&&n.scopedSettings[t]||{},c=t&&a.scopedSettings[t]||{},s=0,u=e;s<u.length;s++){var f=u[s];r[f]=o[f]||n.settings[f]||c[f]||a.settings[f]}return r},e.observe=function(e){s.on(a,"change",e)},e.unobserve=function(e){s.off(a,"change",e)},e._raiseChange=function(){s.raise("change")},e}()},"2a5ddf2bc8c2e65634a8":function(e,t,n){"use strict";t.a=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},"2bb326b5a5bdfb8f3774":function(e,t,n){"use strict";var r=n("1be4f739ec4db34492e4");t.a=function(e){return null==e?"":Object(r.a)(e)}},"31e0f288ed038a50d3d3":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var r,o=n("98bae3dbabd51089d613");!function(e){e[e.none=0]="none",e[e.insertNode=1]="insertNode",e[e.appendChild=2]="appendChild"}(r||(r={}));var c,i=function(){function e(e){this._rules=[],this._rulesToInsert=[],this._counter=0,this._keyToClassName={},this._classNameToArgs={},this._config=o.__assign({injectionMode:1,defaultPrefix:"css"},e)}return e.getInstance=function(){var t="undefined"!=typeof window?window:{};if(!(c=t.__stylesheet__)){var n=t&&t.FabricConfig||{};c=t.__stylesheet__=new e(n.mergeStyles)}return c},e.prototype.setConfig=function(e){this._config=o.__assign({},this._config,e)},e.prototype.getClassName=function(e){return(e||this._config.defaultPrefix)+"-"+this._counter++},e.prototype.cacheClassName=function(e,t,n,r){this._keyToClassName[t]=e,this._classNameToArgs[e]={args:n,rules:r}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[e]},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e){var t=0!==this._config.injectionMode?this._getStyleElement():void 0;if(t)switch(this._config.injectionMode){case 1:var n=t.sheet;try{n.insertRule(e,n.cssRules.length)}catch(e){}break;case 2:t.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e)},e.prototype.getRules=function(){return(this._rules.join("")||"")+(this._rulesToInsert.join("")||"")},e.prototype.reset=function(){this._rules=[],this._rulesToInsert=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={}},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._getStyleElement=function(){var e=this;return this._styleElement||"undefined"==typeof document||(this._styleElement=this._createStyleElement(),window.requestAnimationFrame(function(){e._styleElement=void 0})),this._styleElement},e.prototype._createStyleElement=function(){var e=document.createElement("style");return e.setAttribute("data-merge-styles","true"),e.type="text/css",this._lastStyleElement&&this._lastStyleElement.nextElementSibling?document.head.insertBefore(e,this._lastStyleElement.nextElementSibling):document.head.appendChild(e),this._lastStyleElement=e,e},e}()},"31e2af16f2f551db800f":function(e,t,n){"use strict";var r={themePrimary:"#6264a7",themeLighterAlt:"#f4f4f9",themeLighter:"#e3e3ef",themeLight:"#babbd8",themeTertiary:"#898bbc",themeSecondary:"#696baa",themeDarkAlt:"rgba(37, 36, 36, 0.75);",themeDark:"#3d3f6c",themeDarker:"#34365c",neutralLighterAlt:"#f8f8f8",neutralLighter:"#f3f2f1",neutralLight:"#ffffff",neutralQuaternaryAlt:"#fcfcfb",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c8c8",neutralTertiary:"#b6b4b4",neutralSecondary:"#9f9c9c",neutralPrimaryAlt:"#878383",neutralPrimary:"#252424",neutralDark:"#575454",black:"#3f3d3d",white:"#f9f8f7",primaryBackground:"#f9f8f7",primaryText:"rgba(37, 36, 36, 0.75);",bodyBackground:"#f9f8f7",bodyText:"rgba(37, 36, 36, 0.75);",disabledBackground:"#f4f4f4",disabledText:"#c8c8c8",boxShadowColor:"rgba(0, 0, 0, .5);",appGray06:"rgba(37, 36, 36, 0.3);",appGray02:"rgba(37, 36, 36, 0.75);"},o={themePrimary:"#6264a7",themeLighterAlt:"#07070c",themeLighter:"#11121e",themeLight:"#2a2b49",themeTertiary:"#48497e",themeSecondary:"#5b5ea1",themeDarkAlt:"#7274af",themeDark:"#9a9cc6",themeDarker:"#a9aace",neutralLighterAlt:"#373636",neutralLighter:"#313030",neutralLight:"#201f1f",neutralQuaternaryAlt:"#1e1d1d",neutralQuaternary:"#5c5a5a",neutralTertiaryAlt:"#787575",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#2d2c2c",primaryBackground:"#2d2c2c",primaryText:"#fff",bodyBackground:"#2d2c2c",bodyText:"#fff",disabledBackground:"#2c2b2b",disabledText:"#242323",boxShadowColor:"rgba(0, 0, 0, .5);",appGray06:"rgba(255, 255, 255, 0.3);",appGray02:"rgba(255, 255, 255, .75);"},c={themePrimary:"#ffff01",themeLighterAlt:"#121200",themeLighter:"#2e2e00",themeLight:"#6f6f00",themeTertiary:"#c0c000",themeSecondary:"#f4f400",themeDarkAlt:"#ffff19",themeDark:"#ffff5c",themeDarker:"#ffff73",neutralLighterAlt:"#0b0b0b",neutralLighter:"#151515",neutralLight:"#252525",neutralQuaternaryAlt:"#2f2f2f",neutralQuaternary:"#373737",neutralTertiaryAlt:"#595959",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#fff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#000",primaryBackground:"#000",primaryText:"#fff",bodyBackground:"#000",bodyText:"#fff",disabledBackground:"#NaNNaNNaN",disabledText:"#NaNNaNNaN",boxShadowColor:"rgba(0, 0, 0, .5);",appGray06:"#000",appGray02:"#fff"},i=n("18abc8bf02b8e9156c7e"),a=n("7d0194a0b3c301cb1b8f"),s=function(){return function(e){var t=this;this.name="theme-store",this.themeObservable=Object(i.j)({currentTheme:a.b.default}),this.changeTheme=Object(i.c)(function(e){t.themeObservable.currentTheme=e}),this.changeTheme(e)}}();Object(i.d)({enforceActions:"strict"});var u=function(){return function(e){this.themeStore=new s(Object(a.a)(e))}}();n.d(t,"d",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u})},"337b9e67dd20ada80fa5":function(e,t,n){"use strict";function r(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=i,this.__views__=[]}var o=n("3b252cd5e0e6c3615b6d"),c=n("b6b32bb34d326922d674"),i=4294967295;(r.prototype=Object(o.a)(c.a.prototype)).constructor=r,t.a=r},"354d70141729a36fe898":function(e,t,n){"use strict";t.a=function(e,t,n,r){var o=-1,c=null==e?0:e.length;for(r&&c&&(n=e[++o]);++o<c;)n=t(n,e[o],o,e);return n}},"35a29cebca36f3a27147":function(e,t,n){"use strict";function r(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new o.a;++t<n;)this.add(e[t])}var o=n("ad8cc569f3f069fb91a0"),c="__lodash_hash_undefined__";r.prototype.add=r.prototype.push=function(e){return this.__data__.set(e,c),this},r.prototype.has=function(e){return this.__data__.has(e)};t.a=r},"368eeccd09bffdd9f296":function(e,t,n){"use strict";var r=n("6fb0743f2477864eee04"),o=n("5c2f6399ceca32b7a0b3"),c=n("26d635265766889bfb00"),i="[object Object]",a=Function.prototype,s=Object.prototype,u=a.toString,f=s.hasOwnProperty,l=u.call(Object);t.a=function(e){if(!Object(c.a)(e)||Object(r.a)(e)!=i)return!1;var t=Object(o.a)(e);if(null===t)return!0;var n=f.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==l}},"36dcb0d197c09ea9afe9":function(e,t,n){"use strict";var r=n("ba53fce2bec9e4ed267c"),o=n("94e64458e50d130bfbf3"),c=o.a?function(e,t){return o.a.set(e,t),e}:r.a;t.a=c},"36e0784a51645e8ceed8":function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,c=[];++n<r;){var i=e[n];t(i,n,e)&&(c[o++]=i)}return c}},"38221194fe782b107f03":function(e,t,n){"use strict";var r=n("6fb0743f2477864eee04"),o=n("f1c0e74a95dfbe71c6f0"),c=n("26d635265766889bfb00"),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;var a=n("98cc9c01e58a3d9416da"),s=n("dbf5d091004dd78b9cad"),u=s.a&&s.a.isTypedArray,f=u?Object(a.a)(u):function(e){return Object(c.a)(e)&&Object(o.a)(e.length)&&!!i[Object(r.a)(e)]};t.a=f},"3b252cd5e0e6c3615b6d":function(e,t,n){"use strict";var r=n("978b85f07cd53ebdd0f6"),o=Object.create,c=function(){function e(){}return function(t){if(!Object(r.a)(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();t.a=c},"40c1a00b3363fb21280a":function(e,t,n){"use strict";var r=n("6ab3a222ccd63725ea3a"),o=n("12ad4997381b52bb6668"),c=n("517d6e3962b3db33796d"),i=n("b8c08b527e4f22d848fd"),a=n("7af3fc0c351e507691be"),s=n("38221194fe782b107f03"),u=Object.prototype.hasOwnProperty;t.a=function(e,t){var n=Object(c.a)(e),f=!n&&Object(o.a)(e),l=!n&&!f&&Object(i.a)(e),p=!n&&!f&&!l&&Object(s.a)(e),b=n||f||l||p,d=b?Object(r.a)(e.length,String):[],M=d.length;for(var h in e)!t&&!u.call(e,h)||b&&("length"==h||l&&("offset"==h||"parent"==h)||p&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||Object(a.a)(h,M))||d.push(h);return d}},"41d5bf03b3e7b6dc3b9b":function(e,t,n){"use strict";var r=n("0bd0afb5c74547a322b4").a.Symbol;t.a=r},"43fd540ff64794466865":function(e,t,n){"use strict";var r=n("0be451910340157220f5"),o=n("4605ae836ca138d7eb59"),c=n("e8ee4347350f37f94529"),i=n("517d6e3962b3db33796d");t.a=function(e,t){return(Object(i.a)(e)?r.a:c.a)(e,Object(o.a)(t,3))}},"44e94ccfd904f0f707b3":function(e,t,n){"use strict";t.isFunction=function(e){return"function"==typeof e}},"45d1013502405ff7e024":function(e,t,n){"use strict";var r=n("6fb0743f2477864eee04"),o=n("517d6e3962b3db33796d"),c=n("26d635265766889bfb00"),i="[object String]";t.a=function(e){return"string"==typeof e||!Object(o.a)(e)&&Object(c.a)(e)&&Object(r.a)(e)==i}},"4605ae836ca138d7eb59":function(e,t,n){"use strict";var r=n("fb048f05e0262d24631e"),o=n("1b51aaf361c9b5fe17ea"),c=n("ba53fce2bec9e4ed267c"),i=n("517d6e3962b3db33796d"),a=n("a0a326a2cc843c3ff0fb");t.a=function(e){return"function"==typeof e?e:null==e?c.a:"object"==typeof e?Object(i.a)(e)?Object(o.a)(e[0],e[1]):Object(r.a)(e):Object(a.a)(e)}},"48d2f0c12c34837ccce6":function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},"4925aa2ed200fbe812f5":function(e,t,n){"use strict";t.a=function(e,t){return e.has(t)}},"4b062c29eaf71f6e8d5b":function(e,t,n){"use strict";function r(e){var t={};for(var n in e)!function(n){if(e.hasOwnProperty(n)){var r;Object.defineProperty(t,n,{get:function(){return void 0===r&&(r=Object(P.g)(e[n]).toString()),r},enumerable:!0,configurable:!0})}}(n);return t}function o(e,t){var n=x.__assign({},e,{isRegistered:!1,className:void 0}),r=e.icons;t=t?x.__assign({},I.__options,t):I.__options;for(var o in r)if(r.hasOwnProperty(o)){var c=r[o],i=o.toLowerCase();I[i]?t.disableWarnings||Object(D.b)("Icon '"+o+" being re-registered. Ignoring duplicate registration."):I[i]={code:c,subset:n}}}function c(e,t){I.__remapped[e.toLowerCase()]=t.toLowerCase()}function i(e){var t=void 0,n=I.__options;if(e=e?e.toLowerCase():"",e=I.__remapped[e]||e)if(t=I[e]){var r=t.subset;r.fontFace&&!r.isRegistered&&(Object(P.d)(r.fontFace),r.className=Object(P.g)(r.style,{fontFamily:r.fontFace.fontFamily,fontWeight:r.fontFace.fontWeight||"normal",fontStyle:r.fontFace.fontStyle||"normal"}).toString(),r.isRegistered=!0)}else!n.disableWarnings&&n.warnOnMissingIcons&&Object(D.b)('The icon "'+e+'" was used but not registered. See http://aka.ms/fabric-icon-usage for more information.');return t}function a(e){I.__options=x.__assign({},I.__options,e)}function s(e){var t="",n=i(e);return n&&(t=Object(P.g)(n.subset.className,F,{selectors:{"::before":{content:'"'+n.code+'"'}}})),t}function u(e,t,n){return{animationName:e,animationDuration:t,animationTimingFunction:n,animationFillMode:"both"}}function f(e){return Object(P.e)({from:{transform:"translate3d("+e+"px,0,0)"},to:{transform:"translate3d(0,0,0)"}})}function l(e){return Object(P.e)({from:{transform:"translate3d(0,"+e+"px,0)"},to:{transform:"translate3d(0,0,0)"}})}function p(e){return Object(P.e)({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d("+e+"px,0,0)"}})}function b(e){return Object(P.e)({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(0,"+e+"px,0)"}})}function d(e){return e+", "+qe}function M(e){var t=h(e),n=d(t),r=n;return t===Be&&(r=d(Te.WestEuropean)),{tiny:v(We.mini,we.semibold,n),xSmall:v(We.xSmall,we.regular,n),small:v(We.small,we.regular,n),smallPlus:v(We.smallPlus,we.regular,n),medium:v(We.medium,we.regular,n),mediumPlus:v(We.mediumPlus,we.regular,n),large:v(We.large,we.semilight,r),xLarge:v(We.xLarge,we.light,n),xxLarge:v(We.xxLarge,we.light,n),superLarge:v(We.superLarge,we.light,n),mega:v(We.mega,we.light,n)}}function h(e){for(var t in Ce)if(Ce.hasOwnProperty(t)&&e&&0===t.indexOf(e))return Ce[t];return Be}function v(e,t,n){return{fontFamily:n,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}function g(e,t,n,r){e="'"+e+"'";var o=void 0!==r?"local('"+r+"'),":"";Object(P.d)({fontFamily:e,src:o+"url('"+t+".woff2') format('woff2'),url('"+t+".woff') format('woff')",fontWeight:n,fontStyle:"normal"})}function A(e,t,n,r,o){void 0===r&&(r="segoeui");var c=e+"/"+n+"/"+r;g(t,c+"-light",we.light,o&&o+" Light"),g(t,c+"-semilight",we.semilight,o&&o+" SemiLight"),g(t,c+"-regular",we.regular,o),g(t,c+"-semibold",we.semibold,o&&o+" SemiBold")}function O(e){if(e){var t=e+"/fonts";A(t,R.Thai,"leelawadeeui-thai","leelawadeeui"),A(t,R.Arabic,"segoeui-arabic"),A(t,R.Cyrillic,"segoeui-cyrillic"),A(t,R.EastEuropean,"segoeui-easteuropean"),A(t,R.Greek,"segoeui-greek"),A(t,R.Hebrew,"segoeui-hebrew"),A(t,R.Vietnamese,"segoeui-vietnamese"),A(t,R.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),A(t,Te.Selawik,"selawik","selawik"),g("Leelawadee UI Web",t+"/leelawadeeui-thai/leelawadeeui-semilight",we.light),g("Leelawadee UI Web",t+"/leelawadeeui-thai/leelawadeeui-bold",we.semibold)}}function z(e,t){return"@media only screen and (min-width: "+e+"px) and (max-width: "+t+"px)"}function y(e,t,n,r){return void 0===t&&(t=0),void 0===n&&(n="relative"),void 0===r&&(r=void 0),{outline:"transparent",position:n,selectors:(o={"::-moz-focus-inner":{border:"0"}},o["."+Pe.a+" &:focus:after"]={content:'""',position:"absolute",left:t+1,top:t+1,bottom:t+1,right:t+1,border:"1px solid "+e.palette.white,outline:"1px solid "+e.palette.neutralSecondary,zIndex:ke.FocusStyle,selectors:(c={},c[Re]=r,c)},o)};var o,c}function m(){return{selectors:{"&::-moz-focus-inner":{border:0},"&":{outline:"transparent"}}}}function L(e,t){return{borderColor:e,borderWidth:"0px",width:t,height:t}}function S(e){return{opacity:1,borderWidth:e}}function N(){return{opacity:1}}function q(e,t){return{borderWidth:"0",width:t,height:t,opacity:0,borderColor:e}}function T(e,t){return x.__assign({},L(e,t),{opacity:0})}function W(e,t){return t.disableGlobalClassNames?{}:e}function B(e){return void 0===e&&(e=!1),!0===e&&(Ge=_({},e)),Ge}function C(e){-1===Ke.indexOf(e)&&Ke.push(e)}function w(e){var t=Ke.indexOf(e);-1!==t&&Ke.splice(t,1)}function j(e,t){return void 0===t&&(t=!1),Ge=_(e,t),Object(Ve.loadTheme)(x.__assign({},Ge.palette,Ge.semanticColors)),He.a.applySettings((n={},n[$e]=Ge,n)),Ke.forEach(function(e){try{e(Ge)}catch(e){}}),Ge;var n}function _(e,t){void 0===t&&(t=!1);var n=x.__assign({},Ne,e.palette);e.palette&&e.palette.accent||(n.accent=n.themePrimary);var r=x.__assign({},X(n,!!e.isInverted,t),e.semanticColors);return{palette:n,fonts:x.__assign({},Ee,e.fonts),semanticColors:r,isInverted:!!e.isInverted,disableGlobalClassNames:!!e.disableGlobalClassNames}}function X(e,t,n){return E({bodyBackground:e.white,bodyFrameBackground:e.white,bodyText:e.neutralPrimary,bodyTextChecked:e.black,bodySubtext:e.neutralSecondary,bodyDivider:e.neutralTertiaryAlt,disabledBackground:e.neutralLighter,disabledText:e.neutralTertiary,disabledBodyText:e.neutralTertiaryAlt,disabledSubtext:e.neutralQuaternary,focusBorder:e.black,errorText:t?"#ff5f5f":e.redDark,warningText:t?"#ffffff":"#333333",errorBackground:t?"rgba(232, 17, 35, .5)":"rgba(232, 17, 35, .2)",blockingBackground:t?"rgba(234, 67, 0, .5)":"rgba(234, 67, 0, .2)",warningBackground:t?"rgba(255, 251, 0, .6)":"rgba(255, 185, 0, .2)",warningHighlight:t?"#fff100":"#ffb900",successBackground:t?"rgba(186, 216, 10, .4)":"rgba(186, 216, 10, .2)",inputBorder:e.neutralTertiary,inputBorderHovered:e.neutralDark,inputBackground:e.white,inputBackgroundChecked:e.themePrimary,inputBackgroundCheckedHovered:e.themeDarkAlt,inputForegroundChecked:e.white,inputFocusBorderAlt:e.themePrimary,smallInputBorder:e.neutralSecondary,inputPlaceholderText:e.neutralSecondary,buttonBackground:e.neutralLighter,buttonBackgroundChecked:e.neutralTertiaryAlt,buttonBackgroundHovered:e.neutralLight,buttonBackgroundCheckedHovered:e.neutralLight,buttonBorder:"transparent",buttonText:e.neutralPrimary,buttonTextHovered:e.black,buttonTextChecked:e.neutralDark,buttonTextCheckedHovered:e.black,menuItemBackgroundHovered:e.neutralLighter,menuIcon:e.themePrimary,menuHeader:e.themePrimary,listBackground:e.white,listText:e.neutralPrimary,listItemBackgroundHovered:e.neutralLighter,listItemBackgroundChecked:e.neutralLight,listItemBackgroundCheckedHovered:e.neutralQuaternaryAlt,listHeaderBackgroundHovered:e.neutralLighter,listHeaderBackgroundPressed:e.neutralLight,link:e.themePrimary,linkHovered:e.themeDarker,listTextColor:"",menuItemBackgroundChecked:e.neutralLight},n)}function E(e,t){var n="";return!0===t&&(n=" /* @deprecated */"),e.listTextColor=e.listText+n,e.menuItemBackgroundChecked+=n,e}function k(e,t,n,r,o){Object.defineProperty(e,t+n,{get:function(){var e=(n={},n[o]=B().palette[t],n);return Object(P.g)(r?{selectors:{":hover":e}}:e).toString();var n},enumerable:!0,configurable:!0})}var R,P=n("12a991e89d71187bca1f"),x=n("98bae3dbabd51089d613"),D=n("d6f63ba407b404b4a22d"),I=n("8286379a454aee09d9d3").a.getValue("icons",{__options:{disableWarnings:!1,warnOnMissingIcons:!0},__remapped:{}}),F={display:"inline-block"},U="cubic-bezier(.1,.9,.2,1)",H="cubic-bezier(.1,.25,.75,.9)",V=Object(P.e)({from:{opacity:0},to:{opacity:1}}),G=Object(P.e)({from:{opacity:1},to:{opacity:0}}),K=f(-10),$=f(-20),Q=f(-40),J=f(-400),Y=f(10),Z=f(20),ee=f(40),te=f(400),ne=l(10),re=l(20),oe=l(-10),ce=l(-20),ie=p(10),ae=p(20),se=p(40),ue=p(400),fe=p(-10),le=p(-20),pe=p(-40),be=p(-400),de=b(-10),Me=b(-20),he=b(10),ve=b(20),ge=Object(P.e)({from:{transform:"scale3d(.98,.98,1)"},to:{transform:"scale3d(1,1,1)"}}),Ae=Object(P.e)({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(.98,.98,1)"}}),Oe=Object(P.e)({from:{transform:"scale3d(1.03,1.03,1)"},to:{transform:"scale3d(1,1,1)"}}),ze=Object(P.e)({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(1.03,1.03,1)"}}),ye=Object(P.e)({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(90deg)"}}),me=Object(P.e)({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(-90deg)"}}),Le={easeFunction1:U,easeFunction2:H,durationValue1:"0.167s",durationValue2:"0.267s",durationValue3:"0.367s",durationValue4:"0.467s"},Se={slideRightIn10:u(V+","+K,"0.367s",U),slideRightIn20:u(V+","+$,"0.367s",U),slideRightIn40:u(V+","+Q,"0.367s",U),slideRightIn400:u(V+","+J,"0.367s",U),slideLeftIn10:u(V+","+Y,"0.367s",U),slideLeftIn20:u(V+","+Z,"0.367s",U),slideLeftIn40:u(V+","+ee,"0.367s",U),slideLeftIn400:u(V+","+te,"0.367s",U),slideUpIn10:u(V+","+ne,"0.367s",U),slideUpIn20:u(V+","+re,"0.367s",U),slideDownIn10:u(V+","+oe,"0.367s",U),slideDownIn20:u(V+","+ce,"0.367s",U),slideRightOut10:u(G+","+ie,"0.367s",U),slideRightOut20:u(G+","+ae,"0.367s",U),slideRightOut40:u(G+","+se,"0.367s",U),slideRightOut400:u(G+","+ue,"0.367s",U),slideLeftOut10:u(G+","+fe,"0.367s",U),slideLeftOut20:u(G+","+le,"0.367s",U),slideLeftOut40:u(G+","+pe,"0.367s",U),slideLeftOut400:u(G+","+be,"0.367s",U),slideUpOut10:u(G+","+de,"0.367s",U),slideUpOut20:u(G+","+Me,"0.367s",U),slideDownOut10:u(G+","+he,"0.367s",U),slideDownOut20:u(G+","+ve,"0.367s",U),scaleUpIn100:u(V+","+ge,"0.367s",U),scaleDownIn100:u(V+","+Oe,"0.367s",U),scaleUpOut103:u(G+","+ze,"0.167s",H),scaleDownOut98:u(G+","+Ae,"0.167s",H),fadeIn100:u(V,"0.167s",H),fadeIn200:u(V,"0.267s",H),fadeIn400:u(V,"0.367s",H),fadeIn500:u(V,"0.467s",H),fadeOut100:u(G,"0.167s",H),fadeOut200:u(G,"0.267s",H),fadeOut400:u(G,"0.367s",H),fadeOut500:u(G,"0.467s",H),rotate90deg:u(ye,"0.1s",H),rotateN90deg:u(me,"0.1s",H)},Ne={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#212121",neutralPrimary:"#333333",neutralPrimaryAlt:"#3c3c3c",neutralSecondary:"#666666",neutralTertiary:"#a6a6a6",neutralTertiaryAlt:"#c8c8c8",neutralQuaternary:"#d0d0d0",neutralQuaternaryAlt:"#dadada",neutralLight:"#eaeaea",neutralLighter:"#f4f4f4",neutralLighterAlt:"#f8f8f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a80000",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"},qe="'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif";!function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web"}(R||(R={}));var Te;!function(e){e.Arabic="'"+R.Arabic+"'",e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'"+R.Cyrillic+"'",e.EastEuropean="'"+R.EastEuropean+"'",e.Greek="'"+R.Greek+"'",e.Hebrew="'"+R.Hebrew+"'",e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'"+R.Selawik+"'",e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'"+R.Vietnamese+"'",e.WestEuropean="'"+R.WestEuropean+"'"}(Te||(Te={}));var We,Be="'Segoe UI', '"+R.WestEuropean+"'",Ce={ar:Te.Arabic,bg:Te.Cyrillic,cs:Te.EastEuropean,el:Te.Greek,et:Te.EastEuropean,he:Te.Hebrew,hi:Te.Hindi,hr:Te.EastEuropean,hu:Te.EastEuropean,ja:Te.Japanese,kk:Te.EastEuropean,ko:Te.Korean,lt:Te.EastEuropean,lv:Te.EastEuropean,pl:Te.EastEuropean,ru:Te.Cyrillic,sk:Te.EastEuropean,"sr-latn":Te.EastEuropean,th:Te.Thai,tr:Te.EastEuropean,uk:Te.Cyrillic,vi:Te.Vietnamese,"zh-hans":Te.ChineseSimplified,"zh-hant":Te.ChineseTraditional};!function(e){e.mini="10px",e.xSmall="11px",e.small="12px",e.smallPlus="13px",e.medium="14px",e.mediumPlus="15px",e.icon="16px",e.large="17px",e.xLarge="21px",e.xxLarge="28px",e.superLarge="42px",e.mega="72px"}(We||(We={}));var we;!function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(we||(we={}));var je;!function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(je||(je={}));var _e=n("94c7b7d740a59f8e352c"),Xe="https://static2.sharepointonline.com/files/fabric/assets",Ee=M(Object(_e.a)());O(function(){var e="undefined"!=typeof window?window:void 0,t=e?e.FabricConfig:void 0;return t&&void 0!==t.fontBaseUrl?t.fontBaseUrl:Xe}());var ke,Re="@media screen and (-ms-high-contrast: active)",Pe=n("b3bd1cc7d16f2f5884ea");!function(e){e.Nav=1,e.ScrollablePane=1,e.FocusStyle=1,e.Coachmark=1e3,e.Layer=1e6,e.KeytipLayer=1000001}(ke||(ke={}));var xe={position:"absolute",width:1,height:1,margin:-1,padding:0,border:0,overflow:"hidden"},De="14s",Ie="2s",Fe="1",Ue={continuousPulseAnimationDouble:function(e,t,n,r,o){return Object(P.e)({"0%":L(e,n),"1.42%":S(o),"3.57%":N(),"7.14%":q(t,r),"8%":T(e,n),"29.99%":T(e,n),"30%":L(e,n),"31.42%":S(o),"33.57%":N(),"37.14%":q(t,r),"38%":T(e,n),"79.42%":T(e,n),79.43:L(e,n),81.85:S(o),83.42:N(),"87%":q(t,r),"100%":{}})},continuousPulseAnimationSingle:function(e,t,n,r,o){return Object(P.e)({"0%":L(e,n),"14.2%":S(o),"35.7%":N(),"71.4%":q(t,r),"100%":{}})},createDefaultAnimation:function(e){return{animationName:e,animationIterationCount:Fe,animationDuration:De,animationDelay:Ie}}},He=n("2898f5ca48f2d57df16d"),Ve=n("a8c7165f33a4dc07ab0d"),Ge={palette:Ne,semanticColors:X(Ne,!1,!1),fonts:Ee,isInverted:!1,disableGlobalClassNames:!1},Ke=[],$e="theme";if(!He.a.getSettings([$e]).theme){var Qe="undefined"!=typeof window?window:void 0;Qe&&Qe.FabricConfig&&Qe.FabricConfig.theme&&(Ge=_(Qe.FabricConfig.theme)),He.a.applySettings((Je={},Je[$e]=Ge,Je))}var Je,Ye={boxShadow:"none",margin:0,padding:0,boxSizing:"border-box"},Ze={overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},et=r(Se),tt=r(Ee),nt={};for(var rt in Ne)Ne.hasOwnProperty(rt)&&(k(nt,rt,"",!1,"color"),k(nt,rt,"Hover",!0,"color"),k(nt,rt,"Background",!1,"background"),k(nt,rt,"BackgroundHover",!0,"background"),k(nt,rt,"Border",!1,"borderColor"),k(nt,rt,"BorderHover",!0,"borderColor"));n.d(t,"a",function(){return et}),n.d(t,"g",function(){return tt}),n.d(t,"d",function(){return nt}),n.d(t,"b",function(){return Se}),n.d(t,"c",function(){return Le}),n.d(t,"f",function(){return Ne}),n.d(t,"e",function(){return Ee}),n.d(t,"U",function(){return O}),n.d(t,"h",function(){return We}),n.d(t,"i",function(){return we}),n.d(t,"k",function(){return je}),n.d(t,"D",function(){return M}),n.d(t,"H",function(){return y}),n.d(t,"F",function(){return m}),n.d(t,"N",function(){return xe}),n.d(t,"m",function(){return Ue}),n.d(t,"I",function(){return W}),n.d(t,"z",function(){return $e}),n.d(t,"M",function(){return B}),n.d(t,"P",function(){return j}),n.d(t,"E",function(){return _}),n.d(t,"X",function(){return C}),n.d(t,"Y",function(){return w}),n.d(t,"j",function(){return Re}),n.d(t,"u",function(){return 320}),n.d(t,"t",function(){return 480}),n.d(t,"s",function(){return 640}),n.d(t,"v",function(){return 1024}),n.d(t,"w",function(){return 1366}),n.d(t,"x",function(){return 1920}),n.d(t,"p",function(){return 479}),n.d(t,"o",function(){return 639}),n.d(t,"n",function(){return 1023}),n.d(t,"q",function(){return 1365}),n.d(t,"r",function(){return 1919}),n.d(t,"L",function(){return z}),n.d(t,"T",function(){return Ye}),n.d(t,"S",function(){return Ze}),n.d(t,"A",function(){return ke}),n.d(t,"B",function(){return r}),n.d(t,"J",function(){return i}),n.d(t,"W",function(){return o}),n.d(t,"V",function(){return c}),n.d(t,"Z",function(){return a}),n.d(t,"K",function(){return s}),n.d(t,"l",function(){return P.a}),n.d(t,"y",function(){return P.b}),n.d(t,"C",function(){return P.c}),n.d(t,"G",function(){return P.d}),n.d(t,"O",function(){return P.e}),n.d(t,"Q",function(){return P.f}),n.d(t,"R",function(){return P.g})},"4c259643f4d55b331b73":function(e,t,n){"use strict";function r(e,t){return Promise.all([n.e(2),n.e(6)]).then(n.bind(null,"50f5c6d0ebb146382775")).then(function(n){return n.renderCalendarAppLayout(e,t)})}function o(e){return n.e(1).then(n.bind(null,"470c9a96854cc380355d")).then(function(t){return t.renderCalendarDialogLayout(e)})}function c(e,t){return Promise.all([n.e(2),n.e(5)]).then(n.bind(null,"c7820dc5cd40cf6d2705")).then(function(n){return n.renderChatListLayout(e,t)})}function i(e){return n.e(0).then(n.bind(null,"fad1356b001618759ecd")).then(function(t){return t.renderTeamAnalyticsLayout(e)})}function a(e,t,r){return Promise.all([n.e(2),n.e(4)]).then(n.bind(null,"b88fb05d210ca705e502")).then(function(n){return n.renderChannelFilesLayout(e,t,r)})}function s(e,t,r){return Promise.all([n.e(2),n.e(4)]).then(n.bind(null,"a5e45ff54ba753326590")).then(function(n){return n.renderExternalFilesLayout(t,r,e)})}function u(e,t){var n=!1;return function(){if(!n)return n=!0,t();console.warn("WARNING: function '"+e+"' has been already called under 'call once' policy - next calls will result in noop (and 'undefined' as a return value).")}}function f(e){var t=[],n=[];return e instanceof Array?t=n=e:e instanceof Object&&(t=_.keys(e),n=_.values(e)),{injectedServiceAliases:t,servicesToInject:n}}function l(e,t,n,r,o,c){void 0===o&&(o=function(){}),void 0===c&&(c=function(){});var i=f(t),a=i.injectedServiceAliases;return p(d(i.servicesToInject,n,a,o,c,r),e)}function p(e,t){return function(){return{restrict:"E",controller:e,scope:{},template:"",link:function(e,n,r,o){var c=t();o.mount(c,n[0]),e.$on("$destroy",function(){b(n[0])})}}}}function b(e){X.unmountComponentAtNode(e),X.render(j.createElement(j.Fragment,null),e,function(){X.unmountComponentAtNode(e)})}function d(e,t,n,r,o,c){return e.concat(["$scope",function(){function e(){for(var e=[],c=0;c<arguments.length;c++)e[c]=arguments[c];var i=this;this.injectedServices=_.zipObject(n,e),this.componentRef=j.createRef(),this.renderPartial=function(e,n){return h(e,n,t,i.injectedServices,i.componentRef,r,o)}}return e.prototype.mount=function(e,t){return M(e,t,this.injectedServices,this.renderPartial,c)},e}()])}function M(e,t,n,r,o){return e.then(function(e){return o?o(u("render",function(){return r(e,t)}),n):r(e,t)})}function h(e,t,n,r,o,c,i){var a=t.tagName.toLowerCase();return new Promise(function(s,u){try{var f=n(r,a),l=_.assign({},f,{__componentRef:o,__injectedServices:r,__onComponentDidMount:c,__onComponentWillUnmount:i});X.render(j.createElement(k,R({},l),function(t){return j.createElement(e,R({ref:o},t))}),t,function(){s(this)})}catch(e){u(e)}})}function v(e,t,n,r,o){e!==t&&Object(de.a)(t,function(c,i){if(Object(We.a)(c))o||(o=new ue.a),Fe(e,t,i,n,v,r,o);else{var a=r?r(we(e,i),c,i+"",e,t,o):void 0;void 0===a&&(a=c),be(e,i,a)}},De)}function g(){return window}function A(e,t,n,r,o){var c=-1,i=e.length;for(n||(n=bn),o||(o=[]);++c<i;){var a=e[c];t>0&&n(a)?t>1?A(a,t-1,n,r,o):Object(Mt.a)(o,a):r||(o[o.length]=a)}return o}function O(e,t,n,r,o,c){var i,a=t&Lo,s=t&So,u=t&No;if(n&&(i=o?n(e,r,o,c):n(e)),void 0!==i)return i;if(!Object(We.a)(e))return e;var f=Object(Se.a)(e);if(f){if(i=Ir(e),!a)return Object(Ae.a)(e,i)}else{var l=Object(xr.a)(e),p=l==To||l==Wo;if(Object(qe.a)(e))return Object(Me.a)(e,a);if(l==Bo||l==qo||p&&!o){if(i=s||p?{}:me(e),!a)return s?Rr(e,Er(i,e)):kr(e,Xr(i,e))}else{if(!Co[l])return o?e:{};i=Mo(e,l,a)}}c||(c=new ue.a);var b=c.get(e);if(b)return b;if(c.set(e,i),mo(e))return e.forEach(function(r){i.add(O(r,t,n,r,e,c))}),i;if(Oo(e))return e.forEach(function(r,o){i.set(o,O(r,t,n,o,e,c))}),i;var d=u?s?At:Pr.a:s?keysIn:nt.a,M=f?void 0:d(e);return Object(jn.a)(M||e,function(r,o){M&&(r=e[o=r]),_e(i,o,O(r,t,n,o,e,c))}),i}function z(e,t,n){t=n?void 0:t;var r=Object(en.a)(e,Jo,void 0,void 0,void 0,void 0,void 0,t);return r.placeholder=z.placeholder,r}function y(e,t,n){t=n?void 0:t;var r=Object(en.a)(e,Zo,void 0,void 0,void 0,void 0,void 0,t);return r.placeholder=y.placeholder,r}function m(e,t,n,r,o,c){return Object(We.a)(e)&&Object(We.a)(t)&&(c.set(t,e),Ue(e,t,void 0,m,c),c.delete(t)),e}Object.defineProperty(t,"__esModule",{value:!0});var L=n("cad9253704d182fd1e4c"),S=function(){function e(e,t,n,r,o,c){var i=this;this.$scope=e,this.clientAuthenticationService=t,this.$cookies=n,this.constants=r,this.eventingService=o,this.loggingService=c,this.isError=!1,this.connection=void 0,e.$on("$destroy",function(){i.connection?i.connection.destroy():_.noop(),i.viewScenario&&(i.viewScenario.mark(r.scenarios.bridge.bridge_destroyed),i.viewScenario.cancel())})}return e.$inject=["$scope","clientAuthenticationService","$cookies","constants","eventingService","loggingService"],e.prototype.setConnection=function(e,t){this.connection=e,this.viewScenario=t,this.listenForChangeInLegacyAppState()},e.prototype.listenForChangeInLegacyAppState=function(){var e=this;this.eventingService.$on(this.$scope,this.constants.events.layout.themeChanged,function(t,n){e.connection.changeTheme(n)})},e.prototype.handleError=function(e){this.isError=!0,this.loggingService.error(e.message,e)},e.ControllerAs="bridgeController",e}(),N=angular.module("teamspace.bridge",[]).directive("tsBridge",function(){return{restrict:"E",transclude:!0,replace:!0,templateUrl:"components/ts-bridge/ts-bridge.html",controller:S,controllerAs:S.ControllerAs}}).run(["$templateCache",function(e){e.put("components/ts-bridge/ts-bridge.html",L)}]);N.directive("calendarBridge",["bridgeUtilityService","dialogService","constants",function(e,t,n){return{restrict:"E",require:"^tsBridge",template:"<div></div>",link:function(o,c,i,a){var s=t.open.bind(t),u={openMeetingDetailsDialog:function(e){s(n.dialogs.meetingDetail,e)},openCreateMeetingDialog:function(){s(n.dialogs.createUpdateMeeting,{})}};e.setupBridge(r(c[0],u),a)}}}]),N.directive("calendarDialogBridge",["bridgeUtilityService",function(e){return{restrict:"E",require:"^tsBridge",template:"<div></div>",link:function(t,n,r,c){e.setupBridge(o(n[0]),c)}}}]);var q=n("18abc8bf02b8e9156c7e");!function(){function e(){}e.prototype.handleActionEvent=function(e,t,n){},e.prototype.destroy=function(){return!0},e.prototype.changeTheme=function(e){}}();Object(q.d)({enforceActions:!0});var T,W=n("88b2345a655cbb107091");!function(e){e.Update="Update",e.NavigationToNextSelectedChat="NavigationToNextSelectedChat",e.Hide="Hide",e.LieResolved="LieResolved",e.NewChatDelete="NewChatDelete",e.TypingIndicators="TypingIndicators",e.NavigateToChat="NavigateToChat"}(T||(T={}));var B=function(){function e(e,t,n,r,o,c,i,a,s,u,f,l,p,b,d){this.$element=e,this.$scope=t,this.bridgeChatListService=n,this.bridgeUtilityService=r,this.chatListEntryFactory=o,this.constants=c,this.conversationsService=i,this.loggingService=a,this.navigationService=s,this.newChatService=u,this.peopleService=f,this.peopleSlugService=l,this.routeUtilityService=p,this.settingsService=b,this.sxConfig=d,this.viewScenario=this.loggingService.newScenario(c.scenarios.loadReactChatList),this.logger=this.loggingService.newLogger("chat-list-bridge")}return e.$inject=["$element","$scope","bridgeChatListService","bridgeUtilityService","chatListEntryFactory","constants","conversationsService","loggingService","navigationService","newChatService","peopleService","peopleSlugService","routeUtilityService","settingsService","sxConfig"],e.prototype.$onInit=function(){this.initializeBridge()},Object.defineProperty(e.prototype,"navCtx",{get:function(){return"chat-list-bridge"},enumerable:!0,configurable:!0}),e.prototype.initializeBridge=function(){var e=this;this.bridgeController&&(this.$scope.routeParams=this.routeUtilityService.getRootRouteParams(),this.bridgeUtilityService.setupBridge(this.initBridgePromise(),this.bridgeController,this.viewScenario).then(function(t){t||e.bridgeChatListService.onBridgeLoadError("Chat list bridge setup failed")}))},e.prototype.initBridgePromise=function(){var e=this;return c(this.$element[0],this.bridgeChatListService).then(function(t){var n=!1;return e.$scope.$watch("routeParams.peopleSlug",function(r,o){n&&r!==o&&(e.peopleSlugUpdated(r,t),e.bridgeChatListService.notifyChatListRendered(!0))}),window.requestAnimationFrame(function(){try{var r=e.routeUtilityService.getRootRouteParams(),o=r&&r.peopleSlug;e.peopleSlugUpdated(o,t),e.subscribeToBridgeChatListService(t),e.bridgeChatListService.notifyChatListRendered(!0),n=!0}catch(t){e.bridgeChatListService.onBridgeLoadError("Failed sending initial chats to react",t)}}),t},function(t){return e.bridgeChatListService.onBridgeLoadError("Chat list bridge module init failed",t),Promise.reject(t)})},e.prototype.peopleSlugUpdated=function(e,t){var n=this.chatIdForSlug(e,t);this.bridgeChatListService.setSelectedChatId(n),this.triggerReact(t,W.a.SelectedChatChange,null,n)},e.prototype.chatIdForSlug=function(e,t){var n;if(e===this.constants.p2p.newChatId){this.createNewChatListEntry(t);var r=this.newChatService.getNewChat();n=r&&r.id}else if(e){var o=this.peopleSlugService.resolve(e);n=o.conversation?o.conversation.id:"";var c=this.settingsService.valueAsBoolean(this.constants.settings.names.enableFederatedChat)||!teamspace.services.SfBInteropUtilsService.isFederationConversation(n);if(c&&!n&&o.mri){var i=o.mri;n=this.conversationsService.getChatConversationWith(i).id}else c&&(n||o.mri)||(this.logger.error("no selected chat nor resolved mri. canNavigateTochat: "+c),this.navigationService.navigateToDefaultChatsState(this.navCtx))}return n},e.prototype.triggerReact=function(e,t,n,r){e?e.handleActionEvent(t,n,r):this.logger.warn("unable to send "+t+" to react because there is no connection")},e.prototype.createNewChatListEntry=function(e){this.newChatService.getNewChat()||this.newChatService.createNewChat(),this.chatListEntryFactory.newChatListEntry&&this.triggerReact(e,W.a.CreatedNewChat)},e.prototype.subscribeToBridgeChatListService=function(e){var t=this;this.bridgeChatListService.safeSubscribe(this.$scope,function(n,r){t.triggerReact(e,W.a.Batched,n,r)},T.Update),this.bridgeChatListService.safeSubscribe(this.$scope,function(n,r){t.triggerReact(e,W.a.NavigateToNextSelectedChat,n,r)},T.NavigationToNextSelectedChat),this.bridgeChatListService.safeSubscribe(this.$scope,function(n,r){t.triggerReact(e,W.a.HideChat,n,r)},T.Hide),this.bridgeChatListService.safeSubscribe(this.$scope,function(n,r){t.triggerReact(e,W.a.Resolved,n,r)},T.LieResolved),this.bridgeChatListService.safeSubscribe(this.$scope,function(n,r){t.triggerReact(e,W.a.DeleteNewChat,n,r)},T.NewChatDelete),this.bridgeChatListService.safeSubscribe(this.$scope,function(n,r){t.triggerReact(e,W.a.TypingIndicatorChange,n,r)},T.TypingIndicators),this.bridgeChatListService.safeSubscribe(this.$scope,function(e,n){n.navCtx=t.navCtx,t.navigationService.navigate(t.$scope,t.constants.states.appConversation,n,!1)},T.NavigateToChat)},e}();N.component("chatListBridge",{template:"<div></div>",controller:B,require:{bridgeController:"^tsBridge"}}),N.directive("teamAnalyticsBridge",["bridgeUtilityService",function(e){return{restrict:"E",require:"^tsBridge",template:"<div></div>",link:function(t,n,r){n&&n.length&&e.setupBridge(i(n[0]),null)}}}]);var C=function(){function e(e,t,n,r,o,c,i,a,s){this.$scope=e,this.$element=t,this.bridgeUtilityService=n,this.documentLibraryClient=r,this.filesUtilityService=o,this.filesBridgeUtilityService=c,this.constants=i,this.authenticationService=a,this.loggingService=s;var u=i.scenarios.files.getTeamFilesV2;this.viewScenario=s.findScenario(u),this.viewScenario?this.viewScenario.mark(i.scenarios.files.getFiles.marks.initDefaultState):_.noop()}return e.$inject=["$scope","$element","bridgeUtilityService","documentLibraryClient","filesUtilityService","filesBridgeUtilityService","constants","authenticationService","loggingService"],e.prototype.$onInit=function(){this.initializeBridge(this.tsBridgeCtrl)},e.prototype.initializeBridge=function(e){var t=this,n={siteDetails:{rootUrl:this.siteUrl,listUrl:"",rootFolderPath:this.serverRelativeUrl},threadId:this.threadId},r={copyLink:function(e,n){t.filesBridgeUtilityService.copyLink(e,n,t.constants.files.serviceName.teams,t.threadId)},acquireToken:function(e){return t.bridgeUtilityService.convertToESPromise(t.authenticationService.getAuthTokens([e]))},downloadFiles:function(e){return t.filesBridgeUtilityService.downloadFiles(e,n.siteDetails,t.constants.files.serviceName.teams)},pinToTab:{isEnabled:function(e,n){return t.filesBridgeUtilityService.isPinToTabAllowed(e,n,t.constants.files.serviceName.teams,t.threadId)},execute:function(e,n){t.filesBridgeUtilityService.pinToTab(e,n,t.constants.files.serviceName.teams,t.threadId)}}};this.bridgeUtilityService.setupBridge(a(this.$element[0],n,r),this.tsBridgeCtrl,this.viewScenario)},e}();N.controller("ChannelFilesBridge",C).component("tsChannelFilesBridge",{controller:C,require:{tsBridgeCtrl:"^tsBridge"},template:"<div></div>",bindings:{siteUrl:"<",serverRelativeUrl:"<",threadId:"<"}});var w=function(){function e(e,t,n,r,o,c,i){this.$scope=e,this.$element=t,this.loggingService=n,this.externalUserSettingsService=r,this.bridgeUtilityService=o,this.constants=c,this.eventingService=i}return e.$inject=["$scope","$element","loggingService","externalUserSettingsService","bridgeUtilityService","constants","eventingService"],e.prototype.$onInit=function(){this.initializeBridge(this.tsBridgeCtrl)},e.prototype.initializeBridge=function(e){if(this.fileProviderType===teamspace.services.files.FilesProviderType.WOPI||this.fileProviderType===teamspace.services.files.FilesProviderType.Google){var t={providerType:this.transformProviderTypeEnumToLiteral(this.fileProviderType),providerCode:this.fileProviderCode},n={signInAndRefresh:this.signInAndRefresh.bind(this),removeProvider:this.removeProvider.bind(this)};this.bridgeUtilityService.setupBridge(s(this.$element[0],t,n),this.tsBridgeCtrl)}else this.loggingService.error("External files bridge: wrong provider")},e.prototype.signInAndRefresh=function(e){var t=this.externalUserSettingsService.findProvider(this.fileProviderCode);return this.fileProviderType===teamspace.services.files.FilesProviderType.Google?this.signInAndRefreshGoogle(t):e?this.signInAndRefreshWopi(t,e):(this.loggingService.error("External files bridge: user profile not provided, cannot verify wopi signin"),!1)},e.prototype.removeProvider=function(){var e=this.externalUserSettingsService.removeProvider(this.fileProviderCode);return this.bridgeUtilityService.convertToESPromise(e)},e.prototype.signInAndRefreshGoogle=function(e){if(!e){this.externalUserSettingsService.saveProvider(teamspace.services.files.FilesProviderType.Google,"GOOGLEDRIVE"),this.eventingService.$emit(this.constants.events.files.externalCatalogsLoaded)}return!0},e.prototype.signInAndRefreshWopi=function(e,t){return e?e.userId===t.userId||!!_.isEmpty(e.userId)&&(e.userId=t.userId,e.displayName=t.displayName,this.externalUserSettingsService.saveProvider(e),!0):(this.externalUserSettingsService.saveProvider({userId:t.userId,displayName:t.displayName,type:teamspace.services.files.FilesProviderType.WOPI,code:this.fileProviderCode}),this.eventingService.$emit(this.constants.events.files.externalCatalogsLoaded),!0)},e.prototype.transformProviderTypeEnumToLiteral=function(t){switch(t){case teamspace.services.files.FilesProviderType.Google:return e.GOOGLE_DRIVE;default:return e.WOPI}},e.GOOGLE_DRIVE="GOOGLEDRIVE",e.WOPI="WOPI",e}();N.controller("ExternalFilesBridge",w).component("tsExternalFilesBridge",{controller:w,require:{tsBridgeCtrl:"^tsBridge"},template:"<div></div>",bindings:{fileProviderCode:"<",fileProviderType:"<"}});var j=n("275976081ce1abf67779"),X=n("de7f2df91c095f0cd45d"),E=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),k=function(e){function t(t){var n=e.call(this,t)||this,r={};return Object.keys(t).forEach(function(e){_.startsWith(e,"__")||(r[e]=t[e])}),n.state=Object.assign({},r),n.componentRef=n.props.__componentRef,n.injectedServices=n.props.__injectedServices,n}return E(t,e),t.prototype.render=function(){return this.props.children(this.state)},t.prototype.componentDidMount=function(){this.props.__onComponentDidMount(this.componentRef.current,this.injectedServices)},t.prototype.componentWillUnmount=function(){this.props.__onComponentWillUnmount(this.componentRef.current,this.injectedServices)},t}(j.Component),R=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},P={forLazyLoadedComponent:function(e){return new x({getComponentClassPromise:e,injectedServiceNames:[],setUpComponentProps:function(e,t){return null},withManualRendering:null,onComponentDidMount:function(){},onComponentWillUnmount:function(){},name:this.name})}},x=function(){function e(e){this.spec=e}return e.prototype.withInjected=function(e){var t=this;return{ofType:function(){return t.spec.injectedServiceNames.indexOf(e)<0&&t.spec.injectedServiceNames.push(e),t}}},e.prototype.withThemeChangesHandling=function(e){return this.spec=D.configure(e,this.spec),this},e.prototype.withManualRendering=function(e){return this.spec=I.configure(e,this.spec),this},e.prototype.setUpComponentProps=function(e){return F.configure(e,this.spec)},e}(),D=function(){function e(){}return e.configure=function(e,t){t.injectedServiceNames.indexOf("eventingService")<0&&t.injectedServiceNames.push("eventingService");var n=t.onComponentDidMount;return t.onComponentDidMount=function(t,r){n(t,r),r.eventingService.on("changeTheme",function(n){e(n,t)})},t},e}(),I=function(){function e(){}return e.configure=function(e,t){return t.withManualRendering=e,t},e}(),F=function(){function e(e){this.spec=e}return e.configure=function(t,n){return n.setUpComponentProps=t,new e(n)},e.prototype.onComponentDidMount=function(t){return new e(U.configureOnComponentDidMount(t,this.spec))},e.prototype.onComponentWillUnmount=function(t){return new e(U.configureOnComponentWillUnmount(t,this.spec))},e.prototype.create=function(){return l(this.spec.getComponentClassPromise,this.spec.injectedServiceNames,this.spec.setUpComponentProps,this.spec.withManualRendering,this.spec.onComponentDidMount,this.spec.onComponentWillUnmount)},e}(),U=function(){function e(){}return e.configureOnComponentDidMount=function(e,t){var n=t.onComponentDidMount;return t.onComponentDidMount=function(t,r){n(t,r),e(t,r)},t},e.configureOnComponentWillUnmount=function(e,t){var n=t.onComponentWillUnmount;return t.onComponentWillUnmount=function(t,r){n(t,r),e(t,r)},t},e}();angular.module("teamspace.bridge").directive("personalFilesBridge",P.forLazyLoadedComponent(function(){return Promise.all([n.e(2),n.e(3)]).then(n.bind(null,"d509ad4ece297ab5a0d1")).then(function(e){return e.PersonalFilesRoot})}).withInjected("personalFilesDetailsService").ofType().withInjected("filesBridgeUtilityService").ofType().withInjected("bridgeUtilityService").ofType().withInjected("constants").ofType().withInjected("authenticationService").ofType().withInjected("loggingService").ofType().withInjected("eventingService").ofType().withInjected("$scope").ofType().setUpComponentProps(function(e){var t=e.constants,n=e.loggingService,r=e.personalFilesDetailsService,o=e.filesBridgeUtilityService,c=e.authenticationService,i=e.bridgeUtilityService,a=r.getPersonalSiteInfo(),s={rootUrl:a.personalSiteUrl.slice(0,-1),listUrl:a.personalRootFolderUrl},u=t.scenarios.files.getPersonalFilesV2,f=n.newScenario(u),l=t.files.serviceName.personal;return f.mark(t.scenarios.files.getFiles.marks.initDefaultState),{onCopyLink:function(e,n){o.copyLink(e,n,t.files.serviceName.personal)},acquireToken:function(e){return i.convertToESPromise(c.getAuthTokens([e]))},siteInfo:s,downloadFiles:function(e){return o.downloadFiles(e,s,l)}}}).onComponentDidMount(function(e,t){e.scenario?e.scenario.mark("bridge_render_finished"):_.noop(),t.eventingService.$on(t.$scope,t.constants.events.layout.themeChanged,function(t,n){e.changeTheme(n)})}).create()),angular.module("teamspace.bridge").directive("recentFilesBridge",P.forLazyLoadedComponent(function(){return Promise.all([n.e(2),n.e(4)]).then(n.bind(null,"a038a0586ece3c5b986c")).then(function(e){return e.RecentFilesRoot})}).withInjected("$scope").ofType().withInjected("constants").ofType().withInjected("bridgeUtilityService").ofType().withInjected("authenticationService").ofType().withInjected("eventingService").ofType().setUpComponentProps(function(e){var t=e.authenticationService,n=e.bridgeUtilityService;return{acquireToken:function(e){return n.convertToESPromise(t.getAuthTokens([e]))}}}).onComponentDidMount(function(e,t){t.eventingService.$on(t.$scope,t.constants.events.layout.themeChanged,function(t,n){e.changeTheme(n)})}).create());var H=function(){function e(e,t,n,r,o){this.constants=e,this.clientAuthenticationService=t,this.desktopUtilityService=n,this.appStateService=r,this.$cookies=o}return e.$inject=["constants","clientAuthenticationService","desktopUtilityService","appStateService","$cookies"],e.prototype.getAppState=function(){return{isDesktopApp:this.desktopUtilityService.isDesktop(),clientId:this.clientAuthenticationService.getClientId(),currentTheme:this.$cookies.get(this.constants.themes.cookieName)||this.constants.themes.default}},e.prototype.isConnected=function(){return this.appStateService.isConnected},e}();N.service("bridgeAppStateService",H);var V=function(){function e(e,t,n,r){this.callingUserActionService=e,this.conversationsService=t,this.loggingService=n,this.constants=r}return e.$inject=["callingUserActionService","conversationsService","loggingService","constants"],e.prototype.placeCall=function(e){var t=this,n=this.conversationsService.getConversation(e);if(null!==n){this.loggingService.info("Found the conversation with ID "+e);var r={messageId:"",conversationId:n.id,isStartMeetup:!1,withVideo:!0};this.callingUserActionService.placeCall(r).catch(function(e){t.loggingService.error("Place call failed because of error: "+e)})}else this.loggingService.error("Failed to fetch the conversation with ID "+e+":")},e}();angular.module("teamspace.bridge").service("bridgeCallingUserActionService",V);var G=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),K=function(e){function t(t,n,r,o,c,i,a,s,u,f,l,p,b,d,M,h,v,g,A,O,z,y,m,L){var S=e.call(this)||this;return S.$rootScope=t,S.$timeout=n,S.$compile=r,S.$translate=o,S.accessibilityService=c,S.bridgeUtilityService=i,S.chatListEntryFactory=a,S.chatListService=s,S.chatTitlesService=u,S.constants=f,S.conversationsService=l,S.dialogService=p,S.eventingService=b,S.presenceService=d,S.resources=M,S.flatContactListService=h,S.layoutService=v,S.localizationService=g,S.loggingService=A,S.newChatService=O,S.settingsService=z,S.sxConfig=y,S.typingIndicatorService=m,S.messagingTelemetryService=L,S.settingsService.valueAsBoolean(S.constants.settings.names.enableChatListViewsBridge)&&(S.cachedChatListEntries={},S.throttledHelpers={},S.logger=S.loggingService.newLogger("BridgeChatListService"),S.triggerLogger=function(e){return S.logger.error("trigger error: {0}",e?e.message:"")},S.subscribeToServices(),S.setupEventHandlers()),S}return t.$inject=["$rootScope","$timeout","$compile","$translate","accessibilityService","bridgeUtilityService","chatListEntryFactory","chatListService","chatTitlesService","constants","conversationsService","dialogService","eventingService","presenceService","resources","flatContactListService","layoutService","localizationService","loggingService","newChatService","settingsService","sxConfig","typingIndicatorService","messagingTelemetryService"],G(t,e),Object.defineProperty(t.prototype,"expandedLists",{get:function(){return{PINNED:this.layoutService.pinnedChatsExpanded,RECENTS:this.layoutService.recentChatsExpanded}},set:function(e){e&&(_.isNil(e.PINNED)||(this.layoutService.pinnedChatsExpanded=e.PINNED),_.isNil(e.RECENTS)||(this.layoutService.recentChatsExpanded=e.RECENTS))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRtl",{get:function(){return this.localizationService.langDirection===this.constants.languageDirectionStrings.rtl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pinnedListName",{get:function(){return this._pinnedListName||(this._pinnedListName=this.settingsService.valueAsBoolean(this.constants.settings.names.enableBuddyList)?this.$translate.instant(this.resources.strings.chats_pinned_header):this.$translate.instant(this.resources.strings.chats_favorites_header)),this._pinnedListName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recentsListName",{get:function(){return this._recentsListName||(this._recentsListName=this.$translate.instant(this.resources.strings.chats_recents_header)),this._recentsListName},enumerable:!0,configurable:!0}),t.prototype.safeSubscribe=function(t,n,r,o){var c=e.prototype.safeSubscribe.call(this,t,n,r,o);return this.provideCurrentValues(n,r,o),c},t.prototype.subscribe=function(t,n,r){var o=e.prototype.subscribe.call(this,t,n,r);return this.provideCurrentValues(t,n,r),o},t.prototype.notifyChatListRendered=function(e,t){if(e){if(this.chatListService.isInitialLoadComplete()){var n=this.getChatListLoadScenarioData();this.messagingTelemetryService.onBridgeChatListRendered(n,n);var r=this.loggingService.findScenario(this.constants.scenarios.loadReactChatList);r&&r.stop(n)}}else this.failLoadScenarios("React chat list failed to render",t)},t.prototype.onBridgeLoadError=function(e,t){this.failLoadScenarios(e,t)},t.prototype.navigateToChat=function(e,t){void 0===t&&(t="");var n=this.conversationsService.getConversation(e),r=n&&this.chatTitlesService.getChatConversationTitles(n.id);this.accessibilityService.focusEditorOnInit=!0,this.selectedChatId===e&&this.eventingService.$emit(this.constants.events.messages.requestFocusOnCompose);var o={slug:e,groupName:r&&r.title||"",middlePane:this.constants.messages.panes.conversations,ctx:this.constants.navigation.context.chat};this.triggerWithLogging(this.triggerLogger,T.NavigateToChat,void 0,o)},t.prototype.setSelectedChatId=function(e){var t=this.messagingTelemetryService.activeChannelSwitchScenario;t&&t.mark("ChatList_peopleSlugChange_complete_react"),this.chatListService.setSelectedChatId(e),this.selectedChatId=e},t.prototype.reorderPinned=function(e){var t=this.chatListService.reorderPinned(e);return t&&this.onChatsUpdated(),t},t.prototype.pinChat=function(e){return this.chatListService.pinChat(e)},t.prototype.addFavorite=function(e){if(e){var t=void 0,n=this.cachedChatListEntries[e];if(n)t=n.otherMemberMris;else{var r=this.conversationsService.getChatConversation(e);r?t=r.getOtherMembers(this.sxConfig.getCurrentSkypeMri()):this.logger.error("unable to find chat with id "+e+" in the chat list")}if(t){var o=_.head(t);o?this.flatContactListService.addMriToFavorites(o):this.logger.error(e+" has no other members")}}},t.prototype.setChatVisibility=function(e,t){return this.bridgeUtilityService.convertToESPromise(this.conversationsService.setChatVisibility(e,t))},t.prototype.updateMuteChat=function(e,t){this.chatListService.updateMuteChat(e,t)},t.prototype.unpinChat=function(e){this.chatListService.unpinChat(e)},t.prototype.discardChat=function(e){this.settingsService.valueAsBoolean(this.constants.settings.names.enableMultipleChatDrafts)?this.chatListService.discardChat(e):e&&e===this.constants.p2p.newChatId&&this.newChatService.clearNewChat()},t.prototype.leaveChat=function(e){if(e){var t={chatId:e};this.dialogService.open(this.constants.dialogs.leaveGroupChat,t),this.dialogService.registerCloseCallback(this.constants.dialogs.leaveGroupChat,function(e){e&&e.mark&&e.mark("dialog_closed")})}},t.prototype.setBotChatBlock=function(e,t){return this.bridgeUtilityService.convertToESPromise(this.chatListService.setBotChatBlock(e,t))},t.prototype.contextMenuOpened=function(){this.eventingService.$emit("tooltip.show.before")},t.prototype.contextMenuClosed=function(){this.eventingService.$emit("tooltip.hide")},t.prototype.getAriaLabel=function(e,t){var n=this.chatListService.getChatConversation(t?teamspace.services.ChatListType.PINNED:teamspace.services.ChatListType.RECENTS,e),r=this.getChatListEntry(n);if(r.id===this.constants.p2p.newChatId)return this.$translate.instant(this.resources.strings.chats_aria_new_chat);var o=r.title||r.longTitle,c="";if(r.otherMemberMris&&1===r.otherMemberMris.length){var i=this.presenceService.getTranslatedStatusTextFromMri(r.otherMemberMris[0]);c=i?", "+i:""}var a="";r.isMuted&&(a=this.$translate.instant(this.resources.strings.chats_messagePreview_chatMuted));r.hasFailedMessages&&(a=this.$translate.instant(this.resources.strings.chats_messagePreview_chatHasFailedMessages));var s="";r.isMeeting||r.lastMessageTime&&r.lastMessageTime.length>0&&r.isLastMessageText&&(r.isLastMessageFromMe?s=r.lastMessageTime.contains(":")?this.$translate.instant(this.resources.strings.chats_messagePreview_lastMessage_fromSelfAtTime,{time:r.lastMessageTime,message:r.messagePreviewAria}):this.$translate.instant(this.resources.strings.chats_messagePreview_lastMessage_fromSelfOnDate,{date:r.lastMessageTime,message:r.messagePreviewAria}):r.displayName&&r.displayName.length>0&&(s=r.lastMessageTime.contains(":")?this.$translate.instant(this.resources.strings.chats_messagePreview_lastMessage_fromOtherAtTime,{other:r.displayName,time:r.lastMessageTime,message:r.messagePreviewAria}):this.$translate.instant(this.resources.strings.chats_messagePreview_lastMessage_fromOtherOnDate,{other:r.displayName,date:r.lastMessageTime,message:r.messagePreviewAria})));var u="";return r.isRead||(u=this.$translate.instant(this.resources.strings.chats_aria_new_message)),this.$translate.instant(this.resources.strings.chats_messagePreview,{chatTitle:o,status:c,hasFailedMessages:"",muted:a,lastMessage:s,unread:u})},t.prototype.compileIntoAngular=function(e){var t=this;this.$timeout(function(){t.$compile(e)(t.$rootScope)})},t.prototype.provideCurrentValues=function(e,t,n){this.isBridgeChatListEventUpdate(t,e)?e(n,this.chatItemLists()):this.isBridgeChatListEventTypingIndicators(t,e)&&e(n,this.typingIndicatorService.getTypingUserMRIs())},t.prototype.isBridgeChatListEventUpdate=function(e,t){return e===T.Update},t.prototype.isBridgeChatListEventTypingIndicators=function(e,t){return e===T.TypingIndicators},t.prototype.subscribeToServices=function(){this.subscribeToChatListService(),this.subscribeToFlatContactListService(),this.subscribeToNewChatService(),this.subscribeToTypingIndicatorService()},t.prototype.setupEventHandlers=function(){var e=this;this.eventingService.$on(this.$rootScope,this.constants.scenarios.cancelNewChat,function(t,n){n||e.discardChat(e.selectedChatId)}),this.eventingService.$on(this.$rootScope,this.constants.events.layout.shortcutNavigationInLeftRailList,function(t,n){var r=n.direction;if(e.layoutService.routedToAppBarItem.itemType===teamspace.services.AppBarItemType.Chat){e.logger.debug("Navigation to "+(r===teamspace.services.Direction.Previous?"previous":"next")+" chat");var o=e.chatItemLists(),c=o.PINNED,i=o.RECENTS,a=_.concat(c.chats||[],i.chats||[]),s=_.findIndex(a,function(t){return t.id===e.selectedChatId});if(s>=0){var u=a[s+r];u?(e.navigateToChat(u.id,"_shortcut"),e.setSelectedChatId(u.id)):e.logger.debug("No chat to navigate found.")}}})},t.prototype.subscribeToChatListService=function(){var e=this;if(this.propagate(this.chatListService,teamspace.services.ChatListServiceEvents.EventType_NavigateToNextSelectedChat,T.NavigationToNextSelectedChat),this.propagate(this.chatListService,teamspace.services.ChatListServiceEvents.EventType_HideChat,T.Hide),this.propagate(this.chatListService,teamspace.services.ChatListServiceEvents.EventType_Resolved,T.LieResolved),!this.chatListService.isInitialLoadComplete())var t=this.chatListService.subscribe(function(n,r){e.onInitialChatsLoadComplete(n,r),e.chatListService.unsubscribe(t)},teamspace.services.ChatListServiceEvents.EventType_LoadComplete);this.chatListService.subscribe(function(t,n){return e.onChatsUpdated(t,n)},teamspace.services.ChatListServiceEvents.EventType_Batched),this.chatListService.subscribe(function(){e.newChatService.clearNewChat(),e.onChatsUpdated()},teamspace.services.ChatListServiceEvents.EventType_ClearNewChat)},t.prototype.onInitialChatsLoadComplete=function(e,t){t||this.logger.warn("Got no args in call to onInitialChatsLoadComplete, will assume success"),!t||t.success?this.onChatsUpdated():this.failLoadScenarios("Something went wrong during initial data fetching",t.error)},t.prototype.subscribeToFlatContactListService=function(){var e=this,t=this.flatContactListService.isBuddyListLoaded();if(!t)var n=this.flatContactListService.subscribe(function(){t=!0,e.flatContactListService.unsubscribe(n),e.onChatsUpdated(null,_.keys(e.cachedChatListEntries))},teamspace.services.FlatContactListServiceEvents.EventType_BuddyGroupUpdated);this.flatContactListService.subscribe(function(n,r){if(t){var o=e.idsOfOneOnOnesWithMris(r,e.settingsService.valueAsBoolean(e.constants.settings.names.enableBuddyList));_.size(o)&&e.onChatsUpdated(n,o)}},teamspace.services.FlatContactListServiceEvents.EventType_FavoriteUpdated)},t.prototype.subscribeToNewChatService=function(){var e=this;this.propagate(this.newChatService,teamspace.services.NewChatServiceEvents.EventType_DeleteNewChat,T.NewChatDelete),this.newChatService.subscribe(function(t,n){e.navigateToChat(t)},teamspace.services.NewChatServiceEvents.EventType_ResolveNewChat)},t.prototype.subscribeToTypingIndicatorService=function(){var e=this;this.typingIndicatorService.subscribe(function(t,n){e.triggerWithLogging(e.triggerLogger,T.TypingIndicators,t,{id:t,typingUserMRIs:e.typingIndicatorService.getTypingUserMRIs()})},teamspace.services.TypingIndicatorServiceEvents.EventType_Change)},t.prototype.idsOfOneOnOnesWithMris=function(e,t){var n=this,r=this.sxConfig.getCurrentSkypeMri();return _.reduce(this.cachedChatListEntries,function(o,c,i){return n.canBeFavoritedChanged(c,i,r,e,t)&&o.push(i),o},[])},t.prototype.canBeFavoritedChanged=function(e,t,n,r,o){var c;if(e){var i=this.conversationsService.getChatConversation(t);if(i&&i.isOneOnOne()){var a=i.getOtherMembers(n)[0];if(_.findIndex(r,function(e){return e===a})>=0){var s=o&&t!==this.constants.p2p.newChatId&&!this.flatContactListService.isContactAlreadyAFavorite(a);c=e.canBeFavorited!==s}}}return c||!1},t.prototype.onChatsUpdated=function(e,t){var n=this,r=function(e){var t=n.throttledHelpers[e].accumulator;n.triggerWithLogging(n.triggerLogger,T.Update,e,n.chatItemLists(t)),n.throttledHelpers[e].accumulator.clear()};this.throttledHelpers=this.throttledHelpers||{},e=e||SkypeX.Services.ObservableBase.Key_All,this.throttledHelpers[e]||(this.throttledHelpers[e]={accumulator:new Set,throttledBridgeEvent:_.throttle(function(){return r(e)},100,{leading:!0,trailing:!0})});var o=this.throttledHelpers[e],c=o.accumulator,i=o.throttledBridgeEvent;_.forEach(t,function(e){return c.add(e)}),i()},t.prototype.chatItemLists=function(e){return{PINNED:{chats:this.getChatItemModels(teamspace.services.ChatListType.PINNED,e),name:this.pinnedListName},RECENTS:{chats:this.getChatItemModels(teamspace.services.ChatListType.RECENTS,e),name:this.recentsListName}}},t.prototype.getChatListEntry=function(e,t){var n=this,r=e.id,o=this.cachedChatListEntries[r];if(!o||t){var c=this.chatListEntryFactory.createChatListEntryFromConversation(e,o);if(this.cachedChatListEntries[c.id]=c,c.messagePreviewPromise){var i=c.messagePreview;c.messagePreviewPromise.then(function(){c.messagePreview!==i&&(n.cachedChatListEntries[r]=_.clone(c),n.onChatsUpdated())})}}return this.cachedChatListEntries[r]},t.prototype.getChatListEntries=function(e,t){var n=this;return e?e.map(function(e){return n.getChatListEntry(e,t&&t.has(e.id))}):null},t.prototype.getChatItemModels=function(e,t,n){var r=this,o=this.chatListService.getChatConversations(e,n),c=e===teamspace.services.ChatListType.RECENTS&&this.chatListEntryFactory.newChatListEntry,i=function(){return r.getChatListEntries(_.filter(o,function(e){return e&&r.chatListService.shouldDisplayChat(e,!0)}),t)};return c?o?[c].concat(i()):[c]:o?i():null},t.prototype.failLoadScenarios=function(e,t){var n=this.getChatListLoadScenarioData(),r=t?e+": "+t.message:e;this.messagingTelemetryService.handleLoadFailure(r,n);var o=this.loggingService.findScenario(this.constants.scenarios.loadReactChatList);o&&(o.appendEventData(n),o.fail({errorMessage:r}));var c=t?e+"\n"+t.stack:e;this.logger.error(c)},t.prototype.getChatListLoadScenarioData=function(){return{selectedChat:this.selectedChatId||"none"}},t}(SkypeX.Services.ObservableBase);N.service("bridgeChatListService",K);var $=function(){function e(e,t){this.conversationsService=e,this.loggingService=t}return e.$inject=["conversationsService","loggingService"],e.prototype.getChatConversationWith=function(e){var t=this.conversationsService.getChatConversationWith(e);return t?t.id:(this.loggingService.error("Failed to create chatConversation for the participant(s) : "+e.toString()),null)},e}();angular.module("teamspace.bridge").service("bridgeConversationsService",$);var Q=function(){function e(e){this.loggingService=e}return e.$inject=["loggingService"],e.prototype.startNewScenario=function(e){return this.loggingService.newScenario(e.scenarioName,e.associatedCounters,e.callback,e.timeoutMs)},e.prototype.newCounter=function(e,t,n,r){return this.loggingService.newCounter(e,t,n,r)},e.prototype.sendEvent=function(e,t){this.loggingService.event(e,t)},e.prototype.setLoggingContext=function(e,t){this.loggingService.setContext(e,t)},e.prototype.newLogger=function(e){return this.loggingService.newLogger(e)},e.prototype.findScenario=function(e){return this.loggingService.findScenario(e)},e.prototype.findScenarioByNameAndId=function(e,t){return this.loggingService.findScenarioByNameAndId(e,t)},e.prototype.logInfo=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.loggingService.info(e,t)},e.prototype.logDebug=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.loggingService.debug(e,t)},e.prototype.logWarning=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.loggingService.warn(e,t)},e.prototype.logError=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.loggingService.error(e,t)},e.prototype.log=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.loggingService.log(e,t)},e}();N.service("bridgeLoggingService",Q);var J=n("4ca1c2ac263019ccc2f8"),Y=function(){function e(e,t,n,r,o,c,i,a,s,u,f,l){this.$translate=e,this.blobUrlCacheService=t,this.bridgeUtilityService=n,this.constants=r,this.eventingService=o,this.outgoingWebhookService=c,this.loggingService=i,this.presenceManagerService=a,this.presenceService=s,this.profilePictureLoaderService=u,this.resources=f,this.sfbInteropService=l,this.skypeStatusHelper=new J.BaseSkypeStatus(this.$translate,this.resources,this.presenceService),this.userPresenceMap={},this.logger=this.loggingService.newLogger("bridgeProfilePictureService")}return e.$inject=["$translate","blobUrlCacheService","bridgeUtilityService","constants","eventingService","outgoingWebhookService","loggingService","presenceManagerService","presenceService","profilePictureLoaderService","resources","sfbInteropService"],e.prototype.loadDefaultImage=function(e){return this.profilePictureLoaderService.loadDefaultImage(e)},e.prototype.loadImage=function(e,t,n,r){return void 0===r&&(r=!1),this.bridgeUtilityService.convertToESPromise(this.profilePictureLoaderService.loadImage(e,t,n,r))},e.prototype.registerUserProfileListener=function(e,t){var n;return e?n=this.eventingService.unsafeOn(this.constants.events.personCard.reloadUser,function(n,r){r&&r.plUpn==e.principalName&&t()}):(this.logger.warn("Cannot register for updates to falsy profile"),n=function(){}),n},e.prototype.unregisterUserProfileListener=function(e,t){e&&!e.isBot&&(e.principalName?this.blobUrlCacheService.removeBlobImageUrlReference(e.principalName,e.size):e.groupId?this.blobUrlCacheService.removeBlobImageUrlReference(e.groupId):e.displayName&&this.blobUrlCacheService.removeBlobImageUrlReference(e.displayName)),t()},e.prototype.registerPresenceStatusListener=function(e,t,n,r){this.userPresenceMap[e]||(this.userPresenceMap[e]={});var o;return n?o=this.trackSfBUserPresence(e,r,o):this.trackTeamsUserPresence(e,t,r),this.updatePresence(e),o},e.prototype.trackTeamsUserPresence=function(e,t,n){var r=this;if(this.presenceManagerService.isValidMRI(e)){var o=this.presenceManagerService.trackPresenceV2(e,teamspace.services.PresencePriority.Medium,t,function(e){return r.updatePresence(e)});this.userPresenceMap[e][t]={presence:o,callback:n}}else this.trackWebhookPresence(e,t,n)},e.prototype.trackWebhookPresence=function(e,t,n){var r=this;this.outgoingWebhookService.isValidWebhookMRI(e).then(function(o){o?(r.userPresenceMap[e][t]={presence:{status:SkypeX.Services.UserStatus.Online,mri:e},callback:n},r.updatePresence(e)):r.userPresenceMap[e][t]=null},function(n){r.userPresenceMap[e][t]=null,r.logger.error("isValidWebhookMRI error: "+n)})},e.prototype.trackSfBUserPresence=function(e,t,n){var r=this,o=this.sfbInteropService.trackPresence(e,function(e){return t(r.updatePresenceForSfB(e))});return o&&o.dispose},e.prototype.unregisterPresenceStatusListener=function(e,t,n){n?n():(this.presenceManagerService.untrackPresenceV2(e,teamspace.services.PresencePriority.Medium,t),this.userPresenceMap[e]&&this.userPresenceMap[e][t]&&delete this.userPresenceMap[e][t])},e.prototype.updatePresence=function(e){var t=this,n=this.userPresenceMap[e];n&&_.forEach(_.keys(n),function(e){var r=n[e];r&&(r.presence&&t.skypeStatusHelper.applyStatus(r.presence.status),r.callback({statusClass:t.skypeStatusHelper.statusClass,statusText:t.skypeStatusHelper.statusText,statusAriaLabel:t.$translate.instant(t.resources.strings.alt_team_picture+t.skypeStatusHelper.statusText)}))})},e.prototype.updatePresenceForSfB=function(e){return this.skypeStatusHelper.applyStatus(e),{statusClass:this.skypeStatusHelper.statusClass,statusText:this.skypeStatusHelper.statusText,statusAriaLabel:this.$translate.instant(this.resources.strings.alt_team_picture+this.skypeStatusHelper.statusText)}},e}();N.service("bridgeProfilePictureService",Y);var Z=function(){function e(e,t,n,r,o,c){this.navigationService=e,this.utilityService=t,this.sharePointFilePreviewService=n,this.filesUtilityService=r,this.settingsService=o,this.constants=c}return e.$inject=["navigationService","utilityService","sharePointFilePreviewService","filesUtilityService","settingsService","constants"],e.prototype.navigateToFileViewer=function(e,t){var n={documentViewerParams:{baseUrl:e.baseUrl,fileId:e.fileId,fileType:e.fileType,objectUrl:e.objectUrl,serviceName:e.serviceName,viewerAction:t,threadId:e.threadId,ctx:e.ctx,providerCode:e.providerCode,providerType:e.providerType,rootContext:this.constants.scenarios.files.itemsViewRootContext},viewerState:e.providerCode?"app.externalDocumentViewer":"app.documentViewer"};this.navigationService.navigateToFileViewer(n)},e.prototype.isEditInTeamsAllowed=function(e){if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableOfficeViewerEdit)){var t=this.isEditSideBySideActionAllowed(e);return t&&this.utilityService.isVisioFile(e)?!!this.utilityService.isEditableVisioFileExtension(e)&&this.filesUtilityService.isVisioLicenseEnabled():t}return!1},e.prototype.isEditSideBySideActionAllowed=function(e){return this.settingsService.valueAsBoolean(this.constants.settings.names.filesEnableSharePointFilePreviewService)?this.sharePointFilePreviewService.canEditFileInTeams(e):this.utilityService.canDocumentOpenInWAC(e)},e}();N.service("bridgeNavigationService",Z);var ee=function(){function e(e){this.$templateCache=e}return e.$inject=["$templateCache"],e.prototype.getSvgHtml=function(e){return this.$templateCache.get(e)},e}();N.service("bridgeSvgService",ee);var te=function(){function e(){}return e.prototype.setupBridge=function(e,t,n){return n?n.mark("bridge_load_started"):_.noop(),e.then(function(e){return t.setConnection(e,n),!0}).catch(function(e){return t.handleError.bind(t),t.handleError(e),!1})},e.prototype.convertToESPromise=function(e){return new Promise(function(t,n){e?e.then(t,n):n("attempted to convert falsy promise")})},e}();N.service("bridgeUtilityService",te);var ne=teamspace.services.files,re=function(){function e(e,t,n,r,o,c,i,a,s,u,f,l){this.copyLinkFactory=e,this.pinToTabFactory=t,this.utilityService=n,this.bridgeUtilityService=r,this.oneDriveRepositoryDirect=o,this.sharePointFileEntityFactory=c,this.filesProviderFactory=i,this.constants=a,this.filesRoutingService=s,this.$q=u,this.downloadManagerService=f,this.filesUtilityService=l}return e.$inject=["copyLinkFactory","pinToTabFactory","utilityService","bridgeUtilityService","oneDriveRepositoryDirect","sharePointFileEntityFactory","filesProviderFactory","constants","filesRoutingService","$q","downloadManagerService","filesUtilityService"],e.prototype.createSpoContext=function(e,t,n){return{siteUrl:e,rootRelativeFolderUrl:"",serverRelativeRootUrl:t,sortedAscending:null,pageSize:null,libraryId:null,libraryTitle:null,serviceName:n,provider:this.filesProviderFactory.create(ne.FilesProviderType.Sharepoint)}},e.prototype.downloadFiles=function(e,t,n){var r=this,o=_.map(e,function(e){var o=r.getFileEnittyAndContext(e,t,n).sharepointFileEntity;return{objectId:o.getId(),title:o.getTitle(),size:o.getSize(),type:o.getExtension(),objectUrl:o.getUrl(),downloadUrl:o.getDownloadUrl()}});return this.bridgeUtilityService.convertToESPromise(this.downloadManagerService.download(o,function(e){return r.$q.when({serviceName:n,objectUrl:e.objectUrl})}))},e.prototype.copyLink=function(e,t,n,r){var o=this.getFileEnittyAndContext(e,t,n,r);this.copyLinkFactory.create({sharepointUrl:o.sharepointFileEntity.getUrl(),file:o.sharepointFileEntity,fileContext:o.sharepointFilesContext,folderRouteParams:this.filesRoutingService.getAllRawRouteParams(o.sharepointFilesContext.rootRelativeFolderUrl)}).execute()},e.prototype.pinToTab=function(e,t,n,r){var o=this.getFileEnittyAndContext(e,t,n,r);this.pinToTabFactory.create({file:o.sharepointFileEntity,serviceName:o.sharepointFilesContext.serviceName,threadId:o.sharepointFilesContext.threadId,provider:o.sharepointFilesContext.provider}).execute()},e.prototype.isPinToTabAllowed=function(e,t,n,r){var o=this.getFileEnittyAndContext(e,t,n,r);return this.pinToTabFactory.isAllowed(e.rowDataFacet.File_x0020_Type,o.sharepointFilesContext)},e.prototype.getFileEnittyAndContext=function(e,t,n,r){var o=t.rootUrl,c=t.listUrl,i=this.utilityService.parseUrl(o).origin,a=this.filesUtilityService.extractServerRelativeUrl(o),s=this.oneDriveRepositoryDirect.parseGetItemsRow(this.convertToRowData(e),i,a),u=this.filesUtilityService.extractServerRelativeUrl(c),f=this.createSpoContext(o,u,n),l=this.sharePointFileEntityFactory.create(s,f),p=f.rootRelativeFolderUrl||"";return p=0===p.length?s.title:(p=p.replace(this.constants.files.regexPatterns.leadingAndTrailingSlashesRegex,""))+"/"+l.getTitle(),f.rootRelativeFolderUrl=p,f.threadId=r,{sharepointFilesContext:f,sharepointFileEntity:l}},e.prototype.convertToRowData=function(e){return{UniqueId:e.rowDataFacet.UniqueId,FileLeafRef:e.rowDataFacet.FileLeafRef,FileRef:e.rowDataFacet.FileRef,File_x0020_Size:e.rowDataFacet.File_x0020_Size,File_x0020_Type:e.rowDataFacet.File_x0020_Type,Author:null,Editor:e.rowDataFacet.Editor,Created:null,Modified:e.rowDataFacet.Modified.toString(),ProgId:e.rowDataFacet.ProgId,FSObjType:e.rowDataFacet.FSObjType,".spItemUrl":e.rowDataFacet[".spItemUrl"],MediaServiceFastMetadata:e.rowDataFacet.MediaServiceFastMetadata}},e.prototype.convertSpoFileEntityToTeamspaceFileDto=function(e,t){var n=t.rootUrl,r=(t.listUrl,this.utilityService.parseUrl(n).origin),o=this.filesUtilityService.extractServerRelativeUrl(n);return this.oneDriveRepositoryDirect.parseGetItemsRow(this.convertToRowData(e),r,o)},e}();N.service("filesBridgeUtilityService",re);var oe,ce="default",ie=n("52590c22db4b48afab45"),ae=n("91ecbb091437d8753492"),se=n("a8297f1a1eef815b6c71"),ue=n("fca350482fff53036cf0"),fe=n("c47f1635aacb1501f578"),le=function(e,t,n){"__proto__"==t&&fe.a?Object(fe.a)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},pe=n("fb3a2b210e1d3add6253"),be=function(e,t,n){(void 0===n||Object(pe.a)(e[t],n))&&(void 0!==n||t in e)||le(e,t,n)},de=n("e41ebfedd2623af3046b"),Me=n("015f1a6e17a26e130212"),he=n("a50cc60cf2cb5b489ec3"),ve=function(e){var t=new e.constructor(e.byteLength);return new he.a(t).set(new he.a(e)),t},ge=function(e,t){var n=t?ve(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)},Ae=n("ea2effc0f6d665f6ba8e"),Oe=n("3b252cd5e0e6c3615b6d"),ze=n("5c2f6399ceca32b7a0b3"),ye=n("d7d4fca6d5f8306ef0a5"),me=function(e){return"function"!=typeof e.constructor||Object(ye.a)(e)?{}:Object(Oe.a)(Object(ze.a)(e))},Le=n("12ad4997381b52bb6668"),Se=n("517d6e3962b3db33796d"),Ne=n("ea2194eda6874f39b8b5"),qe=n("b8c08b527e4f22d848fd"),Te=n("d423f003db2cbb5863ff"),We=n("978b85f07cd53ebdd0f6"),Be=n("368eeccd09bffdd9f296"),Ce=n("38221194fe782b107f03"),we=function(e,t){return"__proto__"==t?void 0:e[t]},je=Object.prototype.hasOwnProperty,_e=function(e,t,n){var r=e[t];je.call(e,t)&&Object(pe.a)(r,n)&&(void 0!==n||t in e)||le(e,t,n)},Xe=function(e,t,n,r){var o=!n;n||(n={});for(var c=-1,i=t.length;++c<i;){var a=t[c],s=r?r(n[a],e[a],a,n,e):void 0;void 0===s&&(s=e[a]),o?le(n,a,s):_e(n,a,s)}return n},Ee=n("40c1a00b3363fb21280a"),ke=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},Re=Object.prototype.hasOwnProperty,Pe=function(e){if(!Object(We.a)(e))return ke(e);var t=Object(ye.a)(e),n=[];for(var r in e)("constructor"!=r||!t&&Re.call(e,r))&&n.push(r);return n},xe=n("f76c3b2fae372b75aaef"),De=function(e){return Object(xe.a)(e)?Object(Ee.a)(e,!0):Pe(e)},Ie=function(e){return Xe(e,De(e))},Fe=function(e,t,n,r,o,c,i){var a=we(e,n),s=we(t,n),u=i.get(s);if(u)be(e,n,u);else{var f=c?c(a,s,n+"",e,t,i):void 0,l=void 0===f;if(l){var p=Object(Se.a)(s),b=!p&&Object(qe.a)(s),d=!p&&!b&&Object(Ce.a)(s);f=s,p||b||d?Object(Se.a)(a)?f=a:Object(Ne.a)(a)?f=Object(Ae.a)(a):b?(l=!1,f=Object(Me.a)(s,!0)):d?(l=!1,f=ge(s,!0)):f=[]:Object(Be.a)(s)||Object(Le.a)(s)?(f=a,Object(Le.a)(a)?f=Ie(a):(!Object(We.a)(a)||r&&Object(Te.a)(a))&&(f=me(s))):l=!1}l&&(i.set(s,f),o(f,s,r,c,i),i.delete(s)),be(e,n,f)}},Ue=v,He=n("c9c1436a8870b75df6cf"),Ve=n("f9fcd5e1be45a6d7936a"),Ge=function(e){return Object(He.a)(function(t,n){var r=-1,o=n.length,c=o>1?n[o-1]:void 0,i=o>2?n[2]:void 0;for(c=e.length>3&&"function"==typeof c?(o--,c):void 0,i&&Object(Ve.a)(n[0],n[1],i)&&(c=o<3?void 0:c,o=1),t=Object(t);++r<o;){var a=n[r];a&&e(t,a,r,c)}return t})},Ke=Ge(function(e,t,n){Ue(e,t,n)}),$e=n("5b2a8888241c3d58032e"),Qe=new(function(){function e(){this.delayedEvents=[],this.cacheIsFullEventLogged=!1}return e.prototype.setLoggingService=function(e){var t=this;if(this.loggingService=e,this.delayedEvents){var n={delayedEvent:!0};Object($e.a)(this.delayedEvents,function(e){var r=e.eventData||{};Ke(r,n),t.loggingService.sendEvent(e.eventName,r)}),this.delayedEvents=void 0}},e.prototype.sendEvent=function(e,t){this.loggingService?this.loggingService.sendEvent(e,t):this.delayedEvents&&(this.delayedEvents.length<100?this.delayedEvents.push({eventName:e,eventData:t}):this.cacheIsFullEventLogged||(this.delayedEvents.push({eventName:"delayedeventlogger-cachefull"}),this.cacheIsFullEventLogged=!0))},e}()),Je=n("fa11070de994a894b2a1"),Ye=n("584e93b03a67abaab594"),Ze=function(e,t){return e&&Object(Je.a)(e,Object(Ye.a)(t))},et=n("5797aa9444a26dc50ee4"),tt=n("77cdcf6d92804c8937e7"),nt=n("f3d9c495aaedd8ec38a5"),rt=Ge(function(e,t,n,r){Ue(e,t,n,r)}),ot=n("4605ae836ca138d7eb59"),ct="Expected a function",it=function(e){if("function"!=typeof e)throw new TypeError(ct);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}},at=n("0be451910340157220f5"),st=n("77de278315e7bc78045c"),ut=n("e912579201d6b2659f44"),ft=n("7af3fc0c351e507691be"),lt=n("241740b9bc448e1477af"),pt=function(e,t,n,r){if(!Object(We.a)(e))return e;for(var o=-1,c=(t=Object(ut.a)(t,e)).length,i=c-1,a=e;null!=a&&++o<c;){var s=Object(lt.a)(t[o]),u=n;if(o!=i){var f=a[s];void 0===(u=r?r(f,s,a):void 0)&&(u=Object(We.a)(f)?f:Object(ft.a)(t[o+1])?[]:{})}_e(a,s,u),a=a[s]}return e},bt=function(e,t,n){for(var r=-1,o=t.length,c={};++r<o;){var i=t[r],a=Object(st.a)(e,i);n(a,i)&&pt(c,Object(ut.a)(i,e),a)}return c},dt=n("7dab7527baa6bb82ca72"),Mt=n("545917340bb38318cdfd"),ht=n("8e4296af8a1934c9fbc5"),vt=n("daea84c148dbc0bf9b45"),gt=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Object(Mt.a)(t,Object(ht.a)(e)),e=Object(ze.a)(e);return t}:vt.a,At=function(e){return Object(dt.a)(e,De,gt)},Ot=function(e,t){if(null==e)return{};var n=Object(at.a)(At(e),function(e){return[e]});return t=Object(ot.a)(t),bt(e,n,function(e,n){return t(e,n[0])})},zt=function(e,t){return Ot(e,it(Object(ot.a)(t)))},yt=function(e,t,n){return null==e?e:pt(e,t,n)};!function(e){e[e.Normal=0]="Normal",e[e.Low=1]="Low"}(oe||(oe={}));var mt=function(){function e(e){this.settingsService=e}return e.prototype.getRing=function(){return this.settingsService.get("ring")},e.prototype.getMiddleTierRing=function(){return this.settingsService.get("middleTierRing")},e.prototype.getApi=function(){return this.settingsService.get("api")},e.prototype.areDevToolsEnabled=function(){return this.settingsService.getBoolean("enableDevTools")},e.prototype.isInternalRing=function(){return this.settingsService.getBoolean("isInternalRing")},e.prototype.getPerformanceMode=function(){var e,t=g();t&&t.localStorage&&(e=t.localStorage.getItem("lastSavedPerformanceMode"));var n=e?oe[e]:void 0;return void 0!==n?n:oe.Normal},e.prototype.setCachedPerformanceMode=function(e){var t=g();t&&t.localStorage&&t.localStorage.setItem("lastSavedPerformanceMode",oe[e])},e}(),Lt=function(){function e(){this.providers=[],this.listeners=[],this.mergedSettings={},this.lowerCaseLookupTable={},this.isDirty=!1,this.logger=new ae.a("SettingsService",3),this.refreshSettings(),this.settingsUtilities=new mt(this)}return e.prototype.registerProvider=function(e){this.providers.push(e),e.setChangedCallback(this.notifySettingsChanged.bind(this)),this.isDirty=!0},e.prototype.registerProviders=function(e){var t=this;e.map(function(e){t.registerProvider(e)})},e.prototype.getSettingsForNamespace=function(e){if(void 0===e&&(e=ce),this.isDirty&&this.refreshSettings(),!this.mergedSettings.hasOwnProperty(e))throw new Error("Namespace not found: "+e);return this.mergedSettings[e]},e.prototype.get=function(e,t){return void 0===t&&(t=ce),this.getInternal(e,t)},e.prototype.getBoolean=function(e,t){void 0===t&&(t=ce);var n=this.getInternal(e,t);return Object(se.d)(n)},e.prototype.getString=function(e,t){void 0===t&&(t=ce);var n=this.getInternal(e,t);return"string"==typeof n?n:JSON.stringify(n)},e.prototype.getNumber=function(e,t){void 0===t&&(t=ce);var n=this.getInternal(e,t);return"number"==typeof n?n:NaN},e.prototype.addListener=function(e){this.listeners.push(e)},e.prototype.removeListener=function(e){var t=this.listeners.indexOf(e);return t>=0&&(this.listeners.splice(t,1),!0)},e.prototype.notifySettingsChanged=function(e){if(e)this.isDirty=!0;else{var t=this.mergedSettings;this.refreshSettings();var n=this.getDifferences(t,this.mergedSettings);Object(et.a)(n)||this.listeners.map(function(e){e.invoke(n)})}},e.prototype.enumerateListeners=function(){var e=this;this.logger.info("Registered settings changed subscriptions:"),this.listeners.forEach(function(t){e.logger.info(t.toString())})},e.prototype.refreshSettings=function(){var e=this;this.logger.info("Refreshing settings.");var t={};this.providers.forEach(function(n){var r=n.getSettings(),o=e.expandSettingsKeys(r);rt(t,o,e.mergeRule)}),this.addLowerCaseLookupTable(t),this.mergedSettings=t,this.isDirty=!1},e.prototype.getSettingsUtilities=function(){return this.settingsUtilities},e.prototype.expandSettingsKeys=function(e){var t={};return Ze(e,function(e,n){var r={};Ze(e,function(e,t){yt(r,t,e)}),t[n]=r}),t},e.prototype.mergeRule=function(e,t){if(Object(Se.a)(e))return t},e.prototype.addLowerCaseLookupTable=function(e){var t=this;this.getNamespaces(e).forEach(function(n){var r=e[n],o={};Ze(r,function(e,n){var r=n.toLowerCase();o[r]&&(t.logger.warn("Same key already exists in lower case lookup table,             existing value: "+o[r]+",             duplicate: key: "+n+", value: "+e),Qe.sendEvent("settings-v2-duplicate-key",{duplicateKey:n,originalKey:o[r]})),o[r]=n}),t.lowerCaseLookupTable[n]=o})},e.prototype.getInternal=function(e,t){var n=this.getSettingsForNamespace(t);if(n.hasOwnProperty(e))return n[e];var r=e.toLowerCase(),o=this.lowerCaseLookupTable[t][r];return o?(this.logger.warn("Casing mismatch, setting '"+e+"' (actual: '"+o+"') found using lower case match."),Qe.sendEvent("settings-v2-lowercase-lookup",{key:e,actualKey:o}),n[o]):void 0},e.prototype.getDifferences=function(e,t){var n={};return Ke(this.getNamespaces(e),this.getNamespaces(t)).map(function(r){if(!e[r]&&t[r])Ke(n,(c={},c[r]=t[r],c));else if(e[r]&&t[r]){var o=zt(t[r],function(t,n){return Object(tt.a)(e[r][n],t)});Object(et.a)(o)||Ke(n,(i={},i[r]=o,i))}var c,i}),n},e.prototype.getNamespaces=function(e){return Object(nt.a)(e)},e}(),St=n("f89589b25fe2f057e3ca"),Nt=function(){function e(e,t,n,r){this.friendlyName=e,this.callbackFunction=t,this.settingsNamespace=n,this.keys=r}return e.prototype.invoke=function(e){this.shouldInvoke(e)&&this.callbackFunction(e)},e.prototype.toString=function(){return Object(St.format)("Subscription: %s (Namespace: %s, Keys: %s)",this.friendlyName,this.settingsNamespace||"*",this.keys?JSON.stringify(this.keys):"*")},e.prototype.shouldInvoke=function(e){if(this.settingsNamespace){if(!e||!e.hasOwnProperty(this.settingsNamespace))return!1;if(this.keys){for(var t in this.keys)if(e[this.settingsNamespace].hasOwnProperty(this.keys[t]))return!0;return!1}}return!0},e}(),qt=function(){function e(){}return e.prototype.setChangedCallback=function(e){if(this.callbackFunction)throw Error("Callback has been set already.");if(!Object(Te.a)(e))throw Error("Callback is not a valid function.");this.callbackFunction=e},e.prototype.notifySettingsChanged=function(e){void 0===e&&(e=!1),this.callbackFunction&&this.callbackFunction(e)},e}(),Tt=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wt=function(e){function t(){return e.call(this)||this}return Tt(t,e),t.prototype.setSettings=function(e,t,n){void 0===t&&(t=ce),void 0===n&&(n=!1),this.settings=e?(r={},r[t]=e,r):{},this.notifySettingsChanged(!n);var r},t.prototype.getSettings=function(){return this.settings},t}(qt),Bt=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ct=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},wt=6e5,jt="/config/override",_t=function(e){function t(t){var n=e.call(this)||this;return n.httpTransport=t,n.endpointUrl=jt,n.refreshIntervalInMs=wt,n.logger=new ae.a("EcsSettingsProvider",3),n}return Bt(t,e),t.prototype.initialize=function(e,t,n,r,o){var c=this;if(void 0===n&&(n=!1),this.isInitialized)throw new Error("Already initialized!");return this.appStateService=t,this.loggingService=e,this.refreshIntervalInMs=r||this.refreshIntervalInMs,this.endpointUrl=o||jt,this.isInitialized=!0,n?this.checkForUpdatedOverrideSettings().then(function(e){return c.queueUpdateOverrideCheck(),e}).catch(function(e){return c.logger.warn("Initial override check failed.",e),c.queueUpdateOverrideCheck(),!1}):(this.queueUpdateOverrideCheck(),Promise.resolve(!0))},t.prototype.getSettings=function(){return{default:this.settings}},t.prototype.updateRefreshInterval=function(e){this.refreshIntervalInMs!==e&&(this.refreshIntervalInMs=0===e?e:Math.max(e,6e4),this.refreshIntervalInMs!==e&&this.logger.info("Provided refresh interval was lower than the minimum.",6e4),this.logger.info("Refresh interval changed to",this.refreshIntervalInMs),this.queueUpdateOverrideCheck())},t.prototype.queueUpdateOverrideCheck=function(){this.setIntervalHandle&&(g().clearInterval(this.setIntervalHandle),this.setIntervalHandle=null,this.logger.info("clearInterval() called.")),this.refreshIntervalInMs>0&&(this.setIntervalHandle=g().setInterval(this.checkForUpdatedOverrideSettings.bind(this),this.refreshIntervalInMs),this.logger.info("setInterval() called."))},t.prototype.checkForUpdatedOverrideSettings=function(){return this.appStateService&&!this.appStateService.isConnected()?(this.logger.info("Skipping override settings check due to app not being connected."),Promise.resolve(!1)):this.performRequest()},t.prototype.performRequest=function(){var e=this;this.logger.info("Getting override settings...");var t=this.loggingService.startNewScenario({scenarioName:"checkForUpdateOverrideSettings"}),n=this.currentETag?{"If-None-Match":this.currentETag}:{};return this.httpTransport({url:this.endpointUrl,method:"GET",headers:Ct({},n),credentials:"include"}).then(function(n){return e.handleResponse(n,t)},function(n){return e.handleError(n,t)})},t.prototype.handleResponse=function(e,t){if(200!==e.status||!e.body)return!1;var n=e.body,r=e.headers.etag;return this.currentETag&&this.currentETag===r?this.logger.info("Settings are the same, eTag:",this.currentETag):(this.logger.info("Settings updated to:",n),t.mark("overrideSettingsUpdated",{current:this.currentETag,updated:r}),this.settings=n,this.currentETag=r,this.notifySettingsChanged()),!0},t.prototype.handleError=function(e,t){this.logger.warn("Override settings check failed with: {0}",e);var n=e&&e.status;return t.fail(n),this.loggingService.sendEvent("checkForUpdateOverrideSettingsFailed",{errorStatus:n}),!1},t}(qt),Xt=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Et=function(e){function t(t,n){void 0===n&&(n=ce);var r=e.call(this)||this;return r.settingsStorageKey=t,r.settingsNamespace=n,r.window=g(),r.loadSettings(),r}return Xt(t,e),t.prototype.getSettings=function(){return e={},e[this.settingsNamespace]=this.settings,e;var e},t.prototype.setSetting=function(e,t,n){return void 0===n&&(n=ce),this.settingsNamespace===n&&(this.settings[e]=t,this.saveSettings(),this.notifySettingsChanged(),!0)},t.prototype.clearSettings=function(){return this.settings={},this.window.localStorage.removeItem(this.settingsStorageKey),this.notifySettingsChanged(),!0},t.prototype.saveSettings=function(){var e=JSON.stringify(this.settings);this.window.localStorage.setItem(this.settingsStorageKey,e)},t.prototype.loadSettings=function(){var e=this.window.localStorage.getItem(this.settingsStorageKey);this.settings=e?JSON.parse(e):{},delete this.settings.version},t}(qt),kt=function(){function e(e){this._isValid=!1,this.parse(e)}return Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!0,configurable:!0}),e.prototype.parse=function(e){var t=e.indexOf("="),n=e.indexOf(":");-1!==t&&-1!==n&&"setting"===e.substr(0,t)&&(this._key=e.substr(t+1,n-t-1),this._value=this.tryGetBooleanValueOrReturnOriginalValue(e.substr(n+1)),this._isValid=!!this._key)},e.prototype.tryGetBooleanValueOrReturnOriginalValue=function(e){var t=e.toLowerCase();return"true"===t||"false"===t?"true"===t:e},e}(),Rt=n("43fd540ff64794466865"),Pt=function(){function e(){this.logger=new ae.a("QspSettingsParser",3)}return e.prototype.parse=function(e,t){var n=this;t=t||{};var r=this.getQueryStringParameters(e);return r&&Object(Rt.a)(r,function(e){var r=new kt(e);r.isValid&&(n.logger.info("QSP override: ",r.key,r.value),yt(t,r.key,r.value))}),t},e.prototype.getQueryStringParameters=function(e){if(!e)return null;e.startsWith("?")&&(e=e.substr(1));try{var t=decodeURIComponent(e);if(t)return t.split("&")}catch(e){this.logger.error("Couldn't decode URI: ",e)}return null},e}(),xt=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dt=function(e){function t(){var t=e.call(this)||this;return t.settings={},t.window=g(),t.parser=new Pt,t}return xt(t,e),t.prototype.getSettings=function(){return this.parseQsp(),{default:this.settings}},t.prototype.parseQsp=function(){var e={};this.window.location.search&&this.parser.parse(this.window.location.search,e);var t=this.getQueryStringFromHash();t&&this.parser.parse(t,e),this.settings=e},t.prototype.getQueryStringFromHash=function(){var e=this.window.location.hash;if(!e)return null;var t=e.indexOf("?");return t>-1?e.substr(t):null},t}(qt),It=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ft=function(e){function t(t,n){void 0===n&&(n=ce);var r=e.call(this)||this;return r.utilities=t,r.settingsNamespace=n,r.settings=(o={},o[n]={},o),r;var o}return It(t,e),t.prototype.setSettings=function(e,n,r){if(void 0===r&&(r=ce),this.settingsNamespace!==r)return!1;if(e){var o=e[t.lowPerformanceNamespace],c=n?n[t.lowPerformanceNamespace]:void 0,i=Ke(o,c);this.settings=(a={},a[r]=i,a)}else this.settings=(s={},s[r]={},s);return!0;var a,s},t.prototype.getSettings=function(){return this.getPerformanceMode()===oe.Low?this.settings:(e={},e[this.settingsNamespace]={},e);var e},t.prototype.getPerformanceMode=function(){return this.utilities.getPerformanceMode()},t.lowPerformanceNamespace="lowPerformanceSettingsOverride",t}(qt),Ut={enablePerformanceModeDetection:"enablePerformanceModeDetection",enablePerformanceModeSettings:"enablePerformanceModeSettings"},Ht=function(){function e(){this.createService()}return e.getInstance=function(){return e.instance},e.prototype.getService=function(){return this.service},e.prototype.initializeDefaultSettings=function(e,t,n,r){this.defaultSettingsProvider.setSettings(e),this.overrideSettingsProvider.setSettings(t),this.clientSpecificSettingsProvider.setSettings(n),this.service.getBoolean(Ut.enablePerformanceModeDetection)&&this.service.getBoolean(Ut.enablePerformanceModeSettings)&&this.performanceDetectSettingsProvider.setSettings(e,t),this.testSettingsProvider.setSettings(r),this.addQspSettingsProviderIfDevToolsAreEnabled()},e.prototype.initializeEcsProvider=function(e,t,n){return Qe.setLoggingService(t),this.ecsSettingsProvider.initialize(t,n,e,this.service.getNumber("updateOverrideSettingsTimeout"))},e.prototype.createService=function(){this.service=new Lt,this.service.addListener(new Nt("SettingsServiceFactory-Ecs",this.ecsTimeoutSettingsChanged.bind(this),ce,["updateOverrideSettingsTimeout"])),this.defaultSettingsProvider=new Wt,this.overrideSettingsProvider=new Wt,this.ecsSettingsProvider=new _t(ie.f),this.localStorageSettingsProvider=new Et("ts.settings"),this.debugLocalStorageSettingsProvider=new Et("ts.debugSettings"),this.clientSpecificSettingsProvider=new Wt,this.performanceDetectSettingsProvider=new Ft(this.service.getSettingsUtilities()),this.testSettingsProvider=new Wt,this.service.registerProviders([this.defaultSettingsProvider,this.overrideSettingsProvider,this.ecsSettingsProvider,this.localStorageSettingsProvider,this.debugLocalStorageSettingsProvider,this.clientSpecificSettingsProvider,this.performanceDetectSettingsProvider,this.testSettingsProvider])},e.prototype.ecsTimeoutSettingsChanged=function(){this.ecsSettingsProvider.updateRefreshInterval(this.service.getNumber("updateOverrideSettingsTimeout"))},e.prototype.addQspSettingsProviderIfDevToolsAreEnabled=function(){this.service.getBoolean("enableDevTools")&&(this.qspSettingsProvider=new Dt,this.service.registerProvider(this.qspSettingsProvider))},e.instance=new e,e}(),Vt=n("eeb89c4dda5b564b5094"),Gt=NaN,Kt=function(e){return"number"==typeof e?e:Object(Vt.a)(e)?Gt:+e},$t=n("1be4f739ec4db34492e4"),Qt=function(e,t){return function(n,r){var o;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(o=n),void 0!==r){if(void 0===o)return r;"string"==typeof n||"string"==typeof r?(n=Object($t.a)(n),r=Object($t.a)(r)):(n=Kt(n),r=Kt(r)),o=e(n,r)}return o}},Jt=Qt(function(e,t){return e+t},0),Yt=n("71d97e0a6ad15ad887dd"),Zt="Expected a function",en=n("dbd0c220e64346f05446"),tn=128,nn=function(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,Object(en.a)(e,tn,void 0,void 0,void 0,void 0,t)},rn=Object.prototype.hasOwnProperty,on=Ge(function(e,t){if(Object(ye.a)(t)||Object(xe.a)(t))Xe(t,Object(nt.a)(t),e);else for(var n in t)rn.call(t,n)&&_e(e,n,t[n])}),cn=Ge(function(e,t){Xe(t,De(t),e)}),an=Ge(function(e,t,n,r){Xe(t,De(t),e,r)}),sn=Ge(function(e,t,n,r){Xe(t,Object(nt.a)(t),e,r)}),un=n("c460a4314000aba6b458"),fn=function(e,t){for(var n=-1,r=t.length,o=Array(r),c=null==e;++n<r;)o[n]=c?void 0:Object(un.a)(e,t[n]);return o},ln=n("41d5bf03b3e7b6dc3b9b"),pn=ln.a?ln.a.isConcatSpreadable:void 0,bn=function(e){return Object(Se.a)(e)||Object(Le.a)(e)||!!(pn&&e&&e[pn])},dn=A,Mn=function(e){return(null==e?0:e.length)?dn(e,1):[]},hn=n("bf1d5db339a3b78b70c2"),vn=n("67f913577889d7d73251"),gn=function(e){return Object(vn.a)(Object(hn.a)(e,void 0,Mn),e+"")},An=gn(fn),On=n("13a0a4d0580180405100"),zn=n("6fb0743f2477864eee04"),yn=n("26d635265766889bfb00"),mn="[object DOMException]",Ln="[object Error]",Sn=function(e){if(!Object(yn.a)(e))return!1;var t=Object(zn.a)(e);return t==Ln||t==mn||"string"==typeof e.message&&"string"==typeof e.name&&!Object(Be.a)(e)},Nn=Object(He.a)(function(e,t){try{return Object(On.a)(e,void 0,t)}catch(e){return Sn(e)?e:new Error(e)}}),qn="Expected a function",Tn=function(e,t){var n;if("function"!=typeof t)throw new TypeError(qn);return e=Object(Yt.a)(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}},Wn=n("b62cbc8d532fe17bedcb"),Bn=n("e5205903969d9dc4f02d"),Cn=Object(He.a)(function(e,t,n){var r=1;if(n.length){var o=Object(Bn.a)(n,Object(Wn.a)(Cn));r|=32}return Object(en.a)(e,r,t,n,o)});Cn.placeholder={};var wn=Cn,jn=n("cd6a8bc2ba13c01d7009"),_n=gn(function(e,t){return Object(jn.a)(t,function(t){t=Object(lt.a)(t),le(e,t,wn(e[t],e))}),e}),Xn=Object(He.a)(function(e,t,n){var r=3;if(n.length){var o=Object(Bn.a)(n,Object(Wn.a)(Xn));r|=32}return Object(en.a)(t,r,e,n,o)});Xn.placeholder={};var En=Xn,kn=n("2bb326b5a5bdfb8f3774"),Rn=n("05734458eb0608000d5e"),Pn=function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:Object(Rn.a)(e,t,n)},xn=n("d392773eadf2f2ade722"),Dn=function(e){return e.split("")},In="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Fn="\\ud83c[\\udffb-\\udfff]",Un="(?:\\ud83c[\\udde6-\\uddff]){2}",Hn="[\\ud800-\\udbff][\\udc00-\\udfff]",Vn="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Gn="[\\ufe0e\\ufe0f]?"+Vn+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",Un,Hn].join("|")+")[\\ufe0e\\ufe0f]?"+Vn+")*"),Kn="(?:"+["[^\\ud800-\\udfff]"+In+"?",In,Un,Hn,"[\\ud800-\\udfff]"].join("|")+")",$n=RegExp(Fn+"(?="+Fn+")|"+Kn+Gn,"g"),Qn=function(e){return e.match($n)||[]},Jn=function(e){return Object(xn.a)(e)?Qn(e):Dn(e)},Yn=function(e){return function(t){t=Object(kn.a)(t);var n=Object(xn.a)(t)?Jn(t):void 0,r=n?n[0]:t.charAt(0),o=n?Pn(n,1).join(""):t.slice(1);return r[e]()+o}},Zn=Yn("toUpperCase"),er=function(e){return Zn(Object(kn.a)(e).toLowerCase())},tr=n("354d70141729a36fe898"),nr=function(e){return function(t){return null==e?void 0:e[t]}},rr=nr({"":"A","":"A","":"A","":"A","":"A","":"A"," ":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G"," ":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S"," ":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),or=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,cr=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g"),ir=function(e){return(e=Object(kn.a)(e))&&e.replace(or,rr).replace(cr,"")},ar=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,sr=function(e){return e.match(ar)||[]},ur=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fr=function(e){return ur.test(e)},lr="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pr="["+lr+"]",br="[a-z\\xdf-\\xf6\\xf8-\\xff]",dr="[^\\ud800-\\udfff"+lr+"\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Mr="[A-Z\\xc0-\\xd6\\xd8-\\xde]",hr="(?:"+br+"|"+dr+")",vr="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",gr="[\\ufe0e\\ufe0f]?"+vr+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]","(?:\\ud83c[\\udde6-\\uddff]){2}","[\\ud800-\\udbff][\\udc00-\\udfff]"].join("|")+")[\\ufe0e\\ufe0f]?"+vr+")*"),Ar="(?:"+["[\\u2700-\\u27bf]","(?:\\ud83c[\\udde6-\\uddff]){2}","[\\ud800-\\udbff][\\udc00-\\udfff]"].join("|")+")"+gr,Or=RegExp([Mr+"?"+br+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[pr,Mr,"$"].join("|")+")","(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[pr,Mr+hr,"$"].join("|")+")",Mr+"?"+hr+"+(?:['](?:d|ll|m|re|s|t|ve))?",Mr+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",Ar].join("|"),"g"),zr=function(e){return e.match(Or)||[]},yr=function(e,t,n){return e=Object(kn.a)(e),void 0===(t=n?void 0:t)?fr(e)?zr(e):sr(e):e.match(t)||[]},mr=RegExp("[']","g"),Lr=function(e){return function(t){return Object(tr.a)(yr(ir(t).replace(mr,"")),e,"")}},Sr=Lr(function(e,t,n){return t=t.toLowerCase(),e+(n?er(t):t)}),Nr=n("9809d144ff362f4032ae"),qr=Math.min,Tr=function(e){var t=Math[e];return function(e,n){if(e=Object(Nr.a)(e),n=null==n?0:qr(Object(Yt.a)(n),292)){var r=(Object(kn.a)(e)+"e").split("e"),o=t(r[0]+"e"+(+r[1]+n));return+((r=(Object(kn.a)(o)+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}},Wr=Tr("ceil"),Br=n("f2401f53bf28e2b70eb3"),Cr=function(e){var t=Object(Br.a)(e);return t.__chain__=!0,t},wr=Math.ceil,jr=Math.max,_r=function(e,t,n){return e===e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e},Xr=function(e,t){return e&&Xe(t,Object(nt.a)(t),e)},Er=function(e,t){return e&&Xe(t,De(t),e)},kr=function(e,t){return Xe(e,Object(ht.a)(e),t)},Rr=function(e,t){return Xe(e,gt(e),t)},Pr=n("bd2f00b64cdde6ff3297"),xr=n("6ad221eee0fd1bc82bdc"),Dr=Object.prototype.hasOwnProperty,Ir=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Dr.call(e,"index")&&(n.index=e.index,n.input=e.input),n},Fr=function(e,t){var n=t?ve(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},Ur=/\w*$/,Hr=function(e){var t=new e.constructor(e.source,Ur.exec(e));return t.lastIndex=e.lastIndex,t},Vr=ln.a?ln.a.prototype:void 0,Gr=Vr?Vr.valueOf:void 0,Kr=function(e){return Gr?Object(Gr.call(e)):{}},$r="[object Boolean]",Qr="[object Date]",Jr="[object Map]",Yr="[object Number]",Zr="[object RegExp]",eo="[object Set]",to="[object String]",no="[object Symbol]",ro="[object ArrayBuffer]",oo="[object DataView]",co="[object Float32Array]",io="[object Float64Array]",ao="[object Int8Array]",so="[object Int16Array]",uo="[object Int32Array]",fo="[object Uint8Array]",lo="[object Uint8ClampedArray]",po="[object Uint16Array]",bo="[object Uint32Array]",Mo=function(e,t,n){var r=e.constructor;switch(t){case ro:return ve(e);case $r:case Qr:return new r(+e);case oo:return Fr(e,n);case co:case io:case ao:case so:case uo:case fo:case lo:case po:case bo:return ge(e,n);case Jr:return new r;case Yr:case to:return new r(e);case Zr:return Hr(e);case eo:return new r;case no:return Kr(e)}},ho="[object Map]",vo=n("98cc9c01e58a3d9416da"),go=n("dbf5d091004dd78b9cad"),Ao=go.a&&go.a.isMap,Oo=Ao?Object(vo.a)(Ao):function(e){return Object(yn.a)(e)&&Object(xr.a)(e)==ho},zo="[object Set]",yo=go.a&&go.a.isSet,mo=yo?Object(vo.a)(yo):function(e){return Object(yn.a)(e)&&Object(xr.a)(e)==zo},Lo=1,So=2,No=4,qo="[object Arguments]",To="[object Function]",Wo="[object GeneratorFunction]",Bo="[object Object]",Co={};Co[qo]=Co["[object Array]"]=Co["[object ArrayBuffer]"]=Co["[object DataView]"]=Co["[object Boolean]"]=Co["[object Date]"]=Co["[object Float32Array]"]=Co["[object Float64Array]"]=Co["[object Int8Array]"]=Co["[object Int16Array]"]=Co["[object Int32Array]"]=Co["[object Map]"]=Co["[object Number]"]=Co[Bo]=Co["[object RegExp]"]=Co["[object Set]"]=Co["[object String]"]=Co["[object Symbol]"]=Co["[object Uint8Array]"]=Co["[object Uint8ClampedArray]"]=Co["[object Uint16Array]"]=Co["[object Uint32Array]"]=!0,Co["[object Error]"]=Co[To]=Co["[object WeakMap]"]=!1;var wo=O,jo=4,_o=1,Xo=4,Eo=1,ko=4,Ro=4,Po=n("99ab8b568ca97366239b"),xo="Expected a function",Do=function(e,t,n){var r=n.length;if(null==e)return!r;for(e=Object(e);r--;){var o=n[r],c=t[o],i=e[o];if(void 0===i&&!(o in e)||!c(i))return!1}return!0},Io=function(e){var t=Object(nt.a)(e);return function(n){return Do(n,e,t)}},Fo=1,Uo=n("7ed3f0710947ce397864"),Ho=function(e,t,n,r){for(var o=-1,c=null==e?0:e.length;++o<c;){var i=e[o];t(r,i,n(i),e)}return r},Vo=n("25153e86102d7241054d"),Go=function(e,t,n,r){return Object(Vo.a)(e,function(e,o,c){t(r,e,n(e),c)}),r},Ko=function(e,t){return function(n,r){var o=Object(Se.a)(n)?Ho:Go,c=t?t():{};return o(n,e,Object(ot.a)(r,2),c)}},$o=Object.prototype.hasOwnProperty,Qo=Ko(function(e,t,n){$o.call(e,n)?++e[n]:le(e,n,1)}),Jo=8;z.placeholder={};var Yo=z,Zo=16;y.placeholder={};var ec=y,tc=n("0bd0afb5c74547a322b4"),nc=function(){return tc.a.Date.now()},rc="Expected a function",oc=Math.max,cc=Math.min,ic=function(e,t,n){function r(t){var n=f,r=l;return f=l=void 0,h=t,b=e.apply(r,n)}function o(e){return h=e,d=setTimeout(a,t),v?r(e):b}function c(e){var n=e-h,r=t-(e-M);return g?cc(r,p-n):r}function i(e){var n=e-M,r=e-h;return void 0===M||n>=t||n<0||g&&r>=p}function a(){var e=nc();if(i(e))return s(e);d=setTimeout(a,c(e))}function s(e){return d=void 0,A&&f?r(e):(f=l=void 0,b)}function u(){var e=nc(),n=i(e);if(f=arguments,l=this,M=e,n){if(void 0===d)return o(M);if(g)return d=setTimeout(a,t),r(M)}return void 0===d&&(d=setTimeout(a,t)),b}var f,l,p,b,d,M,h=0,v=!1,g=!1,A=!0;if("function"!=typeof e)throw new TypeError(rc);return t=Object(Nr.a)(t)||0,Object(We.a)(n)&&(v=!!n.leading,p=(g="maxWait"in n)?oc(Object(Nr.a)(n.maxWait)||0,t):p,A="trailing"in n?!!n.trailing:A),u.cancel=function(){void 0!==d&&clearTimeout(d),h=0,f=M=l=d=void 0},u.flush=function(){return void 0===d?b:s(nc())},u},ac=Object.prototype,sc=ac.hasOwnProperty,uc=Object(He.a)(function(e,t){e=Object(e);var n=-1,r=t.length,o=r>2?t[2]:void 0;for(o&&Object(Ve.a)(t[0],t[1],o)&&(r=1);++n<r;)for(var c=t[n],i=De(c),a=-1,s=i.length;++a<s;){var u=i[a],f=e[u];(void 0===f||Object(pe.a)(f,ac[u])&&!sc.call(e,u))&&(e[u]=c[u])}return e}),fc=m,lc=Object(He.a)(function(e){return e.push(void 0,fc),Object(On.a)(rt,void 0,e)}),pc="Expected a function",bc=function(e,t,n){if("function"!=typeof e)throw new TypeError(pc);return setTimeout(function(){e.apply(void 0,n)},t)},dc=Object(He.a)(function(e,t){return bc(e,1,t)}),Mc=Object(He.a)(function(e,t,n){return bc(e,Object(Nr.a)(t)||0,n)}),hc=n("35a29cebca36f3a27147"),vc=n("0a6cea76d35010940b71"),gc=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1},Ac=n("4925aa2ed200fbe812f5"),Oc=200,zc=function(e,t,n,r){var o=-1,c=vc.a,i=!0,a=e.length,s=[],u=t.length;if(!a)return s;n&&(t=Object(at.a)(t,Object(vo.a)(n))),r?(c=gc,i=!1):t.length>=Oc&&(c=Ac.a,i=!1,t=new hc.a(t));e:for(;++o<a;){var f=e[o],l=null==n?f:n(f);if(f=r||0!==f?f:0,i&&l===l){for(var p=u;p--;)if(t[p]===l)continue e;s.push(f)}else c(t,l,r)||s.push(f)}return s},yc=Object(He.a)(function(e,t){return Object(Ne.a)(e)?zc(e,dn(t,1,Ne.a,!0)):[]}),mc=n("f529b206b18b84c5d164"),Lc=Object(He.a)(function(e,t){var n=Object(mc.a)(t);return Object(Ne.a)(n)&&(n=void 0),Object(Ne.a)(e)?zc(e,dn(t,1,Ne.a,!0),Object(ot.a)(n,2)):[]}),Sc=Object(He.a)(function(e,t){var n=Object(mc.a)(t);return Object(Ne.a)(n)&&(n=void 0),Object(Ne.a)(e)?zc(e,dn(t,1,Ne.a,!0),void 0,n):[]}),Nc=Qt(function(e,t){return e/t},1),qc=function(e,t,n,r){for(var o=e.length,c=r?o:-1;(r?c--:++c<o)&&t(e[c],c,e););return n?Object(Rn.a)(e,r?0:c,r?c+1:o):Object(Rn.a)(e,r?c+1:0,r?o:c)},Tc=function(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e},Wc=n("ea6fae70f959b1d35df9"),Bc=Object(Wc.a)(!0),Cc=function(e,t){return e&&Bc(e,t,nt.a)},wc=n("a58909cb8ea1235789f0"),jc=Object(wc.a)(Cc,!0),_c=function(e,t){return(Object(Se.a)(e)?Tc:jc)(e,Object(Ye.a)(t))},Xc=n("bfa1ca23da138d867916"),Ec=n("70ef56491c6ad2d76b52"),kc=Object(Ec.a)(De),Rc=nr({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Pc=/[&<>"']/g,xc=RegExp(Pc.source),Dc=function(e){return(e=Object(kn.a)(e))&&xc.test(e)?e.replace(Pc,Rc):e},Ic=/[\\^$.*+?()[\]{}|]/g,Fc=RegExp(Ic.source),Uc=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0},Hc=function(e,t){var n=!0;return Object(Vo.a)(e,function(e,r,o){return n=!!t(e,r,o)}),n},Vc=4294967295,Gc=function(e){return e?_r(Object(Yt.a)(e),0,Vc):0},Kc=function(e,t,n,r){var o=e.length;for((n=Object(Yt.a)(n))<0&&(n=-n>o?0:o+n),(r=void 0===r||r>o?o:Object(Yt.a)(r))<0&&(r+=o),r=n>r?0:Gc(r);n<r;)e[n++]=t;return e},$c=n("bd6a183fa4110792a897"),Qc=function(e){return function(t,n,r){var o=Object(t);if(!Object(xe.a)(t)){var c=Object(ot.a)(n,3);t=Object(nt.a)(t),n=function(e){return c(o[e],e,o)}}var i=e(t,n,r);return i>-1?o[c?t[i]:i]:void 0}},Jc=n("13c4ea9cb8ef42624470"),Yc=Qc(Jc.a),Zc=function(e,t,n){var r;return n(e,function(e,n,o){if(t(e,n,o))return r=n,!1}),r},ei=n("c92d61b776700b40aa82"),ti=Math.max,ni=Math.min,ri=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return void 0!==n&&(o=Object(Yt.a)(n),o=n<0?ti(r+o,0):ni(o,r-1)),Object(ei.a)(e,Object(ot.a)(t,3),o,!0)},oi=Qc(ri),ci=function(e){return e&&e.length?e[0]:void 0},ii=1/0,ai=1/0,si=512,ui=Tr("floor"),fi=n("c946ac0dbdac302d1be3"),li=n("ce71aab72200cc3b4ad0"),pi=n("2223bf3fd2b6372bfe7f"),bi="Expected a function",di=8,Mi=32,hi=128,vi=256,gi=function(e){return gn(function(t){var n=t.length,r=n,o=Po.a.prototype.thru;for(e&&t.reverse();r--;){var c=t[r];if("function"!=typeof c)throw new TypeError(bi);if(o&&!i&&"wrapper"==Object(li.a)(c))var i=new Po.a([],!0)}for(r=i?r:n;++r<n;){c=t[r];var a=Object(li.a)(c),s="wrapper"==a?Object(fi.a)(c):void 0;i=s&&Object(pi.a)(s[0])&&s[1]==(hi|di|Mi|vi)&&!s[4].length&&1==s[9]?i[Object(li.a)(s[0])].apply(i,s[3]):1==c.length&&Object(pi.a)(c)?i[a]():i.thru(c)}return function(){var e=arguments,r=e[0];if(i&&1==e.length&&Object(Se.a)(r))return i.plant(r).value();for(var o=0,c=n?t[o].apply(this,e):r;++o<n;)c=t[o].call(this,c);return c}})},Ai=gi(),Oi=gi(!0),zi=n("d56f7770a2489fe4ede0"),yi=n("36e0784a51645e8ceed8"),mi=function(e,t){return Object(yi.a)(t,function(t){return Object(Te.a)(e[t])})},Li=Object.prototype.hasOwnProperty,Si=Ko(function(e,t,n){Li.call(e,n)?e[n].push(t):le(e,n,[t])}),Ni=function(e,t){return e>t},qi=function(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=Object(Nr.a)(t),n=Object(Nr.a)(n)),e(t,n)}},Ti=qi(Ni),Wi=qi(function(e,t){return e>=t}),Bi=Object.prototype.hasOwnProperty,Ci=function(e,t){return null!=e&&Bi.call(e,t)},wi=n("a02fedbb74c57c0a899e"),ji=n("0a471ffa71996fbf3cd3"),_i=n("ba53fce2bec9e4ed267c"),Xi=Math.max,Ei=Math.min,ki=function(e,t,n){return e>=Ei(t,n)&&e<Xi(t,n)},Ri=n("14f3ae474ec63bc9b4d8"),Pi=n("9a4c46488e02f609482f"),xi=n("e766c598676a77c10541"),Di=Math.max,Ii=Math.min,Fi=function(e,t,n){for(var r=n?gc:vc.a,o=e[0].length,c=e.length,i=c,a=Array(c),s=1/0,u=[];i--;){var f=e[i];i&&t&&(f=Object(at.a)(f,Object(vo.a)(t))),s=Ii(f.length,s),a[i]=!n&&(t||o>=120&&f.length>=120)?new hc.a(i&&f):void 0}f=e[0];var l=-1,p=a[0];e:for(;++l<o&&u.length<s;){var b=f[l],d=t?t(b):b;if(b=n||0!==b?b:0,!(p?Object(Ac.a)(p,d):r(u,d,n))){for(i=c;--i;){var M=a[i];if(!(M?Object(Ac.a)(M,d):r(e[i],d,n)))continue e}p&&p.push(d),u.push(b)}}return u},Ui=function(e){return Object(Ne.a)(e)?e:[]},Hi=Object(He.a)(function(e){var t=Object(at.a)(e,Ui);return t.length&&t[0]===e[0]?Fi(t):[]}),Vi=Object(He.a)(function(e){var t=Object(mc.a)(e),n=Object(at.a)(e,Ui);return t===Object(mc.a)(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?Fi(n,Object(ot.a)(t,2)):[]}),Gi=Object(He.a)(function(e){var t=Object(mc.a)(e),n=Object(at.a)(e,Ui);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?Fi(n,void 0,t):[]}),Ki=function(e,t,n,r){return Object(Je.a)(e,function(e,o,c){t(r,n(e),o,c)}),r},$i=function(e,t){return function(n,r){return Ki(n,e,t(r),{})}},Qi=Object.prototype.toString,Ji=$i(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Qi.call(t)),e[t]=n},Object(Uo.a)(_i.a)),Yi=Object.prototype,Zi=Yi.hasOwnProperty,ea=Yi.toString,ta=$i(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ea.call(t)),Zi.call(e,t)?e[t].push(n):e[t]=[n]},ot.a),na=n("5536c39646207529a1d3"),ra=function(e,t,n){t=Object(ut.a)(t,e);var r=null==(e=Object(na.a)(e,t))?e:e[Object(lt.a)(Object(mc.a)(t))];return null==r?void 0:Object(On.a)(r,e,n)},oa=Object(He.a)(ra),ca=Object(He.a)(function(e,t,n){var r=-1,o="function"==typeof t,c=Object(xe.a)(e)?Array(e.length):[];return Object(Vo.a)(e,function(e){c[++r]=o?Object(On.a)(t,e,n):ra(e,t,n)}),c}),ia="[object ArrayBuffer]",aa=go.a&&go.a.isArrayBuffer,sa=aa?Object(vo.a)(aa):function(e){return Object(yn.a)(e)&&Object(zn.a)(e)==ia},ua="[object Boolean]",fa="[object Date]",la=go.a&&go.a.isDate,pa=la?Object(vo.a)(la):function(e){return Object(yn.a)(e)&&Object(zn.a)(e)==fa},ba=n("e762c53944e0ba53de07"),da=tc.a.isFinite,Ma=function(e){return"number"==typeof e&&e==Object(Yt.a)(e)},ha=n("f1c0e74a95dfbe71c6f0"),va=n("d1086fdefae624fdb03d"),ga=n("d37896eaa91c67cdcc68"),Aa="[object Number]",Oa=function(e){return"number"==typeof e||Object(yn.a)(e)&&Object(zn.a)(e)==Aa},za=n("bfb1279a823c8d2b12a9"),ya=n("d573284d3226e08a305e"),ma=n("f5d812633866a6a25035"),La=ya.a?Te.a:ma.a,Sa="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",Na=n("0c2a4817447a620bf235"),qa="[object RegExp]",Ta=go.a&&go.a.isRegExp,Wa=Ta?Object(vo.a)(Ta):function(e){return Object(yn.a)(e)&&Object(zn.a)(e)==qa},Ba=9007199254740991,Ca=n("45d1013502405ff7e024"),wa="[object WeakMap]",ja="[object WeakSet]",_a=1,Xa=n("710e92fb6f20e8b7c3b4"),Ea=Lr(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),ka=Ko(function(e,t,n){le(e,n,t)}),Ra=n("d11316739b90bfeb3b2f"),Pa=Lr(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),xa=Yn("toLowerCase"),Da=function(e,t){return e<t},Ia=qi(Da),Fa=qi(function(e,t){return e<=t}),Ua=n("fb048f05e0262d24631e"),Ha=1,Va=n("1b51aaf361c9b5fe17ea"),Ga=1,Ka=function(e,t,n){for(var r=-1,o=e.length;++r<o;){var c=e[r],i=t(c);if(null!=i&&(void 0===a?i===i&&!Object(Vt.a)(i):n(i,a)))var a=i,s=c}return s},$a=function(e,t){for(var n,r=-1,o=e.length;++r<o;){var c=t(e[r]);void 0!==c&&(n=void 0===n?c:n+c)}return n},Qa=NaN,Ja=function(e,t){var n=null==e?0:e.length;return n?$a(e,t)/n:Qa},Ya=n("fcb014d4447b3f993dec"),Za=Object(He.a)(function(e,t){return function(n){return ra(n,e,t)}}),es=Object(He.a)(function(e,t){return function(n){return ra(e,n,t)}}),ts=function(e,t,n){var r=Object(nt.a)(t),o=mi(t,r),c=!(Object(We.a)(n)&&"chain"in n&&!n.chain),i=Object(Te.a)(e);return Object(jn.a)(o,function(n){var r=t[n];e[n]=r,i&&(e.prototype[n]=function(){var t=this.__chain__;if(c||t){var n=e(this.__wrapped__);return(n.__actions__=Object(Ae.a)(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Object(Mt.a)([this.value()],arguments))})}),e},ns=Qt(function(e,t){return e*t},1),rs=function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n},os=n("5674af6f52f89608631c"),cs=n("72a6689db872874504a6"),is=n("676b289012e486a3fc7c"),as="[object Map]",ss="[object Set]",us=ln.a?ln.a.iterator:void 0,fs=function(e){if(!e)return[];if(Object(xe.a)(e))return Object(Ca.a)(e)?Jn(e):Object(Ae.a)(e);if(us&&e[us])return rs(e[us]());var t=Object(xr.a)(e);return(t==as?os.a:t==ss?cs.a:is.a)(e)},ls=n("00522a646af1aaa449a1"),ps=function(e,t){var n=e.length;if(n)return t+=t<0?n:0,Object(ft.a)(t,n)?e[t]:void 0},bs=n("778c19f9613119c13f4c"),ds=function(e){return Object(Be.a)(e)?void 0:e},Ms=gn(function(e,t){var n={};if(null==e)return n;var r=!1;t=Object(at.a)(t,function(t){return t=Object(ut.a)(t,e),r||(r=t.length>1),t}),Xe(e,At(e),n),r&&(n=wo(n,7,ds));for(var o=t.length;o--;)Object(bs.a)(n,t[o]);return n}),hs=n("e8ee4347350f37f94529"),vs=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e},gs=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,o=e===e,c=Object(Vt.a)(e),i=void 0!==t,a=null===t,s=t===t,u=Object(Vt.a)(t);if(!a&&!u&&!c&&e>t||c&&i&&s&&!a&&!u||r&&i&&s||!n&&s||!o)return 1;if(!r&&!c&&!u&&e<t||u&&n&&o&&!r&&!c||a&&n&&o||!i&&o||!s)return-1}return 0},As=function(e,t,n){for(var r=-1,o=e.criteria,c=t.criteria,i=o.length,a=n.length;++r<i;){var s=gs(o[r],c[r]);if(s)return r>=a?s:s*("desc"==n[r]?-1:1)}return e.index-t.index},Os=function(e,t,n){var r=-1;t=Object(at.a)(t.length?t:[_i.a],Object(vo.a)(ot.a));var o=Object(hs.a)(e,function(e,n,o){return{criteria:Object(at.a)(t,function(t){return t(e)}),index:++r,value:e}});return vs(o,function(e,t){return As(e,t,n)})},zs=function(e){return gn(function(t){return t=Object(at.a)(t,Object(vo.a)(ot.a)),Object(He.a)(function(n){var r=this;return e(t,function(e){return Object(On.a)(e,r,n)})})})},ys=zs(at.a),ms=He.a,Ls=Math.min,Ss=ms(function(e,t){var n=(t=1==t.length&&Object(Se.a)(t[0])?Object(at.a)(t[0],Object(vo.a)(ot.a)):Object(at.a)(dn(t,1),Object(vo.a)(ot.a))).length;return Object(He.a)(function(r){for(var o=-1,c=Ls(r.length,n);++o<c;)r[o]=t[o].call(this,r[o]);return Object(On.a)(e,this,r)})}),Ns=zs(Uc),qs=zs(n("19455a0e3b36c61ab3d4").a),Ts=9007199254740991,Ws=Math.floor,Bs=function(e,t){var n="";if(!e||t<1||t>Ts)return n;do{t%2&&(n+=e),(t=Ws(t/2))&&(e+=e)}while(t);return n},Cs=n("68bdc87fa9db91da28b2"),ws=Math.ceil,js=function(e,t){var n=(t=void 0===t?" ":Object($t.a)(t)).length;if(n<2)return n?Bs(t,e):t;var r=Bs(t,ws(e/Object(Cs.a)(t)));return Object(xn.a)(t)?Pn(Jn(r),0,e).join(""):r.slice(0,e)},_s=Math.ceil,Xs=Math.floor,Es=/^\s+/,ks=tc.a.parseInt,Rs=Object(He.a)(function(e,t){var n=Object(Bn.a)(t,Object(Wn.a)(Rs));return Object(en.a)(e,32,void 0,t,n)});Rs.placeholder={};var Ps=Rs,xs=n("500f58630d85237d1ed3"),Ds=Ko(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),Is=function(e,t){return bt(e,t,function(t,n){return Object(ji.a)(e,n)})},Fs=gn(function(e,t){return null==e?{}:Is(e,t)}),Us=n("b6b32bb34d326922d674"),Hs=n("5c8bc8b62030f5c53cf0"),Vs=n("a0a326a2cc843c3ff0fb"),Gs=function(e,t,n,r){for(var o=n-1,c=e.length;++o<c;)if(r(e[o],t))return o;return-1},Ks=Array.prototype.splice,$s=function(e,t,n,r){var o=r?Gs:xi.a,c=-1,i=t.length,a=e;for(e===t&&(t=Object(Ae.a)(t)),n&&(a=Object(at.a)(e,Object(vo.a)(n)));++c<i;)for(var s=0,u=t[c],f=n?n(u):u;(s=o(a,f,s,r))>-1;)a!==e&&Ks.call(a,s,1),Ks.call(e,s,1);return e},Qs=function(e,t){return e&&e.length&&t&&t.length?$s(e,t):e},Js=Object(He.a)(Qs),Ys=n("8fc3969d4aefbcbee5ea"),Zs=gn(function(e,t){var n=null==e?0:e.length,r=fn(e,t);return Object(Ys.a)(e,Object(at.a)(t,function(e){return Object(ft.a)(e,n)?+e:e}).sort(gs)),r}),eu=Math.floor,tu=Math.random,nu=function(e,t){return e+eu(tu()*(t-e+1))},ru=parseFloat,ou=Math.min,cu=Math.random,iu=Math.ceil,au=Math.max,su=function(e,t,n,r){for(var o=-1,c=au(iu((t-e)/(n||1)),0),i=Array(c);c--;)i[r?c:++o]=e,e+=n;return i},uu=function(e){return function(t,n,r){return r&&"number"!=typeof r&&Object(Ve.a)(t,n,r)&&(n=r=void 0),t=Object(Ri.a)(t),void 0===n?(n=t,t=0):n=Object(Ri.a)(n),r=void 0===r?t<n?1:-1:Object(Ri.a)(r),su(t,n,r,e)}},fu=uu(),lu=uu(!0),pu=gn(function(e,t){return Object(en.a)(e,256,void 0,void 0,void 0,t)}),bu=n("1e577fef369aab55b563"),du=function(e,t,n,r){var o=null==e?0:e.length;for(r&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n},Mu=n("b773bc8dd8e5c3d71e12"),hu=n("5f83a414f9ba6ee13f56"),vu=n("fc4c6ea1418d5409cd3b"),gu="Expected a function",Au=Array.prototype.reverse,Ou=function(e){return null==e?e:Au.call(e)},zu=Tr("round"),yu=function(e){var t=e.length;return t?e[nu(0,t-1)]:void 0},mu=function(e){return yu(Object(is.a)(e))},Lu=function(e,t){var n=-1,r=e.length,o=r-1;for(t=void 0===t?r:t;++n<t;){var c=nu(n,o),i=e[c];e[c]=e[n],e[n]=i}return e.length=t,e},Su=function(e,t){return Lu(Object(Ae.a)(e),_r(t,0,e.length))},Nu=function(e,t){var n=Object(is.a)(e);return Lu(n,_r(t,0,n.length))},qu=function(e){return Lu(Object(Ae.a)(e))},Tu=function(e){return Lu(Object(is.a)(e))},Wu=n("e28c9f1338beee7c9991"),Bu=Lr(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Cu=n("6345f064cd972966e453"),wu=Object(He.a)(function(e,t){if(null==e)return[];var n=t.length;return n>1&&Object(Ve.a)(e,t[0],t[1])?t=[]:n>2&&Object(Ve.a)(t[0],t[1],t[2])&&(t=[t[0]]),Os(e,dn(t,1),[])}),ju=4294967294,_u=Math.floor,Xu=Math.min,Eu=function(e,t,n,r){t=n(t);for(var o=0,c=null==e?0:e.length,i=t!==t,a=null===t,s=Object(Vt.a)(t),u=void 0===t;o<c;){var f=_u((o+c)/2),l=n(e[f]),p=void 0!==l,b=null===l,d=l===l,M=Object(Vt.a)(l);if(i)var h=r||d;else h=u?d&&(r||p):a?d&&p&&(r||!b):s?d&&p&&!b&&(r||!M):!b&&!M&&(r?l<=t:l<t);h?o=f+1:c=f}return Xu(c,ju)},ku=2147483647,Ru=function(e,t,n){var r=0,o=null==e?r:e.length;if("number"==typeof t&&t===t&&o<=ku){for(;r<o;){var c=r+o>>>1,i=e[c];null!==i&&!Object(Vt.a)(i)&&(n?i<=t:i<t)?r=c+1:o=c}return o}return Eu(e,t,_i.a,n)},Pu=function(e,t){for(var n=-1,r=e.length,o=0,c=[];++n<r;){var i=e[n],a=t?t(i):i;if(!n||!Object(pe.a)(a,s)){var s=a;c[o++]=0===i?0:i}}return c},xu=4294967295,Du="Expected a function",Iu=Math.max,Fu=Lr(function(e,t,n){return e+(n?" ":"")+Zn(t)}),Uu=Qt(function(e,t){return e-t},0),Hu=n("8c0525b742d8509d59e5"),Vu=Object.prototype,Gu=Vu.hasOwnProperty,Ku=function(e,t,n,r){return void 0===e||Object(pe.a)(e,Vu[n])&&!Gu.call(r,n)?t:e},$u={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Qu=function(e){return"\\"+$u[e]},Ju=/<%=([\s\S]+?)%>/g,Yu={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:Ju,variable:"",imports:{_:{escape:Dc}}},Zu=/\b__p \+= '';/g,ef=/\b(__p \+=) '' \+/g,tf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,nf=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rf=/($^)/,of=/['\n\r\u2028\u2029\\]/g,cf="Expected a function",af=function(e,t){return t(e)},sf=n("c79a51aa17480208b8ea"),uf=n("337b9e67dd20ada80fa5"),ff=function(e,t){var n=e;return n instanceof uf.a&&(n=n.value()),Object(tr.a)(t,function(e,t){return t.func.apply(t.thisArg,Object(Mt.a)([e],t.args))},n)},lf=function(){return ff(this.__wrapped__,this.__actions__)},pf=n("ae807d87f71d0705eaab"),bf=9007199254740991,df=function(e,t){for(var n=e.length;n--&&Object(xi.a)(t,e[n],0)>-1;);return n},Mf=function(e,t){for(var n=-1,r=e.length;++n<r&&Object(xi.a)(t,e[n],0)>-1;);return n},hf=/^\s+|\s+$/g,vf=/\s+$/,gf=/^\s+/,Af=30,Of="...",zf=/\w*$/,yf=nr({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),mf=/&(?:amp|lt|gt|quot|#39);/g,Lf=RegExp(mf.source),Sf=n("a47fc31414d567ab2252"),Nf=Sf.a&&1/Object(cs.a)(new Sf.a([,-0]))[1]==1/0?function(e){return new Sf.a(e)}:ls.a,qf=200,Tf=function(e,t,n){var r=-1,o=vc.a,c=e.length,i=!0,a=[],s=a;if(n)i=!1,o=gc;else if(c>=qf){var u=t?null:Nf(e);if(u)return Object(cs.a)(u);i=!1,o=Ac.a,s=new hc.a}else s=t?[]:a;e:for(;++r<c;){var f=e[r],l=t?t(f):f;if(f=n||0!==f?f:0,i&&l===l){for(var p=s.length;p--;)if(s[p]===l)continue e;t&&s.push(l),a.push(f)}else o(s,l,n)||(s!==a&&s.push(l),a.push(f))}return a},Wf=Object(He.a)(function(e){return Tf(dn(e,1,Ne.a,!0))}),Bf=Object(He.a)(function(e){var t=Object(mc.a)(e);return Object(Ne.a)(t)&&(t=void 0),Tf(dn(e,1,Ne.a,!0),Object(ot.a)(t,2))}),Cf=Object(He.a)(function(e){var t=Object(mc.a)(e);return t="function"==typeof t?t:void 0,Tf(dn(e,1,Ne.a,!0),void 0,t)}),wf=0,jf=n("83dd30bb448d90ed6161"),_f=n("9e8a7f8c69636f440e01"),Xf=function(e,t,n,r){return pt(e,t,n(Object(st.a)(e,t)),r)},Ef=Lr(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),kf=Object(He.a)(function(e,t){return Object(Ne.a)(e)?zc(e,t):[]}),Rf=gn(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return fn(t,e)};return!(t>1||this.__actions__.length)&&r instanceof uf.a&&Object(ft.a)(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:af,args:[o],thisArg:void 0}),new Po.a(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(void 0),e})):this.thru(o)}),Pf=function(e,t,n){var r=e.length;if(r<2)return r?Tf(e[0]):[];for(var o=-1,c=Array(r);++o<r;)for(var i=e[o],a=-1;++a<r;)a!=o&&(c[o]=zc(c[o]||i,e[a],t,n));return Tf(dn(c,1),t,n)},xf=Object(He.a)(function(e){return Pf(Object(yi.a)(e,Ne.a))}),Df=Object(He.a)(function(e){var t=Object(mc.a)(e);return Object(Ne.a)(t)&&(t=void 0),Pf(Object(yi.a)(e,Ne.a),Object(ot.a)(t,2))}),If=Object(He.a)(function(e){var t=Object(mc.a)(e);return t="function"==typeof t?t:void 0,Pf(Object(yi.a)(e,Ne.a),void 0,t)}),Ff=Object(He.a)(jf.a),Uf=function(e,t,n){for(var r=-1,o=e.length,c=t.length,i={};++r<o;){var a=r<c?t[r]:void 0;n(i,e[r],a)}return i},Hf=n("fe4d25c82df832cc2fcb"),Vf={chunk:function(e,t,n){t=(n?Object(Ve.a)(e,t,n):void 0===t)?1:jr(Object(Yt.a)(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var o=0,c=0,i=Array(wr(r/t));o<r;)i[c++]=Object(Rn.a)(e,o,o+=t);return i},compact:function(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var c=e[t];c&&(o[r++]=c)}return o},concat:function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return Object(Mt.a)(Object(Se.a)(n)?Object(Ae.a)(n):[n],dn(t,1))},difference:yc,differenceBy:Lc,differenceWith:Sc,drop:function(e,t,n){var r=null==e?0:e.length;return r?(t=n||void 0===t?1:Object(Yt.a)(t),Object(Rn.a)(e,t<0?0:t,r)):[]},dropRight:function(e,t,n){var r=null==e?0:e.length;return r?(t=n||void 0===t?1:Object(Yt.a)(t),t=r-t,Object(Rn.a)(e,0,t<0?0:t)):[]},dropRightWhile:function(e,t){return e&&e.length?qc(e,Object(ot.a)(t,3),!0,!0):[]},dropWhile:function(e,t){return e&&e.length?qc(e,Object(ot.a)(t,3),!0):[]},fill:function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&Object(Ve.a)(e,t,n)&&(n=0,r=o),Kc(e,t,n,r)):[]},findIndex:Jc.a,findLastIndex:ri,first:ci,flatten:Mn,flattenDeep:function(e){return(null==e?0:e.length)?dn(e,ai):[]},flattenDepth:function(e,t){return(null==e?0:e.length)?(t=void 0===t?1:Object(Yt.a)(t),dn(e,t)):[]},fromPairs:zi.a,head:ci,indexOf:function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:Object(Yt.a)(n);return o<0&&(o=Di(r+o,0)),Object(xi.a)(e,t,o)},initial:function(e){return(null==e?0:e.length)?Object(Rn.a)(e,0,-1):[]},intersection:Hi,intersectionBy:Vi,intersectionWith:Gi,join:Xa.a,last:mc.a,lastIndexOf:Ra.a,nth:function(e,t){return e&&e.length?ps(e,Object(Yt.a)(t)):void 0},pull:Js,pullAll:Qs,pullAllBy:function(e,t,n){return e&&e.length&&t&&t.length?$s(e,t,Object(ot.a)(n,2)):e},pullAllWith:function(e,t,n){return e&&e.length&&t&&t.length?$s(e,t,void 0,n):e},pullAt:Zs,remove:vu.a,reverse:Ou,slice:function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Object(Ve.a)(e,t,n)?(t=0,n=r):(t=null==t?0:Object(Yt.a)(t),n=void 0===n?r:Object(Yt.a)(n)),Object(Rn.a)(e,t,n)):[]},sortedIndex:function(e,t){return Ru(e,t)},sortedIndexBy:function(e,t,n){return Eu(e,t,Object(ot.a)(n,2))},sortedIndexOf:function(e,t){var n=null==e?0:e.length;if(n){var r=Ru(e,t);if(r<n&&Object(pe.a)(e[r],t))return r}return-1},sortedLastIndex:function(e,t){return Ru(e,t,!0)},sortedLastIndexBy:function(e,t,n){return Eu(e,t,Object(ot.a)(n,2),!0)},sortedLastIndexOf:function(e,t){if(null==e?0:e.length){var n=Ru(e,t,!0)-1;if(Object(pe.a)(e[n],t))return n}return-1},sortedUniq:function(e){return e&&e.length?Pu(e):[]},sortedUniqBy:function(e,t){return e&&e.length?Pu(e,Object(ot.a)(t,2)):[]},tail:function(e){var t=null==e?0:e.length;return t?Object(Rn.a)(e,1,t):[]},take:function(e,t,n){return e&&e.length?(t=n||void 0===t?1:Object(Yt.a)(t),Object(Rn.a)(e,0,t<0?0:t)):[]},takeRight:function(e,t,n){var r=null==e?0:e.length;return r?(t=n||void 0===t?1:Object(Yt.a)(t),t=r-t,Object(Rn.a)(e,t<0?0:t,r)):[]},takeRightWhile:function(e,t){return e&&e.length?qc(e,Object(ot.a)(t,3),!1,!0):[]},takeWhile:function(e,t){return e&&e.length?qc(e,Object(ot.a)(t,3)):[]},union:Wf,unionBy:Bf,unionWith:Cf,uniq:function(e){return e&&e.length?Tf(e):[]},uniqBy:function(e,t){return e&&e.length?Tf(e,Object(ot.a)(t,2)):[]},uniqWith:function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Tf(e,void 0,t):[]},unzip:jf.a,unzipWith:_f.a,without:kf,xor:xf,xorBy:Df,xorWith:If,zip:Ff,zipObject:function(e,t){return Uf(e||[],t||[],_e)},zipObjectDeep:function(e,t){return Uf(e||[],t||[],pt)},zipWith:Hf.a},Gf={countBy:Qo,each:$e.a,eachRight:_c,every:function(e,t,n){var r=Object(Se.a)(e)?Uc:Hc;return n&&Object(Ve.a)(e,t,n)&&(t=void 0),r(e,Object(ot.a)(t,3))},filter:$c.a,find:Yc,findLast:oi,flatMap:function(e,t){return dn(Object(Rt.a)(e,t),1)},flatMapDeep:function(e,t){return dn(Object(Rt.a)(e,t),ii)},flatMapDepth:function(e,t,n){return n=void 0===n?1:Object(Yt.a)(n),dn(Object(Rt.a)(e,t),n)},forEach:$e.a,forEachRight:_c,groupBy:Si,includes:Pi.a,invokeMap:ca,keyBy:ka,map:Rt.a,orderBy:function(e,t,n,r){return null==e?[]:(Object(Se.a)(t)||(t=null==t?[]:[t]),n=r?void 0:n,Object(Se.a)(n)||(n=null==n?[]:[n]),Os(e,t,n))},partition:Ds,reduce:bu.a,reduceRight:function(e,t,n){var r=Object(Se.a)(e)?du:Mu.a,o=arguments.length<3;return r(e,Object(ot.a)(t,4),n,o,jc)},reject:function(e,t){return(Object(Se.a)(e)?yi.a:hu.a)(e,it(Object(ot.a)(t,3)))},sample:function(e){return(Object(Se.a)(e)?yu:mu)(e)},sampleSize:function(e,t,n){return t=(n?Object(Ve.a)(e,t,n):void 0===t)?1:Object(Yt.a)(t),(Object(Se.a)(e)?Su:Nu)(e,t)},shuffle:function(e){return(Object(Se.a)(e)?qu:Tu)(e)},size:Wu.a,some:Cu.a,sortBy:wu},Kf={now:nc},$f={after:function(e,t){if("function"!=typeof t)throw new TypeError(Zt);return e=Object(Yt.a)(e),function(){if(--e<1)return t.apply(this,arguments)}},ary:nn,before:Tn,bind:wn,bindKey:En,curry:Yo,curryRight:ec,debounce:ic,defer:dc,delay:Mc,flip:function(e){return Object(en.a)(e,si)},memoize:Ya.a,negate:it,once:function(e){return Tn(2,e)},overArgs:Ss,partial:Ps,partialRight:xs.a,rearg:pu,rest:function(e,t){if("function"!=typeof e)throw new TypeError(gu);return t=void 0===t?t:Object(Yt.a)(t),Object(He.a)(e,t)},spread:function(e,t){if("function"!=typeof e)throw new TypeError(Du);return t=null==t?0:Iu(Object(Yt.a)(t),0),Object(He.a)(function(n){var r=n[t],o=Pn(n,0,t);return r&&Object(Mt.a)(o,r),Object(On.a)(e,this,o)})},throttle:function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError(cf);return Object(We.a)(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),ic(e,t,{leading:r,maxWait:t,trailing:o})},unary:function(e){return nn(e,1)},wrap:function(e,t){return Ps(Object(Ye.a)(t),e)}},Qf={castArray:function(){if(!arguments.length)return[];var e=arguments[0];return Object(Se.a)(e)?e:[e]},clone:function(e){return wo(e,jo)},cloneDeep:function(e){return wo(e,_o|Xo)},cloneDeepWith:function(e,t){return t="function"==typeof t?t:void 0,wo(e,Eo|ko,t)},cloneWith:function(e,t){return t="function"==typeof t?t:void 0,wo(e,Ro,t)},conformsTo:function(e,t){return null==t||Do(e,t,Object(nt.a)(t))},eq:pe.a,gt:Ti,gte:Wi,isArguments:Le.a,isArray:Se.a,isArrayBuffer:sa,isArrayLike:xe.a,isArrayLikeObject:Ne.a,isBoolean:function(e){return!0===e||!1===e||Object(yn.a)(e)&&Object(zn.a)(e)==ua},isBuffer:qe.a,isDate:pa,isElement:function(e){return Object(yn.a)(e)&&1===e.nodeType&&!Object(Be.a)(e)},isEmpty:et.a,isEqual:tt.a,isEqualWith:function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?Object(ba.a)(e,t,void 0,n):!!r},isError:Sn,isFinite:function(e){return"number"==typeof e&&da(e)},isFunction:Te.a,isInteger:Ma,isLength:ha.a,isMap:Oo,isMatch:function(e,t){return e===t||Object(va.a)(e,t,Object(ga.a)(t))},isMatchWith:function(e,t,n){return n="function"==typeof n?n:void 0,Object(va.a)(e,t,Object(ga.a)(t),n)},isNaN:function(e){return Oa(e)&&e!=+e},isNative:function(e){if(La(e))throw new Error(Sa);return Object(za.a)(e)},isNil:Na.a,isNull:function(e){return null===e},isNumber:Oa,isObject:We.a,isObjectLike:yn.a,isPlainObject:Be.a,isRegExp:Wa,isSafeInteger:function(e){return Ma(e)&&e>=-Ba&&e<=Ba},isSet:mo,isString:Ca.a,isSymbol:Vt.a,isTypedArray:Ce.a,isUndefined:function(e){return void 0===e},isWeakMap:function(e){return Object(yn.a)(e)&&Object(xr.a)(e)==wa},isWeakSet:function(e){return Object(yn.a)(e)&&Object(zn.a)(e)==ja},lt:Ia,lte:Fa,toArray:fs,toFinite:Ri.a,toInteger:Yt.a,toLength:Gc,toNumber:Nr.a,toPlainObject:Ie,toSafeInteger:function(e){return e?_r(Object(Yt.a)(e),-bf,bf):0===e?e:0},toString:kn.a},Jf={add:Jt,ceil:Wr,divide:Nc,floor:ui,max:function(e){return e&&e.length?Ka(e,_i.a,Ni):void 0},maxBy:function(e,t){return e&&e.length?Ka(e,Object(ot.a)(t,2),Ni):void 0},mean:function(e){return Ja(e,_i.a)},meanBy:function(e,t){return Ja(e,Object(ot.a)(t,2))},min:function(e){return e&&e.length?Ka(e,_i.a,Da):void 0},minBy:function(e,t){return e&&e.length?Ka(e,Object(ot.a)(t,2),Da):void 0},multiply:ns,round:zu,subtract:Uu,sum:function(e){return e&&e.length?$a(e,_i.a):0},sumBy:function(e,t){return e&&e.length?$a(e,Object(ot.a)(t,2)):0}},Yf={clamp:function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=Object(Nr.a)(n))===n?n:0),void 0!==t&&(t=(t=Object(Nr.a)(t))===t?t:0),_r(Object(Nr.a)(e),t,n)},inRange:function(e,t,n){return t=Object(Ri.a)(t),void 0===n?(n=t,t=0):n=Object(Ri.a)(n),e=Object(Nr.a)(e),ki(e,t,n)},random:function(e,t,n){if(n&&"boolean"!=typeof n&&Object(Ve.a)(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=Object(Ri.a)(e),void 0===t?(t=e,e=0):t=Object(Ri.a)(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=cu();return ou(e+o*(t-e+ru("1e-"+((o+"").length-1))),t)}return nu(e,t)}},Zf={assign:on,assignIn:cn,assignInWith:an,assignWith:sn,at:An,create:function(e,t){var n=Object(Oe.a)(e);return null==t?n:Xr(n,t)},defaults:uc,defaultsDeep:lc,entries:Xc.a,entriesIn:kc,extend:cn,extendWith:an,findKey:function(e,t){return Zc(e,Object(ot.a)(t,3),Je.a)},findLastKey:function(e,t){return Zc(e,Object(ot.a)(t,3),Cc)},forIn:function(e,t){return null==e?e:Object(de.a)(e,Object(Ye.a)(t),De)},forInRight:function(e,t){return null==e?e:Bc(e,Object(Ye.a)(t),De)},forOwn:Ze,forOwnRight:function(e,t){return e&&Cc(e,Object(Ye.a)(t))},functions:function(e){return null==e?[]:mi(e,Object(nt.a)(e))},functionsIn:function(e){return null==e?[]:mi(e,De(e))},get:un.a,has:function(e,t){return null!=e&&Object(wi.a)(e,t,Ci)},hasIn:ji.a,invert:Ji,invertBy:ta,invoke:oa,keys:nt.a,keysIn:De,mapKeys:function(e,t){var n={};return t=Object(ot.a)(t,3),Object(Je.a)(e,function(e,r,o){le(n,t(e,r,o),e)}),n},mapValues:function(e,t){var n={};return t=Object(ot.a)(t,3),Object(Je.a)(e,function(e,r,o){le(n,r,t(e,r,o))}),n},merge:Ke,mergeWith:rt,omit:Ms,omitBy:zt,pick:Fs,pickBy:Ot,result:function(e,t,n){var r=-1,o=(t=Object(ut.a)(t,e)).length;for(o||(o=1,e=void 0);++r<o;){var c=null==e?void 0:e[Object(lt.a)(t[r])];void 0===c&&(r=o,c=n),e=Object(Te.a)(c)?c.call(e):c}return e},set:yt,setWith:function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:pt(e,t,n,r)},toPairs:Xc.a,toPairsIn:kc,transform:function(e,t,n){var r=Object(Se.a)(e),o=r||Object(qe.a)(e)||Object(Ce.a)(e);if(t=Object(ot.a)(t,4),null==n){var c=e&&e.constructor;n=o?r?new c:[]:Object(We.a)(e)&&Object(Te.a)(c)?Object(Oe.a)(Object(ze.a)(e)):{}}return(o?jn.a:Je.a)(e,function(e,r,o){return t(n,e,r,o)}),n},unset:function(e,t){return null==e||Object(bs.a)(e,t)},update:function(e,t,n){return null==e?e:Xf(e,t,Object(Ye.a)(n))},updateWith:function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Xf(e,t,Object(Ye.a)(n),r)},values:is.a,valuesIn:function(e){return null==e?[]:Object(Hu.a)(e,De(e))}},el={at:Rf,chain:Cr,commit:function(){return new Po.a(this.value(),this.__chain__)},lodash:Br.a,next:function(){void 0===this.__values__&&(this.__values__=fs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},plant:function(e){for(var t,n=this;n instanceof Us.a;){var r=Object(Hs.a)(n);r.__index__=0,r.__values__=void 0,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},reverse:function(){var e=this.__wrapped__;if(e instanceof uf.a){var t=e;return this.__actions__.length&&(t=new uf.a(this)),(t=t.reverse()).__actions__.push({func:af,args:[Ou],thisArg:void 0}),new Po.a(t,this.__chain__)}return this.thru(Ou)},tap:function(e,t){return t(e),e},thru:af,toIterator:function(){return this},toJSON:lf,value:lf,valueOf:lf,wrapperChain:function(){return Cr(this)}},tl={camelCase:Sr,capitalize:er,deburr:ir,endsWith:function(e,t,n){e=Object(kn.a)(e),t=Object($t.a)(t);var r=e.length,o=n=void 0===n?r:_r(Object(Yt.a)(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},escape:Dc,escapeRegExp:function(e){return(e=Object(kn.a)(e))&&Fc.test(e)?e.replace(Ic,"\\$&"):e},kebabCase:Ea,lowerCase:Pa,lowerFirst:xa,pad:function(e,t,n){e=Object(kn.a)(e);var r=(t=Object(Yt.a)(t))?Object(Cs.a)(e):0;if(!t||r>=t)return e;var o=(t-r)/2;return js(Xs(o),n)+e+js(_s(o),n)},padEnd:function(e,t,n){e=Object(kn.a)(e);var r=(t=Object(Yt.a)(t))?Object(Cs.a)(e):0;return t&&r<t?e+js(t-r,n):e},padStart:function(e,t,n){e=Object(kn.a)(e);var r=(t=Object(Yt.a)(t))?Object(Cs.a)(e):0;return t&&r<t?js(t-r,n)+e:e},parseInt:function(e,t,n){return n||null==t?t=0:t&&(t=+t),ks(Object(kn.a)(e).replace(Es,""),t||0)},repeat:function(e,t,n){return t=(n?Object(Ve.a)(e,t,n):void 0===t)?1:Object(Yt.a)(t),Bs(Object(kn.a)(e),t)},replace:function(){var e=arguments,t=Object(kn.a)(e[0]);return e.length<3?t:t.replace(e[1],e[2])},snakeCase:Bu,split:function(e,t,n){return n&&"number"!=typeof n&&Object(Ve.a)(e,t,n)&&(t=n=void 0),(n=void 0===n?xu:n>>>0)?(e=Object(kn.a)(e))&&("string"==typeof t||null!=t&&!Wa(t))&&!(t=Object($t.a)(t))&&Object(xn.a)(e)?Pn(Jn(e),0,n):e.split(t,n):[]},startCase:Fu,startsWith:function(e,t,n){return e=Object(kn.a)(e),n=null==n?0:_r(Object(Yt.a)(n),0,e.length),t=Object($t.a)(t),e.slice(n,n+t.length)==t},template:function(e,t,n){var r=Yu.imports._.templateSettings||Yu;n&&Object(Ve.a)(e,t,n)&&(t=void 0),e=Object(kn.a)(e),t=an({},t,r,Ku);var o,c,i=an({},t.imports,r.imports,Ku),a=Object(nt.a)(i),s=Object(Hu.a)(i,a),u=0,f=t.interpolate||rf,l="__p += '",p=RegExp((t.escape||rf).source+"|"+f.source+"|"+(f===Ju?nf:rf).source+"|"+(t.evaluate||rf).source+"|$","g"),b="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";e.replace(p,function(t,n,r,i,a,s){return r||(r=i),l+=e.slice(u,s).replace(of,Qu),n&&(o=!0,l+="' +\n__e("+n+") +\n'"),a&&(c=!0,l+="';\n"+a+";\n__p += '"),r&&(l+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=s+t.length,t}),l+="';\n";var d=t.variable;d||(l="with (obj) {\n"+l+"\n}\n"),l=(c?l.replace(Zu,""):l).replace(ef,"$1").replace(tf,"$1;"),l="function("+(d||"obj")+") {\n"+(d?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(c?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}";var M=Nn(function(){return Function(a,b+"return "+l).apply(void 0,s)});if(M.source=l,Sn(M))throw M;return M},templateSettings:Yu,toLower:function(e){return Object(kn.a)(e).toLowerCase()},toUpper:function(e){return Object(kn.a)(e).toUpperCase()},trim:function(e,t,n){if((e=Object(kn.a)(e))&&(n||void 0===t))return e.replace(hf,"");if(!e||!(t=Object($t.a)(t)))return e;var r=Jn(e),o=Jn(t),c=Mf(r,o),i=df(r,o)+1;return Pn(r,c,i).join("")},trimEnd:function(e,t,n){if((e=Object(kn.a)(e))&&(n||void 0===t))return e.replace(vf,"");if(!e||!(t=Object($t.a)(t)))return e;var r=Jn(e),o=df(r,Jn(t))+1;return Pn(r,0,o).join("")},trimStart:function(e,t,n){if((e=Object(kn.a)(e))&&(n||void 0===t))return e.replace(gf,"");if(!e||!(t=Object($t.a)(t)))return e;var r=Jn(e),o=Mf(r,Jn(t));return Pn(r,o).join("")},truncate:function(e,t){var n=Af,r=Of;if(Object(We.a)(t)){var o="separator"in t?t.separator:o;n="length"in t?Object(Yt.a)(t.length):n,r="omission"in t?Object($t.a)(t.omission):r}var c=(e=Object(kn.a)(e)).length;if(Object(xn.a)(e)){var i=Jn(e);c=i.length}if(n>=c)return e;var a=n-Object(Cs.a)(r);if(a<1)return r;var s=i?Pn(i,0,a).join(""):e.slice(0,a);if(void 0===o)return s+r;if(i&&(a+=s.length-a),Wa(o)){if(e.slice(a).search(o)){var u,f=s;for(o.global||(o=RegExp(o.source,Object(kn.a)(zf.exec(o))+"g")),o.lastIndex=0;u=o.exec(f);)var l=u.index;s=s.slice(0,void 0===l?a:l)}}else if(e.indexOf(Object($t.a)(o),a)!=a){var p=s.lastIndexOf(o);p>-1&&(s=s.slice(0,p))}return s+r},unescape:function(e){return(e=Object(kn.a)(e))&&Lf.test(e)?e.replace(mf,yf):e},upperCase:Ef,upperFirst:Zn,words:yr},nl={attempt:Nn,bindAll:_n,cond:function(e){var t=null==e?0:e.length,n=ot.a;return e=t?Object(at.a)(e,function(e){if("function"!=typeof e[1])throw new TypeError(xo);return[n(e[0]),e[1]]}):[],Object(He.a)(function(n){for(var r=-1;++r<t;){var o=e[r];if(Object(On.a)(o[0],this,n))return Object(On.a)(o[1],this,n)}})},conforms:function(e){return Io(wo(e,Fo))},constant:Uo.a,defaultTo:function(e,t){return null==e||e!==e?t:e},flow:Ai,flowRight:Oi,identity:_i.a,iteratee:function(e){return Object(ot.a)("function"==typeof e?e:wo(e,_a))},matches:function(e){return Object(Ua.a)(wo(e,Ha))},matchesProperty:function(e,t){return Object(Va.a)(e,wo(t,Ga))},method:Za,methodOf:es,mixin:ts,noop:ls.a,nthArg:function(e){return e=Object(Yt.a)(e),Object(He.a)(function(t){return ps(t,e)})},over:ys,overEvery:Ns,overSome:qs,property:Vs.a,propertyOf:function(e){return function(t){return null==e?void 0:Object(st.a)(e,t)}},range:fu,rangeRight:lu,stubArray:vt.a,stubFalse:ma.a,stubObject:function(){return{}},stubString:function(){return""},stubTrue:function(){return!0},times:sf.a,toPath:function(e){return Object(Se.a)(e)?Object(at.a)(e,lt.a):Object(Vt.a)(e)?[e]:Object(Ae.a)(Object(pf.a)(Object(kn.a)(e)))},uniqueId:function(e){var t=++wf;return Object(kn.a)(e)+t}},rl=n("c2e8e7d53dcf6f8b6c2a"),ol=Math.max,cl=Math.min,il=function(e,t,n){for(var r=-1,o=n.length;++r<o;){var c=n[r],i=c.size;switch(c.type){case"drop":e+=i;break;case"dropRight":t-=i;break;case"take":t=cl(t,e+i);break;case"takeRight":e=ol(e,t-i)}}return{start:e,end:t}},al=1,sl=2,ul=Math.min,fl=n("1ac3f0f0bc8d121416c3"),ll=Array.prototype,pl=Object.prototype.hasOwnProperty,bl=ln.a?ln.a.iterator:void 0,dl=Math.max,Ml=Math.min,hl=function(e){return function(t,n,r){if(null==r){var o=Object(We.a)(n),c=o&&Object(nt.a)(n),i=c&&c.length&&mi(n,c);(i?i.length:o)||(r=n,n=t,t=this)}return e(t,n,r)}}(ts);Br.a.after=$f.after,Br.a.ary=$f.ary,Br.a.assign=Zf.assign,Br.a.assignIn=Zf.assignIn,Br.a.assignInWith=Zf.assignInWith,Br.a.assignWith=Zf.assignWith,Br.a.at=Zf.at,Br.a.before=$f.before,Br.a.bind=$f.bind,Br.a.bindAll=nl.bindAll,Br.a.bindKey=$f.bindKey,Br.a.castArray=Qf.castArray,Br.a.chain=el.chain,Br.a.chunk=Vf.chunk,Br.a.compact=Vf.compact,Br.a.concat=Vf.concat,Br.a.cond=nl.cond,Br.a.conforms=nl.conforms,Br.a.constant=nl.constant,Br.a.countBy=Gf.countBy,Br.a.create=Zf.create,Br.a.curry=$f.curry,Br.a.curryRight=$f.curryRight,Br.a.debounce=$f.debounce,Br.a.defaults=Zf.defaults,Br.a.defaultsDeep=Zf.defaultsDeep,Br.a.defer=$f.defer,Br.a.delay=$f.delay,Br.a.difference=Vf.difference,Br.a.differenceBy=Vf.differenceBy,Br.a.differenceWith=Vf.differenceWith,Br.a.drop=Vf.drop,Br.a.dropRight=Vf.dropRight,Br.a.dropRightWhile=Vf.dropRightWhile,Br.a.dropWhile=Vf.dropWhile,Br.a.fill=Vf.fill,Br.a.filter=Gf.filter,Br.a.flatMap=Gf.flatMap,Br.a.flatMapDeep=Gf.flatMapDeep,Br.a.flatMapDepth=Gf.flatMapDepth,Br.a.flatten=Vf.flatten,Br.a.flattenDeep=Vf.flattenDeep,Br.a.flattenDepth=Vf.flattenDepth,Br.a.flip=$f.flip,Br.a.flow=nl.flow,Br.a.flowRight=nl.flowRight,Br.a.fromPairs=Vf.fromPairs,Br.a.functions=Zf.functions,Br.a.functionsIn=Zf.functionsIn,Br.a.groupBy=Gf.groupBy,Br.a.initial=Vf.initial,Br.a.intersection=Vf.intersection,Br.a.intersectionBy=Vf.intersectionBy,Br.a.intersectionWith=Vf.intersectionWith,Br.a.invert=Zf.invert,Br.a.invertBy=Zf.invertBy,Br.a.invokeMap=Gf.invokeMap,Br.a.iteratee=nl.iteratee,Br.a.keyBy=Gf.keyBy,Br.a.keys=nt.a,Br.a.keysIn=Zf.keysIn,Br.a.map=Gf.map,Br.a.mapKeys=Zf.mapKeys,Br.a.mapValues=Zf.mapValues,Br.a.matches=nl.matches,Br.a.matchesProperty=nl.matchesProperty,Br.a.memoize=$f.memoize,Br.a.merge=Zf.merge,Br.a.mergeWith=Zf.mergeWith,Br.a.method=nl.method,Br.a.methodOf=nl.methodOf,Br.a.mixin=hl,Br.a.negate=it,Br.a.nthArg=nl.nthArg,Br.a.omit=Zf.omit,Br.a.omitBy=Zf.omitBy,Br.a.once=$f.once,Br.a.orderBy=Gf.orderBy,Br.a.over=nl.over,Br.a.overArgs=$f.overArgs,Br.a.overEvery=nl.overEvery,Br.a.overSome=nl.overSome,Br.a.partial=$f.partial,Br.a.partialRight=$f.partialRight,Br.a.partition=Gf.partition,Br.a.pick=Zf.pick,Br.a.pickBy=Zf.pickBy,Br.a.property=nl.property,Br.a.propertyOf=nl.propertyOf,Br.a.pull=Vf.pull,Br.a.pullAll=Vf.pullAll,Br.a.pullAllBy=Vf.pullAllBy,Br.a.pullAllWith=Vf.pullAllWith,Br.a.pullAt=Vf.pullAt,Br.a.range=nl.range,Br.a.rangeRight=nl.rangeRight,Br.a.rearg=$f.rearg,Br.a.reject=Gf.reject,Br.a.remove=Vf.remove,Br.a.rest=$f.rest,Br.a.reverse=Vf.reverse,Br.a.sampleSize=Gf.sampleSize,Br.a.set=Zf.set,Br.a.setWith=Zf.setWith,Br.a.shuffle=Gf.shuffle,Br.a.slice=Vf.slice,Br.a.sortBy=Gf.sortBy,Br.a.sortedUniq=Vf.sortedUniq,Br.a.sortedUniqBy=Vf.sortedUniqBy,Br.a.split=tl.split,Br.a.spread=$f.spread,Br.a.tail=Vf.tail,Br.a.take=Vf.take,Br.a.takeRight=Vf.takeRight,Br.a.takeRightWhile=Vf.takeRightWhile,Br.a.takeWhile=Vf.takeWhile,Br.a.tap=el.tap,Br.a.throttle=$f.throttle,Br.a.thru=af,Br.a.toArray=Qf.toArray,Br.a.toPairs=Zf.toPairs,Br.a.toPairsIn=Zf.toPairsIn,Br.a.toPath=nl.toPath,Br.a.toPlainObject=Qf.toPlainObject,Br.a.transform=Zf.transform,Br.a.unary=$f.unary,Br.a.union=Vf.union,Br.a.unionBy=Vf.unionBy,Br.a.unionWith=Vf.unionWith,Br.a.uniq=Vf.uniq,Br.a.uniqBy=Vf.uniqBy,Br.a.uniqWith=Vf.uniqWith,Br.a.unset=Zf.unset,Br.a.unzip=Vf.unzip,Br.a.unzipWith=Vf.unzipWith,Br.a.update=Zf.update,Br.a.updateWith=Zf.updateWith,Br.a.values=Zf.values,Br.a.valuesIn=Zf.valuesIn,Br.a.without=Vf.without,Br.a.words=tl.words,Br.a.wrap=$f.wrap,Br.a.xor=Vf.xor,Br.a.xorBy=Vf.xorBy,Br.a.xorWith=Vf.xorWith,Br.a.zip=Vf.zip,Br.a.zipObject=Vf.zipObject,Br.a.zipObjectDeep=Vf.zipObjectDeep,Br.a.zipWith=Vf.zipWith,Br.a.entries=Zf.toPairs,Br.a.entriesIn=Zf.toPairsIn,Br.a.extend=Zf.assignIn,Br.a.extendWith=Zf.assignInWith,hl(Br.a,Br.a),Br.a.add=Jf.add,Br.a.attempt=nl.attempt,Br.a.camelCase=tl.camelCase,Br.a.capitalize=tl.capitalize,Br.a.ceil=Jf.ceil,Br.a.clamp=Yf.clamp,Br.a.clone=Qf.clone,Br.a.cloneDeep=Qf.cloneDeep,Br.a.cloneDeepWith=Qf.cloneDeepWith,Br.a.cloneWith=Qf.cloneWith,Br.a.conformsTo=Qf.conformsTo,Br.a.deburr=tl.deburr,Br.a.defaultTo=nl.defaultTo,Br.a.divide=Jf.divide,Br.a.endsWith=tl.endsWith,Br.a.eq=Qf.eq,Br.a.escape=tl.escape,Br.a.escapeRegExp=tl.escapeRegExp,Br.a.every=Gf.every,Br.a.find=Gf.find,Br.a.findIndex=Vf.findIndex,Br.a.findKey=Zf.findKey,Br.a.findLast=Gf.findLast,Br.a.findLastIndex=Vf.findLastIndex,Br.a.findLastKey=Zf.findLastKey,Br.a.floor=Jf.floor,Br.a.forEach=Gf.forEach,Br.a.forEachRight=Gf.forEachRight,Br.a.forIn=Zf.forIn,Br.a.forInRight=Zf.forInRight,Br.a.forOwn=Zf.forOwn,Br.a.forOwnRight=Zf.forOwnRight,Br.a.get=Zf.get,Br.a.gt=Qf.gt,Br.a.gte=Qf.gte,Br.a.has=Zf.has,Br.a.hasIn=Zf.hasIn,Br.a.head=Vf.head,Br.a.identity=_i.a,Br.a.includes=Gf.includes,Br.a.indexOf=Vf.indexOf,Br.a.inRange=Yf.inRange,Br.a.invoke=Zf.invoke,Br.a.isArguments=Qf.isArguments,Br.a.isArray=Se.a,Br.a.isArrayBuffer=Qf.isArrayBuffer,Br.a.isArrayLike=Qf.isArrayLike,Br.a.isArrayLikeObject=Qf.isArrayLikeObject,Br.a.isBoolean=Qf.isBoolean,Br.a.isBuffer=Qf.isBuffer,Br.a.isDate=Qf.isDate,Br.a.isElement=Qf.isElement,Br.a.isEmpty=Qf.isEmpty,Br.a.isEqual=Qf.isEqual,Br.a.isEqualWith=Qf.isEqualWith,Br.a.isError=Qf.isError,Br.a.isFinite=Qf.isFinite,Br.a.isFunction=Qf.isFunction,Br.a.isInteger=Qf.isInteger,Br.a.isLength=Qf.isLength,Br.a.isMap=Qf.isMap,Br.a.isMatch=Qf.isMatch,Br.a.isMatchWith=Qf.isMatchWith,Br.a.isNaN=Qf.isNaN,Br.a.isNative=Qf.isNative,Br.a.isNil=Qf.isNil,Br.a.isNull=Qf.isNull,Br.a.isNumber=Qf.isNumber,Br.a.isObject=We.a,Br.a.isObjectLike=Qf.isObjectLike,Br.a.isPlainObject=Qf.isPlainObject,Br.a.isRegExp=Qf.isRegExp,Br.a.isSafeInteger=Qf.isSafeInteger,Br.a.isSet=Qf.isSet,Br.a.isString=Qf.isString,Br.a.isSymbol=Qf.isSymbol,Br.a.isTypedArray=Qf.isTypedArray,Br.a.isUndefined=Qf.isUndefined,Br.a.isWeakMap=Qf.isWeakMap,Br.a.isWeakSet=Qf.isWeakSet,Br.a.join=Vf.join,Br.a.kebabCase=tl.kebabCase,Br.a.last=mc.a,Br.a.lastIndexOf=Vf.lastIndexOf,Br.a.lowerCase=tl.lowerCase,Br.a.lowerFirst=tl.lowerFirst,Br.a.lt=Qf.lt,Br.a.lte=Qf.lte,Br.a.max=Jf.max,Br.a.maxBy=Jf.maxBy,Br.a.mean=Jf.mean,Br.a.meanBy=Jf.meanBy,Br.a.min=Jf.min,Br.a.minBy=Jf.minBy,Br.a.stubArray=nl.stubArray,Br.a.stubFalse=nl.stubFalse,Br.a.stubObject=nl.stubObject,Br.a.stubString=nl.stubString,Br.a.stubTrue=nl.stubTrue,Br.a.multiply=Jf.multiply,Br.a.nth=Vf.nth,Br.a.noop=nl.noop,Br.a.now=Kf.now,Br.a.pad=tl.pad,Br.a.padEnd=tl.padEnd,Br.a.padStart=tl.padStart,Br.a.parseInt=tl.parseInt,Br.a.random=Yf.random,Br.a.reduce=Gf.reduce,Br.a.reduceRight=Gf.reduceRight,Br.a.repeat=tl.repeat,Br.a.replace=tl.replace,Br.a.result=Zf.result,Br.a.round=Jf.round,Br.a.sample=Gf.sample,Br.a.size=Gf.size,Br.a.snakeCase=tl.snakeCase,Br.a.some=Gf.some,Br.a.sortedIndex=Vf.sortedIndex,Br.a.sortedIndexBy=Vf.sortedIndexBy,Br.a.sortedIndexOf=Vf.sortedIndexOf,Br.a.sortedLastIndex=Vf.sortedLastIndex,Br.a.sortedLastIndexBy=Vf.sortedLastIndexBy,Br.a.sortedLastIndexOf=Vf.sortedLastIndexOf,Br.a.startCase=tl.startCase,Br.a.startsWith=tl.startsWith,Br.a.subtract=Jf.subtract,Br.a.sum=Jf.sum,Br.a.sumBy=Jf.sumBy,Br.a.template=tl.template,Br.a.times=nl.times,Br.a.toFinite=Qf.toFinite,Br.a.toInteger=Yt.a,Br.a.toLength=Qf.toLength,Br.a.toLower=tl.toLower,Br.a.toNumber=Qf.toNumber,Br.a.toSafeInteger=Qf.toSafeInteger,Br.a.toString=Qf.toString,Br.a.toUpper=tl.toUpper,Br.a.trim=tl.trim,Br.a.trimEnd=tl.trimEnd,Br.a.trimStart=tl.trimStart,Br.a.truncate=tl.truncate,Br.a.unescape=tl.unescape,Br.a.uniqueId=nl.uniqueId,Br.a.upperCase=tl.upperCase,Br.a.upperFirst=tl.upperFirst,Br.a.each=Gf.forEach,Br.a.eachRight=Gf.forEachRight,Br.a.first=Vf.head,hl(Br.a,function(){var e={};return Object(Je.a)(Br.a,function(t,n){pl.call(Br.a.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),Br.a.VERSION="4.17.10",(Br.a.templateSettings=tl.templateSettings).imports._=Br.a,Object(jn.a)(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){Br.a[e].placeholder=Br.a}),Object(jn.a)(["drop","take"],function(e,t){uf.a.prototype[e]=function(n){n=void 0===n?1:dl(Object(Yt.a)(n),0);var r=this.__filtered__&&!t?new uf.a(this):this.clone();return r.__filtered__?r.__takeCount__=Ml(n,r.__takeCount__):r.__views__.push({size:Ml(n,4294967295),type:e+(r.__dir__<0?"Right":"")}),r},uf.a.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Object(jn.a)(["filter","map","takeWhile"],function(e,t){var n=t+1,r=1==n||3==n;uf.a.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Object(ot.a)(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),Object(jn.a)(["head","last"],function(e,t){var n="take"+(t?"Right":"");uf.a.prototype[e]=function(){return this[n](1).value()[0]}}),Object(jn.a)(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");uf.a.prototype[e]=function(){return this.__filtered__?new uf.a(this):this[n](1)}}),uf.a.prototype.compact=function(){return this.filter(_i.a)},uf.a.prototype.find=function(e){return this.filter(e).head()},uf.a.prototype.findLast=function(e){return this.reverse().find(e)},uf.a.prototype.invokeMap=Object(He.a)(function(e,t){return"function"==typeof e?new uf.a(this):this.map(function(n){return ra(n,e,t)})}),uf.a.prototype.reject=function(e){return this.filter(it(Object(ot.a)(e)))},uf.a.prototype.slice=function(e,t){e=Object(Yt.a)(e);var n=this;return n.__filtered__&&(e>0||t<0)?new uf.a(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=Object(Yt.a)(t))<0?n.dropRight(-t):n.take(t-e)),n)},uf.a.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},uf.a.prototype.toArray=function(){return this.take(4294967295)},Object(Je.a)(uf.a.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Br.a[r?"take"+("last"==t?"Right":""):t],c=r||/^find/.test(t);o&&(Br.a.prototype[t]=function(){var t=this.__wrapped__,i=r?[1]:arguments,a=t instanceof uf.a,s=i[0],u=a||Object(Se.a)(t),f=function(e){var t=o.apply(Br.a,Object(Mt.a)([e],i));return r&&l?t[0]:t};u&&n&&"function"==typeof s&&1!=s.length&&(a=u=!1);var l=this.__chain__,p=!!this.__actions__.length,b=c&&!l,d=a&&!p;if(!c&&u){t=d?t:new uf.a(this);var M=e.apply(t,i);return M.__actions__.push({func:af,args:[f],thisArg:void 0}),new Po.a(M,l)}return b&&d?e.apply(this,i):(M=this.thru(f),b?r?M.value()[0]:M.value():M)})}),Object(jn.a)(["pop","push","shift","sort","splice","unshift"],function(e){var t=ll[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Br.a.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(Object(Se.a)(o)?o:[],e)}return this[n](function(n){return t.apply(Object(Se.a)(n)?n:[],e)})}}),Object(Je.a)(uf.a.prototype,function(e,t){var n=Br.a[t];if(n){var r=n.name+"";(fl.a[r]||(fl.a[r]=[])).push({name:t,func:n})}}),fl.a[Object(rl.a)(void 0,2).name]=[{name:"wrapper",func:void 0}],uf.a.prototype.clone=function(){var e=new uf.a(this.__wrapped__);return e.__actions__=Object(Ae.a)(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Object(Ae.a)(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Object(Ae.a)(this.__views__),e},uf.a.prototype.reverse=function(){if(this.__filtered__){var e=new uf.a(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},uf.a.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Object(Se.a)(e),r=t<0,o=n?e.length:0,c=il(0,o,this.__views__),i=c.start,a=c.end,s=a-i,u=r?a:i-1,f=this.__iteratees__,l=f.length,p=0,b=ul(s,this.__takeCount__);if(!n||!r&&o==s&&b==s)return ff(e,this.__actions__);var d=[];e:for(;s--&&p<b;){for(var M=-1,h=e[u+=t];++M<l;){var v=f[M],g=v.iteratee,A=v.type,O=g(h);if(A==sl)h=O;else if(!O){if(A==al)continue e;break e}}d[p++]=h}return d},Br.a.prototype.at=el.at,Br.a.prototype.chain=el.wrapperChain,Br.a.prototype.commit=el.commit,Br.a.prototype.next=el.next,Br.a.prototype.plant=el.plant,Br.a.prototype.reverse=el.reverse,Br.a.prototype.toJSON=Br.a.prototype.valueOf=Br.a.prototype.value=el.value,Br.a.prototype.first=Br.a.prototype.head,bl&&(Br.a.prototype[bl]=el.toIterator);Br.a;var vl=function(){function e(e,t,n,r,o,c){this.constants=e,this.settingsService=t,this.eventingService=n,this.localStorageService=r,this.utilityService=o,this.resources=c,this.osPlatform=-1,this.indexHeadData={}}return e.prototype.setIndexHeadData=function(e){e&&(this.indexHeadData=e)},e.prototype.getThemes=function(){return this.indexHeadData.themes},e.prototype.getVersionInfo=function(){var e=this.settingsService.valueFor("environment");return{buildDate:this.indexHeadData.buildDate,versionDate:this.indexHeadData.versionDate,versionHash:this.indexHeadData.versionHash,clientVersion:e.clientVersion,semver:e.semver}},e.prototype.getRootUri=function(){var e=this.indexHeadData.app&&this.indexHeadData.app.rootUri||"";return _.endsWith(e,"/")||(e+="/"),e},e.prototype.getOsPlatform=function(){if(this.osPlatform>-1)return this.osPlatform;var e=window.navigator.platform.toLowerCase();return e.contains("win")?this.osPlatform=teamspace.services.OsPlatform.Windows:e.contains("mac")?this.osPlatform=teamspace.services.OsPlatform.Mac:this.osPlatform=teamspace.services.OsPlatform.Unknown,this.osPlatform},e.prototype.getFlights=function(){return this.indexHeadData.app?this.indexHeadData.app.flights:null},e.prototype.isPublicRing=function(){var e=this.settingsService.getRing();return!!e&&e.isPublic},e.prototype.loadStoredSettings=function(e,t){var n=this,r=t;if(r){r.store=function(){var t={};angular.forEach(r,function(e){t[e.key]=e.active}),t.version="1.01",n.localStorageService.set(e,t),n.eventingService.$emit(n.constants.events.settings.reload,n.resources.strings.refresh_message_for_settings_update)},r.clear=function(){n.localStorageService.set(e,"")};var o=this.localStorageService.get(e);o&&"1.01"===o.version&&(angular.forEach(r,function(e){e.active=o[e.key]}),r.enabled=!1,angular.forEach(r,function(e){e.active?r.enabled=!0:!1===e.active&&(r.enabled=!1)}))}return r||[]},e.prototype.valueAsBoolean=function(e,t){if(e===this.constants.settings.names.isDesktopApp&&navigator.userAgent.contains("Electron"))return!0;var n=this.settingsService.valueFor(e);return t?this.utilityService.asBoolean(n,void 0,t):this.utilityService.asBoolean(n)},e}(),gl=function(){function e(e,t,n,r,o,c,i,a){var s=this;this.appConfig=e,this.constants=t,this.eventingService=n,this.utilityService=r,this.$injector=o,this.localStorageService=c,this.translateConfig=i,this.legacySettingsUtils=new vl(this.constants,this,this.eventingService,this.localStorageService,this.utilityService,a),this.eventingService.unsafeOn(this.constants.events.performanceDetect.perfModeBroadcast,function(e,t){s.setCachedPerformanceMode(t.performanceMode)})}return e.$inject=["appConfig","constants","eventingService","utilityService","$injector","localStorageService","translateConfig","resources"],e.prototype.initialize=function(e,t,n){this.indexHeadData=t,this.legacySettingsUtils.setIndexHeadData(t),this.overrideSettings=n.overrideSettings,this.surfaceHubSettings=this.getSettingsFromQspStringInLocalStorage(this.constants.settings.names.surfaceHubQueryParamString),this.testSettings=this.getSettingsFromQspStringInLocalStorage(this.constants.dataNames.testSettings),this.settingsServiceFactory=Ht.getInstance(),this.initializeDefaultSettings(),this.settingsService=this.settingsServiceFactory.getService(),this.settingsUtils=this.settingsService.getSettingsUtilities(),this.changedSubscription=new Nt("WebClient",this.settingsChanged.bind(this),ce),this.settingsService.addListener(this.changedSubscription),this.settings=this.legacySettingsUtils.loadStoredSettings(this.constants.dataNames.settings,n.settings),this.debugSettings=this.legacySettingsUtils.loadStoredSettings(this.constants.dataNames.debugSettings,n.debugSettings);var r=this.settingsService.getSettingsForNamespace();this.translateConfig.setStrategyFromSetting(r),this.utilityService.parseUtilitySettings(r),this.mapBackToAppConfig(this.settingsService.getSettingsForNamespace())},e.prototype.appReady=function(){var e=this.$injector.get("bridgeLoggingService"),t=this.$injector.get("bridgeAppStateService");this.settingsServiceFactory.initializeEcsProvider(!1,e,t)},e.prototype.settingsChanged=function(e){var t=e[ce],n=Object(nt.a)(t);this.eventingService.$emit(this.constants.events.settings.updated,n),this.translateConfig.setStrategyFromSetting(t),this.utilityService.parseUtilitySettings(t)},e.prototype.mapBackToAppConfig=function(e){for(var t in e)e.hasOwnProperty(t)&&(this.appConfig[t]=e[t])},e.prototype.initializeDefaultSettings=function(){this.settingsServiceFactory.initializeDefaultSettings(this.appConfig,this.overrideSettings,this.surfaceHubSettings,this.testSettings)},e.prototype.clearCachedSettings=function(){this.settingsService.refreshSettings()},e.prototype.getVersion=function(){return this.legacySettingsUtils.getVersionInfo()},e.prototype.getThemes=function(){return this.legacySettingsUtils.getThemes()},e.prototype.getRing=function(){return this.settingsUtils.getRing()},e.prototype.getMiddleTierRing=function(){return this.settingsUtils.getMiddleTierRing()},e.prototype.getPerformanceMode=function(){return this.settingsUtils.getPerformanceMode()},e.prototype.setCachedPerformanceMode=function(e){this.settingsUtils.setCachedPerformanceMode(e)},e.prototype.getApi=function(){return this.settingsUtils.getApi()||this.indexHeadData.app?this.indexHeadData.app.api:void 0},e.prototype.getRootUri=function(){return this.legacySettingsUtils.getRootUri()},e.prototype.getSettings=function(){return this.settingsService.getSettingsForNamespace(ce)},e.prototype.valueFor=function(e){return this.settingsService.get(e)},e.prototype.valueAsBoolean=function(e,t){return this.legacySettingsUtils.valueAsBoolean(e,t)},e.prototype.getFlights=function(){return this.legacySettingsUtils.getFlights()},e.prototype.getOsPlatform=function(){return this.legacySettingsUtils.getOsPlatform()},e.prototype.updateSetting=function(e,t){this.testSettings[e]=t,this.initializeDefaultSettings(),this.settingsService.refreshSettings()},e.prototype.isPublicRing=function(){return this.legacySettingsUtils.isPublicRing()},e.prototype.isInternalRing=function(){return this.settingsUtils.isInternalRing()},e.prototype.checkIfSettingHasChanged=function(e,t){return e&&e.includes(t)},e.prototype.getSettingsFromQspStringInLocalStorage=function(e){var t=new Pt,n=this.localStorageService.get(e);return t.parse(n)},e}();angular.module("teamspace.settingsServiceV2",["LocalStorageModule","teamspace.config","teamspace.constants","teamspace.utilityService","teamspace.locales","teamspace.eventingService","teamspace.translateConfig"]).service("settingsServiceV2",gl);var Al=n("8ea987845369178c57e7"),Ol=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},zl=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,c){function i(e){try{s(r.next(e))}catch(e){c(e)}}function a(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}s((r=r.apply(e,t||[])).next())})},yl=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(i=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(c,n[1])).done)return i;switch(c=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,c=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],c=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,c,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},ml=function(){function e(e,t){this.bridgeUtilityService=e,this.authenticationService=t,this._loginRequired=new Al.BehaviorSubject(!1)}return e.$inject=["bridgeUtilityService","authenticationService"],Object.defineProperty(e.prototype,"isLoginRequired",{get:function(){return this._loginRequired.asObservable()},enumerable:!0,configurable:!0}),e.prototype.login=function(){return Promise.reject(new Error("Not Supported in Bridge Auth Service and it is not required as well"))},e.prototype.clearCacheForResource=function(e){this.authenticationService.clearAdalCache(e)},e.prototype.getUser=function(){return this.bridgeUtilityService.convertToESPromise(this.authenticationService.getUserInformation())},e.prototype.authorize=function(e,t){var n=this;return function(r){return zl(n,void 0,void 0,function(){var n,o,c;return yl(this,function(i){switch(i.label){case 0:n=0,i.label=1;case 1:return[4,this.acquireToken(t)];case 2:return o=i.sent(),[4,e(Ol({},r,{headers:Ol({},r.headers,{Authorization:"Bearer "+o})}))];case 3:if((c=i.sent()).status!==ie.b.NOT_AUTHORIZED||n>0)return[2,c];this.authenticationService.clearAdalCache(t),i.label=4;case 4:return++n,[3,1];case 5:return[2]}})})}},e.prototype.acquireToken=function(e){return this.bridgeUtilityService.convertToESPromise(this.authenticationService.getAuthTokens([e]))},e}();angular.module("teamspace.bridge").service("bridgeAuthenticationService",ml)},"4ca1c2ac263019ccc2f8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n){this.presenceService=n,this.presenceService=n,this.initStaticVariables(e,t),this.applyStatus(SkypeX.Services.UserStatus.Unknown),this.lastSeenText=e.instant(t.strings.skype_last_seen)}return e.prototype.applyStatus=function(t){this.statusClass=e.StatusClasses[t],this.statusText=e.TranslatedStatusTexts[t]},e.prototype.initStaticVariables=function(t,n){if(!e.isInit){e.StatusClasses=(o={},o[SkypeX.Services.UserStatus.Offline]="offline",o[SkypeX.Services.UserStatus.Online]="online",o[SkypeX.Services.UserStatus.Busy]="busy",o[SkypeX.Services.UserStatus.Away]="away",o[SkypeX.Services.UserStatus.Idle]="idle",o[SkypeX.Services.UserStatus.OnThePhone]="on-the-phone",o[SkypeX.Services.UserStatus.OutToLunch]="do-not-disturb",o[SkypeX.Services.UserStatus.BeRightBack]="be-right-back",o[SkypeX.Services.UserStatus.Hidden]="hidden",o[SkypeX.Services.UserStatus.Disabled]="disabled",o[SkypeX.Services.UserStatus.Unknown]="unknown",o[SkypeX.Services.UserStatus.AppearAway]="appear-away",o[SkypeX.Services.UserStatus.Reset]="reset",o[SkypeX.Services.UserStatus.OutOfOffice]="out-of-office",o[SkypeX.Services.UserStatus.Presenting]="do-not-disturb",o[SkypeX.Services.UserStatus.InAMeeting]="busy",o);var r=this.presenceService.isUnfiedPresenceStatesEnabled()?n.strings.status_beRightBack:n.strings.status_away;e.TranslatedStatusTexts=(c={},c[SkypeX.Services.UserStatus.Offline]=t.instant(n.strings.status_offline),c[SkypeX.Services.UserStatus.Online]=t.instant(n.strings.status_online),c[SkypeX.Services.UserStatus.Busy]=t.instant(n.strings.status_busy),c[SkypeX.Services.UserStatus.Away]=t.instant(n.strings.status_away),c[SkypeX.Services.UserStatus.Idle]=t.instant(n.strings.status_away),c[SkypeX.Services.UserStatus.OnThePhone]=t.instant(n.strings.status_inACall),c[SkypeX.Services.UserStatus.OutToLunch]=t.instant(n.strings.status_doNotDisturb),c[SkypeX.Services.UserStatus.BeRightBack]=t.instant(r),c[SkypeX.Services.UserStatus.Hidden]=t.instant(n.strings.status_offline),c[SkypeX.Services.UserStatus.Disabled]=t.instant(n.strings.status_disabled),c[SkypeX.Services.UserStatus.Unknown]=t.instant(n.strings.status_unknown),c[SkypeX.Services.UserStatus.AppearAway]=t.instant(n.strings.status_appear_away),c[SkypeX.Services.UserStatus.Reset]=t.instant(n.strings.status_reset),c[SkypeX.Services.UserStatus.OutOfOffice]=t.instant(n.strings.status_outOfOffice),c[SkypeX.Services.UserStatus.Presenting]=t.instant(n.strings.status_presenting),c[SkypeX.Services.UserStatus.InAMeeting]=t.instant(n.strings.status_inAMeeting),c),e.isInit=!0}var o,c},e.isInit=!1,e}();t.BaseSkypeStatus=r},"4e5f58ad7c5e5b3d7316":function(e,t,n){"use strict";var r=/\{\n\/\* \[wrapped with (.+)\] \*/,o=/,? & /,c=function(e){var t=e.match(r);return t?t[1].split(o):[]},i=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,a=function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(i,"{\n/* [wrapped with "+t+"] */\n")},s=n("67f913577889d7d73251"),u=n("cd6a8bc2ba13c01d7009"),f=n("0a6cea76d35010940b71"),l=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],p=function(e,t){return Object(u.a)(l,function(n){var r="_."+n[0];t&n[1]&&!Object(f.a)(e,r)&&e.push(r)}),e.sort()};t.a=function(e,t,n){var r=t+"";return Object(s.a)(e,a(r,p(c(r),n)))}},"500f58630d85237d1ed3":function(e,t,n){"use strict";var r=n("c9c1436a8870b75df6cf"),o=n("dbd0c220e64346f05446"),c=n("b62cbc8d532fe17bedcb"),i=n("e5205903969d9dc4f02d"),a=Object(r.a)(function(e,t){var n=Object(i.a)(t,Object(c.a)(a));return Object(o.a)(e,64,void 0,t,n)});a.placeholder={},t.a=a},"517d6e3962b3db33796d":function(e,t,n){"use strict";var r=Array.isArray;t.a=r},"52590c22db4b48afab45":function(e,t,n){"use strict";function r(e,t){return function(n){var r=n.url,o=M(n,["url"]);return e(d({},o,{url:Object(p.u)(r,t).toString()}))}}function o(e,t){var n,o=this;return function(c){return function(i){return v(o,void 0,void 0,function(){var o,a,s,u;return g(this,function(l){switch(l.label){case 0:o=0,l.label=1;case 1:return n?[3,3]:[4,t()];case 2:n=l.sent(),l.label=3;case 3:return[4,r(e(c,n),n)(h({},i,{headers:h({},i.headers,{BehaviorOverride:"redirectAs404"})}))];case 4:if(a=l.sent(),s=a.status,u=a.headers.location,s!==f.NOT_FOUND||!u||o>2)return[2,a];n=Object(p.u)("/",u).href,l.label=5;case 5:return++o,[3,1];case 6:return[2]}})})}}}function c(e,t){return t.authorize(e,"https://api.spaces.skype.com/")}function i(e,t){var n,r=t.getSearchState()||{};switch((r.agent||r.Agent||"").toLowerCase()){case W:n=S;break;case B:n=T;break;default:n=L}return new n(e)}function a(e,t){var n,r=t.getSearchState()||{};switch((r.agent||r.Agent||"").toLowerCase()){case x:n=S;break;case D:n=T;break;default:n=L}return new n(e)}function s(e,t){return function(n){return e(n).then(function(e){if(e.status===t)return e;throw Object(p.h)(s,{requiredStatus:t,response:e})})}}function u(e){var t=this;return function(n){return Z(t,void 0,void 0,function(){var t,r,o,c;return ee(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e(n)];case 1:if(t=i.sent(),r=400,t.status>=r){o=void 0;try{o=JSON.stringify(t.body)}catch(e){}throw Object(p.h)(u,"HTTP error",t.status,o)}return[2,t];case 2:throw(c=i.sent())instanceof TypeError&&"failed to fetch"===c.message&&(c=Object(p.h)(u,c.message,0)),c;case 3:return[2]}})})}}var f;!function(e){e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.NOT_AUTHORIZED=401]="NOT_AUTHORIZED",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.SERVER_ERROR=500]="SERVER_ERROR"}(f||(f={}));var l,p=n("a8297f1a1eef815b6c71"),b=function(e){var t=e.url,n=e.method,r=e.body,o=e.headers,c=e.responseType,i=e.credentials;return Object(p.o)().fetch(t,{method:n,headers:new Headers(o),body:r,credentials:i}).then(function(e){var t={};return Array.from(e.headers).map(function(e){var n=e[0],r=e[1];return t[n]=r}),e.status===f.NOT_MODIFIED?{status:e.status,headers:t,body:void 0}:e[c||"json"]().then(function(n){return{status:e.status,headers:t,body:n}})})},d=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},M=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]]);return n},h=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},v=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,c){function i(e){try{s(r.next(e))}catch(e){c(e)}}function a(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}s((r=r.apply(e,t||[])).next())})},g=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(i=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(c,n[1])).done)return i;switch(c=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,c=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],c=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,c,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},A=n("8ea987845369178c57e7"),O=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},z=function(){function e(e,t){this.send=s(c(t,e),f.OK),this._skypeToken=new A.BehaviorSubject(void 0)}return e.prototype.skypeToken=function(){return this._skypeToken},e.prototype.regionGtm=function(e){return this.getDiscovery().then(function(t){var n=e,r=t.regionGtms[n];if(void 0!==r){var o=Object(p.u)(r);return o.pathname.endsWith("/")||o.set("pathname",o.pathname+"/"),o.href}})},e.prototype.skypeid=function(){return this.getDiscovery().then(function(e){var t=e.tokens.skypeToken.split(".")[1];return"8:"+JSON.parse(atob(t)).skypeid})},e.prototype.validateSkypeToken=function(e){var t=this,n=this.getDiscovery();return n.then(function(r){var o=r.tokens,c=o.expires,i=o.skypeToken;return i!==e&&c.getTime()>Date.now()?i:(t._discoveryResponse===n&&t.setDiscoveryResponse(void 0),t.getDiscovery().then(function(e){return e.tokens.skypeToken}))})},e.prototype.getDiscovery=function(){var e=this;if(!this._discoveryResponse){var t=Date.now(),n=this.send({method:"POST",url:"https://api.teams.skype.com/beta/auth/skypetoken"}).then(function(e){var n=e.body;return O({},n,{tokens:O({},n.tokens,{expires:new Date(t+1e3*n.tokens.expiresIn)})})}).catch(function(t){throw e.setDiscoveryResponse(void 0),t});this.setDiscoveryResponse(n)}return this._discoveryResponse},e.prototype.setDiscoveryResponse=function(e){var t=this;this._discoveryResponse=e,e&&(this._discoveryResponse=e.then(function(e){return t._skypeToken.next(e.tokens.skypeToken),e}))},e}(),y=n("91ecbb091437d8753492"),m=n("ee431cdcdf25341aafd8"),L=function(){function e(e){this._config=e,this._logger=new y.a("Auth Web",4);var t=this.createAdalConfig(e);this._adal=new m(t),this._loginRequired=new A.BehaviorSubject(!this._adal.getCachedUser()),this._window=Object(p.o)(),this.bindAdalLogger(this._window),this.handleCallback(),this._adal.config.redirectUri=this.getAdalTokenRenewFlowPath(e,this._adal.config)}return Object.defineProperty(e.prototype,"isLoginRequired",{get:function(){return this._loginRequired.asObservable()},enumerable:!0,configurable:!0}),e.prototype.login=function(){var t=this;return new Promise(function(n,r){t._loginRequired.value?t.loginCallback?r(Object(p.h)(e,t.loginCallback,0,"Nested login")):(t.loginCallback=function(o,c,i){c?(t._loginRequired.next(!1),t._adal.config.redirectUri=t.getAdalTokenRenewFlowPath(t._config,t._adal.config),n()):r(Object(p.h)(e,i,1,"ADAL.login: "+i))},t._adal.config.redirectUri=t.getAdalLoginFlowPath(),t._adal.login()):n()})},e.prototype.acquireToken=function(t){var n=this;return new Promise(function(r,o){n._adal.acquireToken(t,function(t,c,i){i?("login_required"!==i&&"interaction_required"!==i||n._loginRequired.next(!0),o(Object(p.h)(e,i,1,"ADAL.acquireToken: "+i))):r(c)})})},e.prototype.getUser=function(){var t=this;return new Promise(function(n,r){t._adal.getUser(function(o,c){o?(t._logger.log(o),r(Object(p.h)(e,o,1,"ADAL.getUser: "+o))):n(c)})})},e.prototype.clearCacheForResource=function(e){this._adal.clearCacheForResource(e)},e.prototype.bindAdalLogger=function(e){var t=new y.a("ADAL",4),n=e.Logging;n?(n.level=3,n.log=t.log.bind(t)):this._logger.error("logging object not supplied to window by adal.js")},e.prototype.createAdalConfig=function(e){var t=this,n={callback:function(e,n,r){var o=t.loginCallback;delete t.loginCallback,o(e,n,r)},loadFrameTimeout:15e3,clientId:e.clientId,tenant:e.tenant},r=e.webAuth;if(r){n.cacheLocation=r.cacheLocation,n.navigateToLoginRequestUrl=r.navigateToLoginRequestUrl;var o=r.top;o&&(n.popUp=o.popUp,o.redirectPath&&(n.redirectUri=e.origin+"/"+e.basePath+(o.redirectPath?"/"+o.redirectPath:"")))}return n},e.prototype.getAdalTokenRenewFlowPath=function(e,t){var n=this.getConfiguredIframePath(e);return!this._loginRequired.value&&n?""+(e.origin?e.origin+"/":"")+(e.basePath?e.basePath+"/":"")+n:t.redirectUri},e.prototype.getConfiguredIframePath=function(e){return e.webAuth&&e.webAuth.iframe?e.webAuth.iframe.redirectPath:void 0},e.prototype.getAdalLoginFlowPath=function(){return this._window.location.href.split("?")[0].split("#")[0]},e.prototype.handleCallback=function(){var e=this;this.loginCallback=function(t,n){return e._loginRequired.next(!n)},this._adal.handleWindowCallback(),delete this.loginCallback},e}(),S=function(){function e(e){this._window=Object(p.o)(),this._loginRequired=new A.BehaviorSubject(!1)}return Object.defineProperty(e.prototype,"isLoginRequired",{get:function(){return this._loginRequired.asObservable()},enumerable:!0,configurable:!0}),e.prototype.login=function(){return Promise.resolve()},e.prototype.acquireToken=function(e){var t=this;return new Promise(function(n){t._window.desktop.ipcRenderer.once("sso-getAdalSsoToken-receive1",function(e,t,r){n(t.data.token)}),t._window.desktop.ipcRenderer.send("sso-getAdalSsoToken-send",e,"1")})},e.prototype.getUser=function(){return Promise.resolve({profile:{},userName:"Test Stub"})},e.prototype.clearCacheForResource=function(e){},e}();!function(e){e[e.MtToken=0]="MtToken",e[e.CsaToken=1]="CsaToken",e[e.PresenceToken=2]="PresenceToken",e[e.IdToken=3]="IdToken",e[e.SkypeToken=4]="SkypeToken"}(l||(l={}));N={},N[l.MtToken]="https://api.spaces.skype.com/",N[l.CsaToken]="https://chatsvcagg.teams.microsoft.com",N[l.PresenceToken]="https://presence.teams.microsoft.com/",q={},q[l.MtToken]="Authorization",q[l.CsaToken]="X-CsaToken",q[l.PresenceToken]="X-PresenceToken",q[l.IdToken]="X-IdToken",q[l.SkypeToken]="X-SkypeToken";var N,q,T=function(){function e(e){var t=this;this._loginRequired=new A.BehaviorSubject(!1),e.tokens.has(l.IdToken)&&(this.idToken=e.tokens.get(l.IdToken).token),this.tokens=new Map,e.tokens.forEach(function(e){t.tokens.set(e.resourceUrl,e.token)})}return Object.defineProperty(e.prototype,"isLoginRequired",{get:function(){return this._loginRequired.asObservable()},enumerable:!0,configurable:!0}),e.prototype.login=function(){return Promise.resolve()},e.prototype.acquireToken=function(e){var t=this;return Promise.resolve().then(function(){return t.tokens.get(e)||""})},e.prototype.getUser=function(){var e=this;return Promise.resolve().then(function(){var t=e.decodeJwt(e.idToken);if(!t)return null;var n=atob(t.JWSPayload),r=JSON.parse(n),o={userName:"",profile:r};return r.hasOwnProperty("upn")?o.userName=r.upn:r.hasOwnProperty("email")&&(o.userName=r.email),o})},e.prototype.clearCacheForResource=function(e){},e.prototype.decodeJwt=function(e){var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e}(),W="electron",B="server",C=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},w=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,c){function i(e){try{s(r.next(e))}catch(e){c(e)}}function a(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}s((r=r.apply(e,t||[])).next())})},j=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(i=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(c,n[1])).done)return i;switch(c=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,c=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],c=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,c,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},_=(function(){function e(e,t){e.origin=t.getOrigin(),this._authenticationProvider=i(e,t)}Object.defineProperty(e.prototype,"isLoginRequired",{get:function(){return this._authenticationProvider.isLoginRequired},enumerable:!0,configurable:!0}),e.prototype.getUser=function(){return this._authenticationProvider.getUser()},e.prototype.login=function(){var e=this;return this._authenticationProvider.login().then(function(){return e})},e.prototype.authorize=function(e,t){var n=this;return function(r){return w(n,void 0,void 0,function(){var n,o,c;return j(this,function(i){switch(i.label){case 0:n=0,i.label=1;case 1:return[4,this.acquireToken(t)];case 2:return o=i.sent(),[4,e(C({},r,{headers:C({},r.headers,{Authorization:"Bearer "+o})}))];case 3:if((c=i.sent()).status!==f.NOT_AUTHORIZED||n>0)return[2,c];this._authenticationProvider.clearCacheForResource(t),i.label=4;case 4:return++n,[3,1];case 5:return[2]}})})}},e.prototype.acquireToken=function(e){return this._authenticationProvider.acquireToken(e)}}(),n("d56f7770a2489fe4ede0")),X=n("bfa1ca23da138d867916"),E=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},k=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,c){function i(e){try{s(r.next(e))}catch(e){c(e)}}function a(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}s((r=r.apply(e,t||[])).next())})},R=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(i=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(c,n[1])).done)return i;switch(c=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,c=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],c=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,c,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},P=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]]);return n},x=(function(){function e(e){this.discover=e}e.prototype.authorize=function(e){var t=this;return function(n){return k(t,void 0,void 0,function(){var t,r,o,c,i,a,s,u,l,p;return R(this,function(b){switch(b.label){case 0:r=0,b.label=1;case 1:return o=E({},n.headers),(c=this.registrationToken)?(o.RegistrationToken=c,[3,4]):[3,2];case 2:return[4,this.discover.validateSkypeToken(t)];case 3:t=b.sent(),o.Authentication="skypetoken="+t,b.label=4;case 4:return[4,e(E({},n,{headers:o}))];case 5:if(i=b.sent(),a=i.status,s=i.headers["set-registrationtoken"],a===f.NOT_AUTHORIZED)if(c){if(c===this.registrationToken&&delete this.registrationToken,0===r)return t=void 0,r=1,[3,6]}else if(2!==r)return r=2,[3,6];return s&&a!==f.NOT_FOUND&&(u=Object(_.a)(s.split(";").map(function(e){return e.split("=",2).map(function(e){return e.trim()})})),l=u.expires,(p=P(u,["expires"])).endpointId&&(this.registrationToken=Object(X.a)(p).map(function(e){return e.join("=")}).join("; "))),[2,i];case 6:return[3,1];case 7:return[2]}})})}}}(),"electron"),D="server",I=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},F=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,c){function i(e){try{s(r.next(e))}catch(e){c(e)}}function a(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}s((r=r.apply(e,t||[])).next())})},U=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(i=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(c,n[1])).done)return i;switch(c=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,c=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],c=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,c,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},H=(function(){function e(e,t){e.origin=t.getOrigin(),this._authenticationProvider=a(e,t)}Object.defineProperty(e.prototype,"isLoginRequired",{get:function(){return this._authenticationProvider.isLoginRequired},enumerable:!0,configurable:!0}),e.prototype.getUser=function(){return this._authenticationProvider.getUser()},e.prototype.login=function(){var e=this;return this._authenticationProvider.login().then(function(){return e})},e.prototype.authorize=function(e,t){var n=this;return function(r){return F(n,void 0,void 0,function(){var n,o,c;return U(this,function(i){switch(i.label){case 0:n=0,i.label=1;case 1:return[4,this.acquireToken(t)];case 2:return o=i.sent(),[4,e(I({},r,{headers:I({},r.headers,{Authorization:"Bearer "+o})}))];case 3:if((c=i.sent()).status!==f.NOT_AUTHORIZED||n>0)return[2,c];this._authenticationProvider.clearCacheForResource(t),i.label=4;case 4:return++n,[3,1];case 5:return[2]}})})}},e.prototype.acquireToken=function(e){return this._authenticationProvider.acquireToken(e)}}(),this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}),V=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,c){function i(e){try{s(r.next(e))}catch(e){c(e)}}function a(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}s((r=r.apply(e,t||[])).next())})},G=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(i=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(c,n[1])).done)return i;switch(c=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,c=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],c=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,c,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},K=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]]);return n},$=function(){function e(e){this.discover=e}return e.prototype.authorize=function(e){var t=this;return function(n){return V(t,void 0,void 0,function(){var t,r,o,c,i,a,s,u,l,p;return G(this,function(b){switch(b.label){case 0:r=0,b.label=1;case 1:return o=H({},n.headers),(c=this.registrationToken)?(o.RegistrationToken=c,[3,4]):[3,2];case 2:return[4,this.discover.validateSkypeToken(t)];case 3:t=b.sent(),o.Authentication="skypetoken="+t,b.label=4;case 4:return[4,e(H({},n,{headers:o}))];case 5:if(i=b.sent(),a=i.status,s=i.headers["set-registrationtoken"],a===f.NOT_AUTHORIZED)if(c){if(c===this.registrationToken&&delete this.registrationToken,0===r)return t=void 0,r=1,[3,6]}else if(2!==r)return r=2,[3,6];return s&&a!==f.NOT_FOUND&&(u=Object(_.a)(s.split(";").map(function(e){return e.split("=",2).map(function(e){return e.trim()})})),l=u.expires,(p=K(u,["expires"])).endpointId&&(this.registrationToken=Object(X.a)(p).map(function(e){return e.join("=")}).join("; "))),[2,i];case 6:return[3,1];case 7:return[2]}})})}},e}(),Q=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,c){function i(e){try{s(r.next(e))}catch(e){c(e)}}function a(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}s((r=r.apply(e,t||[])).next())})},J=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(i=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(c,n[1])).done)return i;switch(c=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,c=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],c=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,c,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Y=function(){function e(e,t){this.aad=e,this.discover=t,this.skype=new $(this.discover)}return e.prototype.bind=function(e,t){var n=this;switch(t){case"chatService":return this.chatService||(this.chatService=o(function(e){return n.skype.authorize(e)},function(){return n.discover.regionGtm(t)})),this.chatService(e);case"middleTier":return function(o){return Q(n,void 0,void 0,function(){var n,i;return J(this,function(a){switch(a.label){case 0:return n=r,i=[c(e,this.aad)],[4,this.discover.regionGtm(t)];case 1:return[2,n.apply(void 0,i.concat([a.sent()]))(o)]}})})};case"unifiedPresence":return this.unifiedPresence||(this.unifiedPresence=o(function(e,t){return n.aad.authorize(e,t)},function(){return n.discover.regionGtm(t)})),this.unifiedPresence(e);case"urlp":case"ams":return function(o){return Q(n,void 0,void 0,function(){var n,c;return J(this,function(i){switch(i.label){case 0:return n=r,c=[e],[4,this.discover.regionGtm(t)];case 1:return[2,n.apply(void 0,c.concat([i.sent()]))(o)]}})})};default:return function(o){return Q(n,void 0,void 0,function(){var n;return J(this,function(c){switch(c.label){case 0:return[4,this.discover.regionGtm(t)];case 1:return n=c.sent(),[2,r(this.aad.authorize(e,n),n)(o)]}})})}}},e}(),Z=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,c){function i(e){try{s(r.next(e))}catch(e){c(e)}}function a(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}s((r=r.apply(e,t||[])).next())})},ee=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(i=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(c,n[1])).done)return i;switch(c=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,c=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],c=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,c,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};n.d(t,"b",function(){return f}),n.d(t,"f",function(){return b}),n.d(t,"d",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return z}),n.d(t,!1,function(){return Y}),n.d(t,"e",function(){return s}),n.d(t,!1,function(){return u})},"5369f199f57943db5523":function(e,t,n){"use strict";function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n("fb3a2b210e1d3add6253"),c=function(e,t){for(var n=e.length;n--;)if(Object(o.a)(e[n][0],t))return n;return-1},i=Array.prototype.splice;r.prototype.clear=function(){this.__data__=[],this.size=0},r.prototype.delete=function(e){var t=this.__data__,n=c(t,e);return!(n<0||(n==t.length-1?t.pop():i.call(t,n,1),--this.size,0))},r.prototype.get=function(e){var t=this.__data__,n=c(t,e);return n<0?void 0:t[n][1]},r.prototype.has=function(e){return c(this.__data__,e)>-1},r.prototype.set=function(e,t){var n=this.__data__,r=c(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};t.a=r},"545917340bb38318cdfd":function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},"5536c39646207529a1d3":function(e,t,n){"use strict";var r=n("77de278315e7bc78045c"),o=n("05734458eb0608000d5e");t.a=function(e,t){return t.length<2?e:Object(r.a)(e,Object(o.a)(t,0,-1))}},"5674af6f52f89608631c":function(e,t,n){"use strict";t.a=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},"5797aa9444a26dc50ee4":function(e,t,n){"use strict";var r=n("b2c7895933e4aed40b1d"),o=n("6ad221eee0fd1bc82bdc"),c=n("12ad4997381b52bb6668"),i=n("517d6e3962b3db33796d"),a=n("f76c3b2fae372b75aaef"),s=n("b8c08b527e4f22d848fd"),u=n("d7d4fca6d5f8306ef0a5"),f=n("38221194fe782b107f03"),l="[object Map]",p="[object Set]",b=Object.prototype.hasOwnProperty;t.a=function(e){if(null==e)return!0;if(Object(a.a)(e)&&(Object(i.a)(e)||"string"==typeof e||"function"==typeof e.splice||Object(s.a)(e)||Object(f.a)(e)||Object(c.a)(e)))return!e.length;var t=Object(o.a)(e);if(t==l||t==p)return!e.size;if(Object(u.a)(e))return!Object(r.a)(e).length;for(var n in e)if(b.call(e,n))return!1;return!0}},"584e93b03a67abaab594":function(e,t,n){"use strict";var r=n("ba53fce2bec9e4ed267c");t.a=function(e){return"function"==typeof e?e:r.a}},"59e11e8f701b7901100c":function(e,t,n){"use strict";t.a=function(e){return function(t){return null==t?void 0:t[e]}}},"5b2a8888241c3d58032e":function(e,t,n){"use strict";var r=n("cd6a8bc2ba13c01d7009"),o=n("25153e86102d7241054d"),c=n("584e93b03a67abaab594"),i=n("517d6e3962b3db33796d");t.a=function(e,t){return(Object(i.a)(e)?r.a:o.a)(e,Object(c.a)(t))}},"5c2f6399ceca32b7a0b3":function(e,t,n){"use strict";var r=n("72697142ff77ddd6e2b2"),o=Object(r.a)(Object.getPrototypeOf,Object);t.a=o},"5c8bc8b62030f5c53cf0":function(e,t,n){"use strict";var r=n("337b9e67dd20ada80fa5"),o=n("99ab8b568ca97366239b"),c=n("ea2effc0f6d665f6ba8e");t.a=function(e){if(e instanceof r.a)return e.clone();var t=new o.a(e.__wrapped__,e.__chain__);return t.__actions__=Object(c.a)(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},"5f83a414f9ba6ee13f56":function(e,t,n){"use strict";var r=n("25153e86102d7241054d");t.a=function(e,t){var n=[];return Object(r.a)(e,function(e,r,o){t(e,r,o)&&n.push(e)}),n}},"62449e904d87879eeb81":function(e,t,n){"use strict";t.isObject=function(e){return null!=e&&"object"==typeof e}},"6345f064cd972966e453":function(e,t,n){"use strict";var r=n("19455a0e3b36c61ab3d4"),o=n("4605ae836ca138d7eb59"),c=n("25153e86102d7241054d"),i=function(e,t){var n;return Object(c.a)(e,function(e,r,o){return!(n=t(e,r,o))}),!!n},a=n("517d6e3962b3db33796d"),s=n("f9fcd5e1be45a6d7936a");t.a=function(e,t,n){var c=Object(a.a)(e)?r.a:i;return n&&Object(s.a)(e,t,n)&&(t=void 0),c(e,Object(o.a)(t,3))}},"676b289012e486a3fc7c":function(e,t,n){"use strict";var r=n("8c0525b742d8509d59e5"),o=n("f3d9c495aaedd8ec38a5");t.a=function(e){return null==e?[]:Object(r.a)(e,Object(o.a)(e))}},"67e970f548b29d701fa8":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("f3449eea2e93f9e8fcd6"),o=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,n,o,c){var i;if(e._isElement(t)){if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent(n,c||!1,!0),Object(r.a)(a,o),i=t.dispatchEvent(a)}else if(document.createEventObject){var s=document.createEventObject(o);t.fireEvent("on"+n,s)}}else for(;t&&!1!==i;){var u=t.__events__,f=u?u[n]:null;if(f)for(var l in f)if(f.hasOwnProperty(l))for(var p=f[l],b=0;!1!==i&&b<p.length;b++){var d=p[b];d.objectCallback&&(i=d.objectCallback.call(d.parent,o))}t=c?t.parent:null}return i},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var r in t)t.hasOwnProperty(r)&&this.on(e,r,t[r],n)},e.prototype.on=function(t,n,r,o){var c=this;if(n.indexOf(",")>-1)for(var i=n.split(/[ ,]+/),a=0;a<i.length;a++)this.on(t,i[a],r,o);else{var s=this._parent,u={target:t,eventName:n,parent:s,callback:r,useCapture:o||!1};if((i=t.__events__=t.__events__||{})[n]=i[n]||{count:0},i[n][this._id]=i[n][this._id]||[],i[n][this._id].push(u),i[n].count++,e._isElement(t)){var f=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!c._isDisposed){var n;try{if(!1===(n=r.apply(s,e))&&e[0]){var o=e[0];o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.cancelBubble=!0}}catch(o){}return n}};u.elementCallback=f,t.addEventListener?t.addEventListener(n,f,o):t.attachEvent&&t.attachEvent("on"+n,f)}else{u.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!c._isDisposed)return r.apply(s,e)}}this._eventRecords.push(u)}},e.prototype.off=function(e,t,n,r){for(var o=0;o<this._eventRecords.length;o++){var c=this._eventRecords[o];if(!(e&&e!==c.target||t&&t!==c.eventName||n&&n!==c.callback||"boolean"==typeof r&&r!==c.useCapture)){var i=c.target.__events__,a=i[c.eventName],s=a?a[this._id]:null;s&&(1!==s.length&&n?(a.count--,s.splice(s.indexOf(c),1)):(a.count-=s.length,delete i[c.eventName][this._id]),a.count||delete i[c.eventName]),c.elementCallback&&(c.target.removeEventListener?c.target.removeEventListener(c.eventName,c.elementCallback,c.useCapture):c.target.detachEvent&&c.target.detachEvent("on"+c.eventName,c.elementCallback)),this._eventRecords.splice(o--,1)}}},e.prototype.raise=function(t,n,r){return e.raise(this._parent,t,n,r)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}()},"67f913577889d7d73251":function(e,t,n){"use strict";var r=n("7ed3f0710947ce397864"),o=n("c47f1635aacb1501f578"),c=n("ba53fce2bec9e4ed267c"),i=o.a?function(e,t){return Object(o.a)(e,"toString",{configurable:!0,enumerable:!1,value:Object(r.a)(t),writable:!0})}:c.a,a=n("dda421216ae1aabc3eb0"),s=Object(a.a)(i);t.a=s},"68bdc87fa9db91da28b2":function(e,t,n){"use strict";var r=n("59e11e8f701b7901100c"),o=Object(r.a)("length"),c=n("d392773eadf2f2ade722"),i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",a="\\ud83c[\\udffb-\\udfff]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",u="[\\ud800-\\udbff][\\udc00-\\udfff]",f="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",l="[\\ufe0e\\ufe0f]?"+f+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",s,u].join("|")+")[\\ufe0e\\ufe0f]?"+f+")*"),p="(?:"+["[^\\ud800-\\udfff]"+i+"?",i,s,u,"[\\ud800-\\udfff]"].join("|")+")",b=RegExp(a+"(?="+a+")|"+p+l,"g"),d=function(e){for(var t=b.lastIndex=0;b.test(e);)++t;return t};t.a=function(e){return Object(c.a)(e)?d(e):o(e)}},"698d75b157f24ae829cc":function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"6ab3a222ccd63725ea3a":function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},"6ad221eee0fd1bc82bdc":function(e,t,n){"use strict";var r=n("09072e49d5f60505514c"),o=n("0bd0afb5c74547a322b4"),c=Object(r.a)(o.a,"DataView"),i=n("c81c22325a11dbeda09d"),a=Object(r.a)(o.a,"Promise"),s=n("a47fc31414d567ab2252"),u=n("249cbff154ffd04c0412"),f=n("6fb0743f2477864eee04"),l=n("9a8c59ff14b4fcc9859b"),p=Object(l.a)(c),b=Object(l.a)(i.a),d=Object(l.a)(a),M=Object(l.a)(s.a),h=Object(l.a)(u.a),v=f.a;(c&&"[object DataView]"!=v(new c(new ArrayBuffer(1)))||i.a&&"[object Map]"!=v(new i.a)||a&&"[object Promise]"!=v(a.resolve())||s.a&&"[object Set]"!=v(new s.a)||u.a&&"[object WeakMap]"!=v(new u.a))&&(v=function(e){var t=Object(f.a)(e),n="[object Object]"==t?e.constructor:void 0,r=n?Object(l.a)(n):"";if(r)switch(r){case p:return"[object DataView]";case b:return"[object Map]";case d:return"[object Promise]";case M:return"[object Set]";case h:return"[object WeakMap]"}return t});t.a=v},"6c9d83bb00e221eb217d":function(e,t,n){(e.exports=n("c9535502986c4b766441")).tz.load(n("aefb93767a0f5bbd0892"))},"6fb0743f2477864eee04":function(e,t,n){"use strict";var r=n("41d5bf03b3e7b6dc3b9b"),o=Object.prototype,c=o.hasOwnProperty,i=o.toString,a=r.a?r.a.toStringTag:void 0,s=function(e){var t=c.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=i.call(e);return r&&(t?e[a]=n:delete e[a]),o},u=Object.prototype.toString,f=function(e){return u.call(e)},l="[object Null]",p="[object Undefined]",b=r.a?r.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?p:l:b&&b in Object(e)?s(e):f(e)}},"70ef56491c6ad2d76b52":function(e,t,n){"use strict";var r=n("0be451910340157220f5"),o=function(e,t){return Object(r.a)(t,function(t){return[t,e[t]]})},c=n("6ad221eee0fd1bc82bdc"),i=n("5674af6f52f89608631c"),a=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n},s="[object Map]",u="[object Set]";t.a=function(e){return function(t){var n=Object(c.a)(t);return n==s?Object(i.a)(t):n==u?a(t):o(t,e(t))}}},"710e92fb6f20e8b7c3b4":function(e,t,n){"use strict";var r=Array.prototype.join;t.a=function(e,t){return null==e?"":r.call(e,t)}},"71d97e0a6ad15ad887dd":function(e,t,n){"use strict";var r=n("14f3ae474ec63bc9b4d8");t.a=function(e){var t=Object(r.a)(e),n=t%1;return t===t?n?t-n:t:0}},"72110207b6499adb0ff6":function(e,t){e.exports=moment},"72697142ff77ddd6e2b2":function(e,t,n){"use strict";t.a=function(e,t){return function(n){return e(t(n))}}},"72a6689db872874504a6":function(e,t,n){"use strict";t.a=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},"778c19f9613119c13f4c":function(e,t,n){"use strict";var r=n("e912579201d6b2659f44"),o=n("f529b206b18b84c5d164"),c=n("5536c39646207529a1d3"),i=n("241740b9bc448e1477af");t.a=function(e,t){return t=Object(r.a)(t,e),null==(e=Object(c.a)(e,t))||delete e[Object(i.a)(Object(o.a)(t))]}},"77cdcf6d92804c8937e7":function(e,t,n){"use strict";var r=n("e762c53944e0ba53de07");t.a=function(e,t){return Object(r.a)(e,t)}},"77de278315e7bc78045c":function(e,t,n){"use strict";var r=n("e912579201d6b2659f44"),o=n("241740b9bc448e1477af");t.a=function(e,t){for(var n=0,c=(t=Object(r.a)(t,e)).length;null!=e&&n<c;)e=e[Object(o.a)(t[n++])];return n&&n==c?e:void 0}},"7af3fc0c351e507691be":function(e,t,n){"use strict";var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){var n=typeof e;return!!(t=null==t?r:t)&&("number"==n||"symbol"!=n&&o.test(e))&&e>-1&&e%1==0&&e<t}},"7d0194a0b3c301cb1b8f":function(e,t,n){"use strict";function r(e){var t;switch(e){case"dark":t=o.dark;break;case"contrast":t=o.contrast;break;default:t=o.default}return t}var o;!function(e){e.dark="dark",e.contrast="contrast",e.default="default"}(o||(o={})),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return r})},"7dab7527baa6bb82ca72":function(e,t,n){"use strict";var r=n("545917340bb38318cdfd"),o=n("517d6e3962b3db33796d");t.a=function(e,t,n){var c=t(e);return Object(o.a)(e)?c:Object(r.a)(c,n(e))}},"7ed3f0710947ce397864":function(e,t,n){"use strict";t.a=function(e){return function(){return e}}},"7f210f4f413cf9faca6e":function(e,t,n){"use strict";var r=n("a6646240fbf3f6e66d6d"),o=n("1d99639b1edc9210398a"),c=n("99d2950ef6e9b8ec386c");t.toSubscriber=function(e,t,n){if(e){if(e instanceof r.Subscriber)return e;if(e[o.rxSubscriber])return e[o.rxSubscriber]()}return e||t||n?new r.Subscriber(e,t,n):new r.Subscriber(c.empty)}},"7f703996b20d29879c6d":function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=function(e){function t(t){e.call(this),this.errors=t;var n=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"");this.name=n.name="UnsubscriptionError",this.stack=n.stack,this.message=n.message}return r(t,e),t}(Error);t.UnsubscriptionError=o},"826cde10a99434acc2b5":function(e,t,n){"use strict";function r(e){return decodeURIComponent(e.replace(/\+/g," "))}var o=Object.prototype.hasOwnProperty;t.stringify=function(e,t){var n=[];"string"!=typeof(t=t||"")&&(t="?");for(var r in e)o.call(e,r)&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return n.length?t+n.join("&"):""},t.parse=function(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,o={};t=n.exec(e);){var c=r(t[1]),i=r(t[2]);c in o||(o[c]=i)}return o}},"8286379a454aee09d9d3":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r={},o=0;if("undefined"!=typeof window){var c=window;r=c.__globalSettings__=c.__globalSettings__||(i={},i.__callbacks__={},i)}var i,a=r.__callbacks__,s=function(){function e(){}return e.getValue=function(e,t){return void 0===r[e]&&(r[e]="function"==typeof t?t():t),r[e]},e.setValue=function(e,t){var n=r[e];if(t!==n){r[e]=t;var o={oldValue:n,value:t,key:e};for(var c in a)a.hasOwnProperty(c)&&a[c](o)}return t},e.addChangeListener=function(e){var t=e.__id__;t||(t=e.__id__=String(o++)),a[t]=e},e.removeChangeListener=function(e){delete a[e.__id__]},e}()},"83dd30bb448d90ed6161":function(e,t,n){"use strict";var r=n("36e0784a51645e8ceed8"),o=n("0be451910340157220f5"),c=n("59e11e8f701b7901100c"),i=n("6ab3a222ccd63725ea3a"),a=n("ea2194eda6874f39b8b5"),s=Math.max;t.a=function(e){if(!e||!e.length)return[];var t=0;return e=Object(r.a)(e,function(e){if(Object(a.a)(e))return t=s(e.length,t),!0}),Object(i.a)(t,function(t){return Object(o.a)(e,Object(c.a)(t))})}},"8759a32591ce105280f0":function(e,t,n){"use strict";(function(e){var n="undefined"!=typeof window&&window,r="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,o=void 0!==e&&e,c=n||o||r;t.root=c,function(){if(!c)throw new Error("RxJS could not find any global context (window, self, global)")}()}).call(t,n("698d75b157f24ae829cc"))},"88b2345a655cbb107091":function(e,t,n){"use strict";var r,o=n("18abc8bf02b8e9156c7e");!function(e){e[e.ClearNewChat=0]="ClearNewChat",e[e.Batched=1]="Batched",e[e.DeleteNewChat=2]="DeleteNewChat",e[e.HideChat=3]="HideChat",e[e.NavigateToNextSelectedChat=4]="NavigateToNextSelectedChat",e[e.Resolved=5]="Resolved",e[e.TypingIndicatorChange=6]="TypingIndicatorChange",e[e.SelectedChatChange=7]="SelectedChatChange",e[e.CreatedNewChat=8]="CreatedNewChat"}(r||(r={}));var c=n("ed5c7a11e99b2467a279"),i=n("13c4ea9cb8ef42624470"),a=this&&this.__decorate||function(e,t,n,r){var o,c=arguments.length,i=c<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(c<3?o(i):c>3?o(t,n,i):o(t,n))||i);return c>3&&i&&Object.defineProperty(t,n,i),i},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(){function e(e,t){this.rootStore=e,this.chatListService=t,this.init()}return e.prototype.noChatsText=function(){return this.chatListService.noChatsText},e.prototype.togglePin=function(e){var t=this;Object(o.k)(function(){e&&(e.pinnedIndex>-1?t.chatListService.unpinChat(e.id):t.chatListService.pinChat(e.id))})},e.prototype.addFavorite=function(e){var t=this;Object(o.k)(function(){e&&t.chatListService.addFavorite(e.id)})},e.prototype.toggleMuteChat=function(e){var t=this;Object(o.k)(function(){e&&t.chatListService.updateMuteChat(e.id,!e.isMuted)})},e.prototype.discardChat=function(e){var t=this;Object(o.k)(function(){e&&t.chatListService.discardChat(e.id)})},e.prototype.toggleBotChatBlock=function(e){var t=this;return Object(o.k)(function(){return e?t.chatListService.setBotChatBlock(e.id,!e.isBotBlocked||null):Promise.reject("Cannot toggle chat block because the chat is null or undefined")})},e.prototype.toggleHideChat=function(e){var t=this;Object(o.k)(function(){e&&t.chatListService.setChatVisibility(e.id,e.isHidden)})},e.prototype.leaveChat=function(e){var t=this;Object(o.k)(function(){e&&t.chatListService.leaveChat(e.id)})},e.prototype.reorderPinned=function(e){var t=this;return Object(o.k)(function(){return t.chatListService.reorderPinned(e)})},e.prototype.onTypingIndicatorChange=function(e){var t=this;Object(o.k)(function(){e&&(t.typingUserMap=e.typingUserMRIs)})},e.prototype.getAriaInfo=function(e,t){var n=t?this.pinnedChats:this.recentChats,r=this.chatsFromList(n),o=Object(i.a)(r,function(t){return t.id===e});return{ariaLabel:this.chatListService.getAriaLabel(e,t),posInSet:o+1,setSize:r.length}},e.prototype.toggleExpandedList=function(e){var t=this;Object(o.k)(function(){t.expandedLists[e]=!t.expandedLists[e],t.chatListService.expandedLists=t.expandedLists})},e.prototype.contextMenuOpened=function(){this.chatListService.contextMenuOpened()},e.prototype.contextMenuClosed=function(){this.chatListService.contextMenuClosed()},e.prototype.compileIntoAngular=function(e){this.chatListService.compileIntoAngular(e)},e.prototype.handleActionEvent=function(e,t,n){switch(e){case r.TypingIndicatorChange:this.onTypingIndicatorChange(n);break;case r.SelectedChatChange:this.setSelectedChatId(n);break;case r.NavigateToNextSelectedChat:case r.HideChat:this.navigateToNextSelectedChatById(t);break;case r.Batched:this.handleBatchedEvent(n);break;case r.DeleteNewChat:this.navigateToNextSelectedChatById("newchat");break;case r.Resolved:this.handleResolvedEvent(t,n);break;case r.CreatedNewChat:this.expandedLists[c.a.RECENTS]||this.toggleExpandedList(c.a.RECENTS)}},e.prototype.notifyChatListRendered=function(e,t){this.chatListService.notifyChatListRendered&&this.chatListService.notifyChatListRendered(e,t)},e.prototype.navigateToChat=function(e){return this.chatListService.navigateToChat(e)},e.prototype.navigateToNextSelectedChatById=function(e){if(e){var t=this.indexForChat(e);t>=0&&this.navigateToNextSelectedChat(t)}},e.prototype.setSelectedChatId=function(e){var t=this;Object(o.k)(function(){e&&t.selectedId!==e&&(t.selectedId=e)})},e.prototype.navigateToNextSelectedChat=function(e){var t=this;Object(o.k)(function(){if(t.recentChats){var n=t.chatsFromList(t.recentChats)[e],r=n&&n.id;if(t.selectedId===r){var o=t.chatsFromList(t.recentChats);++e>=(o&&o.length)&&(e-=2),e<0?(t.selectedId=null,t.navigateToChat("")):(t.selectedId=o&&o[e].id,t.navigateToChat(t.selectedId))}}})},e.prototype.indexForChat=function(e){return Object(i.a)(this.chatsFromList(this.recentChats),function(t){return t&&t.id===e})},e.prototype.handleBatchedEvent=function(e){var t=this;Object(o.k)(function(){t.pinnedChats=e&&e[c.a.PINNED],t.recentChats=e&&e[c.a.RECENTS]})},e.prototype.handleResolvedEvent=function(e,t){this.selectedId===e&&this.setSelectedChatId(t)},e.prototype.init=function(){var e=this;Object(o.k)(function(){e.recentChats={chats:[],name:""},e.pinnedChats={chats:[],name:""},e.selectedId=null,e.typingUserMap={},e.expandedLists=e.chatListService.expandedLists,e.isRtl=e.chatListService.isRtl})},e.prototype.chatsFromList=function(e){return e&&e.chats},a([o.j,s("design:type",Object)],e.prototype,"recentChats",void 0),a([o.j,s("design:type",Object)],e.prototype,"pinnedChats",void 0),a([o.j,s("design:type",String)],e.prototype,"selectedId",void 0),a([o.j,s("design:type",Object)],e.prototype,"typingUserMap",void 0),a([o.j,s("design:type",Object)],e.prototype,"expandedLists",void 0),a([o.j,s("design:type",Boolean)],e.prototype,"isRtl",void 0),e}(),f=function(){function e(e){this.profilePictureService=e}return e.prototype.loadDefaultImage=function(e){return this.profilePictureService.loadDefaultImage(e)},e.prototype.loadImage=function(e,t,n,r){return this.profilePictureService.loadImage(e,t,n,r)},e.prototype.registerUserProfileListener=function(e,t){return this.profilePictureService.registerUserProfileListener(e,t)},e.prototype.unregisterUserProfileListener=function(e,t){this.profilePictureService.unregisterUserProfileListener(e,t)},e.prototype.registerPresenceStatusListener=function(e,t,n,r){return this.profilePictureService.registerPresenceStatusListener(e,t,n,r)},e.prototype.unregisterPresenceStatusListener=function(e,t,n){this.profilePictureService.unregisterPresenceStatusListener(e,t,n)},e}(),l=function(){function e(){}return e.prototype.loadDefaultImage=function(e){return"defaultImagePath"},e.prototype.loadImage=function(e,t,n,r){return Promise.resolve({})},e.prototype.registerUserProfileListener=function(e,t){return function(){}},e.prototype.unregisterUserProfileListener=function(e,t){},e.prototype.registerPresenceStatusListener=function(e,t,n,r){return function(){}},e.prototype.unregisterPresenceStatusListener=function(e,t,n){},e}();!function(){function e(){}e.prototype.loadDefaultImage=function(e){return"defaultImagePath"},e.prototype.loadImage=function(e,t,n,r){return Promise.resolve({})},e.prototype.registerUserProfileListener=function(e,t){return function(){}},e.prototype.unregisterUserProfileListener=function(e,t){},e.prototype.registerPresenceStatusListener=function(e,t,n,r){return function(){}},e.prototype.unregisterPresenceStatusListener=function(e,t,n){}}();Object(o.d)({enforceActions:!0});var p=n("31e2af16f2f551db800f"),b=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.chatListService=n,o.profilePictureService=r,o.name="chat-list-root-store",o.chatListStore=new u(o,n),o.profilePictureStore=new f(r),o}return b(t,e),t}(p.a),M=n("7d0194a0b3c301cb1b8f"),h=this&&this.__decorate||function(e,t,n,r){var o,c=arguments.length,i=c<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(c<3?o(i):c>3?o(t,n,i):o(t,n))||i);return c>3&&i&&Object.defineProperty(t,n,i),i},v=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(){function e(){}return e.prototype.noChatsText=function(){return""},e.prototype.notifyChatListRendered=function(e,t){},e.prototype.navigateToChat=function(e){},e.prototype.discardChat=function(e){},e.prototype.togglePin=function(e){},e.prototype.addFavorite=function(e){},e.prototype.toggleMuteChat=function(e){},e.prototype.toggleBotChatBlock=function(e){},e.prototype.toggleHideChat=function(e){},e.prototype.leaveChat=function(e){},e.prototype.reorderPinned=function(e){return!1},e.prototype.toggleExpandedList=function(e){},e.prototype.contextMenuOpened=function(){},e.prototype.contextMenuClosed=function(){},e.prototype.getAriaInfo=function(e,t){return null},e.prototype.compileIntoAngular=function(e){},e.prototype.handleActionEvent=function(e,t,n){},h([o.j,v("design:type",Object)],e.prototype,"recentChats",void 0),h([o.j,v("design:type",Object)],e.prototype,"pinnedChats",void 0),h([o.j,v("design:type",String)],e.prototype,"selectedId",void 0),h([o.j,v("design:type",Object)],e.prototype,"typingUserMap",void 0),h([o.j,v("design:type",Object)],e.prototype,"expandedLists",void 0),h([o.j,v("design:type",Boolean)],e.prototype,"isRtl",void 0),e}(),A=function(){return function(){this.name="mock-chat-list-store",this.chatListStore=new g,this.profilePictureStore=new l,this.themeStore={changeTheme:jest.fn(),name:"mock-theme-store",themeObservable:Object(o.j)({currentTheme:M.b.default})}}}(),O={loadReactChatList:"load_react_chat_list"};n.d(t,"b",function(){return d}),n.d(t,!1,function(){return A}),n.d(t,!1,function(){return u}),n.d(t,!1,function(){return g}),n.d(t,"a",function(){return r}),n.d(t,"c",function(){return O}),Object(o.d)({enforceActions:!0})},"8c0525b742d8509d59e5":function(e,t,n){"use strict";var r=n("0be451910340157220f5");t.a=function(e,t){return Object(r.a)(t,function(t){return e[t]})}},"8d1246b164f341c9a62f":function(e,t,n){"use strict";var r=n("978b85f07cd53ebdd0f6");t.a=function(e){return e===e&&!Object(r.a)(e)}},"8e4296af8a1934c9fbc5":function(e,t,n){"use strict";var r=n("36e0784a51645e8ceed8"),o=n("daea84c148dbc0bf9b45"),c=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(e){return null==e?[]:(e=Object(e),Object(r.a)(i(e),function(t){return c.call(e,t)}))}:o.a;t.a=a},"8ea987845369178c57e7":function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n("b2b3f493b9702e75bc98"),c=n("b05eab936c731d94a6f2"),i=function(e){function t(t){e.call(this),this._value=t}return r(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new c.ObjectUnsubscribedError;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(o.Subject);t.BehaviorSubject=i},"8fc3969d4aefbcbee5ea":function(e,t,n){"use strict";var r=n("778c19f9613119c13f4c"),o=n("7af3fc0c351e507691be"),c=Array.prototype.splice;t.a=function(e,t){for(var n=e?t.length:0,i=n-1;n--;){var a=t[n];if(n==i||a!==s){var s=a;Object(o.a)(a)?c.call(e,a,1):Object(r.a)(e,a)}}return e}},"91ecbb091437d8753492":function(e,t,n){"use strict";var r=function(){function e(e){this.label=e}return e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke.apply(this,[console.log].concat(e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke.apply(this,[console.info].concat(e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke.apply(this,[console.warn].concat(e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke.apply(this,[console.error].concat(e))},e.prototype.invoke=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if("string"==typeof t[0]){var r=t.shift();e.call.apply(e,[console,this.label+" "+r].concat(t))}else e.call.apply(e,[console,this.label].concat(t))},e}(),o=function(){function e(e,t){void 0===t&&(t=2),this.level=t,this.logger=new r(e)}return e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke.apply(this,[4,this.logger.log].concat(e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke.apply(this,[3,this.logger.info].concat(e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke.apply(this,[2,this.logger.warn].concat(e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke.apply(this,[1,this.logger.error].concat(e))},e.prototype.invoke=function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];this.level>=t&&e.globalLevel>=t&&n.call.apply(n,[this.logger].concat(r))},e.globalLevel=4,e}();n.d(t,"a",function(){return o})},"94a755535d135f12850c":function(e,t){e.exports=void 0},"94c7b7d740a59f8e352c":function(e,t,n){"use strict";function r(e){var t=null;try{t=window.localStorage.getItem(e)}catch(e){}return t}function o(e,t){try{window.localStorage.setItem(e,t)}catch(e){}}var c=n("9cacc934330ce8338522");t.a=function(){if(void 0===i){var e=Object(c.e)(),t=r("language");null!==t&&(i=t),void 0===i&&e&&(i=e.documentElement.getAttribute("lang")),void 0===i&&(i="en")}return i},t.b=function(e,t){void 0===t&&(t=!1);var n=Object(c.e)();n&&n.documentElement.setAttribute("lang",e),t||o("language",e),i=e};var i},"94e64458e50d130bfbf3":function(e,t,n){"use strict";var r=n("249cbff154ffd04c0412"),o=r.a&&new r.a;t.a=o},"978b85f07cd53ebdd0f6":function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},"97f5caeed1a44c59fd0c":function(e,t,n){"use strict";function r(){return void 0===b&&(b="undefined"!=typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),b}function o(e,t){var n=e.split(" "),r=parseInt(n[t],10);return n[0]=n[0].replace(String(r),String(-1*r)),n.join(" ")}function c(e){if("string"==typeof e){var t=e.split(" ");if(4===t.length)return t[0]+" "+t[3]+" "+t[2]+" "+t[1]}return e}t.b=function(e){b!==e&&(a.b.getInstance().resetKeys(),b=e)},t.a=function(e,t){if(r()){var n=e[t];if(!n)return;var i=e[t+1];if("string"==typeof i&&i.indexOf(f)>=0)e[t+1]=i.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(n.indexOf(s)>=0)e[t]=n.replace(s,u);else if(n.indexOf(u)>=0)e[t]=n.replace(u,s);else if(String(i).indexOf(s)>=0)e[t+1]=i.replace(s,u);else if(String(i).indexOf(u)>=0)e[t+1]=i.replace(u,s);else if(l[n])e[t]=l[n];else if(p[i])e[t+1]=p[i];else switch(n){case"margin":case"padding":e[t+1]=c(i);break;case"box-shadow":e[t+1]=o(i,0)}}};var i,a=n("31e0f288ed038a50d3d3"),s="left",u="right",f="@noflip",l=(i={},i[s]=u,i[u]=s,i),p={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"},b=r()},"9809d144ff362f4032ae":function(e,t,n){"use strict";var r=n("978b85f07cd53ebdd0f6"),o=n("eeb89c4dda5b564b5094"),c=NaN,i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,f=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(o.a)(e))return c;if(Object(r.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(r.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=s.test(e);return n||u.test(e)?f(e.slice(2),n?2:8):a.test(e)?c:+e}},"98bae3dbabd51089d613":function(e,t,n){"use strict";function r(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function o(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,c=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=c.next()).done;)i.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=c.return)&&n.call(c)}finally{if(o)throw o.error}}return i}function c(e){return this instanceof c?(this.v=e,this):new c(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.__extends=function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},n.d(t,"__assign",function(){return a}),t.__rest=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]]);return n},t.__decorate=function(e,t,n,r){var o,c=arguments.length,i=c<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(c<3?o(i):c>3?o(t,n,i):o(t,n))||i);return c>3&&i&&Object.defineProperty(t,n,i),i},t.__param=function(e,t){return function(n,r){t(n,r,e)}},t.__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},t.__awaiter=function(e,t,n,r){return new(n||(n=Promise))(function(o,c){function i(e){try{s(r.next(e))}catch(e){c(e)}}function a(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}s((r=r.apply(e,t||[])).next())})},t.__generator=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(i=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(c,n[1])).done)return i;switch(c=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,c=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],c=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,c,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},t.__exportStar=function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},t.__values=r,t.__read=o,t.__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},t.__await=c,t.__asyncGenerator=function(e,t,n){function r(e){l[e]&&(f[e]=function(t){return new Promise(function(n,r){p.push([e,t,n,r])>1||o(e,t)})})}function o(e,t){try{i(l[e](t))}catch(e){u(p[0][3],e)}}function i(e){e.value instanceof c?Promise.resolve(e.value.v).then(a,s):u(p[0][2],e)}function a(e){o("next",e)}function s(e){o("throw",e)}function u(e,t){e(t),p.shift(),p.length&&o(p[0][0],p[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f,l=n.apply(e,t||[]),p=[];return f={},r("next"),r("throw"),r("return"),f[Symbol.asyncIterator]=function(){return this},f},t.__asyncDelegator=function(e){function t(t,o){e[t]&&(n[t]=function(n){return(r=!r)?{value:c(e[t](n)),done:"return"===t}:o?o(n):n})}var n,r;return n={},t("next"),t("throw",function(e){throw e}),t("return"),n[Symbol.iterator]=function(){return this},n},t.__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof r?r(e):e[Symbol.iterator]()},t.__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},t.__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},t.__importDefault=function(e){return e&&e.__esModule?e:{default:e}};var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}},"98cc9c01e58a3d9416da":function(e,t,n){"use strict";t.a=function(e){return function(t){return e(t)}}},"99ab8b568ca97366239b":function(e,t,n){"use strict";function r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}var o=n("3b252cd5e0e6c3615b6d"),c=n("b6b32bb34d326922d674");(r.prototype=Object(o.a)(c.a.prototype)).constructor=r,t.a=r},"99d2950ef6e9b8ec386c":function(e,t,n){"use strict";t.empty={closed:!0,next:function(e){},error:function(e){throw e},complete:function(){}}},"9a4c46488e02f609482f":function(e,t,n){"use strict";var r=n("e766c598676a77c10541"),o=n("f76c3b2fae372b75aaef"),c=n("45d1013502405ff7e024"),i=n("71d97e0a6ad15ad887dd"),a=n("676b289012e486a3fc7c"),s=Math.max;t.a=function(e,t,n,u){e=Object(o.a)(e)?e:Object(a.a)(e),n=n&&!u?Object(i.a)(n):0;var f=e.length;return n<0&&(n=s(f+n,0)),Object(c.a)(e)?n<=f&&e.indexOf(t,n)>-1:!!f&&Object(r.a)(e,t,n)>-1}},"9a8c59ff14b4fcc9859b":function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},"9cacc934330ce8338522":function(e,t,n){"use strict";function r(e){var t;return e&&i(e)&&(t=e._virtual.parent),t}function o(e,t){return void 0===t&&(t=!0),e&&(t&&r(e)||e.parentNode&&e.parentNode)}function c(e,t){return e&&e!==document.body?t(e)?e:c(o(e),t):null}function i(e){return e&&!!e._virtual}t.k=function(e,t){var n=e,r=t;n._virtual||(n._virtual={children:[]});var o=n._virtual.parent;if(o&&o!==t){var c=o._virtual.children.indexOf(n);c>-1&&o._virtual.children.splice(c,1)}n._virtual.parent=r||void 0,r&&(r._virtual||(r._virtual={children:[]}),r._virtual.children.push(n))},t.h=r,t.f=o,t.d=function(e,t){void 0===t&&(t=!0);var n=[];if(e){for(var r=0;r<e.children.length;r++)n.push(e.children.item(r));t&&i(e)&&n.push.apply(n,e._virtual.children)}return n},t.a=function(e,t,n){void 0===n&&(n=!0);var r=!1;if(e&&t)if(n)for(r=!1;t;){var c=o(t);if(c===e){r=!0;break}t=c}else e.contains&&(r=e.contains(t));return r},t.j=function(e){a=e},t.i=function(e){return a||"undefined"==typeof window?void 0:e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window},t.e=function(e){return a||"undefined"==typeof document?void 0:e&&e.ownerDocument?e.ownerDocument:document},t.g=function(e){var t;return e&&(e===window?t={left:0,top:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:e.getBoundingClientRect&&(t=e.getBoundingClientRect())),t},t.c=c,t.b=function(e,t){var n=c(e,function(e){return e.hasAttribute(t)});return n&&n.getAttribute(t)};var a=!1},"9e8a7f8c69636f440e01":function(e,t,n){"use strict";var r=n("13a0a4d0580180405100"),o=n("0be451910340157220f5"),c=n("83dd30bb448d90ed6161");t.a=function(e,t){if(!e||!e.length)return[];var n=Object(c.a)(e);return null==t?n:Object(o.a)(n,function(e){return Object(r.a)(t,void 0,e)})}},a02fedbb74c57c0a899e:function(e,t,n){"use strict";var r=n("e912579201d6b2659f44"),o=n("12ad4997381b52bb6668"),c=n("517d6e3962b3db33796d"),i=n("7af3fc0c351e507691be"),a=n("f1c0e74a95dfbe71c6f0"),s=n("241740b9bc448e1477af");t.a=function(e,t,n){for(var u=-1,f=(t=Object(r.a)(t,e)).length,l=!1;++u<f;){var p=Object(s.a)(t[u]);if(!(l=null!=e&&n(e,p)))break;e=e[p]}return l||++u!=f?l:!!(f=null==e?0:e.length)&&Object(a.a)(f)&&Object(i.a)(p,f)&&(Object(c.a)(e)||Object(o.a)(e))}},a0a326a2cc843c3ff0fb:function(e,t,n){"use strict";var r=n("59e11e8f701b7901100c"),o=n("77de278315e7bc78045c"),c=function(e){return function(t){return Object(o.a)(t,e)}},i=n("f0ecf12d5be0fc5eff7f"),a=n("241740b9bc448e1477af");t.a=function(e){return Object(i.a)(e)?Object(r.a)(Object(a.a)(e)):c(e)}},a350c0c489bcd73fc97c:function(e,t,n){"use strict";var r=n("36dcb0d197c09ea9afe9"),o=n("dda421216ae1aabc3eb0"),c=Object(o.a)(r.a);t.a=c},a47fc31414d567ab2252:function(e,t,n){"use strict";var r=n("09072e49d5f60505514c"),o=n("0bd0afb5c74547a322b4"),c=Object(r.a)(o.a,"Set");t.a=c},a50cc60cf2cb5b489ec3:function(e,t,n){"use strict";var r=n("0bd0afb5c74547a322b4").a.Uint8Array;t.a=r},a58909cb8ea1235789f0:function(e,t,n){"use strict";var r=n("f76c3b2fae372b75aaef");t.a=function(e,t){return function(n,o){if(null==n)return n;if(!Object(r.a)(n))return e(n,o);for(var c=n.length,i=t?c:-1,a=Object(n);(t?i--:++i<c)&&!1!==o(a[i],i,a););return n}}},a6646240fbf3f6e66d6d:function(e,t,n){"use strict";function r(e){return e instanceof u||"syncErrorThrowable"in e&&e[s.rxSubscriber]}var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},c=n("44e94ccfd904f0f707b3"),i=n("bcfe5642589c9dbfb15d"),a=n("99d2950ef6e9b8ec386c"),s=n("1d99639b1edc9210398a"),u=function(e){function t(t,n,o){switch(e.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a.empty;break;case 1:if(!t){this.destination=a.empty;break}if("object"==typeof t){if(r(t)){var c=t[s.rxSubscriber]();this.syncErrorThrowable=c.syncErrorThrowable,this.destination=c,c.add(this)}else this.syncErrorThrowable=!0,this.destination=new f(this,t);break}default:this.syncErrorThrowable=!0,this.destination=new f(this,t,n,o)}}return o(t,e),t.prototype[s.rxSubscriber]=function(){return this},t.create=function(e,n,r){var o=new t(e,n,r);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this,t=e._parent,n=e._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=n,this},t}(i.Subscription);t.Subscriber=u;var f=function(e){function t(t,n,r,o){e.call(this),this._parentSubscriber=t;var i,s=this;c.isFunction(n)?i=n:n&&(i=n.next,r=n.error,o=n.complete,n!==a.empty&&(s=Object.create(n),c.isFunction(s.unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this))),this._context=s,this._next=i,this._error=r,this._complete=o}return o(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){throw this.unsubscribe(),e}},t.prototype.__tryOrSetError=function(e,t,n){try{t.call(this._context,n)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0,!0}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(u)},a8297f1a1eef815b6c71:function(e,t,n){"use strict";function r(e){switch(typeof e){case"boolean":return e;case"number":return 1===e;case"string":var t=e.toLowerCase();return"true"===t||"on"===t||"1"===t}return!1}function o(){var e={promise:null,resolve:null,reject:null};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),e}function c(e,t,n,r){return void 0===r&&(r=(e.name||e)+"#"+n),Object.assign(new Error(r),{category:e,reason:t,code:n})}function i(e,t,n,r){return!(e.category!==t||void 0!=r&&e.reason!==r||void 0!=n&&e.code!==n)}function a(e){return c(a,"Logical Error",void 0,e)}function s(){return window}function u(){return s().document}function f(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];window.electronSafeIpc&&(r=window.electronSafeIpc).send.apply(r,[e].concat(t));var r}function l(e){void 0===e&&(e=1);var t=new Uint32Array(e),n=s();if("msCrypto"in n)n.msCrypto.getRandomValues(t);else if("crypto"in n)n.crypto.getRandomValues(t);else for(var r=e;r--;){t[r-1]=Math.floor(1e9*(Math.random()+1))}return t}function p(e){return new Promise(function(t,n){e<0?n(new Error("negative timeout")):setTimeout(t,e)})}function b(e,t){return p(t).then(e)}function d(e,t,n){return Promise.race([e,p(t).then(function(){throw c(d,"Timeout",void 0,n||"timed out after "+t+" ms")})])}function M(e){var t=W(e);return t.protocol+"//"+t.host}function h(e){var t=s().location.search.replace("?","").split("&").map(function(e){var t=e.split("="),n={};return n[t[0]]=t[1],n});return(t=Object.assign.apply(Object,[{}].concat(t)))[e]}function v(e){switch(e){case C.b.default:return w.d;case C.b.dark:return w.c;case C.b.contrast:return w.b}}function g(e,t,n){var r="";return e?r=t?j.e.teams:j.e.personal:n&&(r=j.e.google),r}function A(e,t){return{fileId:t,providerCode:"GOOGLEDRIVE",providerType:"2",fileType:e,ctx:j.b.externalCtx}}function O(e,t,n,r,o,c,i,a){return{baseUrl:e,fileId:o,fileType:n,objectUrl:c?""+t.substring(0,t.indexOf("/",8))+c:void 0,serviceName:r,threadId:i,ctx:a?j.b.newFileCtx:i?j.b.channelFileCtx:null}}function z(e,t){return e.getTime()<=t.getTime()}function y(e){var t=W(e,"http://example.com").pathname;return decodeURIComponent(t.slice(t.lastIndexOf("/")+1))}function m(){ce||window.requestAnimationFrame(function(){Object(oe.initializeIcons)(),ce=!0})}var L=function(){function e(e){this.val=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this.val},enumerable:!0,configurable:!0}),e.prototype.map=function(t){return new e(t(this.val))},e}(),S=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N=function(){function e(e,t,n){this.maxDelay=e,this.initialDelay=t,this.calculate=n,this.errCount=0}return Object.defineProperty(e.prototype,"errorCount",{get:function(){return this.errCount},enumerable:!0,configurable:!0}),e.prototype.next=function(){return Math.min(this.maxDelay,this.calculate(this.initialDelay,++this.errCount))},e.prototype.reset=function(){this.errCount=0},e}(),q=function(e){function t(t,n){return e.call(this,t,n,function(e,t){return Math.pow(e,t)})||this}return S(t,e),t}(N),T=function(e){function t(t){return e.call(this,t,t,function(){return Math.floor(Math.random()*t)})||this}return S(t,e),t}(N),W=n("d336cfdf83500abe5b8b"),B=function(e,t){void 0===t&&(t={});var n;try{n=JSON.parse(e)}catch(e){n=t}return n},C=n("7d0194a0b3c301cb1b8f"),w=n("31e2af16f2f551db800f"),j=n("af941f503aa1d13e41c1"),_=n("6c9d83bb00e221eb217d"),X=function(e){return _(e).startOf("day").toDate()},E=function(e){return _(e).endOf("day").toDate()},k=function(e){return _(e).startOf("minute").toDate()},R=function(e){return _(e).startOf("isoWeek").toDate()},P=function(e,t){var n=_(e,t);return n.isValid()?n.toDate():null},x=function(e,t){return _(e).format(t)},D=function(e,t){return _(e).isSame(t,"day")},I=function(e,t){return _(e).set(t).toDate()},F=function(e,t){return _(e).add(t).toDate()},U=function(e,t){return F(e,{days:t})},H=function(e,t){return _(e).subtract(t,"days").toDate()},V=function(e){return e&&e.getTime()},G=function(e){var t=_(e);return 60*t.hour()+t.minute()},K=function(e,t){return _(t).diff(_(e),"days")},$=function(){return _.tz.guess()},Q=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,c){function i(e){try{s(r.next(e))}catch(e){c(e)}}function a(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}s((r=r.apply(e,t||[])).next())})},J=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(i=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(c,n[1])).done)return i;switch(c=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,c=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],c=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,c,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Y=this,Z=function(e,t){return function(n){return Q(Y,void 0,void 0,function(){var r;return J(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,4]),[4,e(n)];case 1:return[2,o.sent()];case 2:return r=o.sent(),[4,t(r,n)];case 3:return o.sent(),[3,4];case 4:return[3,0];case 5:return[2]}})})}},ee=function(e,t){return 100*e/t+"%"},te=n("5b2a8888241c3d58032e"),ne=n("fe4d25c82df832cc2fcb"),re=function(){function e(e,t,n){this.onBatchReady=e,this.batchingIntervalInMs=t,this.maxBatchRequests=n,this.intervalId=null,this.queue=[]}return e.prototype.submit=function(e){var t=o();return this.queue.push({request:e,deferred:t}),this.maxBatchRequests&&this.queue.length>=this.maxBatchRequests?(this.stop(),this.processQueue()):this.start(),t.promise},e.prototype.start=function(){var e=this;this.intervalId||(this.intervalId=s().setInterval(function(){return e.processQueue()},this.batchingIntervalInMs))},e.prototype.stop=function(){this.intervalId&&(s().clearInterval(this.intervalId),this.intervalId=null)},e.prototype.processQueue=function(){var e=this,t=this.queue.length;if(t>0){var n=this.queue.splice(0,t);this.onBatchReady(n.map(function(e){return e.request})).then(function(t){return e.processBatchResults(n,t)}).catch(function(t){return e.processBatchError(n,t)})}else this.stop()},e.prototype.processBatchResults=function(e,t){Object(ne.a)(e,t,function(e,t){t instanceof Error?e.deferred.reject(t):e.deferred.resolve(t)})},e.prototype.processBatchError=function(e,t){Object(te.a)(e,function(e){e.deferred.reject(t)})},e}(),oe=n("c60639288dd011bf33a8"),ce=!1;n.d(t,"d",function(){return r}),n.d(t,!1,function(){return L}),n.d(t,!1,function(){return o}),n.d(t,"h",function(){return c}),n.d(t,!1,function(){return i}),n.d(t,!1,function(){return a}),n.d(t,"v",function(){return l}),n.d(t,"z",function(){return p}),n.d(t,!1,function(){return b}),n.d(t,"B",function(){return d}),n.d(t,"a",function(){return q}),n.d(t,"b",function(){return T}),n.d(t,!1,function(){return u}),n.d(t,"o",function(){return s}),n.d(t,"y",function(){return f}),n.d(t,"m",function(){return M}),n.d(t,"u",function(){return W}),n.d(t,!1,function(){return h}),n.d(t,"x",function(){return B}),n.d(t,"l",function(){return v}),n.d(t,"n",function(){return g}),n.d(t,"k",function(){return O}),n.d(t,"j",function(){return A}),n.d(t,!1,function(){return F}),n.d(t,!1,function(){return U}),n.d(t,"c",function(){return $}),n.d(t,"e",function(){return G}),n.d(t,"f",function(){return K}),n.d(t,!1,function(){return V}),n.d(t,"g",function(){return E}),n.d(t,"i",function(){return x}),n.d(t,"q",function(){return D}),n.d(t,"r",function(){return z}),n.d(t,!1,function(){return 6e4}),n.d(t,"t",function(){return P}),n.d(t,"A",function(){return X}),n.d(t,!1,function(){return k}),n.d(t,!1,function(){return R}),n.d(t,!1,function(){return H}),n.d(t,!1,function(){return I}),n.d(t,"w",function(){return Z}),n.d(t,"s",function(){return y}),n.d(t,"C",function(){return ee}),n.d(t,!1,function(){return re}),n.d(t,"p",function(){return m})},a8c7165f33a4dc07ab0d:function(e,t,n){"use strict";(function(e){function n(e){var t=z();e();var n=z();g.perf.duration+=n-t}function r(){n(function(){var e=g.runState.buffer.slice();g.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&c(t)})}function o(){return setTimeout(function(){g.runState.flushTimer=0,r()},0)}function c(e,t){g.loadStyles?g.loadStyles(f(e).styleString,e):h?b(e,t):p(e)}function i(e){void 0===e&&(e=3),3!==e&&2!==e||(a(g.registeredStyles),g.registeredStyles=[]),3!==e&&1!==e||(a(g.registeredThemableStyles),g.registeredThemableStyles=[])}function a(e){e.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)})}function s(){if(g.theme){for(var e=[],t=0,n=g.registeredThemableStyles;t<n.length;t++){var r=n[t];e.push(r.themableStyle)}e.length>0&&(i(1),c([].concat.apply([],e)))}}function u(e){return e&&(e=f(l(e)).styleString),e}function f(e){var t=g.theme,n=!1;return{styleString:(e||[]).map(function(e){var r=e.theme;if(r){n=!0;var o=t?t[r]:void 0,c=e.defaultValue||"inherit";return!t||o||!console||r in t||"undefined"==typeof DEBUG||!DEBUG||console.warn('Theming value not provided for "'+r+'". Falling back to "'+c+'".'),o||c}return e.rawString}).join(""),themable:n}}function l(e){var t=[];if(e){for(var n=0,r=void 0;r=A.exec(e);){var o=r.index;o>n&&t.push({rawString:e.substring(n,o)}),t.push({theme:r[1],defaultValue:r[2]}),n=A.lastIndex}t.push({rawString:e.substring(n)})}return t}function p(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),r=f(e),o=r.styleString,c=r.themable;n.type="text/css",n.appendChild(document.createTextNode(o)),g.perf.count++,t.appendChild(n);var i={styleElement:n,themableStyle:e};c?g.registeredThemableStyles.push(i):g.registeredStyles.push(i)}function b(e,t){var n=document.getElementsByTagName("head")[0],r=g.registeredStyles,o=g.lastStyleElement,c=o?o.styleSheet:void 0,i=c?c.cssText:"",a=r[r.length-1],s=f(e).styleString;(!o||i.length+s.length>O)&&((o=document.createElement("style")).type="text/css",t?(n.replaceChild(o,t.styleElement),t.styleElement=o):n.appendChild(o),t||(a={styleElement:o,themableStyle:e},r.push(a))),o.styleSheet.cssText+=u(s),Array.prototype.push.apply(a.themableStyle,e),g.lastStyleElement=o}function d(){var e=!1;if("undefined"!=typeof document){var t=document.createElement("style");t.type="text/css",e=!!t.styleSheet}return e}var M=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};Object.defineProperty(t,"__esModule",{value:!0});var h,v="undefined"==typeof window?e:window,g=function(){var e=v.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]};return e.runState||(e=M({},e,{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),e.registeredThemableStyles||(e=M({},e,{registeredThemableStyles:[]})),v.__themeState__=e,e}(),A=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,O=1e4,z=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};t.loadStyles=function(e,t){void 0===t&&(t=!1),n(function(){var n=Array.isArray(e)?e:l(e);void 0===h&&(h=d());var r=g.runState,i=r.mode,a=r.buffer,s=r.flushTimer;t||1===i?(a.push(n),s||(g.runState.flushTimer=o())):c(n)})},t.configureLoadStyles=function(e){g.loadStyles=e},t.configureRunMode=function(e){g.runState.mode=e},t.flush=r,t.loadTheme=function(e){g.theme=e,s()},t.clearStyles=i,t.detokenize=u,t.splitStyles=l}).call(t,n("698d75b157f24ae829cc"))},ad8cc569f3f069fb91a0:function(e,t,n){"use strict";function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function o(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var c=n("09072e49d5f60505514c"),i=Object(c.a)(Object,"create"),a="__lodash_hash_undefined__",s=Object.prototype.hasOwnProperty,u=Object.prototype.hasOwnProperty,f="__lodash_hash_undefined__";r.prototype.clear=function(){this.__data__=i?i(null):{},this.size=0},r.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},r.prototype.get=function(e){var t=this.__data__;if(i){var n=t[e];return n===a?void 0:n}return s.call(t,e)?t[e]:void 0},r.prototype.has=function(e){var t=this.__data__;return i?void 0!==t[e]:u.call(t,e)},r.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=i&&void 0===t?f:t,this};var l=r,p=n("5369f199f57943db5523"),b=n("c81c22325a11dbeda09d"),d=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},M=function(e,t){var n=e.__data__;return d(t)?n["string"==typeof t?"string":"hash"]:n.map};o.prototype.clear=function(){this.size=0,this.__data__={hash:new l,map:new(b.a||p.a),string:new l}},o.prototype.delete=function(e){var t=M(this,e).delete(e);return this.size-=t?1:0,t},o.prototype.get=function(e){return M(this,e).get(e)},o.prototype.has=function(e){return M(this,e).has(e)},o.prototype.set=function(e,t){var n=M(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};t.a=o},ae807d87f71d0705eaab:function(e,t,n){"use strict";var r=n("fcb014d4447b3f993dec"),o=500,c=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=function(e){var t=Object(r.a)(e,function(e){return n.size===o&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(c,function(e,n,r,o){t.push(r?o.replace(i,"$1"):n||e)}),t});t.a=a},aefb93767a0f5bbd0892:function(e,t){e.exports={version:"2018e",zones:["Africa/Abidjan|LMT GMT|g.8 0|01|-2ldXH.Q|48e5","Africa/Accra|LMT GMT +0020|.Q 0 -k|012121212121212121212121212121212121212121212121|-26BbX.8 6tzX.8 MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE|41e5","Africa/Nairobi|LMT EAT +0230 +0245|-2r.g -30 -2u -2J|01231|-1F3Cr.g 3Dzr.g okMu MFXJ|47e5","Africa/Algiers|PMT WET WEST CET CEST|-9.l 0 -10 -10 -20|0121212121212121343431312123431213|-2nco9.l cNb9.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 DA0 Imo0 rd0 De0 9Xz0 1fb0 1ap0 16K0 2yo0 mEp0 hwL0 jxA0 11A0 dDd0 17b0 11B0 1cN0 2Dy0 1cN0 1fB0 1cL0|26e5","Africa/Lagos|LMT WAT|-d.A -10|01|-22y0d.A|17e6","Africa/Bissau|LMT -01 GMT|12.k 10 0|012|-2ldX0 2xoo0|39e4","Africa/Maputo|LMT CAT|-2a.k -20|01|-2GJea.k|26e5","Africa/Cairo|EET EEST|-20 -30|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1bIO0 vb0 1ip0 11z0 1iN0 1nz0 12p0 1pz0 10N0 1pz0 16p0 1jz0 s3d0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1WL0 rd0 1Rz0 wp0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1qL0 Xd0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1ny0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 WL0 1qN0 Rb0 1wp0 On0 1zd0 Lz0 1EN0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0|15e6","Africa/Casablanca|LMT WET WEST CET|u.k 0 -10 -10|0121212121212121213121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2gMnt.E 130Lt.E rb0 Dd0 dVb0 b6p0 TX0 EoB0 LL0 gnd0 rz0 43d0 AL0 1Nd0 XX0 1Cp0 pz0 dEp0 4mn0 SyN0 AL0 1Nd0 wn0 1FB0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 Rc0 11A0 e00 e00 U00 11A0 8o0 e00 11A0 11A0 5A0 e00 17c0 1fA0 1a00 1a00 1fA0 17c0 1io0 14o0 1lc0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1lc0 14o0 1fA0|32e5","Africa/Ceuta|WET WEST CET CEST|0 -10 -10 -20|010101010101010101010232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-25KN0 11z0 drd0 18p0 3HX0 17d0 1fz0 1a10 1io0 1a00 1y7o0 LL0 gnd0 rz0 43d0 AL0 1Nd0 XX0 1Cp0 pz0 dEp0 4VB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|85e3","Africa/El_Aaiun|LMT -01 WET WEST|Q.M 10 0 -10|01232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1rDz7.c 1GVA7.c 6L0 AL0 1Nd0 XX0 1Cp0 pz0 1cBB0 AL0 1Nd0 wn0 1FB0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 Rc0 11A0 e00 e00 U00 11A0 8o0 e00 11A0 11A0 5A0 e00 17c0 1fA0 1a00 1a00 1fA0 17c0 1io0 14o0 1lc0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1lc0 14o0 1fA0|20e4","Africa/Johannesburg|SAST SAST SAST|-1u -20 -30|012121|-2GJdu 1Ajdu 1cL0 1cN0 1cL0|84e5","Africa/Juba|LMT CAT CAST EAT|-26.s -20 -30 -30|01212121212121212121212121212121213|-1yW26.s 1zK06.s 16L0 1iN0 17b0 1jd0 17b0 1ip0 17z0 1i10 17X0 1hB0 18n0 1hd0 19b0 1gp0 19z0 1iN0 17b0 1ip0 17z0 1i10 18n0 1hd0 18L0 1gN0 19b0 1gp0 19z0 1iN0 17z0 1i10 17X0 yGd0","Africa/Khartoum|LMT CAT CAST EAT|-2a.8 -20 -30 -30|012121212121212121212121212121212131|-1yW2a.8 1zK0a.8 16L0 1iN0 17b0 1jd0 17b0 1ip0 17z0 1i10 17X0 1hB0 18n0 1hd0 19b0 1gp0 19z0 1iN0 17b0 1ip0 17z0 1i10 18n0 1hd0 18L0 1gN0 19b0 1gp0 19z0 1iN0 17z0 1i10 17X0 yGd0 HjL0|51e5","Africa/Monrovia|MMT MMT GMT|H.8 I.u 0|012|-23Lzg.Q 28G01.m|11e5","Africa/Ndjamena|LMT WAT WAST|-10.c -10 -20|0121|-2le10.c 2J3c0.c Wn0|13e5","Africa/Sao_Tome|LMT GMT WAT|A.J 0 -10|012|-2le00 4i6N0","Africa/Tripoli|LMT CET CEST EET|-Q.I -10 -20 -20|012121213121212121212121213123123|-21JcQ.I 1hnBQ.I vx0 4iP0 xx0 4eN0 Bb0 7ip0 U0n0 A10 1db0 1cN0 1db0 1dd0 1db0 1eN0 1bb0 1e10 1cL0 1c10 1db0 1dd0 1db0 1cN0 1db0 1q10 fAn0 1ep0 1db0 AKq0 TA0 1o00|11e5","Africa/Tunis|PMT CET CEST|-9.l -10 -20|0121212121212121212121212121212121|-2nco9.l 18pa9.l 1qM0 DA0 3Tc0 11B0 1ze0 WM0 7z0 3d0 14L0 1cN0 1f90 1ar0 16J0 1gXB0 WM0 1rA0 11c0 nwo0 Ko0 1cM0 1cM0 1rA0 10M0 zuM0 10N0 1aN0 1qM0 WM0 1qM0 11A0 1o00|20e5","Africa/Windhoek|+0130 SAST SAST CAT WAT|-1u -20 -30 -20 -10|01213434343434343434343434343434343434343434343434343|-2GJdu 1Ajdu 1cL0 1SqL0 9Io0 16P0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0|32e4","America/Adak|NST NWT NPT BST BDT AHST HST HDT|b0 a0 a0 b0 a0 a0 a0 90|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17SX0 8wW0 iB0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cm0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|AST AWT APT AHST AHDT YST AKST AKDT|a0 90 90 a0 90 90 90 80|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17T00 8wX0 iA0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cm0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Port_of_Spain|LMT AST|46.4 40|01|-2kNvR.U|43e3","America/Araguaina|LMT -03 -02|3c.M 30 20|0121212121212121212121212121212121212121212121212121|-2glwL.c HdKL.c 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 dMN0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 ny10 Lz0|14e4","America/Argentina/Buenos_Aires|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323232323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 A4p0 uL0 1qN0 WL0","America/Argentina/Catamarca|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323132321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 rlB0 7B0 8zb0 uL0","America/Argentina/Cordoba|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323132323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 A4p0 uL0 1qN0 WL0","America/Argentina/Jujuy|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323121323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1ze0 TX0 1ld0 WK0 1wp0 TX0 A4p0 uL0","America/Argentina/La_Rioja|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323231232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Qn0 qO0 16n0 Rb0 1wp0 TX0 rlB0 7B0 8zb0 uL0","America/Argentina/Mendoza|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232312121321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1u20 SL0 1vd0 Tb0 1wp0 TW0 ri10 Op0 7TX0 uL0","America/Argentina/Rio_Gallegos|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 rlB0 7B0 8zb0 uL0","America/Argentina/Salta|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323231323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 A4p0 uL0","America/Argentina/San_Juan|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323231232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Qn0 qO0 16n0 Rb0 1wp0 TX0 rld0 m10 8lb0 uL0","America/Argentina/San_Luis|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323121212321212|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 XX0 1q20 SL0 AN0 vDb0 m10 8lb0 8L0 jd0 1qN0 WL0 1qN0","America/Argentina/Tucuman|CMT -04 -03 -02|4g.M 40 30 20|0121212121212121212121212121212121212121212323232313232123232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 rlB0 4N0 8BX0 uL0 1qN0 WL0","America/Argentina/Ushuaia|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 rkN0 8p0 8zb0 uL0","America/Curacao|LMT -0430 AST|4z.L 4u 40|012|-2kV7o.d 28KLS.d|15e4","America/Asuncion|AMT -04 -03|3O.E 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-1x589.k 1DKM9.k 3CL0 3Dd0 10L0 1pB0 10n0 1pB0 10n0 1pB0 1cL0 1dd0 1db0 1dd0 1cL0 1dd0 1cL0 1dd0 1cL0 1dd0 1db0 1dd0 1cL0 1dd0 1cL0 1dd0 1cL0 1dd0 1db0 1dd0 1cL0 1lB0 14n0 1dd0 1cL0 1fd0 WL0 1rd0 1aL0 1dB0 Xz0 1qp0 Xb0 1qN0 10L0 1rB0 TX0 1tB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 WN0 1qL0 11B0 1nX0 1ip0 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 TX0 1tB0 19X0 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0|28e5","America/Atikokan|CST CDT CWT CPT EST|60 50 50 50 50|0101234|-25TQ0 1in0 Rnb0 3je0 8x30 iw0|28e2","America/Bahia_Banderas|LMT MST CST PST MDT CDT|71 70 60 80 60 50|0121212131414141414141414141414141414152525252525252525252525252525252525252525252525252525252|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|84e3","America/Bahia|LMT -03 -02|2y.4 30 20|01212121212121212121212121212121212121212121212121212121212121|-2glxp.U HdLp.U 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 l5B0 Rb0|27e5","America/Barbados|LMT BMT AST ADT|3W.t 3W.t 40 30|01232323232|-1Q0I1.v jsM0 1ODC1.v IL0 1ip0 17b0 1ip0 17b0 1ld0 13b0|28e4","America/Belem|LMT -03 -02|3d.U 30 20|012121212121212121212121212121|-2glwK.4 HdKK.4 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0|20e5","America/Belize|LMT CST -0530 CDT|5Q.M 60 5u 50|01212121212121212121212121212121212121212121212121213131|-2kBu7.c fPA7.c Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1f0Mu qn0 lxB0 mn0|57e3","America/Blanc-Sablon|AST ADT AWT APT|40 30 30 30|010230|-25TS0 1in0 UGp0 8x50 iu0|11e2","America/Boa_Vista|LMT -04 -03|42.E 40 30|0121212121212121212121212121212121|-2glvV.k HdKV.k 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 smp0 WL0 1tB0 2L0|62e2","America/Bogota|BMT -05 -04|4U.g 50 40|0121|-2eb73.I 38yo3.I 2en0|90e5","America/Boise|PST PDT MST MWT MPT MDT|80 70 70 60 60 60|0101023425252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-261q0 1nX0 11B0 1nX0 8C10 JCL0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 Dd0 1Kn0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e4","America/Cambridge_Bay|-00 MST MWT MPT MDDT MDT CST CDT EST|0 70 60 60 50 60 60 50 50|0123141515151515151515151515151515151515151515678651515151515151515151515151515151515151515151515151515151515151515151515151|-21Jc0 RO90 8x20 ix0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11A0 1nX0 2K0 WQ0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e2","America/Campo_Grande|LMT -04 -03|3C.s 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwl.w HdLl.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 1C10 Lz0 1Ip0 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0 1HB0 FX0 1HB0 IL0 1HB0 FX0 1HB0 IL0 1EN0 FX0 1HB0 FX0 1HB0 IL0 1EN0 IL0 1HB0 FX0 1HB0 FX0 1HB0 FX0 1HB0 FX0 1HB0 FX0 1Kp0 FX0 1HB0 IL0 1EN0 FX0 1HB0 FX0 1HB0 IL0 1EN0|77e4","America/Cancun|LMT CST EST EDT CDT|5L.4 60 50 40 50|0123232341414141414141414141414141414141412|-1UQG0 2q2o0 yLB0 1lb0 14p0 1lb0 14p0 Lz0 xB0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 Dd0|63e4","America/Caracas|CMT -0430 -04|4r.E 4u 40|01212|-2kV7w.k 28KM2.k 1IwOu kqo0|29e5","America/Cayenne|LMT -04 -03|3t.k 40 30|012|-2mrwu.E 2gWou.E|58e3","America/Panama|CMT EST|5j.A 50|01|-2uduE.o|15e5","America/Chicago|CST CDT EST CWT CPT|60 50 50 50 50|01010101010101010101010101010101010102010101010103401010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 1wp0 TX0 WN0 1qL0 1cN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 11B0 1Hz0 14p0 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|LMT MST CST CDT MDT|74.k 70 60 50 60|0121212323241414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 2zQN0 1lb0 14p0 1lb0 14q0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|81e4","America/Costa_Rica|SJMT CST CDT|5A.d 60 50|0121212121|-1Xd6n.L 2lu0n.L Db0 1Kp0 Db0 pRB0 15b0 1kp0 mL0|12e5","America/Creston|MST PST|70 80|010|-29DR0 43B0|53e2","America/Cuiaba|LMT -04 -03|3I.k 40 30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwf.E HdLf.E 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 4a10 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0 1HB0 FX0 1HB0 IL0 1HB0 FX0 1HB0 IL0 1EN0 FX0 1HB0 FX0 1HB0 IL0 1EN0 IL0 1HB0 FX0 1HB0 FX0 1HB0 FX0 1HB0 FX0 1HB0 FX0 1Kp0 FX0 1HB0 IL0 1EN0 FX0 1HB0 FX0 1HB0 IL0 1EN0|54e4","America/Danmarkshavn|LMT -03 -02 GMT|1e.E 30 20 0|01212121212121212121212121212121213|-2a5WJ.k 2z5fJ.k 19U0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 DC0|8","America/Dawson_Creek|PST PDT PWT PPT MST|80 70 70 70 70|0102301010101010101010101010101010101010101010101010101014|-25TO0 1in0 UGp0 8x10 iy0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 ML0|12e3","America/Dawson|YST YDT YWT YPT YDDT PST PDT|90 80 80 80 70 80 70|0101023040565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-25TN0 1in0 1o10 13V0 Ser0 8x00 iz0 LCL0 1fA0 jrA0 fNd0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|13e2","America/Denver|MST MDT MWT MPT|70 60 60 60|01010101023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261r0 1nX0 11B0 1nX0 11B0 1qL0 WN0 mn0 Ord0 8x20 ix0 LCN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Detroit|LMT CST EST EWT EPT EDT|5w.b 60 50 40 40 40|012342525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-2Cgir.N peqr.N 156L0 8x40 iv0 6fd0 11z0 XQp0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e5","America/Edmonton|LMT MST MDT MWT MPT|7x.Q 70 60 60 60|01212121212121341212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2yd4q.8 shdq.8 1in0 17d0 hz0 2dB0 1fz0 1a10 11z0 1qN0 WL0 1qN0 11z0 IGN0 8x20 ix0 3NB0 11z0 LFB0 1cL0 3Cp0 1cL0 66N0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|10e5","America/Eirunepe|LMT -05 -04|4D.s 50 40|0121212121212121212121212121212121|-2glvk.w HdLk.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 dPB0 On0 yTd0 d5X0|31e3","America/El_Salvador|LMT CST CDT|5U.M 60 50|012121|-1XiG3.c 2Fvc3.c WL0 1qN0 WL0|11e5","America/Tijuana|LMT MST PST PDT PWT PPT|7M.4 70 80 70 70 70|012123245232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQE0 4PX0 8mM0 8lc0 SN0 1cL0 pHB0 83r0 zI0 5O10 1Rz0 cOO0 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 BUp0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|20e5","America/Fort_Nelson|PST PDT PWT PPT MST|80 70 70 70 70|01023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010104|-25TO0 1in0 UGp0 8x10 iy0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0|39e2","America/Fort_Wayne|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|010101023010101010101010101040454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 QI10 Db0 RB0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 5Tz0 1o10 qLb0 1cL0 1cN0 1cL0 1qhd0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Fortaleza|LMT -03 -02|2y 30 20|0121212121212121212121212121212121212121|-2glxq HdLq 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 5z0 2mN0 On0|34e5","America/Glace_Bay|LMT AST ADT AWT APT|3X.M 40 30 30 30|012134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsI0.c CwO0.c 1in0 UGp0 8x50 iu0 iq10 11z0 Jg10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|19e3","America/Godthab|LMT -03 -02|3q.U 30 20|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a5Ux.4 2z5dx.4 19U0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e3","America/Goose_Bay|NST NDT NST NDT NWT NPT AST ADT ADDT|3u.Q 2u.Q 3u 2u 2u 2u 40 30 20|010232323232323245232323232323232323232323232323232323232326767676767676767676767676767676767676767676768676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-25TSt.8 1in0 DXb0 2HbX.8 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 WL0 1qN0 WL0 1qN0 7UHu itu 1tB0 WL0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1tB0 WL0 1ld0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 S10 g0u 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14n1 1lb0 14p0 1nW0 11C0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|76e2","America/Grand_Turk|KMT EST EDT AST|57.a 50 40 40|01212121212121212121212121212121212121212121212121212121212121212121212121232121212121212121212121212121212121212121|-2l1uQ.O 2HHBQ.O 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 5Ip0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Guatemala|LMT CST CDT|62.4 60 50|0121212121|-24KhV.U 2efXV.U An0 mtd0 Nz0 ifB0 17b0 zDB0 11z0|13e5","America/Guayaquil|QMT -05 -04|5e 50 40|0121|-1yVSK 2uILK rz0|27e5","America/Guyana|LMT -0345 -03 -04|3Q.E 3J 30 40|0123|-2dvU7.k 2r6LQ.k Bxbf|80e4","America/Halifax|LMT AST ADT AWT APT|4e.o 40 30 30 30|0121212121212121212121212121212121212121212121212134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsHJ.A xzzJ.A 1db0 3I30 1in0 3HX0 IL0 1E10 ML0 1yN0 Pb0 1Bd0 Mn0 1Bd0 Rz0 1w10 Xb0 1w10 LX0 1w10 Xb0 1w10 Lz0 1C10 Jz0 1E10 OL0 1yN0 Un0 1qp0 Xb0 1qp0 11X0 1w10 Lz0 1HB0 LX0 1C10 FX0 1w10 Xb0 1qp0 Xb0 1BB0 LX0 1td0 Xb0 1qp0 Xb0 Rf0 8x50 iu0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 3Qp0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 3Qp0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 6i10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Havana|HMT CST CDT|5t.A 50 40|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1Meuu.o 72zu.o ML0 sld0 An0 1Nd0 Db0 1Nd0 An0 6Ep0 An0 1Nd0 An0 JDd0 Mn0 1Ap0 On0 1fd0 11X0 1qN0 WL0 1wp0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 14n0 1ld0 14L0 1kN0 15b0 1kp0 1cL0 1cN0 1fz0 1a10 1fz0 1fB0 11z0 14p0 1nX0 11B0 1nX0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 1a10 1in0 1a10 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 17c0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 11A0 6i00 Rc0 1wo0 U00 1tA0 Rc0 1wo0 U00 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/Hermosillo|LMT MST CST PST MDT|7n.Q 70 60 80 60|0121212131414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0|64e4","America/Indiana/Knox|CST CDT CWT CPT EST|60 50 50 50 50|0101023010101010101010101010101010101040101010101010101010101010101010101010101010101010141010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 3Cn0 8wp0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 z8o0 1o00 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Marengo|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101023010101010101010104545454545414545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 dyN0 11z0 6fd0 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 jrz0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1VA0 LA0 1BX0 1e6p0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Petersburg|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010104010101010101010101010141014545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 njX0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 3Fb0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 19co0 1o00 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Tell_City|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010454541010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 g0p0 11z0 1o10 11z0 1qL0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 caL0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Vevay|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|010102304545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 kPB0 Awn0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1lnd0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Vincennes|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010454541014545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 g0p0 11z0 1o10 11z0 1qL0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 caL0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Winamac|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010101010454541054545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 jrz0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1za0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Inuvik|-00 PST PDDT MST MDT|0 80 60 70 60|0121343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-FnA0 tWU0 1fA0 wPe0 2pz0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|35e2","America/Iqaluit|-00 EWT EPT EST EDDT EDT CST CDT|0 40 40 50 30 40 60 50|01234353535353535353535353535353535353535353567353535353535353535353535353535353535353535353535353535353535353535353535353|-16K00 7nX0 iv0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11C0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|67e2","America/Jamaica|KMT EST EDT|57.a 50 40|0121212121212121212121|-2l1uQ.O 2uM1Q.O 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0|94e4","America/Juneau|PST PWT PPT PDT YDT YST AKST AKDT|80 70 70 70 80 90 90 80|01203030303030303030303030403030356767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cM0 1cM0 1cL0 1cN0 1fz0 1a10 1fz0 co0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|33e3","America/Kentucky/Louisville|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101010102301010101010101010101010101454545454545414545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 3Fd0 Nb0 LPd0 11z0 RB0 8x30 iw0 Bb0 10N0 2bB0 8in0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 xz0 gso0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1VA0 LA0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Kentucky/Monticello|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101023010101010101010101010101010101010101010101010101010101010101010101454545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 SWp0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/La_Paz|CMT BST -04|4w.A 3w.A 40|012|-1x37r.o 13b0|19e5","America/Lima|LMT -05 -04|58.A 50 40|0121212121212121|-2tyGP.o 1bDzP.o zX0 1aN0 1cL0 1cN0 1cL0 1PrB0 zX0 1O10 zX0 6Gp0 zX0 98p0 zX0|11e6","America/Los_Angeles|PST PDT PWT PPT|80 70 70 70|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261q0 1nX0 11B0 1nX0 SgN0 8x10 iy0 5Wp1 1VaX 3dA0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/Maceio|LMT -03 -02|2m.Q 30 20|012121212121212121212121212121212121212121|-2glxB.8 HdLB.8 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 dMN0 Lz0 8Q10 WL0 1tB0 5z0 2mN0 On0|93e4","America/Managua|MMT CST EST CDT|5J.c 60 50 50|0121313121213131|-1quie.M 1yAMe.M 4mn0 9Up0 Dz0 1K10 Dz0 s3F0 1KH0 DB0 9In0 k8p0 19X0 1o30 11y0|22e5","America/Manaus|LMT -04 -03|40.4 40 30|01212121212121212121212121212121|-2glvX.U HdKX.U 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 dPB0 On0|19e5","America/Martinique|FFMT AST ADT|44.k 40 30|0121|-2mPTT.E 2LPbT.E 19X0|39e4","America/Matamoros|LMT CST CDT|6E 60 50|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1UQG0 2FjC0 1nX0 i6p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|45e4","America/Mazatlan|LMT MST CST PST MDT|75.E 70 60 80 60|0121212131414141414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|44e4","America/Menominee|CST CDT CWT CPT EST|60 50 50 50 50|01010230101041010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 LCN0 1fz0 6410 9Jb0 1cM0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|85e2","America/Merida|LMT CST EST CDT|5W.s 60 50 50|0121313131313131313131313131313131313131313131313131313131313131313131313131313131313131|-1UQG0 2q2o0 2hz0 wu30 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|11e5","America/Metlakatla|PST PWT PPT PDT AKST AKDT|80 70 70 70 90 80|0120303030303030303030303030303030454545454545454545454545454545454545454545454|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1hU10 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Mexico_City|LMT MST CST CDT CWT|6A.A 70 60 50 50|012121232324232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 gEn0 TX0 3xd0 Jb0 6zB0 SL0 e5d0 17b0 1Pff0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|20e6","America/Miquelon|LMT AST -03 -02|3I.E 40 30 20|012323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2mKkf.k 2LTAf.k gQ10 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Moncton|EST AST ADT AWT APT|50 40 30 30 30|012121212121212121212134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsH0 CwN0 1in0 zAo0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1K10 Lz0 1zB0 NX0 1u10 Wn0 S20 8x50 iu0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 3Cp0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14n1 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 ReX 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|64e3","America/Monterrey|LMT CST CDT|6F.g 60 50|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1UQG0 2FjC0 1nX0 i6p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|41e5","America/Montevideo|LMT MMT -04 -03 -0330 -0230 -02 -0130|3I.P 3I.P 40 30 3u 2u 20 1u|012343434343434343434343435353636353636375363636363636363636363636363636363636363636363|-2tRUf.9 sVc0 8jcf.9 1db0 1dcu 1cLu 1dcu 1cLu ircu 11zu 1o0u 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 1qMu WLu 1fAu 1cLu 1o0u 11zu NAu 3jXu zXu Dq0u 19Xu pcu jz0 cm10 19X0 6tB0 1fbu 3o0u jX0 4vB0 xz0 3Cp0 mmu 1a10 IMu Db0 4c10 uL0 1Nd0 An0 1SN0 uL0 mp0 28L0 iPB0 un0 1SN0 xz0 1zd0 Lz0 1zd0 Rb0 1zd0 On0 1wp0 Rb0 s8p0 1fB0 1ip0 11z0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0|17e5","America/Toronto|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101012301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TR0 1in0 11Wu 1nzu 1fD0 WJ0 1wr0 Nb0 1Ap0 On0 1zd0 On0 1wp0 TX0 1tB0 TX0 1tB0 TX0 1tB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 4kM0 8x40 iv0 1o10 11z0 1nX0 11z0 1o10 11z0 1o10 1qL0 11D0 1nX0 11B0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|65e5","America/Nassau|LMT EST EDT|59.u 50 40|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2kNuO.u 26XdO.u 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|24e4","America/New_York|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 11B0 1qL0 1a10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x40 iv0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Nipigon|EST EDT EWT EPT|50 40 40 40|010123010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TR0 1in0 Rnb0 3je0 8x40 iv0 19yN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|16e2","America/Nome|NST NWT NPT BST BDT YST AKST AKDT|b0 a0 a0 b0 a0 90 90 80|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17SX0 8wW0 iB0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cl0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|38e2","America/Noronha|LMT -02 -01|29.E 20 10|0121212121212121212121212121212121212121|-2glxO.k HdKO.k 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 2L0 2pB0 On0|30e2","America/North_Dakota/Beulah|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101014545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/North_Dakota/Center|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101014545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14o0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/North_Dakota/New_Salem|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101454545454545454545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14o0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Ojinaga|LMT MST CST CDT MDT|6V.E 70 60 50 60|0121212323241414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 2zQN0 1lb0 14p0 1lb0 14q0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e3","America/Pangnirtung|-00 AST AWT APT ADDT ADT EDT EST CST CDT|0 40 30 30 20 30 40 50 60 50|012314151515151515151515151515151515167676767689767676767676767676767676767676767676767676767676767676767676767676767676767|-1XiM0 PnG0 8x50 iu0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1o00 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11C0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Paramaribo|LMT PMT PMT -0330 -03|3E.E 3E.Q 3E.A 3u 30|01234|-2nDUj.k Wqo0.c qanX.I 1yVXN.o|24e4","America/Phoenix|MST MDT MWT|70 60 60|01010202010|-261r0 1nX0 11B0 1nX0 SgN0 4Al1 Ap0 1db0 SWqX 1cL0|42e5","America/Port-au-Prince|PPMT EST EDT|4N 50 40|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-28RHb 2FnMb 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14q0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 i6n0 1nX0 11B0 1nX0 d430 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 3iN0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","America/Rio_Branco|LMT -05 -04|4v.c 50 40|01212121212121212121212121212121|-2glvs.M HdLs.M 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 NBd0 d5X0|31e4","America/Porto_Velho|LMT -04 -03|4f.A 40 30|012121212121212121212121212121|-2glvI.o HdKI.o 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0|37e4","America/Puerto_Rico|AST AWT APT|40 30 30|0120|-17lU0 7XT0 iu0|24e5","America/Punta_Arenas|SMT -05 -04 -03|4G.K 50 40 30|0102021212121212121232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-2q2jh.e fJAh.e 5knG.K 1Vzh.e jRAG.K 1pbh.e 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 nHX0 op0 blz0 ko0 Qeo0 WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0","America/Rainy_River|CST CDT CWT CPT|60 50 50 50|010123010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TQ0 1in0 Rnb0 3je0 8x30 iw0 19yN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|842","America/Rankin_Inlet|-00 CST CDDT CDT EST|0 60 40 50 50|012131313131313131313131313131313131313131313431313131313131313131313131313131313131313131313131313131313131313131313131|-vDc0 keu0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e2","America/Recife|LMT -03 -02|2j.A 30 20|0121212121212121212121212121212121212121|-2glxE.o HdLE.o 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 2L0 2pB0 On0|33e5","America/Regina|LMT MST MDT MWT MPT CST|6W.A 70 60 60 60 60|012121212121212121212121341212121212121212121212121215|-2AD51.o uHe1.o 1in0 s2L0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 66N0 1cL0 1cN0 19X0 1fB0 1cL0 1fB0 1cL0 1cN0 1cL0 M30 8x20 ix0 1ip0 1cL0 1ip0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 3NB0 1cL0 1cN0|19e4","America/Resolute|-00 CST CDDT CDT EST|0 60 40 50 50|012131313131313131313131313131313131313131313431313131313431313131313131313131313131313131313131313131313131313131313131|-SnA0 GWS0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|229","America/Santarem|LMT -04 -03|3C.M 40 30|0121212121212121212121212121212|-2glwl.c HdLl.c 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 NBd0|21e4","America/Santiago|SMT -05 -04 -03|4G.K 50 40 30|010202121212121212321232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-2q2jh.e fJAh.e 5knG.K 1Vzh.e jRAG.K 1pbh.e 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 nHX0 op0 9Bz0 jb0 1oN0 ko0 Qeo0 WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|62e5","America/Santo_Domingo|SDMT EST EDT -0430 AST|4E 50 40 4u 40|01213131313131414|-1ttjk 1lJMk Mn0 6sp0 Lbu 1Cou yLu 1RAu wLu 1QMu xzu 1Q0u xXu 1PAu 13jB0 e00|29e5","America/Sao_Paulo|LMT -03 -02|36.s 30 20|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwR.w HdKR.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 pTd0 PX0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 1C10 Lz0 1Ip0 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0 1HB0 FX0 1HB0 IL0 1HB0 FX0 1HB0 IL0 1EN0 FX0 1HB0 FX0 1HB0 IL0 1EN0 IL0 1HB0 FX0 1HB0 FX0 1HB0 FX0 1HB0 FX0 1HB0 FX0 1Kp0 FX0 1HB0 IL0 1EN0 FX0 1HB0 FX0 1HB0 IL0 1EN0|20e6","America/Scoresbysund|LMT -02 -01 +00|1r.Q 20 10 0|0121323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2a5Ww.8 2z5ew.8 1a00 1cK0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|452","America/Sitka|PST PWT PPT PDT YST AKST AKDT|80 70 70 70 90 90 80|01203030303030303030303030303030345656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 co0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|90e2","America/St_Johns|NST NDT NST NDT NWT NPT NDDT|3u.Q 2u.Q 3u 2u 2u 2u 1u|01010101010101010101010101010101010102323232323232324523232323232323232323232323232323232323232323232323232323232323232323232323232323232326232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-28oit.8 14L0 1nB0 1in0 1gm0 Dz0 1JB0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1fB0 19X0 1fB0 19X0 10O0 eKX.8 19X0 1iq0 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 WL0 1qN0 WL0 1qN0 7UHu itu 1tB0 WL0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1tB0 WL0 1ld0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14n1 1lb0 14p0 1nW0 11C0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","America/Swift_Current|LMT MST MDT MWT MPT CST|7b.k 70 60 60 60 60|012134121212121212121215|-2AD4M.E uHdM.E 1in0 UGp0 8x20 ix0 1o10 17b0 1ip0 11z0 1o10 11z0 1o10 11z0 isN0 1cL0 3Cp0 1cL0 1cN0 11z0 1qN0 WL0 pMp0|16e3","America/Tegucigalpa|LMT CST CDT|5M.Q 60 50|01212121|-1WGGb.8 2ETcb.8 WL0 1qN0 WL0 GRd0 AL0|11e5","America/Thule|LMT AST ADT|4z.8 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a5To.Q 31NBo.Q 1cL0 1cN0 1cL0 1fB0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|656","America/Thunder_Bay|CST EST EWT EPT EDT|60 50 40 40 40|0123141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141|-2q5S0 1iaN0 8x40 iv0 XNB0 1cL0 1cN0 1fz0 1cN0 1cL0 3Cp0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","America/Vancouver|PST PDT PWT PPT|80 70 70 70|0102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TO0 1in0 UGp0 8x10 iy0 1o10 17b0 1ip0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","America/Whitehorse|YST YDT YWT YPT YDDT PST PDT|90 80 80 80 70 80 70|0101023040565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-25TN0 1in0 1o10 13V0 Ser0 8x00 iz0 LCL0 1fA0 3NA0 vrd0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e3","America/Winnipeg|CST CDT CWT CPT|60 50 50 50|010101023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aIi0 WL0 3ND0 1in0 Jap0 Rb0 aCN0 8x30 iw0 1tB0 11z0 1ip0 11z0 1o10 11z0 1o10 11z0 1rd0 10L0 1op0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 1cL0 1cN0 11z0 6i10 WL0 6i10 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|66e4","America/Yakutat|YST YWT YPT YDT AKST AKDT|90 80 80 80 90 80|01203030303030303030303030303030304545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-17T10 8x00 iz0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cn0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|642","America/Yellowknife|-00 MST MWT MPT MDDT MDT|0 70 60 60 50 60|012314151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151|-1pdA0 hix0 8x20 ix0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|19e3","Antarctica/Casey|-00 +08 +11|0 -80 -b0|01212121|-2q00 1DjS0 T90 40P0 KL0 blz0 3m10|10","Antarctica/Davis|-00 +07 +05|0 -70 -50|01012121|-vyo0 iXt0 alj0 1D7v0 VB0 3Wn0 KN0|70","Antarctica/DumontDUrville|-00 +10|0 -a0|0101|-U0o0 cfq0 bFm0|80","Antarctica/Macquarie|AEST AEDT -00 +11|-a0 -b0 0 -b0|0102010101010101010101010101010101010101010101010101010101010101010101010101010101010101013|-29E80 19X0 4SL0 1ayy0 Lvs0 1cM0 1o00 Rc0 1wo0 Rc0 1wo0 U00 1wo0 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0|1","Antarctica/Mawson|-00 +06 +05|0 -60 -50|012|-CEo0 2fyk0|60","Pacific/Auckland|NZMT NZST NZST NZDT|-bu -cu -c0 -d0|01020202020202020202020202023232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-1GCVu Lz0 1tB0 11zu 1o0u 11zu 1o0u 11zu 1o0u 14nu 1lcu 14nu 1lcu 1lbu 11Au 1nXu 11Au 1nXu 11Au 1nXu 11Au 1nXu 11Au 1qLu WMu 1qLu 11Au 1n1bu IM0 1C00 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1qM0 14o0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1io0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|14e5","Antarctica/Palmer|-00 -03 -04 -02|0 30 40 20|0121212121213121212121212121212121212121212121212121212121212121212121212121212121|-cao0 nD0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 jsN0 14N0 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0|40","Antarctica/Rothera|-00 -03|0 30|01|gOo0|130","Antarctica/Syowa|-00 +03|0 -30|01|-vs00|20","Antarctica/Troll|-00 +00 +02|0 0 -20|01212121212121212121212121212121212121212121212121212121212121212121|1puo0 hd0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|40","Antarctica/Vostok|-00 +06|0 -60|01|-tjA0|25","Europe/Oslo|CET CEST|-10 -20|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2awM0 Qm0 W6o0 5pf0 WM0 1fA0 1cM0 1cM0 1cM0 1cM0 wJc0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1qM0 WM0 zpc0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|62e4","Asia/Riyadh|LMT +03|-36.Q -30|01|-TvD6.Q|57e5","Asia/Almaty|LMT +05 +06 +07|-57.M -50 -60 -70|012323232323232323232321232323232323232323232323232|-1Pc57.M eUo7.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0|15e5","Asia/Amman|LMT EET EEST|-2n.I -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1yW2n.I 1HiMn.I KL0 1oN0 11b0 1oN0 11b0 1pd0 1dz0 1cp0 11b0 1op0 11b0 fO10 1db0 1e10 1cL0 1cN0 1cL0 1cN0 1fz0 1pd0 10n0 1ld0 14n0 1hB0 15b0 1ip0 19X0 1cN0 1cL0 1cN0 17b0 1ld0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1So0 y00 1fc0 1dc0 1co0 1dc0 1cM0 1cM0 1cM0 1o00 11A0 1lc0 17c0 1cM0 1cM0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|25e5","Asia/Anadyr|LMT +12 +13 +14 +11|-bN.U -c0 -d0 -e0 -b0|01232121212121212121214121212121212121212121212121212121212141|-1PcbN.U eUnN.U 23CL0 1db0 2q10 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|13e3","Asia/Aqtau|LMT +04 +05 +06|-3l.4 -40 -50 -60|012323232323232323232123232312121212121212121212|-1Pc3l.4 eUnl.4 24PX0 2pX0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|15e4","Asia/Aqtobe|LMT +04 +05 +06|-3M.E -40 -50 -60|0123232323232323232321232323232323232323232323232|-1Pc3M.E eUnM.E 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0|27e4","Asia/Ashgabat|LMT +04 +05 +06|-3R.w -40 -50 -60|0123232323232323232323212|-1Pc3R.w eUnR.w 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0|41e4","Asia/Atyrau|LMT +03 +05 +06 +04|-3r.I -30 -50 -60 -40|01232323232323232323242323232323232324242424242|-1Pc3r.I eUor.I 24PW0 2pX0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 2sp0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0","Asia/Baghdad|BMT +03 +04|-2V.A -30 -40|012121212121212121212121212121212121212121212121212121|-26BeV.A 2ACnV.A 11b0 1cp0 1dz0 1dd0 1db0 1cN0 1cp0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1de0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0|66e5","Asia/Qatar|LMT +04 +03|-3q.8 -40 -30|012|-21Jfq.8 27BXq.8|96e4","Asia/Baku|LMT +03 +04 +05|-3j.o -30 -40 -50|01232323232323232323232123232323232323232323232323232323232323232|-1Pc3j.o 1jUoj.o WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 1cM0 9Je0 1o00 11z0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|27e5","Asia/Bangkok|BMT +07|-6G.4 -70|01|-218SG.4|15e6","Asia/Barnaul|LMT +06 +07 +08|-5z -60 -70 -80|0123232323232323232323212323232321212121212121212121212121212121212|-21S5z pCnz 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 p90 LE0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0","Asia/Beirut|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-21aq0 1on0 1410 1db0 19B0 1in0 1ip0 WL0 1lQp0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 q6N0 En0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1op0 11b0 dA10 17b0 1iN0 17b0 1iN0 17b0 1iN0 17b0 1vB0 SL0 1mp0 13z0 1iN0 17b0 1iN0 17b0 1jd0 12n0 1a10 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0|22e5","Asia/Bishkek|LMT +05 +06 +07|-4W.o -50 -60 -70|012323232323232323232321212121212121212121212121212|-1Pc4W.o eUnW.o 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2e00 1tX0 17b0 1ip0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1cPu 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0|87e4","Asia/Brunei|LMT +0730 +08|-7D.E -7u -80|012|-1KITD.E gDc9.E|42e4","Asia/Kolkata|MMT IST +0630|-5l.a -5u -6u|012121|-2zOtl.a 1r2LP.a 1un0 HB0 7zX0|15e6","Asia/Chita|LMT +08 +09 +10|-7x.Q -80 -90 -a0|012323232323232323232321232323232323232323232323232323232323232312|-21Q7x.Q pAnx.Q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3re0|33e4","Asia/Choibalsan|LMT +07 +08 +10 +09|-7C -70 -80 -a0 -90|0123434343434343434343434343434343434343434343424242|-2APHC 2UkoC cKn0 1da0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 3Db0 h1f0 1cJ0 1cP0 1cJ0|38e3","Asia/Shanghai|CST CDT|-80 -90|01010101010101010|-1c1I0 LX0 16p0 1jz0 1Myp0 Rb0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0|23e6","Asia/Colombo|MMT +0530 +06 +0630|-5j.w -5u -60 -6u|01231321|-2zOtj.w 1rFbN.w 1zzu 7Apu 23dz0 11zu n3cu|22e5","Asia/Dhaka|HMT +0630 +0530 +06 +07|-5R.k -6u -5u -60 -70|0121343|-18LFR.k 1unn.k HB0 m6n0 2kxbu 1i00|16e6","Asia/Damascus|LMT EET EEST|-2p.c -20 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-21Jep.c Hep.c 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1xRB0 11X0 1oN0 10L0 1pB0 11b0 1oN0 10L0 1mp0 13X0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 Nb0 1AN0 Nb0 bcp0 19X0 1gp0 19X0 3ld0 1xX0 Vd0 1Bz0 Sp0 1vX0 10p0 1dz0 1cN0 1cL0 1db0 1db0 1g10 1an0 1ap0 1db0 1fd0 1db0 1cN0 1db0 1dd0 1db0 1cp0 1dz0 1c10 1dX0 1cN0 1db0 1dd0 1db0 1cN0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1db0 1cN0 1db0 1cN0 19z0 1fB0 1qL0 11B0 1on0 Wp0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0|26e5","Asia/Dili|LMT +08 +09|-8m.k -80 -90|01212|-2le8m.k 1dnXm.k 1nfA0 Xld0|19e4","Asia/Dubai|LMT +04|-3F.c -40|01|-21JfF.c|39e5","Asia/Dushanbe|LMT +05 +06 +07|-4z.c -50 -60 -70|012323232323232323232321|-1Pc4z.c eUnz.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2hB0|76e4","Asia/Famagusta|LMT EET EEST +03|-2f.M -20 -30 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212312121212121212121212121212121212121212121|-1Vc2f.M 2a3cf.M 1cL0 1qp0 Xz0 19B0 19X0 1fB0 1db0 1cp0 1cL0 1fB0 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1o30 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 15U0 2Ks0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Gaza|EET EEST IST IDT|-20 -30 -20 -30|010101010101010101010101010101012323232323232323232323232320101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1c2q0 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 pBd0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 dW0 hfB0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 M10 C00 17c0 1io0 17c0 1io0 17c0 1o00 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 17c0 1io0 18N0 1bz0 19z0 1gp0 1610 1iL0 11z0 1o10 14o0 1lA1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1qL0|18e5","Asia/Hebron|EET EEST IST IDT|-20 -30 -20 -30|01010101010101010101010101010101232323232323232323232323232010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1c2q0 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 pBd0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 dW0 hfB0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 M10 C00 17c0 1io0 17c0 1io0 17c0 1o00 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 17c0 1io0 18N0 1bz0 19z0 1gp0 1610 1iL0 12L0 1mN0 14o0 1lc0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1qL0|25e4","Asia/Ho_Chi_Minh|LMT PLMT +07 +08 +09|-76.E -76.u -70 -80 -90|0123423232|-2yC76.E bK00.a 1h7b6.u 5lz0 18o0 3Oq0 k5b0 aW00 BAM0|90e5","Asia/Hong_Kong|LMT HKT HKST JST|-7A.G -80 -90 -90|0121312121212121212121212121212121212121212121212121212121212121212121|-2CFHA.G 1sEP6.G 1cL0 ylu 93X0 1qQu 1tX0 Rd0 1In0 NB0 1cL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1kL0 14N0 1nX0 U10 1tz0 U10 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 Rd0 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 17d0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1cL0 6fd0 14n0|73e5","Asia/Hovd|LMT +06 +07 +08|-66.A -60 -70 -80|012323232323232323232323232323232323232323232323232|-2APG6.A 2Uko6.A cKn0 1db0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 kEp0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|IMT +07 +08 +09|-6V.5 -70 -80 -90|01232323232323232323232123232323232323232323232323232323232323232|-21zGV.5 pjXV.5 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|60e4","Europe/Istanbul|IMT EET EEST +04 +03|-1U.U -20 -30 -40 -30|012121212121212121212121212121212121212121212121212121234343434342121212121212121212121212121212121212121212121212121212121212124|-2ogNU.U dzzU.U 11b0 8tB0 1on0 1410 1db0 19B0 1in0 3Rd0 Un0 1oN0 11b0 zSp0 CL0 mN0 1Vz0 1gN0 1pz0 5Rd0 1fz0 1yp0 ML0 1kp0 17b0 1ip0 17b0 1fB0 19X0 1jB0 18L0 1ip0 17z0 qdd0 xX0 3S10 Tz0 dA10 11z0 1o10 11z0 1qN0 11z0 1ze0 11B0 WM0 1qO0 WI0 1nX0 1rB0 10L0 11B0 1in0 17d0 1in0 2pX0 19E0 1fU0 16Q0 1iI0 16Q0 1iI0 1Vd0 pb0 3Kp0 14o0 1de0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1a00 1fA0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WO0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1tA0 U00 15w0|13e6","Asia/Jakarta|BMT +0720 +0730 +09 +08 WIB|-77.c -7k -7u -90 -80 -70|01232425|-1Q0Tk luM0 mPzO 8vWu 6kpu 4PXu xhcu|31e6","Asia/Jayapura|LMT +09 +0930 WIT|-9m.M -90 -9u -90|0123|-1uu9m.M sMMm.M L4nu|26e4","Asia/Jerusalem|JMT IST IDT IDDT|-2k.E -20 -30 -40|01212121212132121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-26Bek.E SyMk.E 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 3LB0 Em0 or0 1cn0 1dB0 16n0 10O0 1ja0 1tC0 14o0 1cM0 1a00 11A0 1Na0 An0 1MP0 AJ0 1Kp0 LC0 1oo0 Wl0 EQN0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 1hB0 1dX0 1ep0 1aL0 1eN0 17X0 1nf0 11z0 1tB0 19W0 1e10 17b0 1ep0 1gL0 18N0 1fz0 1eN0 17b0 1gq0 1gn0 19d0 1dz0 1c10 17X0 1hB0 1gn0 19d0 1dz0 1c10 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0|81e4","Asia/Kabul|+04 +0430|-40 -4u|01|-10Qs0|46e5","Asia/Kamchatka|LMT +11 +12 +13|-ay.A -b0 -c0 -d0|012323232323232323232321232323232323232323232323232323232323212|-1SLKy.A ivXy.A 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|18e4","Asia/Karachi|LMT +0530 +0630 +05 PKT PKST|-4s.c -5u -6u -50 -50 -60|012134545454|-2xoss.c 1qOKW.c 7zX0 eup0 LqMu 1fy00 1cL0 dK10 11b0 1610 1jX0|24e6","Asia/Urumqi|LMT +06|-5O.k -60|01|-1GgtO.k|32e5","Asia/Kathmandu|LMT +0530 +0545|-5F.g -5u -5J|012|-21JhF.g 2EGMb.g|12e5","Asia/Khandyga|LMT +08 +09 +10 +11|-92.d -80 -90 -a0 -b0|0123232323232323232323212323232323232323232323232343434343434343432|-21Q92.d pAp2.d 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 qK0 yN0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 17V0 7zD0|66e2","Asia/Krasnoyarsk|LMT +06 +07 +08|-6b.q -60 -70 -80|01232323232323232323232123232323232323232323232323232323232323232|-21Hib.q prAb.q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|10e5","Asia/Kuala_Lumpur|SMT +07 +0720 +0730 +09 +08|-6T.p -70 -7k -7u -90 -80|0123435|-2Bg6T.p 17anT.p l5XE 17bO 8Fyu 1so1u|71e5","Asia/Kuching|LMT +0730 +08 +0820 +09|-7l.k -7u -80 -8k -90|0123232323232323242|-1KITl.k gDbP.k 6ynu AnE 1O0k AnE 1NAk AnE 1NAk AnE 1NAk AnE 1O0k AnE 1NAk AnE pAk 8Fz0|13e4","Asia/Macau|LMT CST CDT|-7y.k -80 -90|012121212121212121212121212121212121212121|-2le80 1XO3u 1wn0 Rd0 1wn0 R9u 1wqu U10 1tz0 TVu 1tz0 17gu 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cJu 1cL0 1cN0 1fz0 1cN0 1cOu 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cJu 1cL0 1cN0 1fz0 1cN0 1cL0|57e4","Asia/Magadan|LMT +10 +11 +12|-a3.c -a0 -b0 -c0|012323232323232323232321232323232323232323232323232323232323232312|-1Pca3.c eUo3.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3Cq0|95e3","Asia/Makassar|LMT MMT +08 +09 WITA|-7V.A -7V.A -80 -90 -80|01234|-21JjV.A vfc0 myLV.A 8ML0|15e5","Asia/Manila|+08 +09|-80 -90|010101010|-1kJI0 AL0 cK10 65X0 mXB0 vX0 VK10 1db0|24e6","Asia/Nicosia|LMT EET EEST|-2d.s -20 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1Vc2d.s 2a3cd.s 1cL0 1qp0 Xz0 19B0 19X0 1fB0 1db0 1cp0 1cL0 1fB0 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1o30 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|32e4","Asia/Novokuznetsk|LMT +06 +07 +08|-5M.M -60 -70 -80|012323232323232323232321232323232323232323232323232323232323212|-1PctM.M eULM.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|55e4","Asia/Novosibirsk|LMT +06 +07 +08|-5v.E -60 -70 -80|0123232323232323232323212323212121212121212121212121212121212121212|-21Qnv.E pAFv.E 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 ml0 Os0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 4eN0|15e5","Asia/Omsk|LMT +05 +06 +07|-4R.u -50 -60 -70|01232323232323232323232123232323232323232323232323232323232323232|-224sR.u pMLR.u 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|12e5","Asia/Oral|LMT +03 +05 +06 +04|-3p.o -30 -50 -60 -40|01232323232323232424242424242424242424242424242|-1Pc3p.o eUop.o 23CK0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 1cM0 IM0 1EM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|27e4","Asia/Pontianak|LMT PMT +0730 +09 +08 WITA WIB|-7h.k -7h.k -7u -90 -80 -80 -70|012324256|-2ua7h.k XE00 munL.k 8Rau 6kpu 4PXu xhcu Wqnu|23e4","Asia/Pyongyang|LMT KST JST KST|-8n -8u -90 -90|012313|-2um8n 97XR 1lTzu 2Onc0 6BAu|29e5","Asia/Qyzylorda|LMT +04 +05 +06|-4l.Q -40 -50 -60|0123232323232323232323232323232323232323232323|-1Pc4l.Q eUol.Q 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 3ao0 1EM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|73e4","Asia/Rangoon|RMT +0630 +09|-6o.L -6u -90|0121|-21Jio.L SmnS.L 7j9u|48e5","Asia/Sakhalin|LMT +09 +11 +12 +10|-9u.M -90 -b0 -c0 -a0|01232323232323232323232423232323232424242424242424242424242424242|-2AGVu.M 1BoMu.M 1qFa0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 2pB0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0|58e4","Asia/Samarkand|LMT +04 +05 +06|-4r.R -40 -50 -60|01232323232323232323232|-1Pc4r.R eUor.R 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0|36e4","Asia/Seoul|LMT KST JST KST KDT KDT|-8r.Q -8u -90 -90 -9u -a0|0123141414141414135353|-2um8r.Q 97XV.Q 1m1zu kKo0 2I0u OL0 1FB0 Rb0 1qN0 TX0 1tB0 TX0 1tB0 TX0 1tB0 TX0 2ap0 12FBu 11A0 1o00 11A0|23e6","Asia/Srednekolymsk|LMT +10 +11 +12|-ae.Q -a0 -b0 -c0|01232323232323232323232123232323232323232323232323232323232323232|-1Pcae.Q eUoe.Q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|35e2","Asia/Taipei|CST JST CDT|-80 -90 -90|01020202020202020202020202020202020202020|-1iw80 joM0 1yo0 Tz0 1ip0 1jX0 1cN0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 10N0 1BX0 10p0 1pz0 10p0 1pz0 10p0 1db0 1dd0 1db0 1cN0 1db0 1cN0 1db0 1cN0 1db0 1BB0 ML0 1Bd0 ML0 uq10 1db0 1cN0 1db0 97B0 AL0|74e5","Asia/Tashkent|LMT +05 +06 +07|-4B.b -50 -60 -70|012323232323232323232321|-1Pc4B.b eUnB.b 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0|23e5","Asia/Tbilisi|TBMT +03 +04 +05|-2X.b -30 -40 -50|0123232323232323232323212121232323232323232323212|-1Pc2X.b 1jUnX.b WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 1cK0 1cL0 1cN0 1cL0 1cN0 2pz0 1cL0 1fB0 3Nz0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 An0 Os0 WM0|11e5","Asia/Tehran|LMT TMT +0330 +04 +05 +0430|-3p.I -3p.I -3u -40 -50 -4u|01234325252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-2btDp.I 1d3c0 1huLT.I TXu 1pz0 sN0 vAu 1cL0 1dB0 1en0 pNB0 UL0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 64p0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0|14e6","Asia/Thimphu|LMT +0530 +06|-5W.A -5u -60|012|-Su5W.A 1BGMs.A|79e3","Asia/Tokyo|JST JDT|-90 -a0|010101010|-QJJ0 Rb0 1ld0 14n0 1zd0 On0 1zd0 On0|38e6","Asia/Tomsk|LMT +06 +07 +08|-5D.P -60 -70 -80|0123232323232323232323212323232323232323232323212121212121212121212|-21NhD.P pxzD.P 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 co0 1bB0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3Qp0|10e5","Asia/Ulaanbaatar|LMT +07 +08 +09|-77.w -70 -80 -90|012323232323232323232323232323232323232323232323232|-2APH7.w 2Uko7.w cKn0 1db0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 kEp0 1cJ0 1cP0 1cJ0|12e5","Asia/Ust-Nera|LMT +08 +09 +12 +11 +10|-9w.S -80 -90 -c0 -b0 -a0|012343434343434343434345434343434343434343434343434343434343434345|-21Q9w.S pApw.S 23CL0 1d90 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 17V0 7zD0|65e2","Asia/Vladivostok|LMT +09 +10 +11|-8L.v -90 -a0 -b0|01232323232323232323232123232323232323232323232323232323232323232|-1SJIL.v itXL.v 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|60e4","Asia/Yakutsk|LMT +08 +09 +10|-8C.W -80 -90 -a0|01232323232323232323232123232323232323232323232323232323232323232|-21Q8C.W pAoC.W 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|28e4","Asia/Yekaterinburg|LMT PMT +04 +05 +06|-42.x -3J.5 -40 -50 -60|012343434343434343434343234343434343434343434343434343434343434343|-2ag42.x 7mQh.s qBvJ.5 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|14e5","Asia/Yerevan|LMT +03 +04 +05|-2W -30 -40 -50|0123232323232323232323212121212323232323232323232323232323232|-1Pc2W 1jUnW WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 4RX0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|13e5","Atlantic/Azores|HMT -02 -01 +00 WET|1S.w 20 10 0 0|01212121212121212121212121212121212121212121232123212321232121212121212121212121212121212121212121232323232323232323232323232323234323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2ldW0 aPX0 Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 qIl0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|25e4","Atlantic/Bermuda|LMT AST ADT|4j.i 40 30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1BnRE.G 1LTbE.G 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|65e3","Atlantic/Canary|LMT -01 WET WEST|11.A 10 0 -10|01232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UtaW.o XPAW.o 1lAK0 1a10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Atlantic/Cape_Verde|LMT -02 -01|1y.4 20 10|01212|-2ldW0 1eEo0 7zX0 1djf0|50e4","Atlantic/Faroe|LMT WET WEST|r.4 0 -10|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2uSnw.U 2Wgow.U 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|49e3","Atlantic/Madeira|FMT -01 +00 +01 WET WEST|17.A 10 0 -10 0 -10|01212121212121212121212121212121212121212121232123212321232121212121212121212121212121212121212121454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2ldX0 aPX0 Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 qIl0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e4","Atlantic/Reykjavik|LMT -01 +00 GMT|1s 10 0 0|012121212121212121212121212121212121212121212121212121212121212121213|-2uWmw mfaw 1Bd0 ML0 1LB0 Cn0 1LB0 3fX0 C10 HrX0 1cO0 LB0 1EL0 LA0 1C00 Oo0 1wo0 Rc0 1wo0 Rc0 1wo0 Rc0 1zc0 Oo0 1zc0 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0|12e4","Atlantic/South_Georgia|-02|20|0||30","Atlantic/Stanley|SMT -04 -03 -02|3P.o 40 30 20|012121212121212323212121212121212121212121212121212121212121212121212|-2kJw8.A 12bA8.A 19X0 1fB0 19X0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 Cn0 1Cc10 WL0 1qL0 U10 1tz0 2mN0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1tz0 U10 1tz0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1tz0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qN0 U10 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 U10 1tz0 U10 1tz0 U10|21e2","Australia/Sydney|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|40e5","Australia/Adelaide|ACST ACDT|-9u -au|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 Oo0 1zc0 WM0 1qM0 Rc0 1zc0 U00 1tA0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|11e5","Australia/Brisbane|AEST AEDT|-a0 -b0|01010101010101010|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 H1A0 Oo0 1zc0 Oo0 1zc0 Oo0|20e5","Australia/Broken_Hill|ACST ACDT|-9u -au|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|18e3","Australia/Currie|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-29E80 19X0 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|746","Australia/Darwin|ACST ACDT|-9u -au|010101010|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0|12e4","Australia/Eucla|+0845 +0945|-8J -9J|0101010101010101010|-293kI xcX 10jd0 yL0 1cN0 1cL0 1gSp0 Oo0 l5A0 Oo0 iJA0 G00 zU00 IM0 1qM0 11A0 1o00 11A0|368","Australia/Hobart|AEST AEDT|-a0 -b0|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-29E80 19X0 10jd0 yL0 1cN0 1cL0 1fB0 19X0 VfB0 1cM0 1o00 Rc0 1wo0 Rc0 1wo0 U00 1wo0 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|21e4","Australia/Lord_Howe|AEST +1030 +1130 +11|-a0 -au -bu -b0|0121212121313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313|raC0 1zdu Rb0 1zd0 On0 1zd0 On0 1zd0 On0 1zd0 TXu 1qMu WLu 1tAu WLu 1tAu TXu 1tAu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu 11zu 1o0u 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 11Au 1nXu 1qMu 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 1qMu 11zu 1o0u WLu 1qMu 14nu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1fzu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu|347","Australia/Lindeman|AEST AEDT|-a0 -b0|010101010101010101010|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 H1A0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0|10","Australia/Melbourne|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1qM0 11A0 1tA0 U00 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|39e5","Australia/Perth|AWST AWDT|-80 -90|0101010101010101010|-293jX xcX 10jd0 yL0 1cN0 1cL0 1gSp0 Oo0 l5A0 Oo0 iJA0 G00 zU00 IM0 1qM0 11A0 1o00 11A0|18e5","CET|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Pacific/Easter|EMT -07 -06 -05|7h.s 70 60 50|012121212121212121212121212123232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-1uSgG.w 1s4IG.w WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 2pA0 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|30e2","CST6CDT|CST CDT CWT CPT|60 50 50 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","EET|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|hDB0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Dublin|DMT IST GMT BST IST|p.l -y.D 0 -10 -10|01232323232324242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242|-2ax9y.D Rc0 1fzy.D 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 g600 14o0 1wo0 17c0 1io0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1a00 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1tA0 IM0 90o0 U00 1tA0 U00 1tA0 U00 1tA0 U00 1tA0 WM0 1qM0 WM0 1qM0 WM0 1tA0 U00 1tA0 U00 1tA0 11z0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","EST|EST|50|0|","EST5EDT|EST EDT EWT EPT|50 40 40 40|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 SgN0 8x40 iv0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Etc/GMT-0|GMT|0|0|","Etc/GMT-1|+01|-10|0|","Pacific/Port_Moresby|+10|-a0|0||25e4","Pacific/Pohnpei|+11|-b0|0||34e3","Pacific/Tarawa|+12|-c0|0||29e3","Etc/GMT-13|+13|-d0|0|","Etc/GMT-14|+14|-e0|0|","Etc/GMT-2|+02|-20|0|","Etc/GMT-3|+03|-30|0|","Etc/GMT-4|+04|-40|0|","Etc/GMT-5|+05|-50|0|","Etc/GMT-6|+06|-60|0|","Indian/Christmas|+07|-70|0||21e2","Etc/GMT-8|+08|-80|0|","Pacific/Palau|+09|-90|0||21e3","Etc/GMT+1|-01|10|0|","Etc/GMT+10|-10|a0|0|","Etc/GMT+11|-11|b0|0|","Etc/GMT+12|-12|c0|0|","Etc/GMT+3|-03|30|0|","Etc/GMT+4|-04|40|0|","Etc/GMT+5|-05|50|0|","Etc/GMT+6|-06|60|0|","Etc/GMT+7|-07|70|0|","Etc/GMT+8|-08|80|0|","Etc/GMT+9|-09|90|0|","Etc/UCT|UCT|0|0|","Etc/UTC|UTC|0|0|","Europe/Amsterdam|AMT NST +0120 +0020 CEST CET|-j.w -1j.w -1k -k -20 -10|010101010101010101010101010101010101010101012323234545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545|-2aFcj.w 11b0 1iP0 11A0 1io0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1co0 1io0 1yo0 Pc0 1a00 1fA0 1Bc0 Mo0 1tc0 Uo0 1tA0 U00 1uo0 W00 1s00 VA0 1so0 Vc0 1sM0 UM0 1wo0 Rc0 1u00 Wo0 1rA0 W00 1s00 VA0 1sM0 UM0 1w00 fV0 BCX.w 1tA0 U00 1u00 Wo0 1sm0 601k WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|16e5","Europe/Andorra|WET CET CEST|0 -10 -20|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-UBA0 1xIN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|79e3","Europe/Astrakhan|LMT +03 +04 +05|-3c.c -30 -40 -50|012323232323232323212121212121212121212121212121212121212121212|-1Pcrc.c eUMc.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0","Europe/Athens|AMT EET EEST CEST CET|-1y.Q -20 -30 -20 -10|012123434121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a61x.Q CNbx.Q mn0 kU10 9b0 3Es0 Xa0 1fb0 1dd0 k3X0 Nz0 SCp0 1vc0 SO0 1cM0 1a00 1ao0 1fc0 1a10 1fG0 1cg0 1dX0 1bX0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|35e5","Europe/London|GMT BST BDST|0 -10 -20|0101010101010101010101010101010101010101010101010121212121210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2axa0 Rc0 1fA0 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 2Rz0 Dc0 1zc0 Oo0 1zc0 Rc0 1wo0 17c0 1iM0 FA0 xB0 1fA0 1a00 14o0 bb0 LA0 xB0 Rc0 1wo0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1a00 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1tA0 IM0 90o0 U00 1tA0 U00 1tA0 U00 1tA0 U00 1tA0 WM0 1qM0 WM0 1qM0 WM0 1tA0 U00 1tA0 U00 1tA0 11z0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|10e6","Europe/Belgrade|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19RC0 3IP0 WM0 1fA0 1cM0 1cM0 1rc0 Qo0 1vmo0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Berlin|CET CEST CEMT|-10 -20 -30|01010101010101210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 kL0 Nc0 m10 WM0 1ao0 1cp0 dX0 jz0 Dd0 1io0 17c0 1fA0 1a00 1ehA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|41e5","Europe/Prague|CET CEST GMT|-10 -20 0|01010101010101010201010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 1cM0 1qM0 11c0 mp0 xA0 mn0 17c0 1io0 17c0 1fc0 1ao0 1bNc0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|13e5","Europe/Brussels|WET CET CEST WEST|0 -10 -20 -10|0121212103030303030303030303030303030303030303030303212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ehc0 3zX0 11c0 1iO0 11A0 1o00 11A0 my0 Ic0 1qM0 Rc0 1EM0 UM0 1u00 10o0 1io0 1io0 17c0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a30 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 y00 5Wn0 WM0 1fA0 1cM0 16M0 1iM0 16M0 1C00 Uo0 1eeo0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|21e5","Europe/Bucharest|BMT EET EEST|-1I.o -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1xApI.o 20LI.o RA0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Axc0 On0 1fA0 1a10 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cK0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|19e5","Europe/Budapest|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1ip0 17b0 1op0 1tb0 Q2m0 3Ne0 WM0 1fA0 1cM0 1cM0 1oJ0 1dc0 1030 1fA0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1iM0 1fA0 8Ha0 Rb0 1wN0 Rb0 1BB0 Lz0 1C20 LB0 SNX0 1a10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e5","Europe/Zurich|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19Lc0 11A0 1o00 11A0 1xG10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|38e4","Europe/Chisinau|CMT BMT EET EEST CEST CET MSK MSD|-1T -1I.o -20 -30 -20 -10 -30 -40|012323232323232323234545467676767676767676767323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-26jdT wGMa.A 20LI.o RA0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 27A0 2en0 39g0 WM0 1fA0 1cM0 V90 1t7z0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 gL0 WO0 1cM0 1cM0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1nX0 11D0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|67e4","Europe/Copenhagen|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2azC0 Tz0 VuO0 60q0 WM0 1fA0 1cM0 1cM0 1cM0 S00 1HA0 Nc0 1C00 Dc0 1Nc0 Ao0 1h5A0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Gibraltar|GMT BST BDST CET CEST|0 -10 -20 -10 -20|010101010101010101010101010101010101010101010101012121212121010121010101010101010101034343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-2axa0 Rc0 1fA0 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 2Rz0 Dc0 1zc0 Oo0 1zc0 Rc0 1wo0 17c0 1iM0 FA0 xB0 1fA0 1a00 14o0 bb0 LA0 xB0 Rc0 1wo0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 10Jz0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|30e3","Europe/Helsinki|HMT EET EEST|-1D.N -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1WuND.N OULD.N 1dA0 1xGq0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Kaliningrad|CET CEST CET CEST MSK MSD EEST EET +03|-10 -20 -20 -30 -30 -40 -30 -20 -30|0101010101010232454545454545454546767676767676767676767676767676767676767676787|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 Am0 Lb0 1en0 op0 1pNz0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|44e4","Europe/Kiev|KMT EET MSK CEST CET MSD EEST|-22.4 -20 -30 -20 -10 -40 -30|0123434252525252525252525256161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161|-1Pc22.4 eUo2.4 rnz0 2Hg0 WM0 1fA0 da0 1v4m0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 Db0 3220 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|34e5","Europe/Kirov|LMT +03 +04 +05|-3i.M -30 -40 -50|01232323232323232321212121212121212121212121212121212121212121|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|48e4","Europe/Lisbon|LMT WET WEST WEMT CET CEST|A.J 0 -10 -20 -10 -20|012121212121212121212121212121212121212121212321232123212321212121212121212121212121212121212121214121212121212121212121212121212124545454212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2le00 aPX0 Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 pvy0 1cM0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e5","Europe/Luxembourg|LMT CET CEST WET WEST WEST WET|-o.A -10 -20 0 -10 -20 -10|0121212134343434343434343434343434343434343434343434565651212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2DG0o.A t6mo.A TB0 1nX0 Up0 1o20 11A0 rW0 CM0 1qP0 R90 1EO0 UK0 1u20 10m0 1ip0 1in0 17e0 19W0 1fB0 1db0 1cp0 1in0 17d0 1fz0 1a10 1in0 1a10 1in0 17f0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 vA0 60L0 WM0 1fA0 1cM0 17c0 1io0 16M0 1C00 Uo0 1eeo0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Europe/Madrid|WET WEST WEMT CET CEST|0 -10 -20 -10 -20|010101010101010101210343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-25Td0 19B0 1cL0 1dd0 b1z0 18p0 3HX0 17d0 1fz0 1a10 1io0 1a00 1in0 17d0 iIn0 Hd0 1cL0 bb0 1200 2s20 14n0 5aL0 Mp0 1vz0 17d0 1in0 17d0 1in0 17d0 1in0 17d0 6hX0 11B0 XHX0 1a10 1fz0 1a10 19X0 1cN0 1fz0 1a10 1fC0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|62e5","Europe/Malta|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2arB0 Lz0 1cN0 1db0 1410 1on0 Wp0 1qL0 17d0 1cL0 M3B0 5M20 WM0 1fA0 1co0 17c0 1iM0 16m0 1de0 1lc0 14m0 1lc0 WO0 1qM0 GTW0 On0 1C10 LA0 1C00 LA0 1EM0 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1co0 1cM0 1lA0 Xc0 1qq0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1iN0 19z0 1fB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|42e4","Europe/Minsk|MMT EET MSK CEST CET MSD EEST +03|-1O -20 -30 -20 -10 -40 -30 -30|01234343252525252525252525261616161616161616161616161616161616161617|-1Pc1O eUnO qNX0 3gQ0 WM0 1fA0 1cM0 Al0 1tsn0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 3Fc0 1cN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0|19e5","Europe/Monaco|PMT WET WEST WEMT CET CEST|-9.l 0 -10 -20 -10 -20|01212121212121212121212121212121212121212121212121232323232345454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2nco9.l cNb9.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 1u00 10o0 1io0 1wo0 Rc0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Df0 2RV0 11z0 11B0 1ze0 WM0 1fA0 1cM0 1fa0 1aq0 16M0 1ekn0 1cL0 1fC0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|38e3","Europe/Moscow|MMT MMT MST MDST MSD MSK +05 EET EEST MSK|-2u.h -2v.j -3v.j -4v.j -40 -30 -50 -20 -30 -40|012132345464575454545454545454545458754545454545454545454545454545454545454595|-2ag2u.h 2pyW.W 1bA0 11X0 GN0 1Hb0 c4v.j ik0 3DA0 dz0 15A0 c10 2q10 iM10 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|16e6","Europe/Paris|PMT WET WEST CEST CET WEMT|-9.l 0 -10 -20 -10 -20|0121212121212121212121212121212121212121212121212123434352543434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434|-2nco8.l cNb8.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 1u00 10o0 1io0 1wo0 Rc0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Df0 Ik0 5M30 WM0 1fA0 1cM0 Vx0 hB0 1aq0 16M0 1ekn0 1cL0 1fC0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e6","Europe/Riga|RMT LST EET MSK CEST CET MSD EEST|-1A.y -2A.y -20 -30 -20 -10 -40 -30|010102345454536363636363636363727272727272727272727272727272727272727272727272727272727272727272727272727272727272727272727272|-25TzA.y 11A0 1iM0 ko0 gWm0 yDXA.y 2bX0 3fE0 WM0 1fA0 1cM0 1cM0 4m0 1sLy0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 1o00 11A0 1o00 11A0 1qM0 3oo0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|64e4","Europe/Rome|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2arB0 Lz0 1cN0 1db0 1410 1on0 Wp0 1qL0 17d0 1cL0 M3B0 5M20 WM0 1fA0 1cM0 16M0 1iM0 16m0 1de0 1lc0 14m0 1lc0 WO0 1qM0 GTW0 On0 1C10 LA0 1C00 LA0 1EM0 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1C00 LA0 1zc0 Oo0 1C00 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1zc0 Oo0 1fC0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|39e5","Europe/Samara|LMT +03 +04 +05|-3k.k -30 -40 -50|0123232323232323232121232323232323232323232323232323232323212|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 2y10 14m0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|12e5","Europe/Saratov|LMT +03 +04 +05|-34.i -30 -40 -50|012323232323232321212121212121212121212121212121212121212121212|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1cM0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 5810","Europe/Simferopol|SMT EET MSK CEST CET MSD EEST MSK|-2g -20 -30 -20 -10 -40 -30 -40|012343432525252525252525252161616525252616161616161616161616161616161616172|-1Pc2g eUog rEn0 2qs0 WM0 1fA0 1cM0 3V0 1u0L0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Q00 4eL0 1cL0 1cN0 1cL0 1cN0 dX0 WL0 1cN0 1cL0 1fB0 1o30 11B0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0|33e4","Europe/Sofia|EET CET CEST EEST|-20 -10 -20 -30|01212103030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030|-168L0 WM0 1fA0 1cM0 1cM0 1cN0 1mKH0 1dd0 1fb0 1ap0 1fb0 1a20 1fy0 1a30 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Stockholm|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2azC0 TB0 2yDe0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|15e5","Europe/Tallinn|TMT CET CEST EET MSK MSD EEST|-1D -10 -20 -20 -30 -40 -30|012103421212454545454545454546363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363|-26oND teD 11A0 1Ta0 4rXl KSLD 2FX0 2Jg0 WM0 1fA0 1cM0 18J0 1sTX0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o10 11A0 1qM0 5QM0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|41e4","Europe/Tirane|LMT CET CEST|-1j.k -10 -20|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2glBj.k 14pcj.k 5LC0 WM0 4M0 1fCK0 10n0 1op0 11z0 1pd0 11z0 1qN0 WL0 1qp0 Xb0 1qp0 Xb0 1qp0 11z0 1lB0 11z0 1qN0 11z0 1iN0 16n0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|42e4","Europe/Ulyanovsk|LMT +03 +04 +05 +02|-3d.A -30 -40 -50 -20|01232323232323232321214121212121212121212121212121212121212121212|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0","Europe/Uzhgorod|CET CEST MSK MSD EET EEST|-10 -20 -30 -40 -20 -30|010101023232323232323232320454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-1cqL0 6i00 WM0 1fA0 1cM0 1ml0 1Cp0 1r3W0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Q00 1Nf0 2pw0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e4","Europe/Vienna|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 3KM0 14o0 LA00 6i00 WM0 1fA0 1cM0 1cM0 1cM0 400 2qM0 1a00 1cM0 1cM0 1io0 17c0 1gHa0 19X0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|18e5","Europe/Vilnius|WMT KMT CET EET MSK CEST MSD EEST|-1o -1z.A -10 -20 -30 -20 -40 -30|012324525254646464646464646473737373737373737352537373737373737373737373737373737373737373737373737373737373737373737373|-293do 6ILM.o 1Ooz.A zz0 Mfd0 29W0 3is0 WM0 1fA0 1cM0 LV0 1tgL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11B0 1o00 11A0 1qM0 8io0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Europe/Volgograd|LMT +03 +04 +05|-2V.E -30 -40 -50|01232323232323232121212121212121212121212121212121212121212121|-21IqV.E psLV.E 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1cM0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|10e5","Europe/Warsaw|WMT CET CEST EET EEST|-1o -10 -20 -20 -30|012121234312121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ctdo 1LXo 11d0 1iO0 11A0 1o00 11A0 1on0 11A0 6zy0 HWP0 5IM0 WM0 1fA0 1cM0 1dz0 1mL0 1en0 15B0 1aq0 1nA0 11A0 1io0 17c0 1fA0 1a00 iDX0 LA0 1cM0 1cM0 1C00 Oo0 1cM0 1cM0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1C00 LA0 uso0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e5","Europe/Zaporozhye|+0220 EET MSK CEST CET MSD EEST|-2k -20 -30 -20 -10 -40 -30|01234342525252525252525252526161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161|-1Pc2k eUok rdb0 2RE0 WM0 1fA0 8m0 1v9a0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cK0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|77e4","HST|HST|a0|0|","Indian/Chagos|LMT +05 +06|-4N.E -50 -60|012|-2xosN.E 3AGLN.E|30e2","Indian/Cocos|+0630|-6u|0||596","Indian/Kerguelen|-00 +05|0 -50|01|-MG00|130","Indian/Mahe|LMT +04|-3F.M -40|01|-2yO3F.M|79e3","Indian/Maldives|MMT +05|-4S -50|01|-olgS|35e4","Indian/Mauritius|LMT +04 +05|-3O -40 -50|012121|-2xorO 34unO 14L0 12kr0 11z0|15e4","Indian/Reunion|LMT +04|-3F.Q -40|01|-2mDDF.Q|84e4","Pacific/Kwajalein|+11 -12 +12|-b0 c0 -c0|012|-AX0 W9X0|14e3","MET|MET MEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","MST|MST|70|0|","MST7MDT|MST MDT MWT MPT|70 60 60 60|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Pacific/Chatham|+1215 +1245 +1345|-cf -cJ -dJ|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-WqAf 1adef IM0 1C00 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1qM0 14o0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1io0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|600","Pacific/Apia|LMT -1130 -11 -10 +14 +13|bq.U bu b0 a0 -e0 -d0|01232345454545454545454545454545454545454545454545454545454|-2nDMx.4 1yW03.4 2rRbu 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|37e3","Pacific/Bougainville|+10 +09 +11|-a0 -90 -b0|0102|-16Wy0 7CN0 2MQp0|18e4","Pacific/Efate|LMT +11 +12|-bd.g -b0 -c0|0121212121212121212121|-2l9nd.g 2Szcd.g 1cL0 1oN0 10L0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 Lz0 1Nd0 An0|66e3","Pacific/Enderbury|-12 -11 +13|c0 b0 -d0|012|nIc0 B7X0|1","Pacific/Fakaofo|-11 +13|b0 -d0|01|1Gfn0|483","Pacific/Fiji|LMT +12 +13|-bT.I -c0 -d0|0121212121212121212121212121212121212121212121212121212121212121|-2bUzT.I 3m8NT.I LA0 1EM0 IM0 nJc0 LA0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0|88e4","Pacific/Galapagos|LMT -05 -06|5W.o 50 60|01212|-1yVS1.A 2dTz1.A gNd0 rz0|25e3","Pacific/Gambier|LMT -09|8X.M 90|01|-2jof0.c|125","Pacific/Guadalcanal|LMT +11|-aD.M -b0|01|-2joyD.M|11e4","Pacific/Guam|GST ChST|-a0 -a0|01|1fpq0|17e4","Pacific/Honolulu|HST HDT HST|au 9u a0|010102|-1thLu 8x0 lef0 8Pz0 46p0|37e4","Pacific/Kiritimati|-1040 -10 +14|aE a0 -e0|012|nIaE B7Xk|51e2","Pacific/Kosrae|+11 +12|-b0 -c0|010|-AX0 1bdz0|66e2","Pacific/Majuro|+11 +12|-b0 -c0|01|-AX0|28e3","Pacific/Marquesas|LMT -0930|9i 9u|01|-2joeG|86e2","Pacific/Pago_Pago|LMT SST|bm.M b0|01|-2nDMB.c|37e2","Pacific/Nauru|LMT +1130 +09 +12|-b7.E -bu -90 -c0|01213|-1Xdn7.E PvzB.E 5RCu 1ouJu|10e3","Pacific/Niue|-1120 -1130 -11|bk bu b0|012|-KfME 17y0a|12e2","Pacific/Norfolk|+1112 +1130 +1230 +11|-bc -bu -cu -b0|01213|-Kgbc W01G On0 1COp0|25e4","Pacific/Noumea|LMT +11 +12|-b5.M -b0 -c0|01212121|-2l9n5.M 2EqM5.M xX0 1PB0 yn0 HeP0 Ao0|98e3","Pacific/Pitcairn|-0830 -08|8u 80|01|18Vku|56","Pacific/Rarotonga|-1030 -0930 -10|au 9u a0|012121212121212121212121212|lyWu IL0 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu Onu|13e3","Pacific/Tahiti|LMT -10|9W.g a0|01|-2joe1.I|18e4","Pacific/Tongatapu|+1220 +13 +14|-ck -d0 -e0|0121212121|-1aB0k 2n5dk 15A0 1wo0 xz0 1Q10 xz0 zWN0 s00|75e3","PST8PDT|PST PDT PWT PPT|80 70 70 70|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261q0 1nX0 11B0 1nX0 SgN0 8x10 iy0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","WET|WET WEST|0 -10|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|hDB0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00"],links:["Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|Atlantic/St_Helena","Africa/Cairo|Egypt","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Nairobi|Africa/Addis_Ababa","Africa/Nairobi|Africa/Asmara","Africa/Nairobi|Africa/Asmera","Africa/Nairobi|Africa/Dar_es_Salaam","Africa/Nairobi|Africa/Djibouti","Africa/Nairobi|Africa/Kampala","Africa/Nairobi|Africa/Mogadishu","Africa/Nairobi|Indian/Antananarivo","Africa/Nairobi|Indian/Comoro","Africa/Nairobi|Indian/Mayotte","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|US/Alaska","America/Argentina/Buenos_Aires|America/Buenos_Aires","America/Argentina/Catamarca|America/Argentina/ComodRivadavia","America/Argentina/Catamarca|America/Catamarca","America/Argentina/Cordoba|America/Cordoba","America/Argentina/Cordoba|America/Rosario","America/Argentina/Jujuy|America/Jujuy","America/Argentina/Mendoza|America/Mendoza","America/Atikokan|America/Coral_Harbour","America/Chicago|US/Central","America/Curacao|America/Aruba","America/Curacao|America/Kralendijk","America/Curacao|America/Lower_Princes","America/Denver|America/Shiprock","America/Denver|Navajo","America/Denver|US/Mountain","America/Detroit|US/Michigan","America/Edmonton|Canada/Mountain","America/Fort_Wayne|America/Indiana/Indianapolis","America/Fort_Wayne|America/Indianapolis","America/Fort_Wayne|US/East-Indiana","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/Indiana/Knox|America/Knox_IN","America/Indiana/Knox|US/Indiana-Starke","America/Jamaica|Jamaica","America/Kentucky/Louisville|America/Louisville","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Manaus|Brazil/West","America/Mazatlan|Mexico/BajaSur","America/Mexico_City|Mexico/General","America/New_York|US/Eastern","America/Noronha|Brazil/DeNoronha","America/Panama|America/Cayman","America/Phoenix|US/Arizona","America/Port_of_Spain|America/Anguilla","America/Port_of_Spain|America/Antigua","America/Port_of_Spain|America/Dominica","America/Port_of_Spain|America/Grenada","America/Port_of_Spain|America/Guadeloupe","America/Port_of_Spain|America/Marigot","America/Port_of_Spain|America/Montserrat","America/Port_of_Spain|America/St_Barthelemy","America/Port_of_Spain|America/St_Kitts","America/Port_of_Spain|America/St_Lucia","America/Port_of_Spain|America/St_Thomas","America/Port_of_Spain|America/St_Vincent","America/Port_of_Spain|America/Tortola","America/Port_of_Spain|America/Virgin","America/Regina|Canada/Saskatchewan","America/Rio_Branco|America/Porto_Acre","America/Rio_Branco|Brazil/Acre","America/Santiago|Chile/Continental","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","America/Tijuana|America/Ensenada","America/Tijuana|America/Santa_Isabel","America/Tijuana|Mexico/BajaNorte","America/Toronto|America/Montreal","America/Toronto|Canada/Eastern","America/Vancouver|Canada/Pacific","America/Whitehorse|Canada/Yukon","America/Winnipeg|Canada/Central","Asia/Ashgabat|Asia/Ashkhabad","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Vientiane","Asia/Dhaka|Asia/Dacca","Asia/Dubai|Asia/Muscat","Asia/Ho_Chi_Minh|Asia/Saigon","Asia/Hong_Kong|Hongkong","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kuala_Lumpur|Asia/Singapore","Asia/Kuala_Lumpur|Singapore","Asia/Macau|Asia/Macao","Asia/Makassar|Asia/Ujung_Pandang","Asia/Nicosia|Europe/Nicosia","Asia/Qatar|Asia/Bahrain","Asia/Rangoon|Asia/Yangon","Asia/Riyadh|Asia/Aden","Asia/Riyadh|Asia/Kuwait","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|PRC","Asia/Taipei|ROC","Asia/Tehran|Iran","Asia/Thimphu|Asia/Thimbu","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Urumqi|Asia/Kashgar","Atlantic/Faroe|Atlantic/Faeroe","Atlantic/Reykjavik|Iceland","Atlantic/South_Georgia|Etc/GMT+2","Australia/Adelaide|Australia/South","Australia/Brisbane|Australia/Queensland","Australia/Broken_Hill|Australia/Yancowinna","Australia/Darwin|Australia/North","Australia/Hobart|Australia/Tasmania","Australia/Lord_Howe|Australia/LHI","Australia/Melbourne|Australia/Victoria","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/NSW","Etc/GMT-0|Etc/GMT","Etc/GMT-0|Etc/GMT+0","Etc/GMT-0|Etc/GMT0","Etc/GMT-0|Etc/Greenwich","Etc/GMT-0|GMT","Etc/GMT-0|GMT+0","Etc/GMT-0|GMT-0","Etc/GMT-0|GMT0","Etc/GMT-0|Greenwich","Etc/UCT|UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Belgrade|Europe/Ljubljana","Europe/Belgrade|Europe/Podgorica","Europe/Belgrade|Europe/Sarajevo","Europe/Belgrade|Europe/Skopje","Europe/Belgrade|Europe/Zagreb","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Helsinki|Europe/Mariehamn","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Portugal","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|W-SU","Europe/Oslo|Arctic/Longyearbyen","Europe/Oslo|Atlantic/Jan_Mayen","Europe/Prague|Europe/Bratislava","Europe/Rome|Europe/San_Marino","Europe/Rome|Europe/Vatican","Europe/Warsaw|Poland","Europe/Zurich|Europe/Busingen","Europe/Zurich|Europe/Vaduz","Indian/Christmas|Etc/GMT-7","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Easter|Chile/EasterIsland","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kwajalein|Kwajalein","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Palau|Etc/GMT-9","Pacific/Pohnpei|Etc/GMT-11","Pacific/Pohnpei|Pacific/Ponape","Pacific/Port_Moresby|Etc/GMT-10","Pacific/Port_Moresby|Pacific/Chuuk","Pacific/Port_Moresby|Pacific/Truk","Pacific/Port_Moresby|Pacific/Yap","Pacific/Tarawa|Etc/GMT-12","Pacific/Tarawa|Pacific/Funafuti","Pacific/Tarawa|Pacific/Wake","Pacific/Tarawa|Pacific/Wallis"]}},af941f503aa1d13e41c1:function(e,t,n){"use strict";var r={newFileCtx:"new_file",channelFileCtx:"files",externalCtx:"external"},o={teams:"teams",google:"google",personal:"personal"},c={getTeamFilesV2:"documents_view_filelist_teams_v2",getPersonalFilesV2:"documents_view_filelist_personal_v2",personalFilesPrefix:"personal_files_v2",channelFilesPrefix:"channel_files_v2"},i={itemsViewLoaded:"items_view_loaded",itemsViewRefreshed:"items_view_refreshed",itemsViewAuthTokenStart:"items_view_auth_token_start",itemsViewAuthTokenEnd:"items_view_auth_token_end"};n.d(t,"d",function(){return c}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"a",function(){return"edit"}),n.d(t,"f",function(){return"view"})},b05eab936c731d94a6f2:function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=function(e){function t(){var t=e.call(this,"object unsubscribed");this.name=t.name="ObjectUnsubscribedError",this.stack=t.stack,this.message=t.message}return r(t,e),t}(Error);t.ObjectUnsubscribedError=o},b2b3f493b9702e75bc98:function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n("1e1522e81ef082721174"),c=n("a6646240fbf3f6e66d6d"),i=n("bcfe5642589c9dbfb15d"),a=n("b05eab936c731d94a6f2"),s=n("1dbba2e6ceb51d224ed6"),u=n("1d99639b1edc9210398a"),f=function(e){function t(t){e.call(this,t),this.destination=t}return r(t,e),t}(c.Subscriber);t.SubjectSubscriber=f;var l=function(e){function t(){e.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return r(t,e),t.prototype[u.rxSubscriber]=function(){return new f(this)},t.prototype.lift=function(e){var t=new p(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new a.ObjectUnsubscribedError;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),o=0;o<n;o++)r[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new a.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),o=0;o<n;o++)r[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new a.ObjectUnsubscribedError;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new a.ObjectUnsubscribedError;return this.hasError?(e.error(this.thrownError),i.Subscription.EMPTY):this.isStopped?(e.complete(),i.Subscription.EMPTY):(this.observers.push(e),new s.SubjectSubscription(this,e))},t.prototype.asObservable=function(){var e=new o.Observable;return e.source=this,e},t.create=function(e,t){return new p(e,t)},t}(o.Observable);t.Subject=l;var p=function(e){function t(t,n){e.call(this),this.destination=t,this.source=n}return r(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):i.Subscription.EMPTY},t}(l);t.AnonymousSubject=p},b2c7895933e4aed40b1d:function(e,t,n){"use strict";var r=n("d7d4fca6d5f8306ef0a5"),o=n("72697142ff77ddd6e2b2"),c=Object(o.a)(Object.keys,Object),i=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return c(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},b3bd1cc7d16f2f5884ea:function(e,t,n){"use strict";function r(e){var t=Object(c.i)(e.target);if(t){var n=t.document.body.classList;n.contains(a)&&n.remove(a)}}function o(e){var t=Object(c.i)(e.target);if(t){var n=t.document.body.classList;Object(i.b)(e.which)&&!n.contains(a)&&n.add(a)}}n.d(t,"a",function(){return a}),t.b=function(e){var t=e||Object(c.i)();t&&!t.__hasInitializeFocusRects__&&(t.__hasInitializeFocusRects__=!0,t.addEventListener("mousedown",r,!0),t.addEventListener("keydown",o,!0))};var c=n("9cacc934330ce8338522"),i=n("e40215a0f909d4abb6b7"),a="ms-Fabric--isFocusVisible"},b62cbc8d532fe17bedcb:function(e,t,n){"use strict";t.a=function(e){return e.placeholder}},b6b32bb34d326922d674:function(e,t,n){"use strict";t.a=function(){}},b773bc8dd8e5c3d71e12:function(e,t,n){"use strict";t.a=function(e,t,n,r,o){return o(e,function(e,o,c){n=r?(r=!1,e):t(n,e,o,c)}),n}},b8c08b527e4f22d848fd:function(e,t,n){"use strict";(function(e){var r=n("0bd0afb5c74547a322b4"),o=n("f5d812633866a6a25035"),c="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=c&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===c?r.a.Buffer:void 0,s=(a?a.isBuffer:void 0)||o.a;t.a=s}).call(t,n("044f282f6141fc605782")(e))},ba53fce2bec9e4ed267c:function(e,t,n){"use strict";t.a=function(e){return e}},bcfe5642589c9dbfb15d:function(e,t,n){"use strict";function r(e){return e.reduce(function(e,t){return e.concat(t instanceof u.UnsubscriptionError?t.errors:t)},[])}var o=n("25ca437399921be55963"),c=n("62449e904d87879eeb81"),i=n("44e94ccfd904f0f707b3"),a=n("db392ee8f4879554196e"),s=n("0d2a916b77eeb630f9fa"),u=n("7f703996b20d29879c6d"),f=function(){function e(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.closed){var n=this,f=n._parent,l=n._parents,p=n._unsubscribe,b=n._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var d=-1,M=l?l.length:0;f;)f.remove(this),f=++d<M&&l[d]||null;if(i.isFunction(p)&&(v=a.tryCatch(p).call(this))===s.errorObject&&(t=!0,e=e||(s.errorObject.e instanceof u.UnsubscriptionError?r(s.errorObject.e.errors):[s.errorObject.e])),o.isArray(b))for(d=-1,M=b.length;++d<M;){var h=b[d];if(c.isObject(h)){var v=a.tryCatch(h.unsubscribe).call(h);if(v===s.errorObject){t=!0,e=e||[];var g=s.errorObject.e;g instanceof u.UnsubscriptionError?e=e.concat(r(g.errors)):e.push(g)}}}if(t)throw new u.UnsubscriptionError(e)}},e.prototype.add=function(t){if(!t||t===e.EMPTY)return e.EMPTY;if(t===this)return this;var n=t;switch(typeof t){case"function":n=new e(t);case"object":if(n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if("function"!=typeof n._addParent){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(n),n._addParent(this),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.prototype._addParent=function(e){var t=this,n=t._parent,r=t._parents;n&&n!==e?r?-1===r.indexOf(e)&&r.push(e):this._parents=[e]:this._parent=e},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();t.Subscription=f},bd2f00b64cdde6ff3297:function(e,t,n){"use strict";var r=n("7dab7527baa6bb82ca72"),o=n("8e4296af8a1934c9fbc5"),c=n("f3d9c495aaedd8ec38a5");t.a=function(e){return Object(r.a)(e,c.a,o.a)}},bd6a183fa4110792a897:function(e,t,n){"use strict";var r=n("36e0784a51645e8ceed8"),o=n("5f83a414f9ba6ee13f56"),c=n("4605ae836ca138d7eb59"),i=n("517d6e3962b3db33796d");t.a=function(e,t){return(Object(i.a)(e)?r.a:o.a)(e,Object(c.a)(t,3))}},bf1d5db339a3b78b70c2:function(e,t,n){"use strict";var r=n("13a0a4d0580180405100"),o=Math.max;t.a=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var c=arguments,i=-1,a=o(c.length-t,0),s=Array(a);++i<a;)s[i]=c[t+i];i=-1;for(var u=Array(t+1);++i<t;)u[i]=c[i];return u[t]=n(s),Object(r.a)(e,this,u)}}},bfa1ca23da138d867916:function(e,t,n){"use strict";var r=n("70ef56491c6ad2d76b52"),o=n("f3d9c495aaedd8ec38a5"),c=Object(r.a)(o.a);t.a=c},bfb1279a823c8d2b12a9:function(e,t,n){"use strict";var r=n("d423f003db2cbb5863ff"),o=n("d573284d3226e08a305e"),c=function(){var e=/[^.]+$/.exec(o.a&&o.a.keys&&o.a.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),i=function(e){return!!c&&c in e},a=n("978b85f07cd53ebdd0f6"),s=n("9a8c59ff14b4fcc9859b"),u=/[\\^$.*+?()[\]{}|]/g,f=/^\[object .+?Constructor\]$/,l=Function.prototype,p=Object.prototype,b=l.toString,d=p.hasOwnProperty,M=RegExp("^"+b.call(d).replace(u,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.a=function(e){return!(!Object(a.a)(e)||i(e))&&(Object(r.a)(e)?M:f).test(Object(s.a)(e))}},c0efcc44a862c6ccf5d3:function(e,t,n){"use strict";var r=n("2223bf3fd2b6372bfe7f"),o=n("a350c0c489bcd73fc97c"),c=n("4e5f58ad7c5e5b3d7316"),i=1,a=2,s=4,u=8,f=32,l=64;t.a=function(e,t,n,p,b,d,M,h,v,g){var A=t&u,O=A?M:void 0,z=A?void 0:M,y=A?d:void 0,m=A?void 0:d;t|=A?f:l,(t&=~(A?l:f))&s||(t&=~(i|a));var L=[e,t,b,y,O,m,z,h,v,g],S=n.apply(void 0,L);return Object(r.a)(e)&&Object(o.a)(S,L),S.placeholder=p,Object(c.a)(S,e,t)}},c2e8e7d53dcf6f8b6c2a:function(e,t,n){"use strict";function r(e,t,n,f,l,p,y,m,L,S){function N(){for(var h=arguments.length,v=Array(h),g=h;g--;)v[g]=arguments[g];if(B)var A=Object(u.a)(N),O=i(v,A);if(f&&(v=Object(o.a)(v,f,l,B)),p&&(v=Object(c.a)(v,p,y,B)),h-=O,B&&h<S){var z=Object(d.a)(v,A);return Object(s.a)(e,t,r,N.placeholder,n,v,z,m,L,S-h)}var j=T?n:this,_=W?j[e]:e;return h=v.length,m?v=b(v,m):C&&h>1&&v.reverse(),q&&L<h&&(v.length=L),this&&this!==M.a&&this instanceof N&&(_=w||Object(a.a)(_)),_.apply(j,v)}var q=t&O,T=t&h,W=t&v,B=t&(g|A),C=t&z,w=W?void 0:Object(a.a)(e);return N}var o=n("dd85f620557a250b3166"),c=n("f53e45c8b3e36c6dcef9"),i=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r},a=n("26e9318898852c9495dd"),s=n("c0efcc44a862c6ccf5d3"),u=n("b62cbc8d532fe17bedcb"),f=n("ea2effc0f6d665f6ba8e"),l=n("7af3fc0c351e507691be"),p=Math.min,b=function(e,t){for(var n=e.length,r=p(t.length,n),o=Object(f.a)(e);r--;){var c=t[r];e[r]=Object(l.a)(c,n)?o[c]:void 0}return e},d=n("e5205903969d9dc4f02d"),M=n("0bd0afb5c74547a322b4"),h=1,v=2,g=8,A=16,O=128,z=512;t.a=r},c460a4314000aba6b458:function(e,t,n){"use strict";var r=n("77de278315e7bc78045c");t.a=function(e,t,n){var o=null==e?void 0:Object(r.a)(e,t);return void 0===o?n:o}},c47f1635aacb1501f578:function(e,t,n){"use strict";var r=n("09072e49d5f60505514c"),o=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=o},c60639288dd011bf33a8:function(e,t,n){"use strict";function r(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('"+e+"fabric-icons-a13498cf.woff') format('woff')"},icons:{GlobalNavButton:"",ChevronDown:"",ChevronUp:"",Edit:"",Add:"",Cancel:"",More:"",Settings:"",Mail:"",Filter:"",Search:"",Share:"",BlockedSite:"",FavoriteStar:"",FavoriteStarFill:"",CheckMark:"",Delete:"",ChevronLeft:"",ChevronRight:"",Calendar:"",Megaphone:"",Undo:"",Flag:"",Page:"",Pinned:"",View:"",Clear:"",Download:"",Upload:"",Folder:"",Sort:"",AlignRight:"",AlignLeft:"",Tag:"",AddFriend:"",Info:"",SortLines:"",List:"",CircleRing:"",Heart:"",HeartFill:"",Tiles:"",Embed:"",Glimmer:"",Ascending:"",Descending:"",SortUp:"",SortDown:"",SyncToPC:"",LargeGrid:"",SkypeCheck:"",SkypeClock:"",SkypeMinus:"",ClearFilter:"",Flow:"",StatusCircleCheckmark:"",MoreVertical:""}};Object(A.W)(n,t)}function o(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-0"',src:"url('"+e+"fabric-icons-0-29734c63.woff') format('woff')"},icons:{DecreaseIndentLegacy:"",IncreaseIndentLegacy:"",SizeLegacy:"",InternetSharing:"",Brightness:"",MapPin:"",Airplane:"",Tablet:"",QuickNote:"",Video:"",People:"",Phone:"",Pin:"",Shop:"",Stop:"",Link:"",AllApps:"",Zoom:"",ZoomOut:"",Microphone:" ",Camera:"",Attach:"",Send:"",FavoriteList:"",PageSolid:"",Forward:"",Back:"",Refresh:"",Lock:"",ReportHacked:"",EMI:"",MiniLink:"",Blocked:"",ReadingMode:"",Favicon:"",Remove:"",Checkbox:"",CheckboxComposite:"",CheckboxIndeterminate:"",CheckboxCompositeReversed:"",BackToWindow:"",FullScreen:"",Print:"",Up:"",Down:"",OEM:"",Save:"",Cloud:"",CommandPrompt:"",Sad:"",SIPMove:"",EraseTool:"",GripperTool:"",Dialpad:"",PageLeft:" ",PageRight:"",MultiSelect:"",KeyboardClassic:"",Play:"",Pause:"",Emoji2:"",GripperBarHorizontal:"",System:"",Personalize:"",SearchAndApps:"",Globe:"",ContactInfo:"",Unpin:"",Contact:"",Memo:"",Paste:"",WindowsLogo:"",Error:"",GripperBarVertical:"",Unlock:"",AutoEnhanceOn:"",AutoEnhanceOff:"",Color:"",SaveAs:"",Light:"",Filters:"",AspectRatio:"",Contrast:"",Redo:"",Crop:"",PhotoCollection:"",Album:"",Rotate:"",PanoIndicator:"",RedEye:"",ThumbnailView:"",Package:"",Warning:"",Financial:"",Education:"",ShoppingCart:"",Train:"",Move:"",TouchPointer:"",Merge:""}};Object(A.W)(n,t)}function c(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-1"',src:"url('"+e+"fabric-icons-1-a653c37c.woff') format('woff')"},icons:{TurnRight:"",Ferry:"",Highlight:"",PowerButton:"",Tab:"",Admin:"",TVMonitor:"",Speakers:"",StackIndicator:"",Nav2DMapView:" ",Car:" ",Bus:" ",EatDrink:" ",LocationCircle:" ",Home:" ",SwitcherStartEnd:" ",ParkingLocation:" ",IncidentTriangle:" ",Touch:" ",MapDirections:" ",CaretHollow:" ",CaretSolid:" ",History:" ",Location:" ",Work:" ",Recent:" ",Hotel:" ",LocationDot:" ",Dictionary:" ",ChromeBack:" ",FolderOpen:" ",PinnedFill:"",RevToggleKey:"",Previous:"",Next:"",Sync:"",Help:"",Emoji:"",MailForward:"",ClosePane:"",OpenPane:" ",PreviewLink:"",ZoomIn:"",Bookmarks:"",Document:"",ProtectedDocument:"",OpenInNewWindow:"",MailFill:"",ViewAll:"",Switch:"",Rename:"",Remote:"",SelectAll:"",Orientation:"",Import:"",Picture:"",ChromeClose:"",ShowResults:"",Message:"",CalendarDay:"",CalendarWeek:"",MailReplyAll:"",Read:"",Cut:"",PaymentCard:"",Copy:"",Important:"",MailReply:"",GotoToday:"",Font:"",FontColor:"",FolderFill:"",Permissions:"",DisableUpdates:"",Unfavorite:"",Italic:"",Underline:"",Bold:"",MoveToFolder:"",Dislike:" ",Like:"",AlignCenter:"",OpenFile:"",FontDecrease:"",FontIncrease:"",FontSize:"",CellPhone:"",Calculator:"",Library:"",PostUpdate:"",NewFolder:"",CalendarReply:"",UnsyncFolder:"",SyncFolder:"",BlockContact:"",Accept:"",BulletedList:"",Preview:"",News:"",Chat:""}};Object(A.W)(n,t)}function i(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-2"',src:"url('"+e+"fabric-icons-2-b9379dbc.woff') format('woff')"},icons:{Group:"",World:"",Comment:"",DockLeft:"",DockRight:"",Repair:"",Accounts:"",RadioBullet:"",Stopwatch:"",Clock:"",WorldClock:"",AlarmClock:"",Photo:"",Hospital:"",Timer:"",FullCircleMask:"",LocationFill:" ",ChromeMinimize:"",Annotation:"",Fingerprint:"",Handwriting:"",Completed:"",Label:"",FlickDown:"",FlickUp:"",FlickLeft:"",FlickRight:"",MiniExpand:"",MiniContract:"",Streaming:"",MusicInCollection:"",OneDriveLogo:"",CompassNW:"",Code:"",LightningBolt:"",CalculatorMultiply:"",CalculatorAddition:"",CalculatorSubtract:"",CalculatorEqualTo:"",PrintfaxPrinterFile:"",Communications:"",Headset:"",Health:"",ChevronUpSmall:"",ChevronDownSmall:"",ChevronLeftSmall:"",ChevronRightSmall:"",ChevronUpMed:"",ChevronDownMed:"",ChevronLeftMed:"",ChevronRightMed:"",PC1:"",PresenceChickletVideo:"",Reply:"",HalfAlpha:"",ConstructionCone:"",DoubleChevronLeftMed:"",Volume0:"",Volume1:"",Volume2:"",Volume3:"",Chart:"",Robot:"",Manufacturing:"",LockSolid:"",BidiLtr:"",BidiRtl:"",RightDoubleQuote:"",Sunny:"",CloudWeather:"",Cloudy:"",PartlyCloudyDay:"",PartlyCloudyNight:"",ClearNight:"",RainShowersDay:"",Rain:"",Thunderstorms:"",RainSnow:"",Snow:"",BlowingSnow:"",Frigid:"",Fog:"",Squalls:"",Duststorm:"",Unknown:"",Precipitation:"",Ribbon:"",AreaChart:"",Assign:"",CheckList:"",Diagnostic:"",Generate:"",LineChart:"",Equalizer:"",BarChartHorizontal:"",BarChartVertical:"",Freezing:"",Processing:"",SnowShowerDay:"",HailDay:""}};Object(A.W)(n,t)}function a(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-3"',src:"url('"+e+"fabric-icons-3-ef2110da.woff') format('woff')"},icons:{WorkFlow:"",HourGlass:"",StoreLogoMed20:"",TimeSheet:"",TriangleSolid:"",VideoSolid:"",RainShowersNight:"",SnowShowerNight:"",Teamwork:"",HailNight:"",PeopleAdd:"",Glasses:"",DateTime2:"",Shield:"",Header1:"",PageAdd:"",NumberedList:"",PowerBILogo:"",Info2:"",MusicInCollectionFill:"",Asterisk:"",ErrorBadge:"",CircleFill:"",Record2:"",AllAppsMirrored:"",BookmarksMirrored:"",BulletedListMirrored:"",CaretHollowMirrored:"",CaretSolidMirrored:"",ChromeBackMirrored:"",ClosePaneMirrored:"",DockLeftMirrored:"",DoubleChevronLeftMedMirrored:"",HelpMirrored:"",ImportMirrored:"",ListMirrored:"",MailForwardMirrored:"",MailReplyMirrored:"",MailReplyAllMirrored:"",OpenPaneMirrored:"",ParkingLocationMirrored:"",SendMirrored:"",ShowResultsMirrored:"",ThumbnailViewMirrored:"",Devices3:"",Lightbulb:"",StatusTriangle:"",VolumeDisabled:"",Puzzle:"",EmojiNeutral:"",EmojiDisappointed:"",HomeSolid:"",Ringer:"",PDF:"",HeartBroken:"",StoreLogo16:"",MultiSelectMirrored:"",Broom:"",Cocktails:"",Wines:"",Articles:"",Cycling:"",DietPlanNotebook:"",Pill:"",ExerciseTracker:"",HandsFree:"",Medical:"",Running:"",Weights:"",Trackers:"",AddNotes:"",AllCurrency:"",BarChart4:"",CirclePlus:"",Coffee:"",Cotton:"",Market:"",Money:"",PieDouble:"",PieSingle:"",RemoveFilter:"",Savings:"",Sell:"",StockDown:"",StockUp:"",Lamp:"",Source:"",MSNVideos:"",Cricket:"",Golf:"",Baseball:" ",Soccer:"",MoreSports:"",AutoRacing:"",CollegeHoops:"",CollegeFootball:"",ProFootball:"",ProHockey:"",Rugby:"",SubstitutionsIn:""}};Object(A.W)(n,t)}function s(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-4"',src:"url('"+e+"fabric-icons-4-aeecd474.woff') format('woff')"},icons:{Tennis:"",Arrivals:"",Design:"",Website:"",Drop:"",SkiResorts:"",Snowflake:"",BusSolid:"",FerrySolid:"",AirplaneSolid:"",TrainSolid:"",Ticket:"",Devices4:"",AzureLogo:"",BingLogo:"",MSNLogo:"",OutlookLogoInverse:"",OfficeLogo:"",SkypeLogo:"",Door:"",EditMirrored:"",GiftCard:"",DoubleBookmark:"",StatusErrorFull:"",Certificate:"",FastForward:"",Rewind:"",Photo2:"",OpenSource:"",Movers:"",CloudDownload:"",Family:"",WindDirection:"",Bug:"",SiteScan:"",BrowserScreenShot:"",F12DevTools:"",CSS:"",JS:"",DeliveryTruck:"",ReminderPerson:"",ReminderGroup:"",TabletMode:"",Umbrella:"",NetworkTower:"",CityNext:"",Section:"",OneNoteLogoInverse:"",ToggleFilled:"",ToggleBorder:"",SliderThumb:"",ToggleThumb:"",Documentation:"",Badge:"",Giftbox:"",VisualStudioLogo:"",ExcelLogoInverse:"",WordLogoInverse:"",PowerPointLogoInverse:"",Cafe:"",SpeedHigh:"",Commitments:"",ThisPC:"",MusicNote:"",MicOff:"",EdgeLogo:" ",CompletedSolid:"",AlbumRemove:"",MessageFill:"",TabletSelected:"",MobileSelected:"",LaptopSelected:"",TVMonitorSelected:"",DeveloperTools:"",InsertTextBox:"",LowerBrightness:"",DOM:"",CloudUpload:"",ScrollUpDown:"",DateTime:"",Event:"",Cake:"",Org:"",PartyLeader:"",DRM:"",CloudAdd:"",AppIconDefault:"",Photo2Add:"",Photo2Remove:"",POI:"",AddTo:"",RadioBtnOff:"",RadioBtnOn:"",ExploreContent:"",Product:"",ProgressLoopInner:"",ProgressLoopOuter:"",Blocked2:"",FangBody:"",ChatInviteFriend:""}};Object(A.W)(n,t)}function u(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-5"',src:"url('"+e+"fabric-icons-5-f6547654.woff') format('woff')"},icons:{Crown:"",Diamond:"",ScaleUp:"",Feedback:"",SharepointLogoInverse:"",YammerLogo:"",Hide:"",Uneditable:"",ReturnToSession:"",OpenFolderHorizontal:"",CalendarMirrored:"",SwayLogoInverse:"",OutOfOffice:"",Trophy:"",ReopenPages:"",EmojiTabSymbols:"",AADLogo:"",AccessLogo:"",AdminALogoInverse32:"",AdminCLogoInverse32:"",AdminDLogoInverse32:"",AdminELogoInverse32:"",AdminLLogoInverse32:"",AdminMLogoInverse32:"",AdminOLogoInverse32:"",AdminPLogoInverse32:"",AdminSLogoInverse32:"",AdminYLogoInverse32:"",DelveLogoInverse:"",ExchangeLogoInverse:"",LyncLogo:"",OfficeVideoLogoInverse:"",SocialListeningLogo:"",VisioLogoInverse:"",Balloons:"",Cat:"",MailAlert:"",MailCheck:"",MailLowImportance:"",MailPause:"",MailRepeat:"",SecurityGroup:"",Table:"",VoicemailForward:"",VoicemailReply:"",Waffle:"",RemoveEvent:"",EventInfo:"",ForwardEvent:"",WipePhone:"",AddOnlineMeeting:"",JoinOnlineMeeting:"",RemoveLink:"",PeopleBlock:"",PeopleRepeat:"",PeopleAlert:"",PeoplePause:"",TransferCall:"",AddPhone:"",UnknownCall:"",NoteReply:"",NoteForward:"",NotePinned:"",RemoveOccurrence:"",Timeline:"",EditNote:"",CircleHalfFull:"",Room:"",Unsubscribe:" ",Subscribe:"",HardDrive:"",RecurringTask:"",TaskManager:"",TaskManagerMirrored:"",Combine:"",Split:"",DoubleChevronUp:"",DoubleChevronLeft:"",DoubleChevronRight:"",TextBox:"",TextField:"",NumberField:"",Dropdown:"",BookingsLogo:"",ClassNotebookLogoInverse:"",DelveAnalyticsLogo:"",DocsLogoInverse:"",Dynamics365Logo:"",DynamicSMBLogo:"",OfficeAssistantLogo:"",OfficeStoreLogo:"",OneNoteEduLogoInverse:"",PlannerLogo:"",PowerApps:"",Suitcase:"",ProjectLogoInverse:"",CaretLeft8:"",CaretRight8:"",CaretUp8:"",CaretDown8:""}};Object(A.W)(n,t)}function f(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-6"',src:"url('"+e+"fabric-icons-6-3954c770.woff') format('woff')"},icons:{CaretLeftSolid8:"",CaretRightSolid8:"",CaretUpSolid8:"",CaretDownSolid8:"",ClearFormatting:"",Superscript:"",Subscript:"",Strikethrough:" ",Export:"",ExportMirrored:"",SingleBookmark:"",SingleBookmarkSolid:"",DoubleChevronDown:"",FollowUser:"",ReplyAll:"",WorkforceManagement:"",RecruitmentManagement:"",Questionnaire:"",ManagerSelfService:"",ReplyMirrored:"",ReplyAllMirrored:"",Medal:"",AddGroup:"",QuestionnaireMirrored:"",TemporaryUser:"",CaretSolid16:"",GroupedDescending:"",GroupedAscending:"",AwayStatus:"",MyMoviesTV:"",GenericScan:"",AustralianRules:"",WifiEthernet:"",TrackersMirrored:"",DateTimeMirrored:"",StopSolid:"",DoubleChevronUp12:"",DoubleChevronDown12:"",DoubleChevronLeft12:"",DoubleChevronRight12:"",CalendarAgenda:"",AddEvent:"",AssetLibrary:"",DataConnectionLibrary:"",DocLibrary:"",FormLibrary:"",FormLibraryMirrored:"",ReportLibrary:"",ReportLibraryMirrored:"",ContactCard:"",CustomList:"",CustomListMirrored:"",IssueTracking:"",IssueTrackingMirrored:"",PictureLibrary:"",OfficeAddinsLogo:"",OfflineOneDriveParachute:"",OfflineOneDriveParachuteDisabled:"",TriangleSolidUp12:"",TriangleSolidDown12:"",TriangleSolidLeft12:"",TriangleSolidRight12:"",TriangleUp12:"",TriangleDown12:"",TriangleLeft12:"",TriangleRight12:"",ArrowUpRight8:"",ArrowDownRight8:"",DocumentSet:"",DelveAnalytics:"",ArrowUpRightMirrored8:"",ArrowDownRightMirrored8:"",CompanyDirectory:"",CompanyDirectoryMirrored:"",OneDriveAdd:"",ProfileSearch:"",Header2:"",Header3:"",Header4:"",Eyedropper:"",MarketDown:"",CalendarWorkWeek:"",SidePanel:"",GlobeFavorite:"",CaretTopLeftSolid8:"",CaretTopRightSolid8:"",ViewAll2:"",DocumentReply:"",PlayerSettings:"",ReceiptForward:"",ReceiptReply:"",ReceiptCheck:"",Fax:"",RecurringEvent:"",ReplyAlt:"",ReplyAllAlt:"",EditStyle:" ",EditMail:"",Lifesaver:"",LifesaverLock:""}};Object(A.W)(n,t)}function l(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-7"',src:"url('"+e+"fabric-icons-7-02107cf8.woff') format('woff')"},icons:{InboxCheck:"",FolderSearch:"",CollapseMenu:"",ExpandMenu:"",Boards:"",SunAdd:"",SunQuestionMark:"",LandscapeOrientation:"",DocumentSearch:"",PublicCalendar:"",PublicContactCard:"",PublicEmail:"",PublicFolder:"",WordDocument:"",PowerPointDocument:"",ExcelDocument:"",GroupedList:"",ClassroomLogo:"",Sections:"",EditPhoto:"",Starburst:"",ShareiOS:"",AirTickets:"",PencilReply:"",Tiles2:"",SkypeCircleCheck:"",SkypeCircleClock:"",SkypeCircleMinus:"",SkypeMessage:"",ClosedCaption:"",ATPLogo:"",OfficeFormsLogoInverse:"",RecycleBin:"",EmptyRecycleBin:"",Hide2:"",Breadcrumb:"",BirthdayCake:"",TimeEntry:"",PageEdit:"",PageRemove:"",Database:"",EditContact:"",ConnectContacts:"",ActivateOrders:" ",DeactivateOrders:"",DocumentManagement:"",CRMReport:"",ZipFolder:"",SurveyQuestions:"",TextDocument:"",TextDocumentShared:"",PageCheckedOut:"",SaveAndClose:"",Script:"",Archive:"",ActivityFeed:"",EventDate:"",ArrowUpRight:"",CaretRight:"",SetAction:"",CaretSolidLeft:"",CaretSolidDown:"",CaretSolidRight:"",CaretSolidUp:"",PowerAppsLogo:"",PowerApps2Logo:"",SearchIssue:"",SearchIssueMirrored:"",FabricAssetLibrary:"",FabricDataConnectionLibrary:"",FabricDocLibrary:"",FabricFormLibrary:"",FabricFormLibraryMirrored:" ",FabricReportLibrary:"",FabricReportLibraryMirrored:"",FabricPublicFolder:"",FabricFolderSearch:"",FabricMovetoFolder:"",FabricUnsyncFolder:"",FabricSyncFolder:"",FabricOpenFolderHorizontal:"",FabricFolder:"",FabricFolderFill:"",FabricNewFolder:"",FabricPictureLibrary:"",AddFavorite:"",AddFavoriteFill:"",BufferTimeBefore:"",BufferTimeAfter:"",BufferTimeBoth:"",CannedChat:"",SkypeForBusinessLogo:"",PageCheckedin:"",ReadOutLoud:"",CaretBottomLeftSolid8:"",CaretBottomRightSolid8:"",FolderHorizontal:"",MicrosoftStaffhubLogo:"",GiftboxOpen:"",StatusCircleOuter:""}};Object(A.W)(n,t)}function p(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-8"',src:"url('"+e+"fabric-icons-8-645fa64e.woff') format('woff')"},icons:{StatusCircleInner:"",StatusCircleRing:"",StatusTriangleOuter:"",StatusTriangleInner:"",StatusTriangleExclamation:"",StatusCircleExclamation:"",StatusCircleErrorX:"",StatusCircleInfo:"",StatusCircleBlock2:"",StatusCircleQuestionMark:"",Toll:" ",ExploreContentSingle:"",CollapseContent:"",CollapseContentSingle:"",InfoSolid:"",ProgressRingDots:"",CaloriesAdd:"",BranchFork:"",MobileReport:"",HardDriveGroup:"",FastMode:"",ToggleOn:"",ToggleOff:"",Trophy2:"",BucketColor:"",BucketColorFill:"",Taskboard:"",SingleColumn:"",DoubleColumn:"",TripleColumn:"",ColumnLeftTwoThirds:"",ColumnRightTwoThirds:"",AccessLogoFill:"",AnalyticsLogo:"",AnalyticsQuery:"",NewAnalyticsQuery:" ",AnalyticsReport:"",WordLogo:"",WordLogoFill:"",ExcelLogo:"",ExcelLogoFill:"",OneNoteLogo:"",OneNoteLogoFill:"",OutlookLogo:"",OutlookLogoFill:"",PowerPointLogo:"",PowerPointLogoFill:"",PublisherLogo:"",PublisherLogoFill:"",ScheduleEventAction:"",FlameSolid:"",ServerProcesses:"",Server:"",SaveAll:"",LinkedInLogo:"",Decimals:"",SidePanelMirrored:"",ProtectRestrict:"",UnknownMirrored:"",PublicContactCardMirrored:"",GridViewSmall:"",GridViewMedium:"",GridViewLarge:"",Step:"",StepInsert:"",StepShared:"",StepSharedAdd:"",StepSharedInsert:"",ViewDashboard:"",ViewList:"",ViewListGroup:"",ViewListTree:"",TriggerAuto:"",TriggerUser:"",PivotChart:"",StackedBarChart:"",StackedLineChart:"",BuildQueue:"",BuildQueueNew:"",UserFollowed:"",ContactLink:"",Stack:"",Bullseye:"",VennDiagram:"",FiveTileGrid:"",FocalPoint:"",RingerRemove:"",TeamsLogoInverse:"",TeamsLogo:"",TeamsLogoFill:"",SkypeForBusinessLogoFill:"",SharepointLogo:"",SharepointLogoFill:"",DelveLogo:"",DelveLogoFill:"",OfficeVideoLogo:"",OfficeVideoLogoFill:"",ExchangeLogo:"",ExchangeLogoFill:"",DocumentApproval:""}};Object(A.W)(n,t)}function b(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-9"',src:"url('"+e+"fabric-icons-9-53746c82.woff') format('woff')"},icons:{CloneToDesktop:"",InstallToDrive:"",Blur:"",Build:"",ProcessMetaTask:"",BranchFork2:"",BranchLocked:"",BranchCommit:"",BranchCompare:"",BranchMerge:"",BranchPullRequest:"",BranchSearch:"",BranchShelveset:"",RawSource:"",MergeDuplicate:"",RowsGroup:"",RowsChild:"",Deploy:"",Redeploy:"",ServerEnviroment:"",VisioDiagram:" ",HighlightMappedShapes:"",TextCallout:"",IconSetsFlag:"",VisioLogo:"",VisioLogoFill:"",VisioDocument:"",TimelineProgress:"",TimelineDelivery:"",Backlog:"",TeamFavorite:"",TaskGroup:"",TaskGroupMirrored:"",ScopeTemplate:"",AssessmentGroupTemplate:"",NewTeamProject:"",CommentAdd:"",CommentNext:"",CommentPrevious:"",ShopServer:"",LocaleLanguage:"",QueryList:"",UserSync:"",UserPause:"",StreamingOff:"",ArrowTallUpLeft:"",ArrowTallUpRight:"",ArrowTallDownLeft:"",ArrowTallDownRight:"",FieldEmpty:"",FieldFilled:"",FieldChanged:"",FieldNotChanged:"",RingerOff:"",PlayResume:"",BulletedList2:"",BulletedList2Mirrored:"",ImageCrosshair:"",GitGraph:"",Repo:"",RepoSolid:"",FolderQuery:"",FolderList:"",FolderListMirrored:"",LocationOutline:"",POISolid:"",CalculatorNotEqualTo:"",BoxSubtractSolid:"",BoxAdditionSolid:"",BoxMultiplySolid:"",BoxPlaySolid:"",BoxCheckmarkSolid:"",CirclePauseSolid:"",CirclePause:"",MSNVideosSolid:"",CircleStopSolid:"",CircleStop:"",NavigateBack:"",NavigateBackMirrored:"",NavigateForward:"",NavigateForwardMirrored:" ",UnknownSolid:"",UnknownMirroredSolid:"",CircleAddition:"",CircleAdditionSolid:"",FilePDB:"",FileTemplate:"",FileSQL:"",FileJAVA:"",FileASPX:"",FileCSS:"",FileSass:"",FileLess:"",FileHTML:"",JavaScriptLanguage:"",CSharpLanguage:"",CSharp:"",VisualBasicLanguage:"",VB:"",CPlusPlusLanguage:""}};Object(A.W)(n,t)}function d(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-10"',src:"url('"+e+"fabric-icons-10-fb519450.woff') format('woff')"},icons:{CPlusPlus:"",FSharpLanguage:"",FSharp:"",TypeScriptLanguage:"",PythonLanguage:"",PY:"",CoffeeScript:"",MarkDownLanguage:"",FullWidth:"",FullWidthEdit:"",Plug:"",PlugSolid:"",PlugConnected:"",PlugDisconnected:"",UnlockSolid:"",Variable:"",Parameter:"",CommentUrgent:"",Storyboard:"",DiffInline:"",DiffSideBySide:"",ImageDiff:"",ImagePixel:"",FileBug:"",FileCode:"",FileComment:"",BusinessHoursSign:"",FileImage:"",FileSymlink:"",AutoFillTemplate:"",WorkItem:"",WorkItemBug:"",LogRemove:"",ColumnOptions:"",Packages:"",BuildIssue:"",AssessmentGroup:"",VariableGroup:"",FullHistory:"",SingleColumnEdit:"",DoubleColumnEdit:"",TripleColumnEdit:"",ColumnLeftTwoThirdsEdit:"",ColumnRightTwoThirdsEdit:"",StreamLogo:"",PassiveAuthentication:"",AlertSolid:"",MegaphoneSolid:"",TaskSolid:"",ConfigurationSolid:"",BugSolid:"",CrownSolid:"",Trophy2Solid:"",QuickNoteSolid:"",ConstructionConeSolid:"",PageListSolid:"",PageListMirroredSolid:"",StarburstSolid:"",ReadingModeSolid:"",SadSolid:"",HealthSolid:"",ShieldSolid:"",GiftBoxSolid:"",ShoppingCartSolid:"",MailSolid:"",ChatSolid:"",RibbonSolid:"",FinancialSolid:"",FinancialMirroredSolid:"",HeadsetSolid:"",PermissionsSolid:"",ParkingSolid:"",ParkingMirroredSolid:"",DiamondSolid:"",AsteriskSolid:"",OfflineStorageSolid:"",BankSolid:"",DecisionSolid:"",Parachute:"",ParachuteSolid:"",FiltersSolid:"",ColorSolid:"",ReviewSolid:"",ReviewRequestSolid:"",ReviewRequestMirroredSolid:"",ReviewResponseSolid:"",FeedbackRequestSolid:"",FeedbackRequestMirroredSolid:"",FeedbackResponseSolid:"",WorkItemBar:"",WorkItemBarSolid:"",Separator:"",NavigateExternalInline:"",PlanView:" ",TimelineMatrixView:"",EngineeringGroup:"",ProjectCollection:"",CaretBottomRightCenter8:"",CaretBottomLeftCenter8:"",CaretTopRightCenter8:""}};Object(A.W)(n,t)}function M(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-11"',src:"url('"+e+"fabric-icons-11-a4026982.woff') format('woff')"},icons:{CaretTopLeftCenter8:"",DonutChart:"",ChevronUnfold10:"",ChevronFold10:"",DoubleChevronDown8:"",DoubleChevronUp8:"",DoubleChevronLeft8:"",DoubleChevronRight8:"",ChevronDownEnd6:"",ChevronUpEnd6:"",ChevronLeftEnd6:"",ChevronRightEnd6:"",ContextMenu:"",AzureAPIManagement:"",AzureServiceEndpoint:"",VSTSLogo:"",VSTSAltLogo1:"",VSTSAltLogo2:"",FileTypeSolution:"",WordLogoInverse16:"",WordLogo16:"",WordLogoFill16:"",PowerPointLogoInverse16:"",PowerPointLogo16:"",PowerPointLogoFill16:"",ExcelLogoInverse16:"",ExcelLogo16:"",ExcelLogoFill16:"",OneNoteLogoInverse16:"",OneNoteLogo16:"",OneNoteLogoFill16:"",OutlookLogoInverse16:"",OutlookLogo16:"",OutlookLogoFill16:"",PublisherLogoInverse16:"",PublisherLogo16:" ",PublisherLogoFill16:"",VisioLogoInverse16:"",VisioLogo16:"",VisioLogoFill16:"",TestBeaker:"",TestBeakerSolid:"",TestExploreSolid:"",TestAutoSolid:"",TestUserSolid:"",TestImpactSolid:"",TestPlan:"",TestStep:"",TestParameter:"",TestSuite:"",TestCase:"",Sprint:"",SignOut:"",TriggerApproval:"",Rocket:"",AzureKeyVault:"",Transition:"",LikeSolid:"",DislikeSolid:"",UnSetColor:"",DeclineCall:"",RectangularClipping:"",TeamsLogo16:"",TeamsLogoFill16:"",Spacer:"",SkypeLogo16:"",SkypeForBusinessLogo16:"",SkypeForBusinessLogoFill16:"",FilterSolid:"",MailUndelivered:"",MailTentative:"",MailTentativeMirrored:"",MailReminder:"",ReceiptUndelivered:"",ReceiptTentative:"",ReceiptTentativeMirrored:"",Inbox:"",IRMReply:"",IRMReplyMirrored:"",IRMForward:"",IRMForwardMirrored:" ",VoicemailIRM:"",EventAccepted:"",EventTentative:"",EventTentativeMirrored:"",EventDeclined:"",IDBadge:"",BackgroundColor:"",OfficeFormsLogoInverse16:"",OfficeFormsLogo:"",OfficeFormsLogoFill:"",OfficeFormsLogo16:"",OfficeFormsLogoFill16:"",OfficeFormsLogoInverse24:"",OfficeFormsLogo24:"",OfficeFormsLogoFill24:"",PageLock:"",NotExecuted:"",NotImpactedSolid:"",FieldReadOnly:""}};Object(A.W)(n,t)}function h(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-12"',src:"url('"+e+"fabric-icons-12-e6882c74.woff') format('woff')"},icons:{FieldRequired:"",BacklogBoard:"",ExternalBuild:"",ExternalTFVC:"",ExternalXAML:"",IssueSolid:"",DefectSolid:"",LadybugSolid:"",NugetLogo:"",TFVCLogo:"",ProjectLogo32:"",ProjectLogoFill32:"",ProjectLogo16:"",ProjectLogoFill16:"",SwayLogo32:"",SwayLogoFill32:"",SwayLogo16:"",SwayLogoFill16:"",ClassNotebookLogo32:"",ClassNotebookLogoFill32:"",ClassNotebookLogo16:"",ClassNotebookLogoFill16:"",ClassNotebookLogoInverse32:"",ClassNotebookLogoInverse16:"",StaffNotebookLogo32:"",StaffNotebookLogoFill32:"",StaffNotebookLogo16:"",StaffNotebookLogoFill16:"",StaffNotebookLogoInverted32:"",StaffNotebookLogoInverted16:"",KaizalaLogo:"",TaskLogo:"",ProtectionCenterLogo32:"",GallatinLogo:"",Globe2:"",Guitar:"",Breakfast:"",Brunch:"",BeerMug:"",Vacation:"",Teeth:" ",Taxi:"",Chopsticks:"",SyncOccurence:"",UnsyncOccurence:"",PrimaryCalendar:"",SearchCalendar:"",VideoOff:"",MicrosoftFlowLogo:"",BusinessCenterLogo:"",ToDoLogoBottom:"",ToDoLogoTop:"",EditSolid12:"",EditSolidMirrored12:"",UneditableSolid12:"",UneditableSolidMirrored12:"",UneditableMirrored:"",AdminALogo32:"",AdminALogoFill32:"",ToDoLogoInverse:"",Snooze:"",WaffleOffice365:" ",ImageSearch:"",NewsSearch:"",VideoSearch:"",R:"",FontColorA:"",FontColorSwatch:"",LightWeight:"",NormalWeight:"",SemiboldWeight:"",GroupObject:"",UngroupObject:"",AlignHorizontalLeft:"",AlignHorizontalCenter:"",AlignHorizontalRight:"",AlignVerticalTop:"",AlignVerticalCenter:"",AlignVerticalBottom:"",HorizontalDistributeCenter:"",VerticalDistributeCenter:"",Ellipse:"",Line:"",Octagon:"",Hexagon:"",Pentagon:"",RightTriangle:"",HalfCircle:"",QuarterCircle:"",ThreeQuarterCircle:"","6PointStar":"","12PointStar":"",ArrangeBringToFront:"",ArrangeSendToBack:"",ArrangeSendBackward:"",ArrangeBringForward:"",BorderDash:"",BorderDot:"",LineStyle:"",LineThickness:""}};Object(A.W)(n,t)}function v(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-13"',src:"url('"+e+"fabric-icons-13-0980cd6d.woff') format('woff')"},icons:{WindowEdit:"",HintText:"",MediaAdd:"",AnchorLock:"",AutoHeight:"",ChartSeries:"",ChartXAngle:"",ChartYAngle:"",Combobox:"",LineSpacing:"",Padding:"",PaddingTop:"",PaddingBottom:"",PaddingLeft:"",PaddingRight:"",NavigationFlipper:"",AlignJustify:"",TextOverflow:"",VisualsFolder:" ",VisualsStore:"",PictureCenter:"",PictureFill:"",PicturePosition:"",PictureStretch:"",PictureTile:"",Slider:"",SliderHandleSize:"",DefaultRatio:"",NumberSequence:"",GUID:"",ReportAdd:"",DashboardAdd:"",MapPinSolid:"",WebPublish:"",PieSingleSolid:"",BlockedSolid:"",DrillDown:"",DrillDownSolid:"",DrillExpand:"",DrillShow:"",OneDriveFolder16:"",FunctionalManagerDashboard:"",BIDashboard:"",CodeEdit:"",RenewalCurrent:"",RenewalFuture:"",SplitObject:"",BulkUpload:"",DownloadDocument:"",WaitlistConfirm:"",WaitlistConfirmMirrored:"",LaptopSecure:"",DragObject:"",EntryView:"",EntryDecline:"",ContactCardSettings:"",ContactCardSettingsMirrored:"",CalendarSettings:"",CalendarSettingsMirrored:"",HardDriveLock:"",HardDriveUnlock:"",AccountManagement:"",TransitionPop:"",TransitionPush:"",TransitionEffect:"",LookupEntities:"",ExploreData:"",AddBookmark:"",SearchBookmark:"",DrillThrough:"",MasterDatabase:"",CertifiedDatabase:"",MaximumValue:"",MinimumValue:"",VisualStudioIDELogo32:"",PasteAsText:"",PasteAsCode:"",BrowserTab:"",BrowserTabScreenshot:"",DesktopScreenshot:"",FileYML:"",ClipboardSolid:"",AnalyticsView:"",Leave:"",Trending12:"",Blocked12:"",Warning12:"",CheckedOutByOther12:"",CheckedOutByYou12:"",CircleShapeSolid:"",SquareShapeSolid:"",TriangleShapeSolid:"",DropShapeSolid:"",RectangleShapeSolid:"",InsertColumnsLeft:"",InsertColumnsRight:"",InsertRowsAbove:"",InsertRowsBelow:"",DeleteColumns:"",DeleteRows:""}};Object(A.W)(n,t)}function g(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-14"',src:"url('"+e+"fabric-icons-14-eb4d1150.woff') format('woff')"},icons:{DeleteRowsMirrored:"",DeleteTable:"",VersionControlPush:"",WhiteBoardApp16:"",WhiteBoardApp32:"",InsertSignatureLine:"",ArrangeByFrom:"",Phishing:"",CreateMailRule:"",PublishCourse:"",DictionaryRemove:"",UserRemove:"",UserEvent:"",Encryption:"",D365TalentLearn:"",D365TalentInsight:"",D365TalentHRCore:"",BacklogList:"",ButtonControl:"",TableGroup:"",MountainClimbing:"",TagUnknown:"",TagUnknownMirror:" ",TagUnknown12:"",TagUnknown12Mirror:"",Link12:"",Presentation:"",Presentation12:"",Lock12:"",BuildDefinition:"",ReleaseDefinition:"",SaveTemplate:"",UserGauge:"",BlockedSiteSolid12:"",TagSolid:"",OfficeChat:"",OfficeChatSolid:"",MailSchedule:""}};Object(A.W)(n,t)}Object.defineProperty(t,"__esModule",{value:!0});var A=n("4b062c29eaf71f6e8d5b");Object(A.V)("trash","delete"),Object(A.V)("onedrive","onedrivelogo"),t.initializeIcons=function(e,t){void 0===e&&(e=O),[r,o,c,i,a,s,u,f,l,p,b,d,M,h,v,g].forEach(function(n){return n(e,t)})};var O="https://spoprod-a.akamaihd.net/files/fabric/assets/icons/"},c79a51aa17480208b8ea:function(e,t,n){"use strict";var r=n("6ab3a222ccd63725ea3a"),o=n("584e93b03a67abaab594"),c=n("71d97e0a6ad15ad887dd"),i=9007199254740991,a=4294967295,s=Math.min;t.a=function(e,t){if((e=Object(c.a)(e))<1||e>i)return[];var n=a,u=s(e,a);t=Object(o.a)(t),e-=a;for(var f=Object(r.a)(u,t);++n<e;)t(n);return f}},c81c22325a11dbeda09d:function(e,t,n){"use strict";var r=n("09072e49d5f60505514c"),o=n("0bd0afb5c74547a322b4"),c=Object(r.a)(o.a,"Map");t.a=c},c92d61b776700b40aa82:function(e,t,n){"use strict";t.a=function(e,t,n,r){for(var o=e.length,c=n+(r?1:-1);r?c--:++c<o;)if(t(e[c],c,e))return c;return-1}},c946ac0dbdac302d1be3:function(e,t,n){"use strict";var r=n("94e64458e50d130bfbf3"),o=n("00522a646af1aaa449a1"),c=r.a?function(e){return r.a.get(e)}:o.a;t.a=c},c9535502986c4b766441:function(e,t,n){var r,o,c;!function(i,a){"use strict";o=[n("72110207b6499adb0ff6")],void 0!==(c="function"==typeof(r=a)?r.apply(t,o):r)&&(e.exports=c)}(0,function(e){"use strict";function t(e){return e>96?e-87:e>64?e-29:e-48}function n(e){var n=0,r=e.split("."),o=r[0],c=r[1]||"",i=1,a=0,s=1;for(45===e.charCodeAt(0)&&(n=1,s=-1),n;n<o.length;n++)a=60*a+t(o.charCodeAt(n));for(n=0;n<c.length;n++)i/=60,a+=t(c.charCodeAt(n))*i;return a*s}function r(e){for(var t=0;t<e.length;t++)e[t]=n(e[t])}function o(e,t){for(var n=0;n<t;n++)e[n]=Math.round((e[n-1]||0)+6e4*e[n]);e[t-1]=1/0}function c(e,t){var n,r=[];for(n=0;n<t.length;n++)r[n]=e[t[n]];return r}function i(e){var t=e.split("|"),n=t[2].split(" "),i=t[3].split(""),a=t[4].split(" ");return r(n),r(i),r(a),o(a,i.length),{name:t[0],abbrs:c(t[1].split(" "),i),offsets:c(n,i),untils:a,population:0|t[5]}}function a(e){e&&this._set(i(e))}function s(e){var t=e.toTimeString(),n=t.match(/\([a-z ]+\)/i);"GMT"===(n=n&&n[0]?(n=n[0].match(/[A-Z]/g))?n.join(""):void 0:(n=t.match(/[A-Z]{3,5}/g))?n[0]:void 0)&&(n=void 0),this.at=+e,this.abbr=n,this.offset=e.getTimezoneOffset()}function u(e){this.zone=e,this.offsetScore=0,this.abbrScore=0}function f(e,t){for(var n,r;r=6e4*((t.at-e.at)/12e4|0);)(n=new s(new Date(e.at+r))).offset===e.offset?e=n:t=n;return e}function l(){var e,t,n,r=(new Date).getFullYear()-2,o=new s(new Date(r,0,1)),c=[o];for(n=1;n<48;n++)(t=new s(new Date(r,n,1))).offset!==o.offset&&(e=f(o,t),c.push(e),c.push(new s(new Date(e.at+6e4)))),o=t;for(n=0;n<4;n++)c.push(new s(new Date(r+n,0,1))),c.push(new s(new Date(r+n,6,1)));return c}function p(e,t){return e.offsetScore!==t.offsetScore?e.offsetScore-t.offsetScore:e.abbrScore!==t.abbrScore?e.abbrScore-t.abbrScore:t.zone.population-e.zone.population}function b(e,t){var n,o;for(r(t),n=0;n<t.length;n++)o=t[n],W[o]=W[o]||{},W[o][e]=!0}function d(e){var t,n,r,o=e.length,c={},i=[];for(t=0;t<o;t++){r=W[e[t].offset]||{};for(n in r)r.hasOwnProperty(n)&&(c[n]=!0)}for(t in c)c.hasOwnProperty(t)&&i.push(T[t]);return i}function M(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e&&e.length>3){var t=T[h(e)];if(t)return t;y("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(e){}var n,r,o,c=l(),i=c.length,a=d(c),s=[];for(r=0;r<a.length;r++){for(n=new u(g(a[r]),i),o=0;o<i;o++)n.scoreOffsetAt(c[o]);s.push(n)}return s.sort(p),s.length>0?s[0].zone.name:void 0}function h(e){return(e||"").toLowerCase().replace(/\//g,"_")}function v(e){var t,n,r,o;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)o=h(n=(r=e[t].split("|"))[0]),N[o]=e[t],T[o]=n,b(o,r[2].split(" "))}function g(e,t){e=h(e);var n,r=N[e];return r instanceof a?r:"string"==typeof r?(r=new a(r),N[e]=r,r):q[e]&&t!==g&&(n=g(q[e],g))?((r=N[e]=new a)._set(n),r.name=T[e],r):null}function A(e){var t,n,r,o;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)r=h((n=e[t].split("|"))[0]),o=h(n[1]),q[r]=o,T[r]=n[0],q[o]=r,T[o]=n[1]}function O(e){return O.didShowError||(O.didShowError=!0,y("moment.tz.zoneExists('"+e+"') has been deprecated in favor of !moment.tz.zone('"+e+"')")),!!g(e)}function z(e){var t="X"===e._f||"x"===e._f;return!(!e._a||void 0!==e._tzm||t)}function y(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}function m(t){var n=Array.prototype.slice.call(arguments,0,-1),r=arguments[arguments.length-1],o=g(r),c=e.utc.apply(null,n);return o&&!e.isMoment(t)&&z(c)&&c.add(o.parse(c),"minutes"),c.tz(r),c}function L(e){return function(){return this._z?this._z.abbr(this):e.call(this)}}var S,N={},q={},T={},W={},B=e.version.split("."),C=+B[0],w=+B[1];(C<2||2===C&&w<6)&&y("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+e.version+". See momentjs.com"),a.prototype={_set:function(e){this.name=e.name,this.abbrs=e.abbrs,this.untils=e.untils,this.offsets=e.offsets,this.population=e.population},_index:function(e){var t,n=+e,r=this.untils;for(t=0;t<r.length;t++)if(n<r[t])return t},parse:function(e){var t,n,r,o,c=+e,i=this.offsets,a=this.untils,s=a.length-1;for(o=0;o<s;o++)if(t=i[o],n=i[o+1],r=i[o?o-1:o],t<n&&m.moveAmbiguousForward?t=n:t>r&&m.moveInvalidForward&&(t=r),c<a[o]-6e4*t)return i[o];return i[s]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){return y("zone.offset has been deprecated in favor of zone.utcOffset"),this.offsets[this._index(e)]},utcOffset:function(e){return this.offsets[this._index(e)]}},u.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.utcOffset(e.at)-e.offset),this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr&&this.abbrScore++},m.version="0.5.17",m.dataVersion="",m._zones=N,m._links=q,m._names=T,m.add=v,m.link=A,m.load=function(e){v(e.zones),A(e.links),m.dataVersion=e.version},m.zone=g,m.zoneExists=O,m.guess=function(e){return S&&!e||(S=M()),S},m.names=function(){var e,t=[];for(e in T)T.hasOwnProperty(e)&&(N[e]||N[q[e]])&&T[e]&&t.push(T[e]);return t.sort()},m.Zone=a,m.unpack=i,m.unpackBase60=n,m.needsOffset=z,m.moveInvalidForward=!0,m.moveAmbiguousForward=!1;var j=e.fn;e.tz=m,e.defaultZone=null,e.updateOffset=function(t,n){var r,o=e.defaultZone;void 0===t._z&&(o&&z(t)&&!t._isUTC&&(t._d=e.utc(t._a)._d,t.utc().add(o.parse(t),"minutes")),t._z=o),t._z&&(r=t._z.utcOffset(t),Math.abs(r)<16&&(r/=60),void 0!==t.utcOffset?t.utcOffset(-r,n):t.zone(r,n))},j.tz=function(t,n){return t?(this._z=g(t),this._z?e.updateOffset(this,n):y("Moment Timezone has no data for "+t+". See http://momentjs.com/timezone/docs/#/data-loading/."),this):this._z?this._z.name:void 0},j.zoneName=L(j.zoneName),j.zoneAbbr=L(j.zoneAbbr),j.utc=function(e){return function(){return this._z=null,e.apply(this,arguments)}}(j.utc),e.tz.setDefault=function(t){return(C<2||2===C&&w<9)&&y("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+e.version+"."),e.defaultZone=t?g(t):null,e};var _=e.momentProperties;return"[object Array]"===Object.prototype.toString.call(_)?(_.push("_z"),_.push("_a")):_&&(_._z=null),e})},c9c1436a8870b75df6cf:function(e,t,n){"use strict";var r=n("ba53fce2bec9e4ed267c"),o=n("bf1d5db339a3b78b70c2"),c=n("67f913577889d7d73251");t.a=function(e,t){return Object(c.a)(Object(o.a)(e,t,r.a),e+"")}},cad9253704d182fd1e4c:function(e,t){e.exports='<div class="flex-fill">\r\n  <div class="error" ng-if="bridgeController.isError">Bridge failed to load</div>\r\n  <div class=\'flex-fill\' ng-if="!bridgeController.isError" ng-transclude></div>\r\n</div>\r\n'},cd6a8bc2ba13c01d7009:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},ce71aab72200cc3b4ad0:function(e,t,n){"use strict";var r=n("1ac3f0f0bc8d121416c3"),o=Object.prototype.hasOwnProperty;t.a=function(e){for(var t=e.name+"",n=r.a[t],c=o.call(r.a,t)?n.length:0;c--;){var i=n[c],a=i.func;if(null==a||a==e)return i.name}return t}},d1086fdefae624fdb03d:function(e,t,n){"use strict";var r=n("fca350482fff53036cf0"),o=n("e762c53944e0ba53de07"),c=1,i=2;t.a=function(e,t,n,a){var s=n.length,u=s,f=!a;if(null==e)return!u;for(e=Object(e);s--;){var l=n[s];if(f&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<u;){var p=(l=n[s])[0],b=e[p],d=l[1];if(f&&l[2]){if(void 0===b&&!(p in e))return!1}else{var M=new r.a;if(a)var h=a(b,d,p,e,t,M);if(!(void 0===h?Object(o.a)(d,b,c|i,a,M):h))return!1}}return!0}},d11316739b90bfeb3b2f:function(e,t,n){"use strict";var r=n("c92d61b776700b40aa82"),o=n("14a2d3a77eb6ff2980ad"),c=function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r},i=n("71d97e0a6ad15ad887dd"),a=Math.max,s=Math.min;t.a=function(e,t,n){var u=null==e?0:e.length;if(!u)return-1;var f=u;return void 0!==n&&(f=(f=Object(i.a)(n))<0?a(u+f,0):s(f,u-1)),t===t?c(e,t,f):Object(r.a)(e,o.a,f,!0)}},d336cfdf83500abe5b8b:function(e,t,n){"use strict";(function(t){function r(e){var n,r={},o=typeof(e=e||t.location||{});if("blob:"===e.protocol)r=new i(unescape(e.pathname),{});else if("string"===o){r=new i(e,{});for(n in p)delete r[n]}else if("object"===o){for(n in e)n in p||(r[n]=e[n]);void 0===r.slashes&&(r.slashes=f.test(e.href))}return r}function o(e){var t=u.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function c(e,t){for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,o=n[r-1],c=!1,i=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),i++):i&&(0===r&&(c=!0),n.splice(r,1),i--);return c&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}function i(e,t,n){if(!(this instanceof i))return new i(e,t,n);var u,f,p,b,d,M,h=l.slice(),v=typeof t,g=this,A=0;for("object"!==v&&"string"!==v&&(n=t,t=null),n&&"function"!=typeof n&&(n=s.parse),t=r(t),u=!(f=o(e||"")).protocol&&!f.slashes,g.slashes=f.slashes||u&&t.slashes,g.protocol=f.protocol||t.protocol||"",e=f.rest,f.slashes||(h[2]=[/(.*)/,"pathname"]);A<h.length;A++)p=(b=h[A])[0],M=b[1],p!==p?g[M]=e:"string"==typeof p?~(d=e.indexOf(p))&&("number"==typeof b[2]?(g[M]=e.slice(0,d),e=e.slice(d+b[2])):(g[M]=e.slice(d),e=e.slice(0,d))):(d=p.exec(e))&&(g[M]=d[1],e=e.slice(0,d.index)),g[M]=g[M]||(u&&b[3]?t[M]||"":""),b[4]&&(g[M]=g[M].toLowerCase());n&&(g.query=n(g.query)),u&&t.slashes&&"/"!==g.pathname.charAt(0)&&(""!==g.pathname||""!==t.pathname)&&(g.pathname=c(g.pathname,t.pathname)),a(g.port,g.protocol)||(g.host=g.hostname,g.port=""),g.username=g.password="",g.auth&&(b=g.auth.split(":"),g.username=b[0]||"",g.password=b[1]||""),g.origin=g.protocol&&g.host&&"file:"!==g.protocol?g.protocol+"//"+g.host:"null",g.href=g.toString()}var a=n("d47c03267be396eb5713"),s=n("826cde10a99434acc2b5"),u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,f=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,l=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],p={hash:1,query:1};i.prototype={set:function(e,t,n){var r=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||s.parse)(t)),r[e]=t;break;case"port":r[e]=t,a(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,/:\d+$/.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";r[e]=t.charAt(0)!==o?o+t:t}else r[e]=t;break;default:r[e]=t}for(var c=0;c<l.length;c++){var i=l[c];i[4]&&(r[i[1]]=r[i[1]].toLowerCase())}return r.origin=r.protocol&&r.host&&"file:"!==r.protocol?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},toString:function(e){e&&"function"==typeof e||(e=s.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var o=r+(n.slashes?"//":"");return n.username&&(o+=n.username,n.password&&(o+=":"+n.password),o+="@"),o+=n.host+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(o+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(o+=n.hash),o}},i.extractProtocol=o,i.location=r,i.qs=s,e.exports=i}).call(t,n("698d75b157f24ae829cc"))},d37896eaa91c67cdcc68:function(e,t,n){"use strict";var r=n("8d1246b164f341c9a62f"),o=n("f3d9c495aaedd8ec38a5");t.a=function(e){for(var t=Object(o.a)(e),n=t.length;n--;){var c=t[n],i=e[c];t[n]=[c,i,Object(r.a)(i)]}return t}},d392773eadf2f2ade722:function(e,t,n){"use strict";var r=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.a=function(e){return r.test(e)}},d423f003db2cbb5863ff:function(e,t,n){"use strict";var r=n("6fb0743f2477864eee04"),o=n("978b85f07cd53ebdd0f6"),c="[object AsyncFunction]",i="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";t.a=function(e){if(!Object(o.a)(e))return!1;var t=Object(r.a)(e);return t==i||t==a||t==c||t==s}},d47c03267be396eb5713:function(e,t,n){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},d56f7770a2489fe4ede0:function(e,t,n){"use strict";t.a=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var o=e[t];r[o[0]]=o[1]}return r}},d573284d3226e08a305e:function(e,t,n){"use strict";var r=n("0bd0afb5c74547a322b4").a["__core-js_shared__"];t.a=r},d6f63ba407b404b4a22d:function(e,t,n){"use strict";function r(e){o?o(e):console&&console.warn&&console.warn(e)}t.d=function(e,t,n){for(var o in n)if(t&&o in t){var c=e+" property '"+o+"' was used but has been deprecated.",i=n[o];i&&(c+=" Use '"+i+"' instead."),r(c)}},t.e=function(e,t,n){for(var o in n)if(t&&o in t){var c=n[o];c&&c in t&&r(e+" property '"+o+"' is mutually exclusive with '"+n[o]+"'. Use one or the other.")}},t.c=function(e,t,n,o,c){if(!0===c)for(var i=0,a=n;i<a.length;i++){var s=a[i];s in t||r(e+" property '"+s+"' is required when '"+o+"' is used.'")}},t.b=r,t.a=function(e){o=e};var o=void 0},d7d4fca6d5f8306ef0a5:function(e,t,n){"use strict";var r=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},daea84c148dbc0bf9b45:function(e,t,n){"use strict";t.a=function(){return[]}},db392ee8f4879554196e:function(e,t,n){"use strict";function r(){try{return o.apply(this,arguments)}catch(e){return c.errorObject.e=e,c.errorObject}}var o,c=n("0d2a916b77eeb630f9fa");t.tryCatch=function(e){return o=e,r}},dbd0c220e64346f05446:function(e,t,n){"use strict";var r=n("36dcb0d197c09ea9afe9"),o=n("26e9318898852c9495dd"),c=n("0bd0afb5c74547a322b4"),i=1,a=function(e,t,n){function r(){return(this&&this!==c.a&&this instanceof r?s:e).apply(a?n:this,arguments)}var a=t&i,s=Object(o.a)(e);return r},s=n("13a0a4d0580180405100"),u=n("c2e8e7d53dcf6f8b6c2a"),f=n("c0efcc44a862c6ccf5d3"),l=n("b62cbc8d532fe17bedcb"),p=n("e5205903969d9dc4f02d"),b=function(e,t,n){function r(){for(var o=arguments.length,a=Array(o),b=o,d=Object(l.a)(r);b--;)a[b]=arguments[b];var M=o<3&&a[0]!==d&&a[o-1]!==d?[]:Object(p.a)(a,d);if((o-=M.length)<n)return Object(f.a)(e,t,u.a,r.placeholder,void 0,a,M,void 0,void 0,n-o);var h=this&&this!==c.a&&this instanceof r?i:e;return Object(s.a)(h,this,a)}var i=Object(o.a)(e);return r},d=1,M=function(e,t,n,r){function i(){for(var t=-1,o=arguments.length,f=-1,l=r.length,p=Array(l+o),b=this&&this!==c.a&&this instanceof i?u:e;++f<l;)p[f]=r[f];for(;o--;)p[f++]=arguments[++t];return Object(s.a)(b,a?n:this,p)}var a=t&d,u=Object(o.a)(e);return i},h=n("c946ac0dbdac302d1be3"),v=n("dd85f620557a250b3166"),g=n("f53e45c8b3e36c6dcef9"),A="__lodash_placeholder__",O=1,z=2,y=4,m=8,L=128,S=256,N=Math.min,q=function(e,t){var n=e[1],r=t[1],o=n|r,c=o<(O|z|L),i=r==L&&n==m||r==L&&n==S&&e[7].length<=t[8]||r==(L|S)&&t[7].length<=t[8]&&n==m;if(!c&&!i)return e;r&O&&(e[2]=t[2],o|=n&O?0:y);var a=t[3];if(a){var s=e[3];e[3]=s?Object(v.a)(s,a,t[4]):a,e[4]=s?Object(p.a)(e[3],A):t[4]}return(a=t[5])&&(s=e[5],e[5]=s?Object(g.a)(s,a,t[6]):a,e[6]=s?Object(p.a)(e[5],A):t[6]),(a=t[7])&&(e[7]=a),r&L&&(e[8]=null==e[8]?t[8]:N(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o,e},T=n("a350c0c489bcd73fc97c"),W=n("4e5f58ad7c5e5b3d7316"),B=n("71d97e0a6ad15ad887dd"),C="Expected a function",w=1,j=2,_=8,X=16,E=32,k=64,R=Math.max;t.a=function(e,t,n,o,c,i,s,f){var l=t&j;if(!l&&"function"!=typeof e)throw new TypeError(C);var p=o?o.length:0;if(p||(t&=~(E|k),o=c=void 0),s=void 0===s?s:R(Object(B.a)(s),0),f=void 0===f?f:Object(B.a)(f),p-=c?c.length:0,t&k){var d=o,v=c;o=c=void 0}var g=l?void 0:Object(h.a)(e),A=[e,t,n,o,c,d,v,i,s,f];if(g&&q(A,g),e=A[0],t=A[1],n=A[2],o=A[3],c=A[4],!(f=A[9]=void 0===A[9]?l?0:e.length:R(A[9]-p,0))&&t&(_|X)&&(t&=~(_|X)),t&&t!=w)O=t==_||t==X?b(e,t,f):t!=E&&t!=(w|E)||c.length?u.a.apply(void 0,A):M(e,t,n,o);else var O=a(e,t,n);var z=g?r.a:T.a;return Object(W.a)(z(O,A),e,t)}},dbf5d091004dd78b9cad:function(e,t,n){"use strict";(function(e){var r=n("03f2c9f483943a5aa073"),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,c=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=c&&c.exports===o&&r.a.process,a=function(){try{var e=c&&c.require&&c.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();t.a=a}).call(t,n("044f282f6141fc605782")(e))},dd85f620557a250b3166:function(e,t,n){"use strict";var r=Math.max;t.a=function(e,t,n,o){for(var c=-1,i=e.length,a=n.length,s=-1,u=t.length,f=r(i-a,0),l=Array(u+f),p=!o;++s<u;)l[s]=t[s];for(;++c<a;)(p||c<i)&&(l[n[c]]=e[c]);for(;f--;)l[s++]=e[c++];return l}},dda421216ae1aabc3eb0:function(e,t,n){"use strict";var r=800,o=16,c=Date.now;t.a=function(e){var t=0,n=0;return function(){var i=c(),a=o-(i-n);if(n=i,a>0){if(++t>=r)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},de7f2df91c095f0cd45d:function(e,t){e.exports=ReactDOM},e28c9f1338beee7c9991:function(e,t,n){"use strict";var r=n("b2c7895933e4aed40b1d"),o=n("6ad221eee0fd1bc82bdc"),c=n("f76c3b2fae372b75aaef"),i=n("45d1013502405ff7e024"),a=n("68bdc87fa9db91da28b2"),s="[object Map]",u="[object Set]";t.a=function(e){if(null==e)return 0;if(Object(c.a)(e))return Object(i.a)(e)?Object(a.a)(e):e.length;var t=Object(o.a)(e);return t==s||t==u?e.size:Object(r.a)(e).length}},e40215a0f909d4abb6b7:function(e,t,n){"use strict";t.b=function(e){return!!o[e]},t.a=function(e){o[e]=1};var r,o=(r={},r[38]=1,r[40]=1,r[37]=1,r[39]=1,r[36]=1,r[35]=1,r[9]=1,r[33]=1,r[34]=1,r)},e41ebfedd2623af3046b:function(e,t,n){"use strict";var r=n("ea6fae70f959b1d35df9"),o=Object(r.a)();t.a=o},e5205903969d9dc4f02d:function(e,t,n){"use strict";var r="__lodash_placeholder__";t.a=function(e,t){for(var n=-1,o=e.length,c=0,i=[];++n<o;){var a=e[n];a!==t&&a!==r||(e[n]=r,i[c++]=n)}return i}},e762c53944e0ba53de07:function(e,t,n){"use strict";function r(e,t,n,o,c){return e===t||(null==e||null==t||!Object(V.a)(e)&&!Object(V.a)(t)?e!==e&&t!==t:H(e,t,n,o,r,c))}var o=n("fca350482fff53036cf0"),c=n("35a29cebca36f3a27147"),i=n("19455a0e3b36c61ab3d4"),a=n("4925aa2ed200fbe812f5"),s=1,u=2,f=function(e,t,n,r,o,f){var l=n&s,p=e.length,b=t.length;if(p!=b&&!(l&&b>p))return!1;var d=f.get(e);if(d&&f.get(t))return d==t;var M=-1,h=!0,v=n&u?new c.a:void 0;for(f.set(e,t),f.set(t,e);++M<p;){var g=e[M],A=t[M];if(r)var O=l?r(A,g,M,t,e,f):r(g,A,M,e,t,f);if(void 0!==O){if(O)continue;h=!1;break}if(v){if(!Object(i.a)(t,function(e,t){if(!Object(a.a)(v,t)&&(g===e||o(g,e,n,r,f)))return v.push(t)})){h=!1;break}}else if(g!==A&&!o(g,A,n,r,f)){h=!1;break}}return f.delete(e),f.delete(t),h},l=n("41d5bf03b3e7b6dc3b9b"),p=n("a50cc60cf2cb5b489ec3"),b=n("fb3a2b210e1d3add6253"),d=n("5674af6f52f89608631c"),M=n("72a6689db872874504a6"),h=1,v=2,g="[object Boolean]",A="[object Date]",O="[object Error]",z="[object Map]",y="[object Number]",m="[object RegExp]",L="[object Set]",S="[object String]",N="[object Symbol]",q="[object ArrayBuffer]",T="[object DataView]",W=l.a?l.a.prototype:void 0,B=W?W.valueOf:void 0,C=function(e,t,n,r,o,c,i){switch(n){case T:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case q:return!(e.byteLength!=t.byteLength||!c(new p.a(e),new p.a(t)));case g:case A:case y:return Object(b.a)(+e,+t);case O:return e.name==t.name&&e.message==t.message;case m:case S:return e==t+"";case z:var a=d.a;case L:var s=r&h;if(a||(a=M.a),e.size!=t.size&&!s)return!1;var u=i.get(e);if(u)return u==t;r|=v,i.set(e,t);var l=f(a(e),a(t),r,o,c,i);return i.delete(e),l;case N:if(B)return B.call(e)==B.call(t)}return!1},w=n("bd2f00b64cdde6ff3297"),j=1,_=Object.prototype.hasOwnProperty,X=function(e,t,n,r,o,c){var i=n&j,a=Object(w.a)(e),s=a.length;if(s!=Object(w.a)(t).length&&!i)return!1;for(var u=s;u--;){var f=a[u];if(!(i?f in t:_.call(t,f)))return!1}var l=c.get(e);if(l&&c.get(t))return l==t;var p=!0;c.set(e,t),c.set(t,e);for(var b=i;++u<s;){var d=e[f=a[u]],M=t[f];if(r)var h=i?r(M,d,f,t,e,c):r(d,M,f,e,t,c);if(!(void 0===h?d===M||o(d,M,n,r,c):h)){p=!1;break}b||(b="constructor"==f)}if(p&&!b){var v=e.constructor,g=t.constructor;v!=g&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof g&&g instanceof g)&&(p=!1)}return c.delete(e),c.delete(t),p},E=n("6ad221eee0fd1bc82bdc"),k=n("517d6e3962b3db33796d"),R=n("b8c08b527e4f22d848fd"),P=n("38221194fe782b107f03"),x=1,D="[object Arguments]",I="[object Array]",F="[object Object]",U=Object.prototype.hasOwnProperty,H=function(e,t,n,r,c,i){var a=Object(k.a)(e),s=Object(k.a)(t),u=a?I:Object(E.a)(e),l=s?I:Object(E.a)(t),p=(u=u==D?F:u)==F,b=(l=l==D?F:l)==F,d=u==l;if(d&&Object(R.a)(e)){if(!Object(R.a)(t))return!1;a=!0,p=!1}if(d&&!p)return i||(i=new o.a),a||Object(P.a)(e)?f(e,t,n,r,c,i):C(e,t,u,n,r,c,i);if(!(n&x)){var M=p&&U.call(e,"__wrapped__"),h=b&&U.call(t,"__wrapped__");if(M||h){var v=M?e.value():e,g=h?t.value():t;return i||(i=new o.a),c(v,g,n,r,i)}}return!!d&&(i||(i=new o.a),X(e,t,n,r,c,i))},V=n("26d635265766889bfb00");t.a=r},e766c598676a77c10541:function(e,t,n){"use strict";var r=n("c92d61b776700b40aa82"),o=n("14a2d3a77eb6ff2980ad"),c=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1};t.a=function(e,t,n){return t===t?c(e,t,n):Object(r.a)(e,o.a,n)}},e8ee4347350f37f94529:function(e,t,n){"use strict";var r=n("25153e86102d7241054d"),o=n("f76c3b2fae372b75aaef");t.a=function(e,t){var n=-1,c=Object(o.a)(e)?Array(e.length):[];return Object(r.a)(e,function(e,r,o){c[++n]=t(e,r,o)}),c}},e912579201d6b2659f44:function(e,t,n){"use strict";var r=n("517d6e3962b3db33796d"),o=n("f0ecf12d5be0fc5eff7f"),c=n("ae807d87f71d0705eaab"),i=n("2bb326b5a5bdfb8f3774");t.a=function(e,t){return Object(r.a)(e)?e:Object(o.a)(e,t)?[e]:Object(c.a)(Object(i.a)(e))}},ea2194eda6874f39b8b5:function(e,t,n){"use strict";var r=n("f76c3b2fae372b75aaef"),o=n("26d635265766889bfb00");t.a=function(e){return Object(o.a)(e)&&Object(r.a)(e)}},ea2effc0f6d665f6ba8e:function(e,t,n){"use strict";t.a=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},ea6fae70f959b1d35df9:function(e,t,n){"use strict";t.a=function(e){return function(t,n,r){for(var o=-1,c=Object(t),i=r(t),a=i.length;a--;){var s=i[e?a:++o];if(!1===n(c[s],s,c))break}return t}}},ed5c7a11e99b2467a279:function(e,t,n){"use strict";var r;!function(e){e.PINNED="PINNED",e.RECENTS="RECENTS"}(r||(r={}));var o=function(){function e(){this.pinnedChats=[{id:"pinned chat id",title:"pinned chat title"}],this.recentChats=[{id:"recent chat id",title:"recent chat title"},{id:"recent chat id 2",title:"recent chat title 2"},{id:"recent chat id 3",title:"recent chat title 3"}],this.expandedLists={PINNED:!0,RECENTS:!0},this.isRtl=!1,this.noChatsText="no chats text"}return e.prototype.notifyChatListRendered=function(e,t){},e.prototype.navigateToChat=function(e){},e.prototype.setSelectedChatId=function(e){},e.prototype.reorderPinned=function(e){return!1},e.prototype.pinChat=function(e){return!1},e.prototype.addFavorite=function(e){},e.prototype.setChatVisibility=function(e,t){},e.prototype.updateMuteChat=function(e,t){},e.prototype.unpinChat=function(e){},e.prototype.discardChat=function(e){},e.prototype.leaveChat=function(e){},e.prototype.setBotChatBlock=function(e,t){return Promise.resolve()},e.prototype.countUnreadVisibleChats=function(){return this.unreadCount||0},e.prototype.updateUnreadCountFromChatList=function(e){this.unreadCount=e},e.prototype.getAriaLabel=function(e,t){return null},e.prototype.compileIntoAngular=function(e){},e.prototype.contextMenuOpened=function(){},e.prototype.contextMenuClosed=function(){},e}();n.d(t,"a",function(){return r}),n.d(t,!1,function(){return o})},ee431cdcdf25341aafd8:function(e,t){e.exports=AuthenticationContext},eeb89c4dda5b564b5094:function(e,t,n){"use strict";var r=n("6fb0743f2477864eee04"),o=n("26d635265766889bfb00"),c="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(o.a)(e)&&Object(r.a)(e)==c}},f0ecf12d5be0fc5eff7f:function(e,t,n){"use strict";var r=n("517d6e3962b3db33796d"),o=n("eeb89c4dda5b564b5094"),c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;t.a=function(e,t){if(Object(r.a)(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Object(o.a)(e))||i.test(e)||!c.test(e)||null!=t&&e in Object(t)}},f1c0e74a95dfbe71c6f0:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},f2401f53bf28e2b70eb3:function(e,t,n){"use strict";function r(e){if(Object(s.a)(e)&&!Object(a.a)(e)&&!(e instanceof o.a)){if(e instanceof c.a)return e;if(f.call(e,"__wrapped__"))return Object(u.a)(e)}return new c.a(e)}var o=n("337b9e67dd20ada80fa5"),c=n("99ab8b568ca97366239b"),i=n("b6b32bb34d326922d674"),a=n("517d6e3962b3db33796d"),s=n("26d635265766889bfb00"),u=n("5c8bc8b62030f5c53cf0"),f=Object.prototype.hasOwnProperty;(r.prototype=i.a.prototype).constructor=r,t.a=r},f3449eea2e93f9e8fcd6:function(e,t,n){"use strict";(function(e){function n(e,t){for(var n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||t[n]!==e[n]))return!1;return!0}function r(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t=t||{};for(var o=0,c=n;o<c.length;o++){var i=c[o];if(i)for(var a in i)!i.hasOwnProperty(a)||e&&!e(a)||(t[a]=i[a])}return t}t.e=function(e,t){return n(e,t)&&n(t,e)},t.a=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(this,[null,e].concat(t))},t.b=r,t.c=function(e){var t=i[o]++;return(e||c)+t},t.d=function(e,t){return Object.keys(e).map(function(n){if(String(Number(n))!==n)return t(n,e[n])}).filter(function(e){return!!e})},t.f=function(e){return Object.keys(e).reduce(function(t,n){return t.push(e[n]),t},[])};var o="__currentId__",c="id__",i="undefined"!=typeof window&&window||e;void 0===i[o]&&(i[o]=0)}).call(t,n("26d59f808dff3e83c741"))},f3d9c495aaedd8ec38a5:function(e,t,n){"use strict";var r=n("40c1a00b3363fb21280a"),o=n("b2c7895933e4aed40b1d"),c=n("f76c3b2fae372b75aaef");t.a=function(e){return Object(c.a)(e)?Object(r.a)(e):Object(o.a)(e)}},f529b206b18b84c5d164:function(e,t,n){"use strict";t.a=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},f53e45c8b3e36c6dcef9:function(e,t,n){"use strict";var r=Math.max;t.a=function(e,t,n,o){for(var c=-1,i=e.length,a=-1,s=n.length,u=-1,f=t.length,l=r(i-s,0),p=Array(l+f),b=!o;++c<l;)p[c]=e[c];for(var d=c;++u<f;)p[d+u]=t[u];for(;++a<s;)(b||c<i)&&(p[d+n[a]]=e[c++]);return p}},f5d812633866a6a25035:function(e,t,n){"use strict";t.a=function(){return!1}},f76c3b2fae372b75aaef:function(e,t,n){"use strict";var r=n("d423f003db2cbb5863ff"),o=n("f1c0e74a95dfbe71c6f0");t.a=function(e){return null!=e&&Object(o.a)(e.length)&&!Object(r.a)(e)}},f89589b25fe2f057e3ca:function(e,t,n){(function(e,r){function o(e,n){var r={seen:[],stylize:i};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),M(n)?r.showHidden=n:n&&t._extend(r,n),A(r.showHidden)&&(r.showHidden=!1),A(r.depth)&&(r.depth=2),A(r.colors)&&(r.colors=!1),A(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),s(r,e,r.depth)}function c(e,t){var n=o.styles[t];return n?"["+o.colors[n][0]+"m"+e+"["+o.colors[n][1]+"m":e}function i(e,t){return e}function a(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function s(e,n,r){if(e.customInspect&&n&&L(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return g(o)||(o=s(e,o,r)),o}var c=u(e,n);if(c)return c;var i=Object.keys(n),M=a(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(n)),m(n)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return f(n);if(0===i.length){if(L(n)){var h=n.name?": "+n.name:"";return e.stylize("[Function"+h+"]","special")}if(O(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(y(n))return e.stylize(Date.prototype.toString.call(n),"date");if(m(n))return f(n)}var v="",A=!1,z=["{","}"];if(d(n)&&(A=!0,z=["[","]"]),L(n)&&(v=" [Function"+(n.name?": "+n.name:"")+"]"),O(n)&&(v=" "+RegExp.prototype.toString.call(n)),y(n)&&(v=" "+Date.prototype.toUTCString.call(n)),m(n)&&(v=" "+f(n)),0===i.length&&(!A||0==n.length))return z[0]+v+z[1];if(r<0)return O(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n);var S;return S=A?l(e,n,r,M,i):i.map(function(t){return p(e,n,r,M,t,A)}),e.seen.pop(),b(S,v,z)}function u(e,t){if(A(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return v(t)?e.stylize(""+t,"number"):M(t)?e.stylize(""+t,"boolean"):h(t)?e.stylize("null","null"):void 0}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,n,r,o){for(var c=[],i=0,a=t.length;i<a;++i)T(t,String(i))?c.push(p(e,t,n,r,String(i),!0)):c.push("");return o.forEach(function(o){o.match(/^\d+$/)||c.push(p(e,t,n,r,o,!0))}),c}function p(e,t,n,r,o,c){var i,a,u;if((u=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),T(r,o)||(i="["+o+"]"),a||(e.seen.indexOf(u.value)<0?(a=h(n)?s(e,u.value,null):s(e,u.value,n-1)).indexOf("\n")>-1&&(a=c?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),A(i)){if(c&&o.match(/^\d+$/))return a;(i=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(i=i.substr(1,i.length-2),i=e.stylize(i,"name")):(i=i.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),i=e.stylize(i,"string"))}return i+": "+a}function b(e,t,n){var r=0;return e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function d(e){return Array.isArray(e)}function M(e){return"boolean"==typeof e}function h(e){return null===e}function v(e){return"number"==typeof e}function g(e){return"string"==typeof e}function A(e){return void 0===e}function O(e){return z(e)&&"[object RegExp]"===S(e)}function z(e){return"object"==typeof e&&null!==e}function y(e){return z(e)&&"[object Date]"===S(e)}function m(e){return z(e)&&("[object Error]"===S(e)||e instanceof Error)}function L(e){return"function"==typeof e}function S(e){return Object.prototype.toString.call(e)}function N(e){return e<10?"0"+e.toString(10):e.toString(10)}function q(){var e=new Date,t=[N(e.getHours()),N(e.getMinutes()),N(e.getSeconds())].join(":");return[e.getDate(),w[e.getMonth()],t].join(" ")}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var W=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,c=r.length,i=String(e).replace(W,function(e){if("%%"===e)return"%";if(n>=c)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),a=r[n];n<c;a=r[++n])h(a)||!z(a)?i+=" "+a:i+=" "+o(a);return i},t.deprecate=function(n,o){if(A(e.process))return function(){return t.deprecate(n,o).apply(this,arguments)};if(!0===r.noDeprecation)return n;var c=!1;return function(){if(!c){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),c=!0}return n.apply(this,arguments)}};var B,C={};t.debuglog=function(e){if(A(B)&&(B=Object({NODE_ENV:"production"}).NODE_DEBUG||""),e=e.toUpperCase(),!C[e])if(new RegExp("\\b"+e+"\\b","i").test(B)){var n=r.pid;C[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else C[e]=function(){};return C[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=M,t.isNull=h,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=A,t.isRegExp=O,t.isObject=z,t.isDate=y,t.isError=m,t.isFunction=L,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n("48d2f0c12c34837ccce6");var w=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",q(),t.format.apply(t,arguments))},t.inherits=n("26b9c59acec1595afa89"),t._extend=function(e,t){if(!t||!z(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(t,n("698d75b157f24ae829cc"),n("26d59f808dff3e83c741"))},f9fcd5e1be45a6d7936a:function(e,t,n){"use strict";var r=n("fb3a2b210e1d3add6253"),o=n("f76c3b2fae372b75aaef"),c=n("7af3fc0c351e507691be"),i=n("978b85f07cd53ebdd0f6");t.a=function(e,t,n){if(!Object(i.a)(n))return!1;var a=typeof t;return!!("number"==a?Object(o.a)(n)&&Object(c.a)(t,n.length):"string"==a&&t in n)&&Object(r.a)(n[t],e)}},fa11070de994a894b2a1:function(e,t,n){"use strict";var r=n("e41ebfedd2623af3046b"),o=n("f3d9c495aaedd8ec38a5");t.a=function(e,t){return e&&Object(r.a)(e,t,o.a)}},fb048f05e0262d24631e:function(e,t,n){"use strict";var r=n("d1086fdefae624fdb03d"),o=n("d37896eaa91c67cdcc68"),c=n("2a5ddf2bc8c2e65634a8");t.a=function(e){var t=Object(o.a)(e);return 1==t.length&&t[0][2]?Object(c.a)(t[0][0],t[0][1]):function(n){return n===e||Object(r.a)(n,e,t)}}},fb3a2b210e1d3add6253:function(e,t,n){"use strict";t.a=function(e,t){return e===t||e!==e&&t!==t}},fc4c6ea1418d5409cd3b:function(e,t,n){"use strict";var r=n("4605ae836ca138d7eb59"),o=n("8fc3969d4aefbcbee5ea");t.a=function(e,t){var n=[];if(!e||!e.length)return n;var c=-1,i=[],a=e.length;for(t=Object(r.a)(t,3);++c<a;){var s=e[c];t(s,c,e)&&(n.push(s),i.push(c))}return Object(o.a)(e,i),n}},fca350482fff53036cf0:function(e,t,n){"use strict";function r(e){var t=this.__data__=new o.a(e);this.size=t.size}var o=n("5369f199f57943db5523"),c=n("c81c22325a11dbeda09d"),i=n("ad8cc569f3f069fb91a0"),a=200;r.prototype.clear=function(){this.__data__=new o.a,this.size=0},r.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},r.prototype.get=function(e){return this.__data__.get(e)},r.prototype.has=function(e){return this.__data__.has(e)},r.prototype.set=function(e,t){var n=this.__data__;if(n instanceof o.a){var r=n.__data__;if(!c.a||r.length<a-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new i.a(r)}return n.set(e,t),this.size=n.size,this};t.a=r},fcb014d4447b3f993dec:function(e,t,n){"use strict";function r(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(c);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],c=n.cache;if(c.has(o))return c.get(o);var i=e.apply(this,r);return n.cache=c.set(o,i)||c,i};return n.cache=new(r.Cache||o.a),n}var o=n("ad8cc569f3f069fb91a0"),c="Expected a function";r.Cache=o.a,t.a=r},fe4d25c82df832cc2fcb:function(e,t,n){"use strict";var r=n("c9c1436a8870b75df6cf"),o=n("9e8a7f8c69636f440e01"),c=Object(r.a)(function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Object(o.a)(e,n)});t.a=c}});
!function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var r=window.webpackJsonp;window.webpackJsonp=function(t,c,u){for(var i,a,f,l=0,s=[];l<t.length;l++)a=t[l],o[a]&&s.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);for(r&&r(t,c,u);s.length;)s.shift()();if(u)for(l=0;l<u.length;l++)f=n(n.s=u[l]);return f};var t={},o={4:0};n.e=function(e){function r(){i.onerror=i.onload=null,clearTimeout(a);var n=o[e];0!==n&&(n&&n[1](new Error("Loading chunk "+e+" failed.")),o[e]=void 0)}var t=o[e];if(0===t)return new Promise(function(e){e()});if(t)return t[2];var c=new Promise(function(n,r){t=o[e]=[n,r]});t[2]=c;var u=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.async=!0,i.timeout=12e4,n.nc&&i.setAttribute("nonce",n.nc),i.src=n.p+""+e+".js";var a=setTimeout(r,12e4);return i.onerror=i.onload=r,u.appendChild(i),c},n.m=e,n.c=t,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:t})},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="/",n.oe=function(e){throw console.error(e),e}}([]);
webpackJsonp([1],[,function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.ClientSkillsId={agent:"skill:agent",call:"skill:call",card:"skill:card",communication:"communication",location:"skill:location",meeting:"private/inmeeting",private:"private",speech:"skill:speech",speechRecognizer:"skill:speechRecognizer",system:"skill:system",teams:"private/teamsUI",test:"skill:test",text:"skill:text"},t.ClientSkillsEvents={invokeSkill:"invokeSkill",listenCanceled:"listenCanceled",speechOutputCanceled:"speechOutputCanceled",submit:"submit",tcp:"tcp",text:"text"},t.ClientSkillsActions={addToCall:"addToCall",callback:"callback",endCall:"endCall",forwardCalls:"forwardCalls",holdCall:"holdCall",makeCall:"makeCall",muteCall:"muteCall",resumeCall:"resumeCall",sendMessage:"sendMessage",teamsAction:"teamsResponse",transferCall:"transferCall",unmuteCall:"unmuteCall",meeting:{addToMeeting:"addParticipant",endMeeting:"endMeeting",goToSlide:"goToSlide",joinMeeting:"joinMeeting",muteAll:"muteAll",muteSelf:"muteSelf",muteSomeone:"muteSomeone",nextSlide:"nextSlide",previousSlide:"previousSlide",present:"shareDeck",navigateDeck:"navigateDeck",startRecording:"startRecording",stopRecording:"stopRecording",stopSharingDeck:"stopSharingDeck",turnOffCamera:"turnOffCamera",turnOnCamera:"turnOnCamera",unmuteAll:"unmuteAll",unmuteSelf:"unmuteSelf",unmuteSomeone:"unmuteSomeone"}},t.CommAddressTypes={number:"number",upn:"UPN"};var r=function(){return function(){this.version="1.0.0"}}();t.ContextBase=r;var s=function(e){function t(t,i,n){var r=e.call(this)||this;return t&&i&&(r.state={latitude:t,longitude:i,accuracy:n||100,timestamp:(new Date).toISOString()}),r}return n(t,e),t}(r);t.LocationContext=s;var a=function(e){function t(){return e.call(this)||this}return n(t,e),t}(r);t.SpeechContext=a;var o=function(e){function t(){var t=e.call(this)||this;return t.state={activeCalls:[]},t}return n(t,e),t}(r);t.CallsContext=o,t.ICommCallState={idle:"Idle",calling:"Calling",inCall:"InCall",incoming:"Incoming",onHold:"OnHold"};var c=function(e){function t(){return e.call(this)||this}return n(t,e),t}(r);t.CommunicationContext=c;var l=function(e){function t(t){var i=e.call(this)||this;return i.settings={renderingFormat:t},i}return n(t,e),t}(r);t.CardContext=l;var p=function(e){function t(t,i,n,r,s,a,o){var c=e.call(this)||this;return c.settings={sdk:{version:"1.0.0"},language:t,region:i,timezoneOffset:n,deviceId:r,deviceName:s,os:a,device:o},c}return n(t,e),t}(r);t.SystemContext=p;var u=function(e){function t(t,i){var n=e.call(this)||this;return t&&(n[t]=i),delete n.version,n}return n(t,e),t}(r);t.PrivateContext=u;var h=function(e){function t(t){return e.call(this,"teamsUI",t)||this}return n(t,e),t}(u);t.TeamsPrivateContext=h;var d=function(e){function t(t){return e.call(this,"inmeeting",t)||this}return n(t,e),t}(u);t.InMeetingPrivateContext=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.unknown=0]="unknown",e[e.version_conflict_save=1]="version_conflict_save",e[e.version_conflict_lock=2]="version_conflict_lock",e[e.version_conflict_unlock=3]="version_conflict_unlock",e[e.section_locked=4]="section_locked",e[e.section_delete=5]="section_delete",e[e.section_deleted=6]="section_deleted",e[e.section_deleted_while_editing=7]="section_deleted_while_editing",e[e.section_unlocked_while_editing=8]="section_unlocked_while_editing",e[e.section_max_content_length_exceeded=9]="section_max_content_length_exceeded",e[e.section_not_ready=10]="section_not_ready",e[e.section_update=11]="section_update",e[e.section_updated=12]="section_updated",e[e.page_delete=13]="page_delete",e[e.page_update=14]="page_update",e[e.canvas_delete=15]="canvas_delete",e[e.canvas_missmatched_items=16]="canvas_missmatched_items",e[e.start_conversation=17]="start_conversation",e[e.copy_link=18]="copy_link",e[e.sharepoint_not_provisioned=19]="sharepoint_not_provisioned",e[e.sharepoint_forbidden=20]="sharepoint_forbidden",e[e.cannot_execute_page_reloading=21]="cannot_execute_page_reloading",e[e.http_client_error=22]="http_client_error",e[e.network_offline=23]="network_offline"}(n=t.WikiErrorCode||(t.WikiErrorCode={}));var r="__wiki_error__",s=function(){function e(t,i,s){this.errorCode=t,this.message=i,this.details=s,this.signature=r,this.message||(this.message=""),this.error=n[this.errorCode],this.message=e.sanitize(this.message),this.details&&(this.details=e.sanitize(this.details))}return Object.defineProperty(e.prototype,"report",{get:function(){var e;return e=this.details?"string"==typeof this.details?this.details:JSON.stringify(this.details):"",this.error+": "+this.message+" "+e},enumerable:!0,configurable:!0}),e.prototype.getString=function(e){return"wiki_"+n[this.errorCode]+"_"+e},e.is=function(e,t){return!(!e||e.signature!==r)&&(!_.isNumber(t)||t===e.errorCode)},e.isHttpRequestConflict=function(e){var t=[412,409];return e&&!!_.find(t,function(t){return t==e.statusCode})},e.isCritical=function(t){return!e.is(t)||!0===t.critical},e.log=function(t,i,n){e.is(n)?e.isCritical(n)?t.error("["+i+"]: "+n.report):t.info("["+i+"]: "+n.report):t.error("["+i+"]: "+JSON.stringify(e.sanitize(n)))},e.sanitize=function(e){if(!e||e.signature===r)return e;var t="string"==typeof e,i=/teams\/[\d\w\s,-]*\//g;try{var n=t?e:JSON.stringify(e);return n=n.replace(i,"<team-path>/"),t?n:JSON.parse(n)}catch(t){return e}},e.extractErrorMessage=function(e){var t="",i=function(e,i){var n=e[i];n&&("string"!=typeof n&&"number"!=typeof n&&(n="<"+typeof n+">"),t+=": "+i+"="+n)},n=function(e,s){if(!(s>3)&&e){if("string"==typeof e){var a=e;if(a.trim().startsWith("{"))try{var o=JSON.parse(a);return void n(o,s+1)}catch(e){}t+=": "+e}if(i(e,"statusCode"),i(e,"errorCode"),i(e,"code"),i(e,"reason"),i(e,"_code"),e["odata.error"]&&i(e["odata.error"],"code"),e.errorMessage&&e.errorMessage["odata.error"]&&i(e.errorMessage["odata.error"],"code"),e.headers&&i(e.headers,"sprequestguid"),e.signature===r){var c=e;t+=": "+c.error+": "+c.message}else e.error&&n(e.error,s+1);e.details&&n(e.details,s+1)}};try{n(e,0)}catch(e){}return t},Object.defineProperty(e.prototype,"critical",{get:function(){return-1===[n.version_conflict_save,n.version_conflict_lock,n.version_conflict_unlock,n.section_locked,n.section_deleted,n.section_deleted_while_editing,n.section_unlocked_while_editing,n.section_max_content_length_exceeded,n.section_not_ready,n.section_updated,n.cannot_execute_page_reloading].indexOf(this.errorCode)},enumerable:!0,configurable:!0}),e}();t.WikiError=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Unknown=0]="Unknown",e[e.AddBot=1]="AddBot",e[e.AddChannel=2]="AddChannel",e[e.AddMember=3]="AddMember",e[e.AddMention=4]="AddMention",e[e.AddTab=5]="AddTab",e[e.AddConnector=6]="AddConnector",e[e.ComposeChannelMessage=7]="ComposeChannelMessage",e[e.ComposeChannelReply=8]="ComposeChannelReply",e[e.ComposeOneOnManyChatMessage=9]="ComposeOneOnManyChatMessage",e[e.ComposeOneOnOneChatMessage=10]="ComposeOneOnOneChatMessage",e[e.ExpandComposer=11]="ExpandComposer",e[e.FavoriteConversation=12]="FavoriteConversation",e[e.LoginTeamsMobileApp=13]="LoginTeamsMobileApp",e[e.LoginOfficeMobileApp=14]="LoginOfficeMobileApp",e[e.ShareFile=15]="ShareFile",e[e.StartAudioCall=16]="StartAudioCall",e[e.StartVideoCall=17]="StartVideoCall",e[e.LoginElectron=18]="LoginElectron",e[e.LoginDesktopHwa=19]="LoginDesktopHwa",e[e.LoginSurfaceHub=20]="LoginSurfaceHub"}(t.EngagementSurfaceAction||(t.EngagementSurfaceAction={}));!function(e){e[e.AppStart=0]="AppStart",e[e.AppReady=1]="AppReady",e[e.SurfaceShown=2]="SurfaceShown",e[e.FREComplete=3]="FREComplete",e[e.BIEvent=4]="BIEvent",e[e.FirstRun=5]="FirstRun"}(t.Trigger||(t.Trigger={}));!function(e){e[e.Modal=0]="Modal",e[e.Coachmark=1]="Coachmark",e[e.Banner=2]="Banner",e[e.HelpBot=3]="HelpBot",e[e.Carousel=4]="Carousel"}(t.EngagementSurface||(t.EngagementSurface={})),t.IsUserInterfaceControlText=function(e){return e&&"text"===e.type},t.IsUserInterfaceControlBoldText=function(e){return e&&"text"===e.type&&"bold"===e.weight},t.IsUserInterfaceControlImage=function(e){return e&&"image"===e.type},t.IsUserInterfaceControlButton=function(e){return e&&"button"===e.type},t.IsUserInterfaceEmailSms=function(e){return e&&"email-sms"===e.type}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TeamsActionsId={addToMeeting:"addParticipant",callingAction:"callingAction",channelAction:"channelAction",downloadFilesAction:"downloadFiles",meetingAction:"meetingAction",navigation:"navigation",openFileAction:"openFile",present:"present",search:"search",sendMessageAction:"sendMessage"};!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error",e[e.Fatal=2]="Fatal",e[e.Inactive=3]="Inactive",e[e.EmptyResponse=4]="EmptyResponse",e[e.InvalidAction=5]="InvalidAction",e[e.InvalidActionData=6]="InvalidActionData",e[e.TenantNotSupported=7]="TenantNotSupported",e[e.NotSupported=8]="NotSupported",e[e.UserNotFound=9]="UserNotFound",e[e.InvalidParameters=10]="InvalidParameters",e[e.SysCancel=11]="SysCancel"}(t.TeamsCortanaActionStatus||(t.TeamsCortanaActionStatus={}));var n=function(){function e(e){this.actionId=e}return e.prototype.actionResult=function(e,t,i,n){return void 0===t&&(t=!0),{status:e,actionId:this.actionId,actionInfo:n,dismissOnAction:t,actionResponseData:i}},e}();t.TeamsCortanaActionHandlerBase=n,t.NavigationDestinations={activity:"activity",atMentions:"atMentions",calendar:"calendar",createTeam:"createTeam",downloads:"downloads",feedback:"feedback",help:"help",joinTeam:"joinTeam",keyboardShortcuts:"keyboardShortcuts",myActivity:"myActivity",openSettings:"openSettings",otherPersonActivity:"otherPersonActivity",otherPersonChat:"otherPersonChat",otherPersonOrganization:"otherPersonOrganization",recentFiles:"recentFiles",saved:"saved",store:"store",unreadActivity:"unreadActivity"},t.TeamChannelActionType={favorite:"favorite",unfavorite:"unfavorite",follow:"follow",unfollow:"unfollow",addToTeam:"addToTeam",removeFromTeam:"removeFromTeam"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.open=1]="open",e[e.close=2]="close",e[e.startRinging=3]="startRinging",e[e.stopRinging=4]="stopRinging",e[e.hook=5]="hook",e[e.offHook=6]="offHook",e[e.hold=7]="hold",e[e.resume=8]="resume",e[e.mute=9]="mute",e[e.unmute=10]="unmute",e[e.unsupported=11]="unsupported",e[e.selectDriver=12]="selectDriver"}(t.HidDeviceOperation||(t.HidDeviceOperation={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(25),r=function(){function e(e,t){void 0===t&&(t=void 0),t&&this.setValues(t),this.itemType=e}return e.prototype.setValues=function(e){for(var t=0,i=n.spColumns;t<i.length;t++){var r=i[t];r.attributeName&&e.hasOwnProperty(r.attributeName)&&(this[r.attributeName]=e[r.attributeName])}e.hasOwnProperty("id")&&(this.id=e.id),e.hasOwnProperty("version")&&(this.version=e.version),e.hasOwnProperty("modified")&&(this.modified=e.modified)},e.prototype.updateMetadata=function(e){_.assign(this.metadata,e)},e.prototype.getSharepointData=function(t){return e.toSpItem(t,this)},e.prototype.isFake=function(){return e.isFakeId(this.id)},e.prototype.isType=function(e){return this.itemType===e},e.createFake=function(t,i){return i&&t.setValues(i),t.id=e.nextFakeId--,t},e.toSpItem=function(t,i){for(var r={},s=0,a=n.spColumns;s<a.length;s++){var o=a[s];if(o.attributeName&&i.hasOwnProperty(o.attributeName))if(4===o.type){var c=i[o.attributeName];r[o.name]=c?c.toISOString():void 0}else r[o.name]=i[o.attributeName]}return i.order&&(r.wikiOrder=e.serializeItemsOrder(i.order,t)),i.metadata&&(r.wikiMetadata=e.serializeMetadata(i.metadata,t)),r},e.isFakeId=function(e){return e<0},e.filterIds=function(t){var i={};return _.filter(t,function(t){var n=!e.isFakeId(t)&&!i[t];return i[t]=!0,n})},e.fromSpItemInternal=function(t,i,r){for(var s=0,a=n.spColumns;s<a.length;s++){var o=a[s];if(r.hasOwnProperty(o.name)&&o.attributeName)if(4===o.type){var c=r[o.name]?new Date(r[o.name]):void 0;i[o.attributeName]=c}else i[o.attributeName]=r[o.name]}i.id=r.Id,i.version=r["odata.etag"],i.order=e.parseItemsOrder(r.wikiOrder,t),i.metadata=e.parseMetadata(r.wikiMetadata,t);var l=r.Modified;return i.modified=l?new Date(l):void 0,i},e.parseItemsOrder=function(t,i){try{var n=JSON.parse(t),r=e.filterIds(_.isArray(n)?n:[]);return i&&n.length!==r.length&&i.warn("[parseItemsOrder]: - There are duplicates in the stored identifiers "+t+"."),r}catch(e){return[]}},e.parseMetadata=function(e,t){try{return e?JSON.parse(e)||{}:{}}catch(i){return t.error("[parseMetadata]: JSON.parse failed for serializedMetadata: "+e),{}}},e.serializeItemsOrder=function(t,i){var n=e.filterIds(_.isArray(t)?t:[]);return i&&t.length!==n.length&&i.warn("[serializeItemsOrder]: - There are duplicates or fake ids in the identifiers "+JSON.stringify(t)+"."),JSON.stringify(n)},e.serializeMetadata=function(e,t){try{return JSON.stringify(e||{})}catch(i){return t.error("[serializeMetadata]: JSON.stringify failed for metadata: "+e),""}},e.nextFakeId=-1,e}();t.WikiBaseItem=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),r=i(10),s=i(47),a=function(){function e(e,t,i,n){this.$timeout=e,this.device=t,this.hidScenarioManager=i,this.hidDeviceDriverConstants=n,this.instanceID=1e4*Math.random(),this.iterationIndex=0,this.deviceProperties={name:"",path:"",productId:"",vendorId:""},this.hookProtectionTimeout=1e3,this.hookProtectionTime=null,this.onDeviceCallback=function(e,t){e?(e(),t.stop()):t.cancel({message:"onDeviceCallback not set"})},this.logger=this.hidScenarioManager.logger,this.deviceState=s.HidState.create(),this.hookDisabled=!1,this.init()}return Object.defineProperty(e.prototype,"id",{get:function(){var e=this;return this.safeCall(function(){return e.device.identifier()})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.deviceProperties.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this.deviceState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.deviceProperties},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logInfo",{get:function(){return this.deviceLogInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHookSupported",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMuteSupported",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHoldResumeSupported",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRingingSupported",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.open=function(){var e=this;this.deviceState.opened=this.safeCall(function(){return e.device.open(!1)}),this.populateDeviceProperties(),this.hidScenarioManager.init(this.deviceLogInfo),this.logger.info("[open]: "+(this.deviceState.opened?"opened":"failed to open")+" "+this.deviceLogInfo)},e.prototype.close=function(){var e=this;this.safeCall(function(){return e.device.removeAllListeners()});var t=this.safeCall(function(){return e.device.close()});this.hidScenarioManager.destroy(),this.logger.info("[close]: "+(t?"closed":"failed to close")+" "+this.deviceLogInfo)},e.prototype.startRinging=function(){this.isRingingSupported?(this.deviceState.ringing=!0,this.setValue(r.Page.LEDs,r.LED.Ring,1,this.hidScenarioManager.getAppScenario(n.HidDeviceOperation.startRinging))?this.logger.info("ringing "+this.deviceLogInfo):this.logger.error("'failed to ring "+this.deviceLogInfo)):this.logger.warn("[startRinging]: not supported for "+this.deviceLogInfo)},e.prototype.stopRinging=function(){this.isRingingSupported?(this.deviceState.ringing=!1,this.setValue(r.Page.LEDs,r.LED.Ring,0,this.hidScenarioManager.getAppScenario(n.HidDeviceOperation.stopRinging))?this.logger.info("stopped ringing for "+this.deviceLogInfo):this.logger.error("'failed to stop ringing "+this.deviceLogInfo)):this.logger.warn("[stopRinging]: not supported for "+this.deviceLogInfo)},e.prototype.hook=function(){this.isHookSupported?(this.deviceState.hooked=!0,this.setValue(r.Page.LEDs,r.LED.OffHook,0,this.hidScenarioManager.getAppScenario(n.HidDeviceOperation.hook))?this.logger.info("put "+this.deviceLogInfo+" back on hook"):this.logger.error("'failed to put "+this.deviceLogInfo+" back on hook")):this.logger.warn("[hook]: not supported for "+this.deviceLogInfo)},e.prototype.offHook=function(){this.isHookSupported?(this.deviceState.hooked=!1,this.setValue(r.Page.LEDs,r.LED.OffHook,1,this.hidScenarioManager.getAppScenario(n.HidDeviceOperation.offHook))?this.logger.info("took "+this.deviceLogInfo+" off the hook"):this.logger.error("'failed to take "+this.deviceLogInfo+" off the hook")):this.logger.warn("[offHook]: not supported for "+this.deviceLogInfo)},e.prototype.hold=function(){this.isHoldResumeSupported?(this.deviceState.onHold=!0,this.setValue(r.Page.LEDs,r.LED.Hold,1,this.hidScenarioManager.getAppScenario(n.HidDeviceOperation.hold))?this.logger.info("putting "+this.deviceLogInfo+" on hold"):this.logger.error("'failed to put "+this.deviceLogInfo+" on hold")):this.logger.warn("[hold]: not supported for "+this.deviceLogInfo)},e.prototype.resume=function(){this.isHoldResumeSupported?(this.deviceState.onHold=!1,this.setValue(r.Page.LEDs,r.LED.Hold,0,this.hidScenarioManager.getAppScenario(n.HidDeviceOperation.resume))?this.logger.info("resuming "+this.deviceLogInfo):this.logger.error("'failed to resume "+this.deviceLogInfo)):this.logger.warn("[resume]: not supported for "+this.deviceLogInfo)},e.prototype.mute=function(){this.isMuteSupported?(this.deviceState.muted=!0,this.setValue(r.Page.LEDs,r.LED.Mute,1,this.hidScenarioManager.getAppScenario(n.HidDeviceOperation.mute))?this.logger.info("muted "+this.deviceLogInfo):this.logger.error("'failed to mute "+this.deviceLogInfo)):this.logger.warn("[mute]: not supported for "+this.deviceLogInfo)},e.prototype.unmute=function(){this.isMuteSupported?(this.deviceState.muted=!1,this.setValue(r.Page.LEDs,r.LED.Mute,0,this.hidScenarioManager.getAppScenario(n.HidDeviceOperation.unmute))?this.logger.info("umnmuted "+this.deviceLogInfo):this.logger.error("'failed to unmute "+this.deviceLogInfo)):this.logger.warn("[unmute]: not supported for "+this.deviceLogInfo)},e.prototype.isEqual=function(e){return!!e&&this.name===e.name},e.prototype.dispose=function(){this.logger.debug("[dispose]: cleanup for "+this.deviceLogInfo),this.onDidMute=null,this.onDidUnmute=null,this.onDidHook=null,this.onDidOffHook=null,this.onDidHold=null,this.onDidResume=null},e.areDevicesEqual=function(e,t){return!!e&&!!t&&e.name===t.name},e.prototype.onAppStateChanged=function(e){this.appState=e},e.prototype.getLogDataFromUsageParams=function(e,t,i,n){var s="usagePage: "+r.Page[e]+" ("+e+"), usage: "+function(){switch(e){case r.Page.Telephony:return r.Telephony[t]+" ("+t+") isRelative ("+n+")";case r.Page.LEDs:return r.LED[t]+" ("+t+") isRelative ("+n+")";default:return t.toString()}}()+", value: "+i;return _.isBoolean(n)?s+", isRelative: "+n:s},e.prototype.hookProtect=function(e){var t=this;this.logger.debug(e+": Disable Hook"),this.hookProtectionTime=new Date,this.hookDisabled=!0,this.$timeout(function(){t.hookProtectionTime.getTime()+t.hookProtectionTimeout<=(new Date).getTime()&&(t.hookDisabled=!1,t.logger.debug("[hookProtect]: Re-enable hook"))},this.hookProtectionTimeout,!1)},e.prototype.isAppHooked=function(){return!!(this.hidDeviceDriverConstants.disableMuteUnmuteWhenNotInCalls&&this.appState&&this.appState.hooked)},e.prototype.muteRelative=function(e){0===e.value||(this.hookProtect("[muteRelative]"),this.appState&&(this.appState.muted?(this.unmute(),this.onDeviceCallback(this.onDidUnmute,this.hidScenarioManager.getDeviceScenario(n.HidDeviceOperation.unmute))):(this.mute(),this.onDeviceCallback(this.onDidMute,this.hidScenarioManager.getDeviceScenario(n.HidDeviceOperation.mute)))))},e.prototype.muteAbsolute=function(e){var t=1===e.value;if(this.appState){if(t===this.appState.muted)return void this.logger.debug("["+this.driver+" (mute absolute)]: not changing mute state : "+(this.deviceState.muted?"muted":"unmuted"));this.hookProtect("[muteAbsolulte]"),this.appState.muted?this.onDeviceCallback(this.onDidUnmute,this.hidScenarioManager.getDeviceScenario(n.HidDeviceOperation.unmute)):this.onDeviceCallback(this.onDidMute,this.hidScenarioManager.getDeviceScenario(n.HidDeviceOperation.mute))}},e.prototype.holdRelative=function(e){0===e.value||(this.hookProtect("[holdRelative]"),this.deviceState.onHold?(this.resume(),this.onDeviceCallback(this.onDidResume,this.hidScenarioManager.getDeviceScenario(n.HidDeviceOperation.resume))):(this.hold(),this.onDeviceCallback(this.onDidHold,this.hidScenarioManager.getDeviceScenario(n.HidDeviceOperation.hold))))},e.prototype.init=function(){var t=this;this.open(),this.safeCall(function(){return t.device.on(e.inputReportEvent,function(i){t.iterationIndex++,t.onDeviceStateChanged&&t.onDeviceStateChanged()?t.logger.debug("["+e.inputReportEvent+"]: ignoring onInputReportEvent"):i.elements.sort(t.compareElements).forEach(function(e){return t.onInputReportEvent(e)})})})},e.prototype.compareElements=function(e,t){return e.usagePage!==t.usagePage?e.usagePage-t.usagePage:e.usage!==t.usage?e.usage-t.usage:0},e.prototype.setValue=function(e,t,i,n){var r=this,s=this.safeCall(function(){return r.device.setValue(e,t,i)});return this.logger.debug("[setValue]: called with "+this.getLogDataFromUsageParams(e,t,i)+"; returns "+s),s?n.stop():n.fail(),s},e.prototype.setFeatureReport=function(e,t,i,n){var r=this;if(!this.device.setFeatureReport)return this.logger.warn("[setFeatureReport]: hasn't been supported yet"),!1;var s=void 0===this.safeCall(function(){return r.device.setFeatureReport(e,t,i)});return this.logger.debug("[setFeatureReport]: called with ...TODO; returns "+s),s?n.stop():n.fail(),s},e.prototype.setOutputReport=function(e,t,i,n){var r=this;if(!this.device.setOutputReport)return this.logger.warn("[setOutputReport]: hasn't been supported yet"),!1;var s=void 0===this.safeCall(function(){return r.device.setOutputReport(e,t,i)});return this.logger.debug("[setOutputReport]: called with ...TODO; returns "+s),s?n.stop():n.fail(),s},e.prototype.isDeviceSupported=function(e){return e===r.Page.Telephony},e.prototype.onInputReportEvent=function(t){var i=this.deviceLogInfo+": with "+this.getLogDataFromUsageParams(t.usagePage,t.usage,t.value,t.isRelative);if(this.deviceSelected()){if(this.logger.debug("[InstanceID: "+this.instanceID+" iterationIndex: "+this.iterationIndex+"]: "+e.inputReportEvent+" "+i),this.isDeviceSupported(t.usagePage))return void this.onInputValueChanged(t);this.logger.warn("Unsupported input "+e.inputReportEvent+":"+i)}},e.prototype.deviceSelected=function(){return null!=this.onDidMute&&null!=this.onDidUnmute&&null!=this.onDidHook&&null!=this.onDidOffHook},e.prototype.populateDeviceProperties=function(){var t=this;_.assign(this.deviceProperties,{name:this.safeCall(function(){return t.device.property("Product")})||e.unknownDevice,path:this.safeCall(function(){return t.device.property("Path")})||"",productId:this.safeCall(function(){return t.device.property("ProductID")})||"",vendorId:this.safeCall(function(){return t.device.property("VendorID")})||""}),this.deviceLogInfo="device name: "+this.name,this.deviceDetailedLogInfo=_.isEmpty(this.deviceProperties)?"no device info":"device info: "+_.keys(this.deviceProperties).sort().map(function(i){return i+": "+(t.deviceProperties[i]||e.unknownDevice)}).join(", ")},e.prototype.safeCall=function(e){try{return e()}catch(e){return void this.logger.error("[BaseDevice]: failed with "+e)}},e.inputReportEvent="input-report",e.unknownDevice="<unknown>",e}();t.BaseDriver=a},,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Undefined=0]="Undefined",e[e.GenericDesktop=1]="GenericDesktop",e[e.Simulation=2]="Simulation",e[e.VR=3]="VR",e[e.Sport=4]="Sport",e[e.Game=5]="Game",e[e.GenericDeviceControls=6]="GenericDeviceControls",e[e.KeyboardOrKeypad=7]="KeyboardOrKeypad",e[e.LEDs=8]="LEDs",e[e.Button=9]="Button",e[e.Ordinal=10]="Ordinal",e[e.Telephony=11]="Telephony",e[e.Consumer=12]="Consumer",e[e.Digitizer=13]="Digitizer",e[e.PID=15]="PID",e[e.Unicode=16]="Unicode",e[e.AlphanumericDisplay=20]="AlphanumericDisplay",e[e.Sensor=32]="Sensor",e[e.Monitor=128]="Monitor",e[e.MonitorEnumerated=129]="MonitorEnumerated",e[e.MonitorVirtual=130]="MonitorVirtual",e[e.MonitorReserved=131]="MonitorReserved",e[e.PowerDevice=132]="PowerDevice",e[e.BatterySystem=133]="BatterySystem",e[e.PowerReserved=134]="PowerReserved",e[e.PowerReserved2=135]="PowerReserved2",e[e.BarCodeScanner=140]="BarCodeScanner",e[e.WeighingDevice=141]="WeighingDevice",e[e.Scale=141]="Scale",e[e.MagneticStripeReader=142]="MagneticStripeReader",e[e.CameraControl=144]="CameraControl",e[e.Arcade=145]="Arcade",e[e.VendorDefinedStart=65280]="VendorDefinedStart"}(t.Page||(t.Page={}));!function(e){e[e.Phone=1]="Phone",e[e.AnsweringMachine=2]="AnsweringMachine",e[e.MessageControls=3]="MessageControls",e[e.Handset=4]="Handset",e[e.Headset=5]="Headset",e[e.TelephonyKeyPad=6]="TelephonyKeyPad",e[e.ProgrammableButton=7]="ProgrammableButton",e[e.HookSwitch=32]="HookSwitch",e[e.Flash=33]="Flash",e[e.Feature=34]="Feature",e[e.Hold=35]="Hold",e[e.Redial=36]="Redial",e[e.Transfer=37]="Transfer",e[e.Drop=38]="Drop",e[e.Park=39]="Park",e[e.ForwardCalls=40]="ForwardCalls",e[e.AlternateFunction=41]="AlternateFunction",e[e.Line=42]="Line",e[e.SpeakerPhone=43]="SpeakerPhone",e[e.Conference=44]="Conference",e[e.RingEnable=45]="RingEnable",e[e.Ring=46]="Ring",e[e.PhoneMute=47]="PhoneMute",e[e.CallerID=48]="CallerID",e[e.SpeedDial=80]="SpeedDial",e[e.StoreNumber=81]="StoreNumber",e[e.RecallNumber=82]="RecallNumber",e[e.PhoneDirectory=83]="PhoneDirectory",e[e.VoiceMail=112]="VoiceMail",e[e.ScreenCalls=113]="ScreenCalls",e[e.DoNotDisturb=114]="DoNotDisturb",e[e.Message=115]="Message",e[e.AnswerOnOrOff=116]="AnswerOnOrOff",e[e.InsideDialTone=144]="InsideDialTone",e[e.OutsideDialTone=145]="OutsideDialTone",e[e.InsideRingTone=146]="InsideRingTone",e[e.OutsideRingTone=147]="OutsideRingTone",e[e.PriorityRingTone=148]="PriorityRingTone",e[e.InsideRingback=149]="InsideRingback",e[e.PriorityRingback=150]="PriorityRingback",e[e.LineBusyTone=151]="LineBusyTone",e[e.ReorderTone=152]="ReorderTone",e[e.CallWaitingTone=153]="CallWaitingTone",e[e.ConfirmationTone1=154]="ConfirmationTone1",e[e.ConfirmationTone2=155]="ConfirmationTone2",e[e.TonesOff=156]="TonesOff",e[e.OutsideRingback=157]="OutsideRingback",e[e.PhoneKey0=176]="PhoneKey0",e[e.PhoneKey1=177]="PhoneKey1",e[e.PhoneKey2=178]="PhoneKey2",e[e.PhoneKey3=179]="PhoneKey3",e[e.PhoneKey4=180]="PhoneKey4",e[e.PhoneKey5=181]="PhoneKey5",e[e.PhoneKey6=182]="PhoneKey6",e[e.PhoneKey7=183]="PhoneKey7",e[e.PhoneKey8=184]="PhoneKey8",e[e.PhoneKey9=185]="PhoneKey9",e[e.PhoneKeyStar=186]="PhoneKeyStar",e[e.PhoneKeyPound=187]="PhoneKeyPound",e[e.PhoneKeyA=188]="PhoneKeyA",e[e.PhoneKeyB=189]="PhoneKeyB",e[e.PhoneKeyC=190]="PhoneKeyC",e[e.PhoneKeyD=191]="PhoneKeyD"}(t.Telephony||(t.Telephony={}));!function(e){e[e.NumLock=1]="NumLock",e[e.CapsLock=2]="CapsLock",e[e.ScrollLock=3]="ScrollLock",e[e.Compose=4]="Compose",e[e.Kana=5]="Kana",e[e.Power=6]="Power",e[e.Shift=7]="Shift",e[e.DoNotDisturb=8]="DoNotDisturb",e[e.Mute=9]="Mute",e[e.ToneEnable=10]="ToneEnable",e[e.HighCutFilter=11]="HighCutFilter",e[e.LowCutFilter=12]="LowCutFilter",e[e.EqualizerEnable=13]="EqualizerEnable",e[e.SoundFieldOn=14]="SoundFieldOn",e[e.SurroundOn=15]="SurroundOn",e[e.Repeat=16]="Repeat",e[e.Stereo=17]="Stereo",e[e.SamplingRateDetect=18]="SamplingRateDetect",e[e.Spinning=19]="Spinning",e[e.CAV=20]="CAV",e[e.CLV=21]="CLV",e[e.RecordingFormatDetect=22]="RecordingFormatDetect",e[e.OffHook=23]="OffHook",e[e.Ring=24]="Ring",e[e.MessageWaiting=25]="MessageWaiting",e[e.DataMode=26]="DataMode",e[e.BatteryOperation=27]="BatteryOperation",e[e.BatteryOK=28]="BatteryOK",e[e.BatteryLow=29]="BatteryLow",e[e.Speaker=30]="Speaker",e[e.HeadSet=31]="HeadSet",e[e.Hold=32]="Hold",e[e.Microphone=33]="Microphone",e[e.Coverage=34]="Coverage",e[e.NightMode=35]="NightMode",e[e.SendCalls=36]="SendCalls",e[e.CallPickup=37]="CallPickup",e[e.Conference=38]="Conference",e[e.StandBy=39]="StandBy",e[e.CameraOn=40]="CameraOn",e[e.CameraOff=41]="CameraOff",e[e.OnLine=42]="OnLine",e[e.OffLine=43]="OffLine",e[e.Busy=44]="Busy",e[e.Ready=45]="Ready",e[e.PaperOut=46]="PaperOut",e[e.PaperJam=47]="PaperJam",e[e.Remote=48]="Remote",e[e.Forward=49]="Forward",e[e.Reverse=50]="Reverse",e[e.Stop=51]="Stop",e[e.Rewind=52]="Rewind",e[e.FastForward=53]="FastForward",e[e.Play=54]="Play",e[e.Pause=55]="Pause",e[e.Record=56]="Record",e[e.Error=57]="Error",e[e.Usage=58]="Usage",e[e.UsageInUseIndicator=59]="UsageInUseIndicator",e[e.UsageMultiModeIndicator=60]="UsageMultiModeIndicator",e[e.IndicatorOn=61]="IndicatorOn",e[e.IndicatorFlash=62]="IndicatorFlash",e[e.IndicatorSlowBlink=63]="IndicatorSlowBlink",e[e.IndicatorFastBlink=64]="IndicatorFastBlink",e[e.IndicatorOff=65]="IndicatorOff",e[e.FlashOnTime=66]="FlashOnTime",e[e.SlowBlinkOnTime=67]="SlowBlinkOnTime",e[e.SlowBlinkOffTime=68]="SlowBlinkOffTime",e[e.FastBlinkOnTime=69]="FastBlinkOnTime",e[e.FastBlinkOffTime=70]="FastBlinkOffTime",e[e.UsageIndicatorColor=71]="UsageIndicatorColor",e[e.IndicatorRed=72]="IndicatorRed",e[e.IndicatorGreen=73]="IndicatorGreen",e[e.IndicatorAmber=74]="IndicatorAmber",e[e.GenericIndicator=75]="GenericIndicator",e[e.SystemSuspend=76]="SystemSuspend",e[e.ExternalPowerConnected=77]="ExternalPowerConnected",e[e.PlayerIndicator=78]="PlayerIndicator",e[e.Player1=79]="Player1",e[e.Player2=80]="Player2",e[e.Player3=81]="Player3",e[e.Player4=82]="Player4",e[e.Player5=83]="Player5",e[e.Player6=84]="Player6",e[e.Player7=85]="Player7",e[e.Player8=86]="Player8",e[e.Reserved=65535]="Reserved"}(t.LED||(t.LED={}))},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(73),r=function(){function e(e){this.$q=e}return Object.defineProperty(e.prototype,"type",{get:function(){return this.getLogFileType()},enumerable:!0,configurable:!0}),e.prototype.getContentToUpload=function(){var e=this,t=this.$q.defer();return Windows.Storage.ApplicationData.current.localFolder.getFolderAsync("logs").then(function(i){i.getFilesAsync().then(function(i){var r=i.filter(function(t){return e.filterFile(t)}),s=_.maxBy(r,function(e){return e.dateCreated});s||t.reject(),s.getBasicPropertiesAsync().then(function(i){i.size>n.BrBV2FeedbackService.sizeLimit?t.reject():e.isBinary()?Windows.Storage.FileIO.readBufferAsync(s).then(function(i){var n=Windows.Storage.Streams.DataReader.fromBuffer(i),r=new Array(i.length);n.readBytes(r),n.close(),t.resolve(e.createContentToUpload(Uint8Array.from(r),!0))}):Windows.Storage.FileIO.readTextAsync(s).then(function(i){t.resolve(e.createContentToUpload(i,!1))})})})}),t.promise},e.prototype.createContentToUpload=function(e,t){return{type:this.getLogFileType(),fileName:this.getLogFileName(),isBinary:t,content:e}},e}();t.BrbV2HwaLogFileProviderBase=r},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(21),s=i(14),a=function(e){function t(i){var n=e.call(this,i)||this;return Object.setPrototypeOf(n,t.prototype),n}return n(t,e),t}(Error),o=function(){function e(e,t,i,n,r,s,a,o){this.resources=e,this.$translate=t,this.constants=i,this.conversationsService=n,this.appId=r,this.conversationId=s,this.botId=a,this.caller=o}return e.prototype.generateTaskFetchCallback=function(e){var t=this;return function(){return t.performInvoke(t.constants.taskModuleConstants.invokeNames.fetch,e).then(function(e){var i={},n={};return n[t.constants.taskModuleConstants.invokeResponse.continueType]=t.generateInvokeResultHandlerForContinueType("initial-fetch",function(e){return i=e}),new r.InvokeResultHelper(t.constants.taskModuleConstants.invokeResponse.topLevelWrapper).processInvokeResult(e,n),i}).catch(function(e){if(e instanceof a)return{type:s.TaskModuleType.ErrorMessage,message:t.$translate.instant(t.resources.strings.extension_taskModuleInvalidBotResponse)};throw e})}},e.prototype.generateExecuteActionCallback=function(e,t){var i=this;return function(n){return e.userInputs=n,i.performInvoke(i.constants.taskModuleConstants.invokeNames.complete,e).then(function(e){var n={},s={};return s[i.constants.taskModuleConstants.invokeResponse.messageType]=i.generateInvokeResultHandlerForMessageType(function(e){return n=e},t),s[i.constants.taskModuleConstants.invokeResponse.cardResult]=i.generateInvokeResultHandlerForCardResultType(function(e){return n=e},t),s[i.constants.taskModuleConstants.invokeResponse.continueType]=i.generateInvokeResultHandlerForContinueType("post-action",function(e){return n=e}),new r.InvokeResultHelper(i.constants.taskModuleConstants.invokeResponse.topLevelWrapper).processInvokeResult(e,s),n}).catch(function(e){if(e instanceof a)return{type:s.TaskModuleResultType.ErrorMessage,message:i.$translate.instant(i.resources.strings.extension_taskModuleInvalidBotResponse)};throw e})}},e.prototype.generateTaskModuleInputFromCardAttachment=function(e){var t={},i=e.contentType.toLowerCase();return i&&i!==this.constants.bots.cards.types.adaptive?(t.type=s.TaskModuleType.ErrorMessage,t.message=this.$translate.instant(this.resources.strings.extension_taskModuleUnsupportedContentType)):(t.type=s.TaskModuleType.AdaptiveCard,t.adaptiveCard={cardPayload:e.content}),t},e.prototype.generateTaskModuleResultFromCardAttachment=function(e){var t={},i=e.contentType.toLowerCase();return i&&i!==this.constants.bots.cards.types.adaptive?(t.type=s.TaskModuleResultType.ErrorMessage,t.message=this.$translate.instant(this.resources.strings.extension_taskModuleUnsupportedContentType)):(t.type=s.TaskModuleResultType.MoreAdaptiveCard,t.adaptiveCard={cardPayload:e.content}),t},e.prototype.parseTitleAndSize=function(e,t){e.width&&(t.widthLayout=e.width),e.height&&(t.heightLayout=e.height),e.title&&(t.title=e.title)},e.prototype.generateInvokeResultHandlerForMessageType=function(e,t){return{propertyRules:[r.TaskModuleInvokeResultRuleFactory.getValuePropertyRuleForMessageType()],onResult:function(i){var n={};i.value?(n.type=s.TaskModuleResultType.InfoMessage,n.message=i.value):n.type=s.TaskModuleResultType.Done,e(n),t(i.value)}}},e.prototype.generateInvokeResultHandlerForCardResultType=function(e,t){return{propertyRules:[r.TaskModuleInvokeResultRuleFactory.getAttachmentPropertyRuleForCardResult()],onResult:function(i){var n={},r=i.attachments[0];n.type=s.TaskModuleResultType.Done,e(n),t(r)}}},e.prototype.generateInvokeResultHandlerForContinueType=function(e,t){var i=this;return{propertyRules:[r.TaskModuleInvokeResultRuleFactory.getValuePropertyRuleForContinueType()],onResult:function(n){var r={},a=n.value;!!a.card!=!!a.url?(a.card&&(r="initial-fetch"===e?i.generateTaskModuleInputFromCardAttachment(a.card):i.generateTaskModuleResultFromCardAttachment(a.card)),a.url&&(r={type:"initial-fetch"===e?s.TaskModuleType.Webview:s.TaskModuleResultType.MoreWebview,webView:{url:a.url},appId:i.appId}),i.parseTitleAndSize(a,r)):(r.type="initial-fetch"===e?s.TaskModuleType.ErrorMessage:s.TaskModuleResultType.ErrorMessage,r.message=i.$translate.instant(i.resources.strings.extension_taskModuleInvalidBotResponse)),t(r)}}},e.prototype.performInvoke=function(e,t){return this.conversationsService.postInvokeMessageWithUserInfo(this.conversationId,this.constants.bots.keyPrefix+this.botId,t,this.caller,e).catch(function(e){throw e&&e.errorCode&&(e.errorCode===SkypeX.Services.ChatServiceUtils.BotFailureErrorCode||e.errorCode===SkypeX.Services.ChatServiceUtils.SyncErrorCode_NoAccess)?new a(e.errorMessage||""):e})},e}();t.TaskModuleHelper=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Done=0]="Done",e[e.InfoMessage=1]="InfoMessage",e[e.ErrorMessage=2]="ErrorMessage",e[e.MoreAdaptiveCard=3]="MoreAdaptiveCard",e[e.MoreWebview=4]="MoreWebview"}(t.TaskModuleResultType||(t.TaskModuleResultType={}));!function(e){e[e.AdaptiveCard=0]="AdaptiveCard",e[e.Webview=1]="Webview",e[e.ErrorMessage=2]="ErrorMessage"}(t.TaskModuleType||(t.TaskModuleType={}));!function(e){e.Small="small",e.Medium="medium",e.Large="large"}(t.TaskModuleLayout||(t.TaskModuleLayout={}))},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(20),r=function(){function e(){}return e.scrubPayloadForLogging=function(e){if(!e)return{};var t=_.cloneDeep(e);if(t.errorMessage=e.errorCode?"Error Code: "+e.errorCode+" ":"",e.errorMessage){var i=e.errorMessage.match(/<[^>]*>/g);i&&i.length>0&&(t.errorMessage+=i[0]+" (PII scrubbed by [InvokeErrorHelper::scrubPayloadForLogging()])")}return t},e}();t.InvokeErrorHelper=r;var s=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S,y,C,b,T,I,w,k,P){this.$window=e,this.$location=t,this.$state=i,this.$q=n,this.$rootScope=r,this.$translate=s,this.messageService=a,this.htmlSanitizer=o,this.loggingService=c,this.utilityService=l,this.settingsService=p,this.conversationsService=u,this.constants=h,this.templateCompileService=d,this.tenantSettingsStore=g,this.appStateAdapter=v,this.resources=m,this.extensionDefinitionService=f,this.tabService=S,this.appsService=y,this.channelService=C,this.signinCardAuthService=b,this.botService=T,this.analyticsService=I,this.botCardFactory=w,this.dialogService=k,this.deepLinkService=P,this._sharedSpinner=null,this._sharedImageErrorIcon=null}return e.$inject=["$window","$location","$state","$q","$rootScope","$translate","messageService","htmlSanitizer","loggingService","utilityService","settingsService","conversationsService","constants","templateCompileService","tenantSettingsStore","appStateAdapter","resources","extensionDefinitionService","tabService","appsService","channelService","signinCardAuthService","botService","analyticsService","botCardFactory","dialogService","deepLinkService"],Object.defineProperty(e.prototype,"sharedSpinner",{get:function(){if(!this._sharedSpinner){var e=angular.element("<div></div>");this.templateCompileService.compile(this.constants.files.templates.cardSpinner,this.$rootScope,e,{mode:teamspace.services.TemplateCompileMode.Append}),this._sharedSpinner=angular.element(e.children().first())}return this._sharedSpinner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedImageErrorIcon",{get:function(){if(!this._sharedImageErrorIcon){var e=angular.element("<div></div>");this.templateCompileService.compile(this.constants.files.templates.cardImageError,this.$rootScope,e),this._sharedImageErrorIcon=angular.element(e.children().first()),this._sharedImageErrorIcon.addClass("card-image-error")}return this._sharedImageErrorIcon},enumerable:!0,configurable:!0}),e.prototype.processClickedButton=function(e,t){var i=this;return t?t.viewOnly?(this.loggingService.info("[BotCardService::processClickedButton()] user triggered a card action on view only card"),this.$q.reject("No click on view only card")):this.shouldCardActionsBeBlocked(t).then(function(n){var r=n[0],s=n[1];if(r)return i.loggingService.info("[BotCardService::processClickedButton()] user triggered a card action on blocked bot. Reason shown on banner: {0}",s||""),i.$q.reject("bot is blocked.");if(e&&e.type)switch(e.type.toLowerCase()){case i.constants.bots.cards.actions.openUrl.toLowerCase():return i.onButtonClicked_openUrl(e,t);case i.constants.bots.cards.actions.signIn.toLowerCase():return i.onButtonClicked_signin(e,t);case i.constants.bots.cards.actions.reply.toLowerCase():return i.onButtonClicked_reply(e,t);case i.constants.bots.cards.actions.invoke.toLowerCase():return i.onButtonClicked_invoke(e,t);case i.constants.bots.cards.actions.pinAsTab.toLowerCase():return i.onButtonClicked_pinAsTab(e,t);case i.constants.bots.cards.actions.messageback.toLowerCase():return i.onButtonClicked_messageBack(e,t);case i.constants.bots.cards.actions.openEntity.toLowerCase():return i.onButtonClicked_openStageView(e,t)}}):(this.loggingService.error("[BotCardService::processClickedButton()] card was not supplied"),this.$q.reject("No card supplied"))},e.prototype.isCardSentBy1pBot=function(e){if(e&&e.cardSender){var t=e.cardSender.mri,i=SkypeX.Services.ChatServiceUtils.isSkypeBotMri(t),n=this.isCardSentByWhoBot(e);return i||n}return!1},e.prototype.isCardSentByWhoBot=function(e){if(e&&e.cardSender){var t=e.cardSender.mri;return t==this.constants.bots.whoBot.mriDev||t==this.constants.bots.whoBot.mriPpe||t==this.constants.bots.whoBot.mriProd}return!1},e.prototype.shouldCardActionsBeBlocked=function(e,t){var i=this;return void 0===t&&(t=!0),this.checkCardSenderBlocked(e).then(function(e){var n=!!e;return n&&t&&i.appStateAdapter.mainNotificationBannerStore.showBanner(teamspace.services.Severity.Warning,e,"bot_blocked_reason",{countdownInSeconds:2.5,autoHideTimer:2.5}),[n,e]})},e.prototype.logTelementryForCardAction=function(e,t){var i=this,n={action:{gesture:teamspace.components.PanelActionGesture.click,outcome:teamspace.shared.AttributeHelper.tryGetEnum(this.buttonTrackOutcome(t,e).toString(),teamspace.components.PanelActionOutcome,this.loggingService),scenario:teamspace.shared.AttributeHelper.tryGetEnum(this.buttonTrackScenario(t).toString(),teamspace.components.PanelActionScenario,this.loggingService),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(this.buttonTrackScenarioType(t,e).toString(),teamspace.components.PanelActionScenarioType,this.loggingService)},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(this.buttonTrackName(t,e).toString(),teamspace.components.PanelModuleName,this.loggingService),type:teamspace.shared.AttributeHelper.tryGetEnum(this.buttonTrackType(t,e).toString(),teamspace.components.PanelModuleType,this.loggingService),summary:this.buttonTrackSummary(t?t.title:"N/A",e),state:this.buttonTrackState(t,e)},dataBag:{actionType:t?t.type:null}},r=this.conversationsService.getConversation(e.conversationId),s=r&&r.isOneOnOne(),a=e&&e.cardSender&&e.cardSender.type===this.constants.connectors.type;this.getAppDefinitionFromCard(e).then(function(t){var i=s?teamspace.components.PanelAppScope.personal:r&&r.isGroupChat()?teamspace.components.PanelAppScope.group:teamspace.components.PanelAppScope.team;t?(n.app=teamspace.components.AppAnalyticsHelper.getAppAnalyticsData(t),n.app&&(n.app.id=t.id,n.app.scope=i,n.app.scenarioCapability=a?teamspace.components.PanelAppScenarioCapability.connectors:teamspace.components.PanelAppScenarioCapability.bots,n.bot={id:n.app.botId,name:n.app.name},delete n.app.botId)):e.isInputExtension&&(n.app={},n.app.id=e.appId,n.app.scope=i,n.app.scenarioCapability=teamspace.components.PanelAppScenarioCapability.messaging)}).catch(function(t){i.loggingService.error("Failed to get app entitlement for botId {0}",e.cardSender.mri)}).finally(function(){i.analyticsService.getAnalyticsPanelActionEventData(n).then(function(e){i.analyticsService.sendPanelAction(e)})})},e.prototype.checkCardSenderBlocked=function(e){var t=this,i=function(i){var n=t.resources.strings.botcards_action_blocked_banner_message,r=t.resources.strings.botcards_action_blocked_reason_botblockedbyadmin,s=t.resources.strings.botcards_action_blocked_reason_botblockedbyuser,a=i?t.$translate.instant(r,{name:e.cardSender.displayName}):t.$translate.instant(s,{name:e.cardSender.displayName});return t.$translate.instant(n,{reason:a})},n=this.conversationsService.getConversation(e.conversationId),r=e.cardSender&&SkypeX.Services.ChatServiceUtils.isBotMri(e.cardSender.mri,!1),s=e.cardSender&&e.cardSender.type===this.constants.connectors.type;if(n&&!n.isOneOnOneTBotChat()&&(r||s)){var a=!!n.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_P2PMessagingDisabled],o=this.tenantSettingsStore.getSettingValue(SkypeX.Services.TenantSettingsStorageKey.isSideLoadedAppsEnabled),c=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTenantSettingsForBots);if(a)return this.$q.resolve(i(!1));if(!o&&c){return(n.isOneOnOne()?this.appsService.getUserAppDefinitions("botCardService",null,!0):this.channelService.resolveTeamAndChannel(e.conversationId).then(function(e){return e&&e.team?t.appsService.getTeamAppDefinitions(e.team.objectId,"botCardService",null,!0):null},function(e){return null})).then(function(n){if(n){var a=e.cardSender&&e.cardSender.mri&&e.cardSender.mri.replace(t.constants.bots.keyPrefix,"");return n.some(function(e){return r&&e.bots&&e.bots.length>0&&e.bots[0].id===a||s&&e.connectors&&e.connectors.length>0&&e.connectors[0].connectorId===a})?null:i(!0)}return null})}}return this.$q.resolve(null)},e.prototype.onButtonClicked_openUrl=function(e,t){var i=this,n=e.value,r=function(){var e=i.utilityService.getDeeplinkUrl(n,i.settingsService.getRootUri());e?i.$location.url(e):i.$window.open(n)};return this.settingsService.valueAsBoolean(this.constants.settings.names.enableNewDeepLinkHandler)?this.deepLinkService.resolveURL(n,{button:e,card:t}).then(function(e){return new teamspace.services.BotCardOpenUrlActionResult(n,!0,e)}).catch(function(e){return r(),i.$q.when(new teamspace.services.BotCardOpenUrlActionResult(n,!1))}):(r(),this.$q.when(new teamspace.services.BotCardOpenUrlActionResult(n,!1)))},e.prototype.onButtonClicked_signin=function(e,t){return this.signinCardAuthService.launchWebAuthFlow(this.$rootScope,e.value,t).then(function(){return new teamspace.services.BotCardSignInActionResult})},e.prototype.onButtonClicked_openStageView=function(e,t){var i,n=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTenantSettingsForBots);try{i=JSON.parse(e.value)}catch(e){return this.loggingService.error("[BotCardService::onButtonClicked_openStageView()] can not parse JSON."),this.$q.when(new teamspace.services.BotCardOpenStageViewActionResult)}var r=i.websiteUrl,s=this.utilityService.getDeeplinkUrl(r,this.settingsService.getRootUri());if(s)return this.$location.url(s),this.$q.when(new teamspace.services.BotCardOpenStageViewActionResult);if(n){var a={id:i.entityId,canvasUrl:i.contentUrl,websiteUrl:r,entityName:i.title?i.title:t.cardSender.displayName,icon:t.cardSender.imageUri,accentColor:t.accentColor};return this.$state.go(this.constants.states.appStageViewer,a).then(function(){return new teamspace.services.BotCardOpenStageViewActionResult})}},e.prototype.onButtonClicked_reply=function(e,t){var i=this,n=t.conversationId,r=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.cardActions.imBackScenario),s=this.conversationsService.getConversation(n),a=s.isChannelConversation(),o=s.isOneOnOneBotChat(),c=a||!o,l=e.value,p=e.value,u=!1,h=[];if(c&&t.cardSender){var d=this.createAtMention(t.cardSender);d.itemid=0;var g=t.cardSender.displayName,v='<span contenteditable="false" itemscope="" itemtype="'+this.constants.semanticObjectSchemas.mention+'" itemid="0">'+this.utilityService.escapeHtml(g)+"</span>";l=this.htmlSanitizer.sanitizeHtml("<div>"+v+" "+l+"</div>"),p=this.htmlSanitizer.sanitizeHtml(g+" "+p),u=!0,h.push(d)}var m=a?t.replyChainId:null,f=c?h:null;return this.createMessage(n,l,p,u,m,f,a).then(function(e){return r.stop(),i.$q.when(new teamspace.services.BotCardReplyActionResult)}).catch(function(e){return r.fail(),i.$q.when(new teamspace.services.BotCardReplyActionResult)})},e.prototype.onButtonClicked_invoke=function(e,t){var i=this,n=this.getInvokeValue(e.value);if(n&&n.type&&n.type.toLowerCase()===this.constants.taskModuleConstants.invokeNames.fetch)return this.onButtonClicked_taskModule(n,t);var s=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.cardActions.invokeScenario);return this.sendInvoke(n,t,this.constants.scenarios.extensibility.bots.postInvokeCallers.invokeButton).then(function(e){return s.stop(),new teamspace.services.BotCardInvokeActionResult}).catch(function(e){var n=r.scrubPayloadForLogging(e);i.loggingService.error("[BotCardService::onButtonClicked_invoke()] postInvokeMessage failed: "+JSON.stringify(n));var a={error:JSON.stringify(n),botId:t.cardSender&&t.cardSender.mri};return e&&e.errorCode&&(e.errorCode===SkypeX.Services.ChatServiceUtils.BotFailureErrorCode||e.errorCode===SkypeX.Services.ChatServiceUtils.SyncErrorCode_NoAccess)?s.stop(a):s.fail(a),new teamspace.services.BotCardInvokeActionResult})},e.prototype.onButtonClicked_taskModule=function(e,t){var i=this;if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableTaskModuleDialog)){var r=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.cardActions.invokeScenario);return this.getAppDefinitionFromCard(t).then(function(e){return e&&e.id?i.botCardFactory.addAppAttribution(t,e.id):null}).then(function(){return n.InputExtensionCardHelper.launchTaskModuleFromCard(i.resources,i.$translate,i.$q,i.constants,i.botCardFactory,i.conversationsService,i.utilityService,i.messageService,i.dialogService,t,t.appId,e)}).then(function(){return r.stop(),new teamspace.services.BotCardInvokeActionResult}).catch(function(e){var n="[BotCardService::onButtonClicked_invoke()] postInvokeMessage failed: "+JSON.stringify(e);return i.loggingService.error(n),r.fail({error:n,botId:t.cardSender&&t.cardSender.mri}),new teamspace.services.BotCardInvokeActionResult})}return this.$q.resolve(new teamspace.services.BotCardInvokeActionResult)},e.prototype.onButtonClicked_messageBack=function(e,t){var i=this,n=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.cardActions.messagebackScenario);if(e.displayText){var s=t.conversationId,a=this.conversationsService.getConversation(s).isChannelConversation(),o=a?t.replyChainId:null;this.createMessage(s,e.displayText,e.displayText,!1,o,null,a,!0).then(function(){n.mark("response_text_sent")},function(e){i.loggingService.error("[BotCardService::onButtonClicked_messageback()] createMessage failed: "+JSON.stringify(e))})}return this.sendInvoke(this.getInvokeValue(e.value),t,this.constants.scenarios.extensibility.bots.postInvokeCallers.messageBackButton,this.constants.bots.cards.actions.messageback.toLowerCase(),e.text).then(function(){return n.stop(),new teamspace.services.BotCardMessageBackActionResult},function(e){var s=r.scrubPayloadForLogging(e);i.loggingService.error("[BotCardService::onButtonClicked_messageback()] sendInvoke failed: "+JSON.stringify(s));var a={error:JSON.stringify(s),botId:t.cardSender&&t.cardSender.mri};e&&e.errorCode&&(e.errorCode===SkypeX.Services.ChatServiceUtils.BotFailureErrorCode||e.errorCode===SkypeX.Services.ChatServiceUtils.SyncErrorCode_NoAccess)?n.stop(a):n.fail(a)})},e.prototype.onButtonClicked_pinAsTab=function(e,t){var i=this,n=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.cardActions.pinAsTabScenario);if(!this.isCardSentByWhoBot(t))return this.loggingService.error("[BotCardService::onButtonClicked_pinAsTab()] pin as tab card can only be sent by WhoBot."),n.fail({error:"Pin as tab action request by an entity other then who bot"}),this.$q.reject("Pin as tab action request by an entity other then who bot");if(!t||!t.conversationId)return this.loggingService.error("[BotCardService::onButtonClicked_pinAsTab()] cannot obtain card or conversationId."),n.fail({error:"Unable to obtain card and conversationId"}),this.$q.reject("Unable to obtain card and conversationId");var r=this.conversationsService.getConversation(t.conversationId).id,s=t.cardSender&&t.cardSender.mri;if(!r)return this.loggingService.error("[BotCardService::onButtonClicked_pinAsTab()] cannot obtain threadID."),n.fail({error:"Unable to obtain threadId",botId:s}),this.$q.reject("Unable to obtain threadId");var a;try{var o=JSON.parse(e.value);if(!(o instanceof Object)||o instanceof Array)throw"payload not of correct type";a=o}catch(e){return this.loggingService.error("[BotCardService::onButtonClicked_pinAsTab()] can not parse JSON."),n.fail({error:e,botId:s,threadId:r}),this.$q.reject("[BotCardService::onButtonClicked_pinAsTab()] can not parse JSON.")}return this.extensionDefinitionService.getExtensionDefinition(this.constants.tab.queryTabType).then(function(e){var o=new teamspace.services.ExtensionInstanceViewModel(e,i.constants);return o.name=a.tabTitle,o.settings.botId=s,o.settings.conversationId=t.conversationId,o.settings.command=JSON.stringify(a.pinQueryTabContext.composeExtensionPayload),o.settings.entityId=a.entityId,i.tabService.createTab(r,o).then(function(e){return n.stop(),i.$q.when(new teamspace.services.BotCardPinAsTabActionResult)}).catch(function(e){if("duplicateId"===e.type){var t=e.tab;if(t){var s=i.constants.states.appConversation;return i.$state.is(i.constants.states.appAppsAppSection)&&(s=i.constants.states.appAppsAppSection),i.$state.go(s,{middlePane:t.id,notify:!1,reload:!1,slug:r,messageId:void 0,groupName:"unknown",ctx:i.constants.navigation.context.chat,navCtx:"bot-card"}),n.stop(),i.$q.when(new teamspace.services.BotCardPinAsTabActionResult)}return i.loggingService.error("[BotCardService::onButtonClicked_pinAsTab()] unable to obtain duplicate tab."),n.fail({message:"CreateTab duplicate tab, unable to obtain duplicate tab."}),i.$q.reject("CreateTab duplicate tab, unable to obtain duplicate tab.")}return i.loggingService.error("[BotCardService::onButtonClicked_pinAsTab()] unable to create tab."),n.fail({error:e,message:"Unable to create tab"}),i.$q.reject(e)})})},e.prototype.getInvokeValue=function(e){var t={};try{var i=JSON.parse(e);i instanceof Object&&!(i instanceof Array)?t=i:this.loggingService.warn("[BotCardService::onButtonClicked_invoke()] invoke payload must be an object (and array is not supported). Will return an empty object.")}catch(t){this.loggingService.warn("[BotCardService::onButtonClicked_invoke()] can not parse JSON. Will return an empty object. Wrong button payload: "+e)}return t},e.prototype.sendInvoke=function(e,t,i,n,r){void 0===i&&(i="Unknown Caller");var s=void 0;try{s=this.botService.conversationIdWithReplyChainId(t.conversationId,t.replyChainId)}catch(e){return this.$q.reject(e)}return this.conversationsService.postInvokeMessageWithUserInfo(s,t.cardSender.mri,e,i,n,t.clientMessageId,t.serverMessageId,t.messageType,r)},e.prototype.createMessage=function(e,t,i,n,r,s,a,o){void 0===o&&(o=!1);var c=a?this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.cardActions.channelSendThread):this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.cardActions.P2PSendNewMessage);return this.messageService.createMessage({conversationId:e,replyChainId:r,messageSubject:null,messageBody:t,messagePreview:i,fileAttachments:null,extensions:null,mentions:s,embeddedLinks:null,isHtml:n,importance:null,clientId:null,externalId:null,draftObjectId:null,scenario:c,inlineImages:null,skipFanoutToBots:o}).then(function(){c.stop()}).catch(function(){c.fail()})},e.prototype.createAtMention=function(e){return{userPrincipalName:e.displayName,userDisplayName:e.displayName,userObjectId:e.mri,userType:this.constants.atMentions.type.bot}},e.prototype.buttonTrackOutcome=function(e,t){if(e&&e instanceof teamspace.services.O365ActionButton&&e.actionType){var i=this.constants.bots.cards.o365Card.actions;switch(e.actionType){case i.actionCard:return teamspace.components.PanelActionOutcome.inspect;case i.viewAction:case i.openUri:case i.httpPOST:return teamspace.components.PanelActionOutcome.submit;default:this.loggingService.error("[BotCardServiceImplememntation.buttonTrackOutcome()] Unsupported action type for O365 card: "+e.actionType)}}else{if(!(e&&t&&t instanceof teamspace.services.AdaptiveCard))return teamspace.components.PanelActionOutcome.submit;switch(e.type){case this.constants.bots.cards.adaptiveCard.actions.showCard:return teamspace.components.PanelActionOutcome.inspect;case this.constants.bots.cards.actions.openUrl:case this.constants.bots.cards.actions.messageback:return teamspace.components.PanelActionOutcome.submit;default:this.loggingService.error("[BotCardServiceImplememntation.buttonTrackOutcome()] Unsupported action type for adaptive card: "+e.type)}}},e.prototype.buttonTrackScenario=function(e){return teamspace.components.PanelActionScenario.botClickCardAction},e.prototype.buttonTrackScenarioType=function(e,t){if(e&&e instanceof teamspace.services.O365ActionButton&&e.actionType){var i=this.constants.bots.cards.o365Card.actions;switch(e.actionType){case i.actionCard:return teamspace.components.PanelActionScenarioType.toggleExpand;case i.viewAction:case i.openUri:case i.httpPOST:return teamspace.components.PanelActionScenarioType.link;default:this.loggingService.error("[BotCardServiceImplememntation.buttonTrackScenarioType()] Unsupported action type for O365 card: "+e.actionType)}}else{if(!(e&&t&&t instanceof teamspace.services.AdaptiveCard))return teamspace.components.PanelActionScenarioType.link;switch(e.type){case this.constants.bots.cards.adaptiveCard.actions.showCard:return teamspace.components.PanelActionScenarioType.toggleExpand;case this.constants.bots.cards.actions.openUrl:case this.constants.bots.cards.actions.messageback:return teamspace.components.PanelActionScenarioType.link;default:this.loggingService.error("[BotCardServiceImplememntation.buttonTrackScenarioType()] Unsupported action type for adaptive card: "+e.type)}}},e.prototype.buttonTrackName=function(e,t){return e&&e instanceof teamspace.services.O365ActionButton?teamspace.components.PanelModuleName.botCardButtonO365Action:e&&t&&t instanceof teamspace.services.AdaptiveCard?teamspace.components.PanelModuleName.botCardButtonAdaptiveCardAction:teamspace.components.PanelModuleName.botCardButtonDefaultAction},e.prototype.buttonTrackType=function(e,t){if(e&&e instanceof teamspace.services.O365ActionButton&&e.actionType){var i=this.constants.bots.cards.o365Card.actions;switch(e.actionType){case i.actionCard:return teamspace.components.PanelModuleType.inspect;case i.viewAction:case i.openUri:case i.httpPOST:return teamspace.components.PanelModuleType.link;default:this.loggingService.error("[BotCardServiceImplememntation.buttonTrackType()] Unsupported action type for O365 card: "+e.actionType)}}else{if(!(e&&t&&t instanceof teamspace.services.AdaptiveCard))return teamspace.components.PanelModuleType.link;switch(e.type){case this.constants.bots.cards.adaptiveCard.actions.showCard:return teamspace.components.PanelModuleType.inspect;case this.constants.bots.cards.actions.openUrl:case this.constants.bots.cards.actions.messageback:return teamspace.components.PanelModuleType.link;default:this.loggingService.error("[BotCardServiceImplememntation.buttonTrackType()] Unsupported action type for adaptive card: "+e.type)}}},e.prototype.buttonTrackState=function(e,t){if(e&&e instanceof teamspace.services.O365ActionButton&&e.actionType){var i=this.constants.bots.cards.o365Card.actions;switch(e.actionType){case i.actionCard:return"Selected";case i.viewAction:case i.openUri:return"URL opened";case i.httpPOST:return"Submitted";default:this.loggingService.error("[BotCardServiceImplememntation.buttonTrackState()] Unsupported action type for O365 card: "+e.actionType)}}else{if(!(e&&t&&t instanceof teamspace.services.AdaptiveCard))return"Clicked";switch(e.type){case this.constants.bots.cards.adaptiveCard.actions.showCard:return"Selected";case this.constants.bots.cards.actions.openUrl:return"URL opened";case this.constants.bots.cards.actions.messageback:return"Submitted";default:this.loggingService.error("[BotCardServiceImplememntation.buttonTrackState()] Unsupported action type for adaptive card: "+e.type)}}},e.prototype.buttonTrackSummary=function(e,t){return this.isCardSentBy1pBot(t)?e:"Click on Bot Card"},e.prototype.getAppDefinitionFromCard=function(e){var t=this,i=e&&e.cardSender&&SkypeX.Services.ChatServiceUtils.isBotMri(e.cardSender.mri,!1),n=e&&e.cardSender&&e.cardSender.type===this.constants.connectors.type,r=this.conversationsService.getConversation(e.conversationId),s=r&&r.isOneOnOne();return(i||n?s?this.settingsService.valueAsBoolean(this.constants.settings.names.enableInstalledAppAPIs)?this.appsService.getInstalledAppsForUser().then(function(e){return e.map(function(e){return e.appDefinition})}):this.appsService.getUserAppEntitlements():this.channelService.resolveTeamAndChannel(e.conversationId).then(function(e){return e&&e.team?t.settingsService.valueAsBoolean(t.constants.settings.names.enableInstalledAppAPIs)?t.appsService.getInstalledAppsForTeam(e.team.objectId).then(function(e){return e.map(function(e){return e.appDefinition})}):t.appsService.getTeamAppEntitlements(e.team.objectId):null},function(e){return null}):this.$q.resolve(null)).then(function(r){if(r){var s=e.cardSender&&e.cardSender.mri&&e.cardSender.mri.replace(t.constants.bots.keyPrefix,"");return _.find(r,function(e){return i&&e.bots&&e.bots.length>0&&e.bots[0].id===s||n&&e.connectors&&e.connectors.length>0&&e.connectors[0].connectorId===s})}return null})},e}();t.BotCardServiceImplememntation=s,angular.module("teamspace.botCardService",[]).service("botCardService",s).run(["$templateCache",function(e){e.put("services/extensibility/bot/card-image-error.html","<ng-include src=\"'svg/icons-image.html'\"></ng-include>"),e.put("services/extensibility/bot/card-spinner.html","<span class=\"ts-card-spinner\"><busy-animation size='small' context='card'></busy-animation></span>")}])},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(16),s=i(34),a=function(){function e(){}return e.format=function(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))},e}();t.ErrorUtility=a;var o=function(){function e(){}return e.maxResultCount=50,e}();t.InputExtensionServiceConstants=o;var c=function(e){function t(i){var n=e.call(this,i)||this;return Object.setPrototypeOf(n,t.prototype),n}return n(t,e),t}(Error),l=function(e){function t(t,i){var n=e.call(this,t.appDefinition,t.appEntitlement)||this;return n.teamId=i,n}return n(t,e),t}(s.InstalledApp),p=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h,d,g,v){this.$q=e,this.constants=t,this.appsService=i,this.botCardFactory=n,this.conversationsService=r,this.loggingService=s,this.sdkHelperService=a,this.utilityService=o,this.$timeout=c,this.$interval=l,this.extensionTabService=p,this.appStateService=u,this.authenticationService=h,this.settingsService=d,this.channelService=g,this.localStorageService=v,this.defaultNewWindowWidth=800,this.defaultNewWindowHeight=600,this.maxOrderOfInputExtensions=0}return e.$inject=["$q","constants","appsService","botCardFactory","conversationsService","loggingService","sdkHelperService","utilityService","$timeout","$interval","extensionTabService","appStateService","authenticationService","settingsService","channelService","localStorageService"],e.prototype.getSvgImageColorFilterMatrixValue=function(e,t){void 0===t&&(t=!1),this.svgImageColorFilterMatrixValues||(this.svgImageColorFilterMatrixValues={});var i;if(this.svgImageColorFilterMatrixValues[e]&&this.svgImageColorFilterMatrixValues[e].length>0?i=this.svgImageColorFilterMatrixValues[e][Number(t)]:this.svgImageColorFilterMatrixValues[e]=["",""],!i){var n=function(e){return e[0]+"  0           0           0           0\n        0           "+e[1]+"  0           0           0\n        0           0           "+e[2]+"  0           0\n        0           0           0           "+e[3]+"  0"},r=function(e,t,i,n){return[e/255,t/255,i/255,n]};switch(e){case this.constants.themes.dark:i=n(t?r(159,164,254,1):r(255,255,255,.74));break;case this.constants.themes.highContrast:i=n(t?r(0,0,0,1):r(255,255,255,1));break;default:i=n(t?r(85,88,175,1):r(22,35,58,.74))}this.svgImageColorFilterMatrixValues[e][Number(t)]=i}return i},e.prototype.getMaxOrder=function(){var e=this;return 0==this.maxOrderOfInputExtensions?this.getInputExtensions().then(function(t){return _.each(t,function(t){t.isFavorite&&e.setMaxOrder(t.favoriteRank)}),e.$q.resolve(e.maxOrderOfInputExtensions)}):this.$q.resolve(this.maxOrderOfInputExtensions)},e.prototype.setMaxOrder=function(e){this.maxOrderOfInputExtensions=Math.max(this.maxOrderOfInputExtensions,e)},e.prototype.installAndFavorite=function(e){var t=this;if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableComposeExtensionFlyoutV2)){var i=_.cloneDeep(e);return i.inputExtensions[0].isFavorited=!0,this.getMaxOrder().then(function(e){return i.inputExtensions[0].order=e+100,t.setMaxOrder(i.inputExtensions[0].order),t.appsService.createUserAppEntitlement(i)}).catch(function(){return i.inputExtensions[0].order=100,t.appsService.createUserAppEntitlement(i)})}return this.appsService.createUserAppEntitlement(e)},e.prototype.setFavorite=function(e,t,i,n){var r=this;return this.favoriteScenario&&this.favoriteScenario.cancel(),this.favoriteScenario=this.loggingService.newScenario(this.constants.scenarios.extensibility.inputExtension.favorite),this.favoriteScenario.eventData={isGlobalContext:n},this.appsService.getUserAppEntitlement(e).then(function(n){var s=_.cloneDeep(n);return!!s&&(t?(s.inputExtensions[0].isFavorited=!0,void 0!==i?(s.inputExtensions[0].order=i,r.setMaxOrder(i)):delete s.inputExtensions[0].order,teamspace.services.AppsServiceUtils.isAppInstalled(s)||(s.state=teamspace.Constants.Instance.extensibility.apps.appStates.installed)):delete s.inputExtensions,r.appsService.createUserAppEntitlement(s).then(function(){return r.favoriteScenario.stop({appId:e}),!0}).catch(function(t){return r.favoriteScenario.fail({appId:e,error:a.format(t),errorCode:t.statusCode}),!1}))}).catch(function(t){return r.favoriteScenario.fail({appId:e,error:a.format(t),errorCode:t.statusCode}),!1})},e.prototype.getInputExtensions=function(e,t){var i=this;if(this.authenticationService.isAnonymous())return this.$q.when([]);if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableComposeExtensionFlyoutV2))return this.getInputExtensionsV2(e,t);var n=[];return e&&n.push(e),this.settingsService.valueAsBoolean(this.constants.settings.names.enableInstalledAppAPIs)?this.appsService.getAggregatedInstalledAppsForUser(!1,n,{category:teamspace.services.AppsServiceCategoryFilter.InputExtensions}).then(function(e){return i.processInstalledApps(e,t)}):this.appsService.getUserAggregatedAppEntitlements(!1,n,{category:teamspace.services.AppsServiceCategoryFilter.InputExtensions}).then(function(e){return i.processAppDefinitions(e,t)})},e.prototype.getInputExtensionsV2=function(e,t){var i=this;return this.appsService.getAggregatedInstalledAppsForUser(!1,void 0,{category:teamspace.services.AppsServiceCategoryFilter.InputExtensions}).then(function(n){var r=[];e&&r.push(e);var s=[];return r.forEach(function(e){s.push(i.appsService.getInstalledAppsForTeam(e,{category:teamspace.services.AppsServiceCategoryFilter.InputExtensions}))}),s.length>0?i.$q.all(s).then(function(e){var s=i.mergeTeamInstalledApps(r,e);return i.processInstalledApps(i.mergeUserAndTeamInstalledApps(n,s),t)}):i.processInstalledApps(n,t)})},e.prototype.mergeTeamInstalledApps=function(e,t){var i=this,n={};return _.zipWith(e,t,function(e,t){t.forEach(function(t){var r=new l(t,e);r.appEntitlement=i.cleanUpTeamEntitlement(t.appEntitlement),n[t.appDefinition.id.toLowerCase()]=r})}),_.values(n)},e.prototype.cleanUpTeamEntitlement=function(e){var t=_.cloneDeep(e);return t.isInstalledPersonally=!1,_.each(t.inputExtensions,function(e){delete e.isFavorited,delete e.order}),t},e.prototype.mergeUserAndTeamInstalledApps=function(e,t){var i={};return e.forEach(function(e){i[e.appDefinition.id.toLowerCase()]=new l(e)}),t.forEach(function(e){var t=e.appDefinition.id.toLowerCase();i[t]&&(!e.isAppInstalled()||!i[t].isAppFeatured()&&i[t].isAppInstalled())||(i[t]=e)}),_.values(i)},e.prototype.runCommand=function(e,t,i,n,s,a,o,l,p){var u=this;o||(o=this.constants.inputExtensionConstants.queryInvokeName),this.runCommandScenario&&this.runCommandScenario.cancel(),!l&&i&&(l={commandId:i.id,parameters:[]},i.parameters.forEach(function(e){l.parameters.push({name:e.name,value:e.value})}),a&&(l.state=a),n&&(l.queryOptions={skip:n.skip,count:n.count})),this.runCommandScenario=this.loggingService.newScenario(this.constants.scenarios.extensibility.inputExtension.runCommand),this.runCommandScenario.eventData={isGlobalContext:p};var h=this.conversationsService.postInvokeMessageWithUserInfo(t,this.constants.bots.keyPrefix+e,l,this.constants.scenarios.extensibility.bots.postInvokeCallers.inputExtension,o).then(function(t){if(!t)throw new c("Invalid invoke response: result is missing");var n=u.processInvokeResult(t);if(!n)throw new c("Invalid invoke response: failed to parse the response");if(n.queryId=s,u.runCommandScenario){var r={invokeName:o,botId:e,resultType:n.type};i&&(r.commandId=i.id,r.initialRun=i.initialRun),u.runCommandScenario.stop(r)}return u.runCommandScenario=null,n});return h.catch(function(n){if(u.loggingService.error("Input extension invoke command failed"),u.runCommandScenario){var s=r.InvokeErrorHelper.scrubPayloadForLogging(n),a={invokeName:o,botId:e,conversationId:t,message:n.message,errorMessage:s.errorMessage,stack:n.stack,errorCode:n.statusCode,contextId:n.headers?n.headers.contextid:void 0};i&&(a.commandId=i.id,a.initialRun=i.initialRun),n instanceof c||n.errorCode&&n.errorCode===SkypeX.Services.ChatServiceUtils.BotFailureErrorCode||n.statusCode&&(403===n.statusCode||404===n.statusCode)||!u.appStateService.isOnline||!u.appStateService.isConnected?u.runCommandScenario.stop(a):u.runCommandScenario.fail(a)}u.runCommandScenario=null}),h},e.prototype.launchWebFlow=function(e,t,i,n,r){var s,o,c,l=this,p=this.utilityService.parseUrl(e),u=!1,h=function(){o&&(u=!0,l.$timeout(function(){o.close(),o=null},0,!1)),s&&(s.destroy(),s=null),c&&(l.$interval.cancel(c),c=null)},d=this.parseQueryString(e),g=parseInt(d.width);g=g!==Number.NaN?g:this.defaultNewWindowWidth;var v=parseInt(d.height);v=v!==Number.NaN?v:this.defaultNewWindowHeight;var m=this.loggingService.newScenario(this.constants.scenarios.extensibility.inputExtension.launchWebFlow,null,null,9e5);m.eventData={isGlobalContext:r};var f,S=function(e){m&&(m.fail({appId:t,error:a.format(e),errorCode:e.statusCode}),m=null),l.loggingService.error(e)};try{f=this.sdkHelperService.openNewWindowWithPreCheckedUrl(e,g,v).then(function(e){return l.$q(function(a,d){m&&(m.stop({appId:t}),m=null),o=e.window,c=l.$interval(function(){o&&!o.closed||l.$timeout(function(){m&&(m.cancel({appId:t}),m=null),h()},0,!1)},100),(s=l.sdkHelperService.createWindowMessageHandler(i,{window:o,type:"window"},p.origin,n)).addMessageHandler(l.constants.SdkHelperServiceConstants.getThemeChangedNotifyWindows,function(){return[{window:o,type:"window"}]}),s.addMessageHandler("initialize",function(e,t){return[l.constants.inputExtensionConstants.contextName,l.sdkHelperService.getHostClientType()]});var g=function(e){u||(h(),a(e))};s.addMessageHandler(l.constants.inputExtensionConstants.successMessageName,function(e,t){g({success:!0,result:t})}),s.addMessageHandler(l.constants.inputExtensionConstants.failureMessageName,function(e,t){g({success:!1,result:t})}),s.addMessageHandler("getContext",function(e){return l.extensionTabService.getTabContext(null).then(function(e){return r&&(e.teamId="",e.teamName="",e.channelId="",e.channelName=""),e})}),s.addMessageHandler("authentication.getAuthToken",function(e,i){return l.extensionTabService.getAuthTokenForApp(t,i)}),s.addMessageHandler("authentication.getUser",function(e){return l.extensionTabService.getUserForApp(t)})})}).catch(function(e){return S(e),{success:!1}})}catch(e){return S(e),this.$q.reject(e)}return f},e.prototype.onInvokeResult=function(e){var t=this,i={type:teamspace.services.InputExtensionCommandResultType.result};if(!e.attachmentLayout)throw new c("Invalid invoke response: attachmentLayout is missing");if(e.attachmentLayout!==this.constants.inputExtensionConstants.attachmentListLayout&&e.attachmentLayout!==this.constants.inputExtensionConstants.attachmentGridLayout)throw new c("Invalid invoke response: unsupported attachmentLayout");return i.attachmentResult={attachments:[],layout:e.attachmentLayout===this.constants.inputExtensionConstants.attachmentListLayout?teamspace.services.InputExtensionRunCommandResultLayout.list:teamspace.services.InputExtensionRunCommandResultLayout.grid},e.attachments&&e.attachments.length&&(e.attachments.length>o.maxResultCount&&(e.attachments=e.attachments.slice(0,o.maxResultCount)),_.forEach(e.attachments,function(e){var n=e.preview?e.preview.content:e.content,r={contentType:e.preview&&e.preview.contentType===t.constants.bots.cards.types.hero?t.constants.bots.cards.types.hero:t.constants.bots.cards.types.thumbnail,content:{title:n.title,text:n.text?n.text:n.subTitle,images:n.images,tap:n.tap}};if(i.attachmentResult.layout==teamspace.services.InputExtensionRunCommandResultLayout.list&&!r.content.title&&!r.content.text)throw new c("Invalid invoke response: Missing title or text in preview content for list layout");if(i.attachmentResult.layout==teamspace.services.InputExtensionRunCommandResultLayout.grid&&!r.content.images)throw new c("Invalid invoke response: Missing images in preview content for grid layout");try{var s=t.botCardFactory.createCard(r,"dummy",null,!1,!1);s.miniMode=!0,s.isInputExtension=!0;var a={contentType:e.contentType,content:e.content},o=t.botCardFactory.createCard(a,"dummy",null,!1,!1);o.isInputExtension=!0,i.attachmentResult.attachments.push({card:o,previewCard:s,rawPayload:a})}catch(e){throw new c("Failed to parse card payload: "+JSON.stringify(e))}})),i},e.prototype.onInvokeOpenApp=function(e,t){if(!e.suggestedActions||!e.suggestedActions.actions||e.suggestedActions.actions.length<=0)throw new c("Invalid invoke response: empty suggestedAction");var i={type:t===this.constants.inputExtensionConstants.authType?teamspace.services.InputExtensionCommandResultType.needAuth:teamspace.services.InputExtensionCommandResultType.needConfig};if(e.suggestedActions.actions.length>1)throw new c("Invalid invoke response: only one suggestedAction is supported");var n=e.suggestedActions.actions[0];if(n.type!==this.constants.inputExtensionConstants.openAppActionType&&n.type!==this.constants.inputExtensionConstants.openAppUrlType)throw new c("Invalid invoke response: unsupported suggestedAction type");if(!n.value)throw new c("Invalid invoke response: suggestedAction value is missing");return i.openUrlResult={url:n.value,title:n.title,type:n.type},i},e.prototype.onInvokeMessage=function(e){var t={type:teamspace.services.InputExtensionCommandResultType.message};return t.messageResult={text:e.text},t},e.prototype.processInvokeResult=function(e){var t=e[this.constants.inputExtensionConstants.topLevelWrapper];if(!t)throw new c("Invalid invoke response: response empty or top level field is missing");switch(t.type){case this.constants.inputExtensionConstants.resultType:return this.onInvokeResult(t);case this.constants.inputExtensionConstants.authType:case this.constants.inputExtensionConstants.configType:return this.onInvokeOpenApp(t,t.type);case this.constants.inputExtensionConstants.messageType:return this.onInvokeMessage(t);default:throw new c("Invalid invoke response: unsupported type")}},e.prototype.preCheckAndFormatWindowUrl=function(e,t,i){return this.sdkHelperService.preCheckAndFormatWindowUrl(e,t,i)},e.prototype.processAppDefinitions=function(e,t){var i=[];return e.forEach(function(e){e.inputExtensions&&(teamspace.services.AppsServiceUtils.isAppInstalled(e)||t&&teamspace.services.AppsServiceUtils.isAppFeatured(e))&&e.inputExtensions.forEach(function(t){var n={appId:e.id,botId:t.botId,name:e.name,description:e.shortDescription,imageUrl:e.largeImageUrl,imageUrlSmall:e.smallImageUrl,accentColor:e.accentColor,commands:t.commands,canUpdateConfiguration:t.canUpdateConfiguration,isFavorite:t.isFavorited,isFeatured:teamspace.services.AppsServiceUtils.isAppFeatured(e),isInstalledPersonally:e.isInstalledPersonally,favoriteRank:t.order};i.push(n)})}),i},e.prototype.processInstalledApps=function(e,t){var i=this,n=this.settingsService.valueAsBoolean(this.constants.settings.names.enableComposeExtensionMultiCommand),r=[];if(e.forEach(function(e){var s=e,a=e.appDefinition,o=e.appEntitlement;if(a.inputExtensions&&(e.isAppInstalled()||t&&e.isAppFeatured()))for(var c=0;c<a.inputExtensions.length;c++){var l=a.inputExtensions[c],p=o.inputExtensions&&c<o.inputExtensions.length?o.inputExtensions[c]:void 0,u={appId:a.id,botId:l.botId,name:a.name,description:a.shortDescription,imageUrl:a.largeImageUrl,imageUrlSmall:a.smallImageUrl,accentColor:a.accentColor,commands:l.commands,canUpdateConfiguration:l.canUpdateConfiguration,isFavorite:p?p.isFavorited:void 0,isFeatured:e.isAppFeatured(),isInstalledPersonally:o.isInstalledPersonally,favoriteRank:p?p.order:void 0,teamName:s.teamId?i.channelService.getTeamByObjectId(s.teamId).displayName:void 0};!n&&u.commands&&u.commands.length>1&&(u.commands=u.commands.slice(0,1)),r.push(u)}}),this.settingsService.valueAsBoolean(this.constants.settings.names.enableComposeExtensionCreate)){var s=this.localStorageService.get(this.constants.inputExtensionConstants.testAppItem);_.isEmpty(s)||r.push(s)}return r},e.prototype.parseQueryString=function(e){var t=e.indexOf("?");return-1===t?{}:(e=e.substr(t),(e=e.trim().replace(/^\?/,""))?e.trim().split("&").reduce(function(e,t){var i=t.replace(/\+/g," ").split("=");return e[i[0]]=void 0===i[1]?null:decodeURIComponent(i[1]),e},{}):{})},e}();t.InputExtensionServiceImplementation=p,angular.module("teamspace.inputExtensionService",["teamspace.authenticationService"]).service("inputExtensionService",p)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(i){void 0===i&&(i=void 0);var n=e.call(this,t.TYPE,i)||this;return n.activeUsers=[],n.reloadAfterSave=!1,n.sections=[],n.order=[],n}return n(t,e),t.prototype.hasSections=function(){return this.sections&&this.sections.length>0},t.fromSpItem=function(i,n){return e.fromSpItemInternal.call(this,i,new t,n)},Object.defineProperty(t.prototype,"itemId",{get:function(){return"page-"+this.id+"-"+this.canvasId},enumerable:!0,configurable:!0}),t.TYPE="page",t}(i(6).WikiBaseItem);t.WikiPage=r},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(i){void 0===i&&(i=void 0);var n=e.call(this,t.TYPE,i)||this;return n.isMeetingNotes=!1,n.isInCalling=!1,n.imageThumbnails=void 0,n.pages=[],n.order=[],n.editingSectionsArr=[],n.shouldShowToolbar=!1,n}return n(t,e),t.prototype.hasPages=function(){return this.pages&&this.pages.length>0},t.prototype.isEditingSectionReady=function(){var e=this.editingSection;return!e||e.ready},Object.defineProperty(t.prototype,"shouldShowEditorToolbar",{get:function(){return this.shouldShowToolbar&&!!this.editingSection},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editingSection",{get:function(){return this.editingSectionsArr[0]},enumerable:!0,configurable:!0}),t.prototype.setSectionEditingMode=function(e,t){void 0===t&&(t=!0);var i=_.findIndex(this.editingSectionsArr,function(t){return t.id===e.id});i>-1&&this.editingSectionsArr.splice(i,1),e.editing=t,t&&(this.editingSectionsArr.unshift(e),this.selectedSection=this.editingSection)},t.prototype.setSectionConversation=function(e){this.conversationSection&&(this.conversationSection.conversationPane=!1),e&&(e.conversationPane=!0),this.conversationSection=e},t.prototype.lockedSectionsForUserWithException=function(e,t){var i=[];return this.pages.forEach(function(n){n.sections.forEach(function(n){n.user===e&&n.id!==t.id&&n.locked&&i.push(n)})}),i},Object.defineProperty(t.prototype,"itemId",{get:function(){return"canvas-"+this.id},enumerable:!0,configurable:!0}),t.fromSpItem=function(i,n){return e.fromSpItemInternal.call(this,i,new t,n)},t.TYPE="canvas",t}(i(6).WikiBaseItem);t.WikiCanvas=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(13),r=function(){function e(){}return e.launchTaskModuleFromCard=function(t,i,r,s,a,o,c,l,p,u,h,d){return r(function(r,g){var v=new n.TaskModuleHelper(t,i,s,o,h,u.conversationId,u.inputExtensionBotId,s.taskModuleConstants.invokeCallers.card),m={getContent:v.generateTaskFetchCallback(d),onExecuteAction:v.generateExecuteActionCallback({},function(t){if(_.isObject(t)&&u.isInputExtension){var i=t,n=e.getInputExtensionAttachmentFromCardPayload(a,c,i,h);e.updateInputExtensionCard(l,n,u)}r()})};u.appAttribution&&(m.appName=u.appAttribution.name,m.appImageUrl=u.appAttribution.imageUrl,m.appAccentColor=u.appAttribution.accentColor),p.open(s.dialogs.taskModule,{options:m,preCloseCallback:function(){r()}})})},e.updateInputExtensionCard=function(e,t,i){},e.getInputExtensionAttachmentFromCardPayload=function(e,t,i,n){var r=e.createCard(i,"dummy",null,!1,!1);r.isInputExtension=!0;var s={card:r,previewCard:r,rawPayload:i},a=t.generateUUIDNormalized();return s.previewCard.cardClientId=a,s.card.cardClientId=a,s.rawPayload.cardClientId=a,s.rawPayload.appId=n,s},e}();t.InputExtensionCardHelper=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.topLevelName=e}return e.prototype.processInvokeResult=function(t,i){if(!t||!t[this.topLevelName])throw new Error("Top level property name does not match!");var n=t[this.topLevelName],r=i[n.type];if(!r)throw new Error("Unexpected result type:"+n.type);var s={};return _.each(r.propertyRules,function(t){if(_.isUndefined(n[t.propertyName]))throw new Error("Property: "+t.propertyName+" is missing!");var i=n[t.propertyName];t.isArray&&e.validateArrayProperty(i,t),t.customizedRule&&t.customizedRule(i),s[t.propertyName]=i}),r.onResult&&r.onResult(s),s},e.validateArrayProperty=function(e,t){if(!(e instanceof Array))throw new Error("Unexpected property, not an Array: "+JSON.stringify(e));if(e.length<1)throw new Error("Property: "+t.propertyName+" is empty!");if(t.expectedArrayLength&&e.length!==t.expectedArrayLength)throw new Error("Property: "+t.propertyName+" unexpected size: "+e.length);return!0},e}();t.InvokeResultHelper=n;var r=function(){function e(){}return e.getAttachmentPropertyRule=function(){return{propertyName:"attachments",isArray:!0,expectedArrayLength:1}},e.getSuggestedActionPropertyRule=function(){return{propertyName:"suggestedActions",isArray:!0,expectedArrayLength:1}},e.getMessagePropertyRule=function(){return{propertyName:"text"}},e.getAttachmentLayoutPropertyRule=function(){return{propertyName:"attachmentLayout"}},e}();t.InvokeResultPropertyRuleFactory=r;var s=function(){function e(){}return e.getValuePropertyRuleForMessageType=function(){return{propertyName:"value"}},e.getAttachmentPropertyRuleForCardResult=function(){return r.getAttachmentPropertyRule()},e.getValuePropertyRuleForContinueType=function(){return{propertyName:"value",customizedRule:function(e){if(e.card&&e.url)throw new Error("TaskInfo can only have either 'card' or 'url' property (mutually exclusive)");return!0}}},e}();t.TaskModuleInvokeResultRuleFactory=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createGuid=function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(e.xyRegExp,function(e){var i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?i:3&i|8).toString(16)})},e.createNoDashGuid=function(){return e.createGuid().replace(e.dashRegExp,"")},e.xyRegExp=new RegExp("[xy]","g"),e.dashRegExp=new RegExp("-","g"),e}();t.CortanaUtilities=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Idle=0]="Idle",e[e.Initializing=1]="Initializing",e[e.Listening=2]="Listening",e[e.Thinking=3]="Thinking",e[e.Responding=4]="Responding",e[e.ExecutingAction=5]="ExecutingAction"}(t.RecognitionState||(t.RecognitionState={})),t.CortanaServiceEvents={stateChanged:"stateChanged",intermidiateResult:"hypothesis",recognizedPhrase:"phrase",turnEnded:"turnEnded",response:"response",dismiss:"dismiss"};!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error",e[e.AppOffline=2]="AppOffline",e[e.ConnectError=3]="ConnectError"}(t.TurnEndedStatus||(t.TurnEndedStatus={})),t.CortanaDevToolsStorageKeys={cortanaMSAToken:"cmsatoken",debugMode:"cdebugmode",disableFollowUpListening:"cdisablefl",enableNative:"cenablenative",enableRHOverride:"cenablerhoverride",flight:"cflight",hrsEndpoint:"crhhrsep",lastTraceId:"cltrace",reactiveHostEndpoint:"crhep",useClassicCard:"cuseclassic",useMSA:"cusemsa"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.OPEN=0]="OPEN",e[e.CLOSED=1]="CLOSED"}(t.WizardStatus||(t.WizardStatus={}));!function(e){e[e.large=70]="large",e[e.medium=60]="medium"}(t.WizardWidth||(t.WizardWidth={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spColumns=[{name:"wikiCanvasId",type:1,attributeName:"canvasId"},{name:"wikiPageId",type:1,attributeName:"pageId"},{name:"wikiTitle",type:3,attributeName:"title"},{name:"wikiContent",type:3,attributeName:"content"},{name:"wikiUser",type:2,attributeName:"user"},{name:"wikiTimestamp",type:4,attributeName:"timestamp"},{name:"wikiDeleted",type:8,attributeName:"deleted"},{name:"wikiSession",type:2,attributeName:"session"},{name:"wikiSpare1",type:2,attributeName:void 0},{name:"wikiSpare2",type:2,attributeName:void 0},{name:"wikiSpare3",type:2,attributeName:void 0},{name:"wikiConversationId",type:2,attributeName:"conversationId"},{name:"wikiMetadata",type:3,attributeName:"metadata"},{name:"wikiOrder",type:3,attributeName:"order"}]},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Chicklet=0]="Chicklet",e[e.CallingScreen=1]="CallingScreen",e[e.Tab=2]="Tab"}(n=t.CanvasDeepLinkOrigin||(t.CanvasDeepLinkOrigin={}));var r=function(){return function(e,t,i){void 0===i&&(i=n.Tab),this.pageId=e,this.sectionId=t,this.origin=i}}();t.CanvasDeepLinkContext=r},,,,function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=SkypeX.Services.SyncTasks,s=SkypeX.Services.SkypeMessageSource,a=SkypeX.Services.ChatServiceUtils,o=SkypeX.Services.MessageViewType,c=SkypeX.Services.SkypeMessageLocal,l=teamspace.services.SyncStateStorageTarget,p=function(){return function(){this.calls=0,this.earliestVersion=Number.MAX_VALUE,this.previousWrite=r.Resolved(),this.uniqueReplyChains=[]}}();t.MessageSyncAccumulation=p;var u=function(){function e(e,t,i,n,r,a,c){this.$injector=e,this.conversationsStore=t,this.eventingService=i,this.constants=n,this.conversationId=r,this.args=a,this.syncSource=s.Sync,this.syncAccumulation=c||new p,this.args.completeReplyChains=!!_.isUndefined(this.args.completeReplyChains)||this.args.completeReplyChains,this.syncStateService=this.$injector.get("syncStateService"),this.settingsService=this.$injector.get("settingsService"),this.messageMetadata={syncSource:this.syncSource,messageViewType:o.ReplyChains}}return e.prototype.execute=function(t){var i=this,n=performance.now();if(!this.conversationsStore.isConversationAvailable(this.conversationId))return t.logger.warn("Conversation not found for message sync: {0}",this.conversationId),r.Rejected();var s=this.conversationsStore.dangerousGetConversationMutable(this.conversationId),o=this.conversationsStore.getConversationSyncState(this.conversationId),c=this.conversationsStore.isPersisted(this.conversationId);return this.getMessages(t).then(function(l){var p=i.conversationsStore.isCSAReplyChainApiSupported(i.conversationId)?t.replyChainStore.handleSyncedMessages(l.messages,i.messageMetadata,c):t.messageStore.handleSyncedMessages(l.messages,i.syncSource,c),u=i.syncAccumulation.previousWrite||r.when(),h=r.whenAll([u,p]),d=!l._metadata.backwardLink,g=i.getMessageHistoryStartTime();i.syncAccumulation=e.accumulateState(i.syncAccumulation,l,h),g||(d?g=1:(i.hasFoundSyncWindow()||i.syncAccumulation.calls>=14)&&(g=i.syncAccumulation.earliestVersion,i.args.extendStartTime=!1));var v=o.isSyncedToStartOfTime||d&&1===g;i.saveSyncState({syncState:a.decodeSyncState(l._metadata.syncState),messageHistoryStartTime:g,messagesStale:!d,isSyncedToStartOfTime:v,continuationToken:v?void 0:o.continuationToken,lastSyncTime:Date.now(),isFailed:void 0,conversationVersion:s.version,clientCacheClearedAt:void 0},h,t);var m=performance.now()-n;if(i.eventingService.$emit(i.constants.events.syncService.syncStatus,{jobType:SkypeX.Services.Sync.SyncJobType.MESSAGES,conversationId:i.conversationId,delta:m,messages:l.messages.length,withSyncState:!!o.syncState,successful:!0}),d)i.onSyncComplete(t);else{if(i.syncAccumulation.calls>=15)return void t.logger.warn("==Reached MaxCallCount {0} for {1}... stopping",15,i.conversationId);t.pushFront(new e(i.$injector,i.conversationsStore,i.eventingService,i.constants,i.conversationId,i.args,i.syncAccumulation))}}).fail(function(r){var s=performance.now()-n;if(i.eventingService.$emit(i.constants.events.syncService.syncStatus,{jobType:SkypeX.Services.Sync.SyncJobType.MESSAGES,conversationId:i.conversationId,delta:s,messages:void 0,withSyncState:!!o.syncState,successful:!1}),t.logger.error("GetMessages Error: convId: {0} error: {1}",i.conversationId,r),r&&400==r.statusCode&&r.errorCode==a.ErrorCode_InvalidToken)return t.logger.warn("Conversation has invalid sync token - clearing it. {0} {1}",r,o.syncState),t.conversationsStore.patchConversation(i.conversationId,function(e){return e.syncState=""},!0,!1),o=i.conversationsStore.getConversationSyncState(i.conversationId),o.syncState="",o.errorCode=r.statusCode||r.errorCode,i.syncStateService.addUpdateSyncState([o],l.Memory),void t.pushFront(new e(i.$injector,i.conversationsStore,i.eventingService,i.constants,i.conversationId,i.args));var c=t.syncStateService.getSyncState(i.conversationId)||new SkypeX.Services.Sync.TeamsObjectSyncState(i.conversationId);c.errorCode=r.statusCode||r.errorCode,t.syncStateService.addUpdateSyncState([c],l.Memory),404!==r.statusCode&&403!==r.statusCode||t.conversationsStore.markThreadAsDead(i.conversationId)})},e.prototype.isValid=function(){if(this.args.force)return!0;if(SkypeX.Services.SkypeConversationLocal.isLie(this.conversationId))return!1;var e=this.conversationsStore.getConversationSyncState(this.conversationId),t=e&&e.messagesStale||this.args.extendStartTime;return!!e&&!a.containsParentMessageId(this.conversationId)&&t},e.prototype.resourceTags=function(){return["messages/"+this.conversationId]},e.prototype.abort=function(){},e.getConversationId=function(e){return e.startsWith("messages")?e.split("/")[1]:null},e.prototype.getMessages=function(e){var t=e.conversationsStore.getConversationSyncState(this.conversationId);return e.chatServiceClient.getConversationMessages(this.conversationId,{clientCacheClearedAt:t.clientCacheClearedAt,startTimeUtcMs:this.getMessageHistoryStartTime()||1,syncState:t.syncState})},e.prototype.onSyncComplete=function(e){var t=this,i=e.conversationsStore.dangerousGetConversationMutable(this.conversationId),n=e.conversationsStore.getConversationSyncState(this.conversationId),r=n&&n.messageHistoryStartTime;if(i)if(this.args.completeReplyChains){var s=function(e){return t.syncStateService.isReplyChainSynced(i,a.formatActivityId(t.conversationId,e))},o=_.filter(this.syncAccumulation.uniqueReplyChains,function(e){return!s(e)});_.forEach(o,function(i){e.pushFront(new h(t.$injector,t.conversationsStore,t.eventingService,t.constants,t.conversationId,i,t.messageMetadata.messageViewType))}),e.logger.info("==Reached full sync for {0} for messages after {1} - {2} ({3}) reply chains",this.conversationId,new Date(r).toISOString(),this.syncAccumulation.uniqueReplyChains.length,o.length)}else e.logger.info("==Reached full sync for {0} for messages after {1}",this.conversationId,new Date(r).toISOString());else e.logger.warn("MessageSyncJob complete but conversation is gone {0}",this.conversationId)},e.prototype.getMessageHistoryStartTime=function(){if(!this.args.extendStartTime){var e=this.conversationsStore.getConversationSyncState(this.conversationId);return this.args.forceSyncInterval||e&&e.messageHistoryStartTime}},e.prototype.hasFoundSyncWindow=function(){var e=this.syncAccumulation.uniqueReplyChains.length>(this.args.minimumUniqueReplyChains||20),t=this.syncAccumulation.earliestVersion<=(this.args.minimumSyncIntervalMs||Number.MAX_VALUE);return e&&t},e.prototype.saveSyncState=function(e,t,i){var n=this;this.conversationsStore.patchConversation(this.conversationId,function(t){t.syncState=e.syncState,t.messageHistoryStartTime=e.messageHistoryStartTime,t.messagesStale=e.messagesStale,t.isSyncedToStartOfTime=e.isSyncedToStartOfTime,t.lastSyncTime=e.lastSyncTime,t.clientCacheClearedAt=e.clientCacheClearedAt},!0,!1);var r=this.conversationsStore.getConversationSyncState(this.conversationId)||new SkypeX.Services.Sync.TeamsObjectSyncState(this.conversationId);r.syncState=e.syncState,r.messageHistoryStartTime=e.messageHistoryStartTime,r.messagesStale=e.messagesStale,r.isSyncedToStartOfTime=e.isSyncedToStartOfTime,r.lastSyncTime=e.lastSyncTime,r.clientCacheClearedAt=e.clientCacheClearedAt,r.errorCode=null,this.syncStateService.addUpdateSyncState([r],l.Memory),this.conversationsStore.isPersisted(this.conversationId)&&t.then(function(){var t=n.syncStateService.getSyncState(n.conversationId)||new SkypeX.Services.Sync.TeamsObjectSyncState(n.conversationId);t.isFailed?i.logger.info("Message sync state not updated due to previous write failure {0}",n.conversationId):(_.assign(t,e),n.syncStateService.addUpdateSyncState([t],l.Persistence))}).fail(function(e){i.logger.warn("Unable to write messages for conversation "+n.conversationId+" error: "+e);var t=n.syncStateService.getSyncState(n.conversationId)||new SkypeX.Services.Sync.TeamsObjectSyncState(n.conversationId);t.isFailed=!0,n.syncStateService.addUpdateSyncState([t],l.Persistence)})},e.accumulateState=function(e,t,i){var n=_.clone(e),r=_.map(t.messages,function(e){return c.getParentMessageId(e)||e.id}),s=t.messages.length>0?Number(_.minBy(t.messages,"version").version):void 0;return n.calls++,n.uniqueReplyChains=_.uniq(n.uniqueReplyChains.concat(r)),n.earliestVersion=Math.min(n.earliestVersion,s||Number.MAX_VALUE),n.previousWrite=i,n},e}();t.MessageSyncJob=u;var h=function(e){function t(t,i,n,r,o,c,l){var p=this,u=a.formatActivityId(o,c);if(!i.dangerousGetConversationMutable(u)){var h=i.createReplyChainConversationLie(o,u);i.addOrUpdateConversation(h)}return p=e.call(this,t,i,n,r,u,{forceSyncInterval:1,completeReplyChains:!1})||this,p.syncSource=s.SyncRelated,p.messageMetadata.syncSource=p.syncSource,p.messageMetadata.messageViewType=l,p.threadId=o,p.messageId=c,p}return n(t,e),t.prototype.isValid=function(){return!!this.conversationsStore.dangerousGetConversationMutable(this.conversationId)},t.prototype.abort=function(){},t.prototype.getMessages=function(t){var i=t.conversationsStore.dangerousGetConversationMutable(this.conversationId);return i&&i.isReplyChainSyncSupported()?e.prototype.getMessages.call(this,t):t.chatServiceClient.getConversationMessage(this.threadId,this.messageId).then(function(e){return{_metadata:{totalCount:1,forwardLink:null,backwardLink:null,syncState:""},messages:[e]}})},t.prototype.onSyncComplete=function(t){var i=this;e.prototype.onSyncComplete.call(this,t);var n=function(e){var n=t.conversationsStore.dangerousGetConversationMutable(i.conversationId),r=t.conversationsStore.getConversationSyncState(i.conversationId);if(n){var s=t.conversationsStore.getConversation(n.parentConversationId);s&&(i.syncStateService.updateReplyChainSyncState(s.id,i.conversationId,{messagesStale:r.messagesStale,syncState:r.syncState,syncStartTime:1,replyChainId:i.conversationId}),t.settingsService.valueAsBoolean("enableReplyChainApi")&&t.replyChainStore.isRunning&&t.replyChainStore.updateReplyChainOnSyncComplete(i.conversationId),t.conversationsStore.patchConversation(s.id,function(e){e.replyChainSyncMap[i.conversationId]={messagesStale:r.messagesStale,syncState:r.syncState,syncStartTime:1,replyChainId:i.conversationId}},e,!1))}};n(!1),(this.syncAccumulation.previousWrite||r.Resolved()).then(function(){i.conversationsStore.isPersisted(i.conversationId)&&n(!0),t.conversationsStore.removeConversation(i.conversationId)})},t}(u);t.RelatedMessagesSyncJob=h},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=SkypeX.Services.ChatServiceUtils;t.NonRetryableStatusCodes=[400,403,404];var r=function(){function e(e,t,i,n){this.conversationsStore=e,this.eventingService=t,this.constants=i,this.conversationId=n}return e.prototype.execute=function(e){var i=this,r=performance.now();return e.chatServiceClient.getThread(this.conversationId).then(function(t){var n=e.conversationsStore.applyThreadUpdate(t),s=performance.now()-r;return i.eventingService.$emit(i.constants.events.syncService.syncStatus,{jobType:SkypeX.Services.Sync.SyncJobType.DETAILS,conversationId:i.conversationId,delta:s,threads:1,successful:!0}),n}).fail(function(s){var a=performance.now()-r;i.eventingService.$emit(i.constants.events.syncService.syncStatus,{jobType:SkypeX.Services.Sync.SyncJobType.DETAILS,conversationId:i.conversationId,delta:a,threads:1,successful:!1});var o=e.conversationsStore.getConversation(i.conversationId),c=!1;if(t.NonRetryableStatusCodes.indexOf(s.statusCode)>-1){switch(s.errorCode){case n.SyncErrorCode_NoAccess:e.logger.warn("No access to thread: {0}. {1}",i.conversationId,s);break;case n.SyncErrorCode_ThreadNotFound:e.logger.warn("Thread not found: {0}. {1}",i.conversationId,s);break;default:e.logger.warn("Non-retryable thread error: {0}. {1}",i.conversationId,s)}c=!0}if(c){var l=e.loggingService.newScenario(i.constants.scenarios.sync.markThreadAsDead);return l.eventData={data:JSON.stringify({source:"ThreadDetailsSyncJob",id:i.conversationId})},e.conversationsStore.markThreadAsDead(i.conversationId),void l.stop()}e.logger.warn("Unknown error accessing thread: {0}",i.conversationId),e.conversationsStore.patchConversation(o.id,function(e){e.conversationSyncFailureCount=(o.conversationSyncFailureCount||0)+1},!1)})},e.prototype.isValid=function(){var e=this.conversationsStore.dangerousGetConversationMutable(this.conversationId);return e&&e.threadVersion>e.detailsVersion},e.prototype.resourceTags=function(){return["thread/"+this.conversationId]},e.prototype.abort=function(){},e.getConversationId=function(e){return e.startsWith("thread")?e.split("/")[1]:null},e}();t.ThreadDetailsSyncJob=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CortanaConfigurationServiceEvents={configurationUpdated:"configurationUpdated"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(t.SpeechResultFormat||(t.SpeechResultFormat={}));!function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(t.ConnectionState||(t.ConnectionState={}));!function(e){e[e.Text=0]="Text",e[e.Binary=1]="Binary"}(t.MessageType||(t.MessageType={})),t.SpeechConnectionEvents={connectionEstablished:"ConnectionEstablishedEvent",connectionClosed:"ConnectionClosedEvent",connectionError:"ConnectionErrorEvent"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.definition=e,this.entitlement=t}return Object.defineProperty(e.prototype,"appDefinition",{get:function(){return this.definition},set:function(e){this.definition=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appEntitlement",{get:function(){return this.entitlement},set:function(e){this.entitlement=e},enumerable:!0,configurable:!0}),e.prototype.isAppInstalled=function(){return this.checkAppStates([teamspace.Constants.Instance.extensibility.apps.appStates.installed,teamspace.Constants.Instance.extensibility.apps.appStates.installedAndFavorited,teamspace.Constants.Instance.extensibility.apps.appStates.installedAndPermanent])},e.prototype.isAppPermanent=function(){return this.checkAppStates([teamspace.Constants.Instance.extensibility.apps.appStates.installedAndPermanent])},e.prototype.isAppDeprecated=function(){return this.checkAppStates([teamspace.Constants.Instance.extensibility.apps.appStates.installedAndDeprecated])},e.prototype.isAppFeatured=function(){return this.checkAppStates([teamspace.Constants.Instance.extensibility.apps.appStates.featured])},e.prototype.checkAppStates=function(e){return e.includes(this.entitlement.state)},e}();t.InstalledApp=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(t.Size||(t.Size={}));!function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(t.TextSize||(t.TextSize={}));!function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(t.Spacing||(t.Spacing={}));!function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(t.TextWeight||(t.TextWeight={}));!function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(t.TextColor||(t.TextColor={}));!function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.HorizontalAlignment||(t.HorizontalAlignment={}));!function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(t.VerticalAlignment||(t.VerticalAlignment={}));!function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(t.ActionAlignment||(t.ActionAlignment={}));!function(e){e[e.Default=0]="Default",e[e.Person=1]="Person"}(t.ImageStyle||(t.ImageStyle={}));!function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(t.ShowCardActionMode||(t.ShowCardActionMode={}));!function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.Orientation||(t.Orientation={}));!function(e){e[e.Stretch=0]="Stretch",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(t.BackgroundImageMode||(t.BackgroundImageMode={}));!function(e){e.Default="default",e.Emphasis="emphasis"}(t.ContainerStyle||(t.ContainerStyle={}));!function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.TooManyActions=9]="TooManyActions",e[e.UnknownActionType=10]="UnknownActionType",e[e.UnknownElementType=11]="UnknownElementType",e[e.UnsupportedCardVersion=12]="UnsupportedCardVersion"}(t.ValidationError||(t.ValidationError={}));!function(e){e[e.FullyInContainer=0]="FullyInContainer",e[e.Overflowing=1]="Overflowing",e[e.FullyOutOfContainer=2]="FullyOutOfContainer"}(t.ContainerFitStatus||(t.ContainerFitStatus={}))},function(e,t){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.incomplete=0]="incomplete",e[e.stop=1]="stop",e[e.fail=2]="fail"}(t.ScenarioOperation||(t.ScenarioOperation={}))},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(i){void 0===i&&(i=void 0);var n=e.call(this,t.TYPE,i)||this;return n.ready=!0,n.conversationPane=!1,n.metadata={},n}return n(t,e),t.fromSpItem=function(i,n){return e.fromSpItemInternal.call(this,i,new t,n)},Object.defineProperty(t.prototype,"locked",{get:function(){return!!this.session},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemId",{get:function(){return"section-"+this.id+"-"+this.pageId+"-"+this.canvasId},enumerable:!0,configurable:!0}),t.prototype.isLockedFromDifferentSession=function(e){return this.locked&&this.session!==e},t.TYPE="section",t}(i(6).WikiBaseItem);t.WikiSection=r},,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t,i,n,r,s,a){var o=this;this.constants=t,this.loggingService=i,this.localizationService=n,this.settingsService=r,this.policiesService=s,this.policySettingsStore=a,this.userLocale=e.DefaultLocale,this.isDialPlansEnabled=!1,this.logger=this.loggingService.newLogger("PstnNumberService"),this.isDialPlansEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enableDialPlans),this.phoneUtil=libphonenumber.PhoneNumberUtil.getInstance(),this.policySettingsStore.subscribe(function(){o.setUserLocale()}),this.setUserLocale()}return e.$inject=["constants","loggingService","localizationService","settingsService","policiesService","policySettingsStore"],e.prototype.setUserLocale=function(){var t=this.policySettingsStore.getSettingValue(SkypeX.Services.PolicySettingsStorageKey.iTUCountryPrefix);if(t&&!_.isEmpty(t)){var i=this.phoneUtil.getRegionCodeForCountryCode(Number(t));if(i)return this.userLocale=i.toLowerCase(),void this.logger.info("Setting locale based on dial plan to {0}",this.userLocale)}var n=this.localizationService.getLocale();if(n)return this.userLocale=n.substr(n.indexOf("-")+1).toLowerCase(),void this.logger.info("Setting locale based on teams locale to {0}",this.userLocale);this.logger.warn("localizationService failed to get locale. Falling back to 'us' locale"),this.userLocale=e.DefaultLocale},e.prototype.isPossibleNumber=function(e){return/^\+?\d+[a-z0-9,-;=.]*$/i.test(e)},e.prototype.isStandardFormatNormalized=function(e){if(!e)return!1;try{var t=this.normalizePstnNumber(e),i=this.phoneUtil.parse(t,this.userLocale);return this.phoneUtil.isPossibleNumber(i)&&this.phoneUtil.isValidNumber(i)}catch(e){return this.logger.warn(e),!1}},e.prototype.isStandardFormat=function(e){if(!e)return!1;var t=this.normalizePstnNumber(e);if(this.policiesService.hasDialPlans())return this.isPossibleNumber(t);try{var i=this.phoneUtil.parse(t,this.userLocale);return this.phoneUtil.isPossibleNumber(i)&&this.phoneUtil.isValidNumber(i)}catch(e){return this.logger.log(e),!1}},e.prototype.getNumberToCall=function(e){if(!this.isStandardFormatNormalized(e))throw this.logger.warn("getNumberToCall received an invalid phone number"),"Given number is not a valid phone number";var t=this.phoneUtil.parse(e,this.userLocale);return this.phoneUtil.format(t,libphonenumber.PhoneNumberFormat.E164)},e.prototype.getExtension=function(e){var t=this.normalizePstnNumber(e);if(!this.isStandardFormatNormalized(t))return"";try{return this.phoneUtil.parse(t,this.userLocale).getExtension()||""}catch(e){return this.logger.warn("Failed to parse and format a phone number: ${error}"),""}},e.prototype.parseAndFormatNumber=function(e,t){void 0===t&&(t=libphonenumber.PhoneNumberFormat.INTERNATIONAL);var i=this.normalizePstnNumber(e);if(!this.isStandardFormatNormalized(i))return i;try{var n=this.phoneUtil.parse(i,this.userLocale);return this.phoneUtil.format(n,t)}catch(e){return this.logger.warn("Failed to parse and format a phone number: "+e),i}},e.prototype.normalizePstnNumber=function(e){var t=this.removeGuid(e),i=this.removeUnneededCharacters(t);return this.isDialPlansEnabled?this.policiesService.normalize(i):i},e.prototype.removeUnneededCharacters=function(e){return e.replace(/[ \(\)\-_]+/g,"")},e.prototype.removeGuid=function(e){return e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,"")},e.DefaultLocale="us",e.EXT_SEPARATOR=",",e}();t.PstnNumberServiceImplementation=n,angular.module("teamspace.pstnNumberService",["teamspace.loggingService","teamspace.localizationService","teamspace.settingsService","teamspace.policiesService"]).service("pstnNumberService",n)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t,i,n){this.errorMessage=e,this.contextId=t,this.statusCode=i,this.errorCode=n}}();t.ErrorData=r;var s=function(e){function t(t,i,n,r,s,a,o){return e.call(this,"",t,i,n,r,s,a,o)||this}return n(t,e),t.prototype._getAuthHeaders=function(e){void 0===e&&(e=!1);var t={};return t[this.constants.headers.accept]=this.constants.headers.jsonContent,this.authenticationService.getAuthHeaders(t,[this._endpointUrl])},t.prototype.setEndpointUrl=function(e){this._endpointUrl?this._endpointUrl.toUpperCase()!==e.toUpperCase()&&(this._endpointUrl=e):this._endpointUrl=e},t.prototype.getErrorFromData=function(e,t,i){return new r(e,t&&t.headers&&t.headers[this.constants.headers.sharePoint.SPRequestGuid.toLowerCase()]||i)},t.prototype.getStandardizedError=function(e,t,i){return t?"string"==typeof t?new r(e+": "+(t||"unknown")):new r(e+": "+teamspace.services.CallingTelemetryService.getErrorMessage(t.errorMessage||"unknown"),t.headers&&t.headers[this.constants.headers.sharePoint.SPRequestGuid.toLowerCase()]||i,t.statusCode,t.errorCode):new r(e)},t}(SkypeX.Services.GenericRestClient);t.PptSharingSharePointClient=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.subscriptions=new Map,this.subTokenNum=1,this.subsByNum={}}return e.prototype.subscribe=function(e,t){this.subscriptions.has(t)?this.subscriptions.get(t).push(e):this.subscriptions.set(t,[e]);var i=this.subTokenNum++;return this.subsByNum[i]={key:t,callback:e},i},e.prototype.unsubscribe=function(e){if(this.subsByNum[e]){var t=this.subsByNum[e].key,i=this.subsByNum[e].callback;if(delete this.subsByNum[e],this.subscriptions.has(t))for(var n=this.subscriptions.get(t),r=0;r<n.length;r++)n[r]===i&&(n.splice(r,1),0===n.length&&this.subscriptions.delete(t))}},e.prototype.clearSubscriptions=function(){this.subscriptions.clear(),this.subsByNum={},this.subTokenNum=1},e.prototype.trigger=function(e,t){if(this.subscriptions.has(e)){var i=[];this.subscriptions.get(e).forEach(function(e){i=i.concat(e)});var n=[];i.forEach(function(i){try{i(e,t)}catch(e){n.push(e)}}),n.forEach(function(e){return console.log(e)})}},e}();t.EventSource=n},function(e,t,i){"use strict";function n(e,t){return e||t}function r(e){return void 0===e||null===e||""===e}function s(e,t,i){if(r(t))return i;for(var n in e)if(parseInt(n,10)>=0){var s=e[n];if(s&&"string"==typeof s&&s.toLowerCase()===t.toLowerCase())return parseInt(n,10)}return i}function a(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){var i=parseInt(t[1],16)/255;return"rgba("+parseInt(t[2],16)+","+parseInt(t[3],16)+","+parseInt(t[4],16)+","+i+")"}return e}function o(e){for(var t=[],i=c(e,-1);i<e.length;)" "==e[i]&&t.push(i),i=c(e,i);return t}function c(e,t){for(t+=1;t<e.length&&"<"==e[t];)for(;t<e.length&&">"!=e[t++];);return t}Object.defineProperty(t,"__esModule",{value:!0});var l=i(35);t.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"},t.getValueOrDefault=n,t.isNullOrEmpty=r,t.appendChild=function(e,t){null!=t&&void 0!=t&&e.appendChild(t)},t.getEnumValueOrDefault=s,t.parseHostConfigEnum=function(e,t,i){return"string"==typeof t?s(e,t,i):"number"==typeof t?n(t,i):i},t.renderSeparation=function(e,t){if(e.spacing>0||e.lineThickness>0){var i=document.createElement("div");return t==l.Orientation.Horizontal?e.lineThickness?(i.style.marginTop=e.spacing/2+"px",i.style.paddingTop=e.spacing/2+"px",i.style.borderTop=e.lineThickness+"px solid "+a(e.lineColor)):i.style.height=e.spacing+"px":e.lineThickness?(i.style.marginLeft=e.spacing/2+"px",i.style.paddingLeft=e.spacing/2+"px",i.style.borderLeft=e.lineThickness+"px solid "+a(e.lineColor)):i.style.width=e.spacing+"px",i.style.overflow="hidden",i}return null},t.stringToCssColor=a;var p=function(){function e(){this._isProcessed=!1,this._original=null,this._processed=null}return e.prototype.substituteInputValues=function(e,i){this._processed=this._original;for(var n,r=/\{{2}([a-z0-9_$@]+).value\}{2}/gi;null!=(n=r.exec(this._original));){for(var s=null,a=0;a<e.length;a++)if(e[a].id.toLowerCase()==n[1].toLowerCase()){s=e[a];break}if(s){var o="";s.value&&(o=s.value),i===t.ContentTypes.applicationJson?o=(o=JSON.stringify(o)).slice(1,-1):i===t.ContentTypes.applicationXWwwFormUrlencoded&&(o=encodeURIComponent(o)),this._processed=this._processed.replace(n[0],o)}}this._isProcessed=!0},e.prototype.get=function(){return this._isProcessed?this._processed:this._original},e.prototype.set=function(e){this._original=e,this._isProcessed=!1},e}();t.StringWithSubstitutions=p,t.truncate=function(e,t,i){var n=function(){return t-e.scrollHeight>=-1};if(!n()){for(var r=e.innerHTML,s=function(t){e.innerHTML=r.substring(0,t)+"..."},a=o(r),l=0,p=a.length,u=0;l<p;){var h=Math.floor((l+p)/2);s(a[h]),n()?(u=a[h],l=h+1):p=h}if(s(u),i&&t-e.scrollHeight>=i-1){for(var d=c(r,u);d<r.length&&(s(d),n());)u=d,d=c(r,d);s(u)}}},t.getFitStatus=function(e,t){var i=e.offsetTop;return i+e.clientHeight<=t?l.ContainerFitStatus.FullyInContainer:i<t?l.ContainerFitStatus.Overflowing:l.ContainerFitStatus.FullyOutOfContainer}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.opened=!1,this.ringing=this.muted=this.onHold=!1,this.hooked=!0}return e.create=function(){return new e},e}();t.HidState=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t,i,n){this.$window=t,this.constants=i,this.localizationService=n,this.htmlPasteElements=e.htmlElements,this.htmlPasteAttributes="height,width,style,itemscope,itemtype,itemprop,itemid,content,data-itemprops,type,title",this.htmlPasteStyles="font-style,font-size,font-weight,text-decoration,background,background-color,color",this.htmlPasteClasses=e.htmlClasses,this.pasteImageAttributeRule="img[!src]",this.pasteLinkAttributeRule="a[!href]";var r=this.$window.CKEDITOR?this.$window.CKEDITOR.ENTER_DIV:3,s=e.htmlAttributes+","+this.constants.semanticObjects.ignoreSemanticLinkAttr,a=e.htmlElements+"["+s+"]{"+e.htmlStyles+"}("+e.htmlClasses+")",o=this.htmlPasteElements+"["+this.htmlPasteAttributes+"]{"+this.htmlPasteStyles+"}("+this.htmlPasteClasses+")";o+=";"+this.getPasteRules(),this.config={resize_enabled:!1,title:!1,toolbarGroups:[],removeButtons:"Strike,Subscript,Superscript,Anchor,Styles,Specialchar",removePlugins:"a11yhelp,liststyle,tabletools,contextmenu,elementspath,resize,magicline,tableselection",width:"100%",skin:"moono",height:"100%",extraPlugins:"sharedspace,divarea,widget,font,colorbutton,button,panelbutton,panel,floatpanel,",allowedContent:a,disallowedContent:"script style",pasteFilter:o,startupFocus:!1,enterMode:r,shiftEnterMode:r,disableNativeSpellChecker:!1,defaultLanguage:"en",contentsLangDirection:this.localizationService.langDirection,language:"en"},this.config.extraPlugins+=",pastefromword"}return e.$inject=["$window","constants","localizationService"],e.prototype.getPasteRules=function(){return this.pasteImageAttributeRule+";"+this.pasteLinkAttributeRule+";"},e.htmlElements="area br col hr img wbr colgroup dd dt li p tbody td tfoot th thead tr rp rt address article aside blockquote caption center dir div dl figure figcaption footer h1 h2 h3 h4 h5 h6 header hgroup map menu nav ol pre section table ul a abbr acronym b bdi bdo big cite code del dfn em font i img ins kbd label map mark q ruby rp rt s samp small span strike strong sub sup time tt u var",e.htmlAttributes="href,src,abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,contenteditable,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,usemap,valign,value,vspace,width,data-ams-src,data-ts-imgid,data-ts-imglen,data-preview-src,data-src,style,itemscope,itemtype,itemprop,itemid,content,data-itemprops",e.htmlStyles="*",e.allowedStyles=_.keyBy(["color","opacity","background","background-attachment","background-blend-mode","background-color","background-image","background-position","background-repeat","background-clip","background-origin","background-size","border","border-bottom","border-bottom-color","border-bottom-left","border-bottom-right","border-bottom-style","border-bottom-width","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-style","border-top","border-top-color","border-top-left","border-top-right","border-top-style","border-top-width","border-width","box-decoration-break","box-shadow","bottom","clear","clip","display","float","height","left","margin","margin-bottom","margin-left","margin-right","margin-top","max-height","max-width","min-height","min-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","position","right","top","visibility","width","vertical-align","align-content","align-items","align-self","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","justify-content","order","hanging-punctuation","hyphens","letter-spacing","line-break","line-height","overflow-wrap","tab-size","text-align","text-align-last","text-combine-upright","text-indent","text-justify","text-transform","white-space","word-break","word-spacing","word-wrap","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-shadow","text-underline-position","@font-face","@font-feature-values","font","font-family","font-feature-settings","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","direction","text-orientation","text-combine-upright","unicode-bidi","user-select","writing-mode","border-collapse","border-spacing","caption-side","empty-cells","table-layout","counter-increment","counter-reset","list-style","list-style-image","list-style-position","list-style-type","@keyframes","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","break-after","break-before","break-inside","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","widows","image-orientation","image-rendering","image-resolution","object-fit","object-position","marquee-direction","marquee-play-count","marquee-speed","marquee-style"]),e.htmlClasses="swift-*,ts-image,emojione,emoticon-*,animated-emoticon-*,copy-paste-table,hljs*,language-*,zoetrope",e}();t.TextEditorConfig=n,angular.module("teamspace.textEditorConfig",["teamspace.constants","teamspace.localizationService"]).service("textEditorConfig",n)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.None=0]="None",e[e.Initialized=1]="Initialized",e[e.InProgress=2]="InProgress",e[e.Complete=3]="Complete"}(r=t.PrefetchConversationState||(t.PrefetchConversationState={}));var s=function(e){function t(t,i,n,s,a,o,c,l,p,u,h,d,g,v,m,f,S,y,C,b,T,I,w,k,P,A,M,_,E,U,D,R,O,N,x,F,$,L,B,j,H,q,W,V,z,X,G,K){var J=e.call(this)||this;return J.$injector=t,J.$interval=i,J.$q=n,J.$rootScope=s,J.$translate=a,J.analyticsService=o,J.appConfig=c,J.appStateService=l,J.chatServiceClient=p,J.chatSyncPriorityService=u,J.chatSyncService=h,J.connectorService=d,J.constants=g,J.conversationsService=v,J.conversationsStore=m,J.eventingService=f,J.externalFilesRepositoryFactory=S,J.filesAsyncMediaService=y,J.filesAttachmentAdapter=C,J.filesProviderFactory=b,J.filesUploadRouter=T,J.localMessageStorageService=I,J.loggingService=w,J.messageProcessingService=k,J.messageStore=P,J.replyChainStore=A,J.offlineActionService=M,J.outgoingWebhookService=_,J.peopleService=E,J.resourceManager=U,J.resources=D,J.settingsService=R,J.sfbInteropService=O,J.sfbInteropUtilsService=N,J.skypeXMembersService=x,J.sxConfig=F,J.systemMessageHydrators=$,J.urlPreviewCacheService=L,J.utilityService=B,J.mruChannelsService=j,J.messagingTelemetryService=H,J.codeSnippetService=q,J.teamMembersCacheService=W,J.channelMembershipPropertiesService=V,J.teamMembershipPropertiesService=z,J.htmlSanitizer=X,J.syncStateService=G,J.htmlMessageBodyAdapterService=K,J.messagesDeletedInCurrentSession={},J.sendHistory=[],J.conversationPrefetchQueue=[],J.conversationPrefetchTable={},J._convPrefetchEnabled=!0,J.prefetchConversationState=r.None,J.defaultPromiseTimeout=2e4,J.enableNewFullInputExtensions=!1,J.sipUriCache={},J.enableMessageSendFailureNotification=!1,J.enableNonVisibleMessagesCleanup=!0,J.enableSfBGateway=!1,J.logger=J.loggingService.newLogger("MessageService"),J.triggerLogger=function(e){return J.logger.error("trigger error: {0}",e)},J.targetChatPrefetchCount=J.settingsService.valueFor(J.constants.settings.names.targetChatPrefetchCount),J.targetChannelPrefetchCount=J.settingsService.valueFor(J.constants.settings.names.targetChannelPrefetchCount),J.chatItemsCacheSize=J.settingsService.valueFor(J.constants.settings.names.chatItemsCacheSize),J.channelItemsCacheSize=J.settingsService.valueFor(J.constants.settings.names.channelItemsCacheSize),J.messageCacheCleanupIntervalInMs=J.settingsService.valueFor(J.constants.settings.names.messageCacheCleanupIntervalInMs),J.enableMessageSendFailureNotification=J.settingsService.valueAsBoolean(g.settings.names.enableMessageSendFailureNotification),J.enableSfBGateway=J.settingsService.valueAsBoolean(J.constants.settings.names.enableSfBGateway),J.propagate(P,SkypeX.Services.MessageStoreConstants.EventType_All),J.propagate(P,SkypeX.Services.MessageStoreConstants.EventType_Batched),J.propagate(O,SkypeX.Services.MessageStoreConstants.EventType_Batched),J.propagate(O,teamspace.services.SfBInteropUtilsService.EventType_Disconnected),J.enableNonVisibleMessagesCleanup=J.settingsService.valueFor(J.constants.settings.names.enableNonVisibleMessagesCleanup),J.settingsService.valueFor(J.constants.settings.names.enableMessageCacheCleanup)&&J.eventingService.unsafeOn(J.constants.events.appState.appInUse,function(e,t){t||J.cacheCleanupTimer?t&&J.clearTimerInterval():J.cacheCleanupTimer=J.$interval(J.cleanupStreamItemsCache.bind(J),J.messageCacheCleanupIntervalInMs,0,!1)}),J.editExclusionFields=["content","versionNumber","version","contenttype","messagetype","properties","mentions","hyperLinks","renderContent","state","editTime","isSanitized","isPlainTextConvertedToHtml"],J.editPropertyExclusionFields=["files","mentions",J.constants.skypeMessagePropertyName.subject,J.constants.skypeMessagePropertyName.importance,J.constants.skypeMessagePropertyName.links.name,SkypeX.Services.ChatServiceUtils.MessageProperty_EditTime,SkypeX.Services.ChatServiceUtils.MessageProperty_Cards],J.enableBugFix72133=J.settingsService.valueAsBoolean("bugFix72133"),J.enableNewFullInputExtensions=J.settingsService.valueAsBoolean(J.constants.settings.names.enableFullInputExtensions),J.boldLogic2=J.settingsService.valueAsBoolean(J.constants.settings.names.boldLogic2),J.cache=new teamspace.services.messaging.StreamItemsCache(J.$q,J.constants,J.conversationsService,J.loggingService,J.messageProcessingService,J.messageStore,J.utilityService,J.messagingTelemetryService),J.eventingService.unsafeOn(J.constants.events.pushEvents.messageStore.createOrUpdateMessage,function(e,t){var i=J.findDeletedTimeChangedMessages(t.messages);J.createOrUpdateMessage(t),J.triggerDeletedOrUndeletedMessages(i)}),J.eventingService.unsafeOn(SkypeX.Services.OfflineActionServiceEvents.Type_CreateTempMessage,function(e,t){if(t&&teamspace.services.MessagingUtilities.isClientLie(t.id)){var i=void 0,n=(i=J.useReplyChainStore(t.conversationId)?J.replyChainStore.getMessagesByConversationId(t.conversationId,function(e){return!teamspace.services.MessagingUtilities.isClientLie(e.id)}):J.cache.getStreamItems(t.conversationId)).filter(function(e){return e.clientmessageid===t.clientmessageid});if(n.length>0&&!teamspace.services.MessagingUtilities.isClientLie(n[0].id)){J.logger.warn("Duplicate client lies found. clientMessageId: {0}",t.clientmessageid);var r=J.offlineActionService.findOfflineAction(t);return void(r&&(J.logger.warn("Cancelling the offline action with clientMessageId: {0}",t.clientmessageid),J.offlineActionService.cancelOfflineAction(r)))}J.addTempStreamItem(t.conversationId,t)}}),J.eventingService.unsafeOn(J.constants.events.appState.longInactive,function(){J.messagesDeletedInCurrentSession={}}),J.resourceManager.subscribe(function(){J.convPrefetchEnabled=J.resourceManager.currentPriority!==teamspace.services.TaskPriority.RealTime},J.resourceManager.Type_CurrentPriority),J}return n(t,e),t.$inject=["$injector","$interval","$q","$rootScope","$translate","analyticsService","appConfig","appStateService","chatServiceClient","chatSyncPriorityService","chatSyncService","connectorService","constants","conversationsService","conversationsStore","eventingService","externalFilesRepositoryFactory","filesAsyncMediaService","filesAttachmentAdapter","filesProviderFactory","filesUploadRouter","localMessageStorageService","loggingService","messageProcessingService","messageStore","replyChainStore","offlineActionService","outgoingWebhookService","peopleService","resourceManager","resources","settingsService","sfbInteropService","sfbInteropUtilsService","skypeXMembersService","sxConfig","systemMessageHydrators","urlPreviewCacheService","utilityService","mruChannelsService","messagingTelemetryService","codeSnippetService","teamMembersCacheService","channelMembershipPropertiesService","teamMembershipPropertiesService","htmlSanitizer","syncStateService","htmlMessageBodyAdapterService"],t.prototype.loadMessagesForReplyChain=function(e,t,i){var n=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePagingOfReplies),r=this.settingsService.valueFor(this.constants.settings.names.replyChainExpansionPageSize),s=n?t||i?void 0:r:void 0;return e.loadMessages(s),this.triggerWithLogging(this.triggerLogger,teamspace.services.MessageServiceEvents.EventType_NewReplyChains,e.conversationId,[e]),this.$q.resolve({})},t.prototype.findDeletedTimeChangedMessages=function(e){var t=this,i={};return _.forEach(e,function(e){if(e){var n=_.find(t.cache.getStreamItems(e.conversationId),function(t){return t.id===e.id});n&&e.deleteTime!==n.deleteTime&&(i[e.conversationId]||(i[e.conversationId]=[]),i[e.conversationId].push(e))}}),i},t.prototype.triggerDeletedOrUndeletedMessages=function(e){var t=this;_.isEmpty(e)||_.forEach(_.keys(e),function(i){t.trigger(teamspace.services.MessageServiceEvents.EventType_DeletedTime,i,e[i])})},t.prototype.getReplyChainsByParentMessageIds=function(e,t){var i=this,n=[];return _.each(t,function(t){n.push(i.getReplyChain(e,t))}),this.$q.all(n)},t.prototype.getReplyChains=function(e,t,i,n,r){var s=this;return this.convPrefetchEnabled=!1,this.getReplyChainsInternal(e,t,i,n,r).then(function(t){s.convPrefetchEnabled=!0;var i=_.chain(t.replyChains).filter(function(e){return!!e}).value();return r&&r.mark(r.name+"_skype_model_conversion",{replyChainCount:i&&i.length}),s.logger.info("GetReplyChains: Returning {0} reply chains for conversation: {1}",t.replyChains.length,e),{replyChains:i,hasMore:t.hasMore}})},t.prototype.getReplyChainParticipants=function(e,t){return this.getReplyChain(e,t).then(function(e){var t=e.messages.map(function(e){return e.creatorProfile}).filter(function(e){return SkypeX.Services.ChatServiceUtils.isMri(e.mri)});return _.uniqBy(t,function(e){return e.mri})})},t.prototype.prefetchConversationList=function(){var e=this;if(this.prefetchConversationState===r.None){if(this.logger.debug("prefetch conversations started"),this.prefetchConversationState=r.Initialized,this.settingsService.valueAsBoolean(this.constants.settings.names.disablePerfTableLogging)||(this.convPrefetchPerfCounter=this.loggingService.newCounter("prefetch_conversations")),this.prefetchStartTime=performance.now(),this.settingsService.valueAsBoolean(this.constants.settings.names.enableMruChannels)){t=this.conversationsService.getAllConversations(function(t){return!t.isReplyChain()&&!e.cache.isDatabaseExhausted(t.id)});this.conversationPrefetchQueue=this.chatSyncPriorityService.getPrioritizedConversationsToRetain(t,!1)}else{var t=this.conversationsService.getAllConversations(function(t){return!t.isReplyChain()&&(t.isChat()||t.isFavorite()||t.isTeam())&&!e.cache.isDatabaseExhausted(t.id)}),i=this.sxConfig.getCurrentSkypeMri(),n=_.partition(t,function(e){return e.isChat()}),s=n[0],a=n[1],o=_.partition(s,function(e){return!e.isReadForUser(i)}),c=o[0],l=o[1],p=_.partition(a,function(e){return!e.isReadForUser(i)}),u=p[0],h=p[1];c=c.sort(function(e,t){return t.lastMessageTimeUtc-e.lastMessageTimeUtc}),l=l.sort(function(e,t){return t.lastMessageTimeUtc-e.lastMessageTimeUtc}),s=(s=c.concat(l)).slice(0,this.targetChatPrefetchCount),u=u.sort(function(e,t){return t.lastMessageTimeUtc-e.lastMessageTimeUtc}),h=h.sort(function(e,t){return t.lastMessageTimeUtc-e.lastMessageTimeUtc}),a=(a=u.concat(h)).slice(0,this.targetChannelPrefetchCount),this.conversationPrefetchQueue=s.concat(a);var d=1;this.chatSyncPriorityService.addSortStrategy(this.chatSyncPriorityService.sortByFavorite,++d),this.chatSyncPriorityService.addSortStrategy(this.chatSyncPriorityService.sortByMostRecentMessage,++d),this.conversationPrefetchQueue=this.chatSyncPriorityService.sort(this.conversationPrefetchQueue)}this.convPrefetchCount=this.conversationPrefetchQueue.length,this.processPrefetchQueue()}},t.prototype.getStreamItemsCacheMetrics=function(){return this.cache.getStreamItemsCacheMetrics()},Object.defineProperty(t.prototype,"convPrefetchEnabled",{get:function(){return this._convPrefetchEnabled},set:function(e){this._convPrefetchEnabled!==e&&(this._convPrefetchEnabled=e,this.prefetchConversationState!==r.None&&this._convPrefetchEnabled&&this.processPrefetchQueue())},enumerable:!0,configurable:!0}),t.prototype.processPrefetchQueue=function(){var e=this;if(this.prefetchConversationState!==r.InProgress&&this.convPrefetchEnabled&&this.conversationPrefetchQueue.length>0){this.prefetchConversationState=r.InProgress;var t=_.first(this.conversationPrefetchQueue);if(t){this.logger.debug("prefetch: {0}",t.id);var i=t.isChannelConversation()?this.channelItemsCacheSize:this.chatItemsCacheSize;(this.useReplyChainStore(t.id)?this.replyChainStore.loadHeadView({conversationId:t.id,count:i}).toNgPromise(this.$q):this.cache.loadFromStore(t.id,Number.MAX_VALUE,i)).then(function(){_.pull(e.conversationPrefetchQueue,t),e.conversationPrefetchTable[t.id]=!0,e.conversationPrefetchQueue.length>0?(e.prefetchConversationState=r.Initialized,e.processPrefetchQueue()):(e.logger.debug("prefetch complete. time: {0}, count: {1}",performance.now()-e.prefetchStartTime,e.convPrefetchCount),e.prefetchConversationState=r.Complete,e.convPrefetchPerfCounter&&e.convPrefetchPerfCounter.stop({count:e.convPrefetchCount}))})}}},t.parseTimeArg=function(e){return("string"==typeof e?Date.parse(e):e)||void 0},t.prototype.getReplyChainsInternal=function(e,i,n,r,s){var a=this,o=t.parseTimeArg(i),c=_.overEvery([r,t.SystemMessageHydratedContentFilter,function(e){return!e.isDeleted||a.isMessageDeletedInCurrentSession(e.conversationIdMessageIdUnion)}]);return this.getMessagesForReplyChains(e,o,n,r,c,s).then(function(t){var r=a.getFilteredReplyChainItems(t,i,n);return a.ensureReplyChainsAreLoaded(e,r,s).then(function(t){r=t;var i=!0;if(a.logger.info("getReplyChainsInternal: {0} reply chains are loaded for conversation: {1}",r.length,e),r.length<n){var o=a.useReplyChainStore(e);if(o?a.replyChainStore.isDatabaseExhausted(e):a.cache.isDatabaseExhausted(e)){var c=a.conversationsService.getConversation(e),l=a.conversationsService.getConversationSyncState(e);i=l&&!l.isSyncedToStartOfTime;var p=!1;if(o&&(p=c&&!i&&0===r.length&&!!c.lastMessage),i||p)if(a.logger.info("getReplyChainsInternal: expanding sync window to load more messages for conversation {0}",e),o){var u=a.replyChainStore.getHeadView(e);u&&u.loadMore()}else a.chatSyncService.extendMessageHistoryStartTime(e)&&s&&s.mark("expanding_sync_window")}}return s&&(a.utilityService.markPerfInfo(s,"completeness_check"),s.mark(s.name+"_dbfetch")),{replyChains:r,hasMore:i}})})},t.prototype.getRecentReplyChains=function(e,t,i,n,r){return void 0===t&&(t=0),void 0===i&&(i=50),void 0===n&&(n=Date.now()),void 0===r&&(r=0),this.messageStore.getRecentReplyChains(e,n,r,i,t).toNgPromise(this.$q)},t.prototype.getMessagesForReplyChains=function(e,i,n,r,s,a){var o=this;if(n=n||t.defaultPagedReplyChainCount,this.logger.info("getMessagesForReplyChains: latestDeliveryTimeExclusive: {0} replyChainCount: {1} conversationId: {2}",i,n,e),a){var c=this.conversationsStore.dangerousGetConversationMutable(e);this.messagingTelemetryService.decorateWithDataSource(a,teamspace.services.ConversationDataSource.inMemory),a.eventData.prefetchState=this.prefetchConversationState,a.eventData.isConvPrefetched=this.conversationPrefetchTable[e],a.eventData.isUserMember=!(!c||!c.isUserMember()),a.eventData.isCSAReplyChainSupported=this.conversationsStore.isCSAReplyChainApiSupported(e)}return(this.useReplyChainStore(e)?this.replyChainStore.loadHeadView({conversationId:e,startTime:i,count:n,messageFilter:s,scenario:a}).toNgPromise(this.$q):this.cache.loadFromStore(e,i,n,s,a)).then(function(){if(a){var t="loadStreamItems_completed";a.mark(t),a.eventData.datasource&&(t=a.eventData.datasource.toString()),o.utilityService.markPerfInfo(a,t)}var i=o.getCachedMessages(e,r);if(o.logger.info("getMessagesForReplyChains: Retrieved {0} messages from the cache for conversation: {1}",i.length,e),a){a.mark("getCachedMessages_completed"),o.utilityService.markPerfInfo(a,"getCachedMessages");var n=_.filter(i,function(e){return SkypeX.Services.ChatServiceUtils.isBotMri(e.creator,!1)}).length,s=_.filter(i,function(e){return e.messagetype===SkypeX.Services.ChatServiceUtils.MessageType_MediaCard}).length;a.eventData.botMessageCount=n,a.eventData.cardMessageCount=s}return o.hydrateAndFilterMessages(i).then(function(e){return o.logger.info("getMessagesForReplyChains: {0} messages remain after hydration and filtering",e.length),a&&(a.mark("hydrateMessages_completed"),o.utilityService.markPerfInfo(a,"hydrate & filter")),e},function(e){a&&(a.mark("hydrateMessages_failed",{error:e}),o.utilityService.markPerfInfo(a,"hydrate & filter failed"))})},function(e){a&&(a.mark("loadStreamItems_failed",{error:e}),o.utilityService.markPerfInfo(a,"loadStreamItems_failed"))})},t.prototype.getReplyChain=function(e,t,i,n,r,s,a){var o=this;void 0===i&&(i=""),void 0===n&&(n=100),void 0===r&&(r=teamspace.services.ReplyChainIdType.ParentMessageId),this.logger.info("getReplyChain() replyChainId: {0} startTime: {1} itemCount: {2}",t,i,n),a=a||SkypeX.Services.MessageViewType.ReplyChains;var c,l=this.useReplyChainStore(e)?this.replyChainStore.isReplyChainLoaded(e,t):this.cache.isReplyChainLoaded(e,t);if(teamspace.services.MessagingUtilities.isClientLie(t)||l)c=this.$q.when();else{if(!this.isReplyChainSynced(t,e))return s&&s.eventData&&this.messagingTelemetryService.decorateWithDataSource(s,teamspace.services.ConversationDataSource.network),this.logger.info("GetReplyChain: reply chain {0} not synced, syncing related messages in conversation: {1}",t,e),this.chatSyncService.syncRelatedMessages(e,t,a,r),this.$q.when(null);s&&s.eventData&&this.messagingTelemetryService.decorateWithDataSource(s,teamspace.services.ConversationDataSource.indexedDB),c=this.useReplyChainStore(e)?this.replyChainStore.loadHeadView({conversationId:SkypeX.Services.ChatServiceUtils.formatActivityId(e,t),count:n}):this.cache.loadReplyChainFromStore(e,t)}return c.then(function(){var i=o.getCachedMessagesByParentMessageId(e,t);return i&&i.length>0?o.hydrateAndFilterMessages(i).then(function(i){if(i&&i.length>0){var n=new SkypeX.Services.SkypeReplyChain(i,o.messagesDeletedInCurrentSession);return n.firstMessage.id!==n.firstMessage.parentMessageId&&n.firstMessage.parentMessageId!==SkypeX.Services.ChatServiceUtils.ThreadProp_P2PChatFilesIndexId_Value?(o.loggingService.event("missing_parent_message"),o.logger.info("GetReplyChain: Parent message missing, syncing related messages for replyChain {0} in conversation: {1}",t,e),o.chatSyncService.syncRelatedMessages(e,t,a,r),null):n}return null}):(o.logger.info("GetReplyChain: No messages present, syncing related messages for replyChain {0} in conversation: {1}",t,e),o.chatSyncService.syncRelatedMessages(e,t,a,r),null)})},t.prototype.sendMessage=function(e,t,i,n,r){var s=this;if(!e){a="Invalid message";return this.logger.error(a),this.$q.reject(a)}if(!t){var a="Invalid offline action";return this.logger.error(a),this.$q.reject(a)}var o=this.settingsService.valueAsBoolean(this.constants.settings.names.enableFederatedChat),c=e.conversationId,l=!1;return r=r||!this.enableSfBGateway&&teamspace.services.SfBInteropUtilsService.isSfBConversation(c),this.conversationsService.markConversationAsPending(e.conversationId).then(function(){return(SkypeX.Services.ChatServiceUtils.isPrivateFeed(e.conversationId)?s.$q.when(e.conversationId):s.conversationsService.ensureConversationCreated(e.conversationId).then(function(e){return e.id})).then(function(a){c=a;var l=s.$q.when(),p=s.$q.when();return e.conversationId!==c&&(e.conversationId=c,e.conversationLink="blah/"+SkypeX.Services.ChatServiceUtils.formatActivityId(e.conversationId,e.parentMessageId),i.mark("thread_created",{threadId:c}),i.eventData.thread_created="true",s.offlineActionService.cancelOfflineAction(t),p=s.saveOfflineActionMessage(e,i,!0,!1).then(function(e){t=e}),l=s.addTempStreamItem(e.conversationId,e),s.cache.markDatabaseExhausted(c)),s.$q.all([p,l]).then(function(){if(!s.appStateService.isOnline){var a={errorMessage:"Network offline, could not send message: "+e.clientmessageid,_code:s.constants.errorCodes.networkOffline};return s.logger.error(a.errorMessage),s.$q.reject(a)}var l=s.uploadToAms(e,n),p=s.shareAttachments(e);return i.mark(i.name+"_begin_processimages",{clientId:e.clientmessageid}),s.$q.all([l,p.catch(function(e){return s.setErrorAndReject("shareAttachments",e)})]).then(function(){var a=_.last(s.sendHistory);i.mark(s.constants.scenarios.steps.renderClientLie,{clientId:e.clientmessageid,isConnected:s.appStateService.isOnline,timeSinceLast:a?Date.now()-a.sendTime:void 0}),n&&s.updatePreviewIfMessageNotSend(n,e),s.sendHistory.push({clientId:e.clientmessageid,sendTime:Date.now()});var l=e.prepareMessageForPosting();s.constants.messages.codesnippetFindRegex.test(l.content)&&(l.content=s.codeSnippetService.removeCodeSnippetsFromDOMString(l.content));var p=SkypeX.Services.ChatServiceUtils.formatActivityId(e.conversationId,teamspace.services.MessagingUtilities.isClientLie(e.parentMessageId)?null:e.parentMessageId),u=teamspace.services.SfBInteropUtilsService.isSfBConversation(c),h=void 0,d=function(t,i){var n=s.$q.resolve();if(c&&(s.enableSfBGateway||o)&&(a=s.conversationsService.getConversation(c))&&(a.isSfB()||a.isFederated())){i.properties[SkypeX.Services.ChatServiceUtils.MessageProperty_InteropType]=SkypeX.Services.ChatServiceUtils.InteropType_ReceiverSfB,i.messagetype=SkypeX.Services.ChatServiceUtils.MessageType_Text;var r=a.members.filter(function(t){return t.id!=e.creator});h=r[0].id,r.length>0&&(n=s.getSipUris(e.creator,h,a.isFederated()).then(function(e){i.fromSipUri=e.fromSipUri,i.toSipUri=e.toSipUri})),i.content=s.utilityService.decodeHtml(i.content),l.content=l.content.replace(/<div>(.*)<\/div>\n*/gi,"$1\n"),l.content=l.content.replace(/<br\s*\/?>\n*/gi,"\n")}if(s.boldLogic2&&c){var a=s.conversationsService.getConversation(c);a&&a.isChannelConversation()&&a.isRead()&&s.conversationsStore.setFakeConsumptionHorizon(a.id,i.clientmessageid)}return n.then(function(){return s.chatServiceClient.postMessageToConversation(t,i).toNgPromise(s.$q)})};return u&&!s.enableSfBGateway&&(d=function(e,t){return s.sfbInteropService.sendMessage(e,t)}),i.mark(i.name+"_begin_post",{clientId:e.clientmessageid}),d(p,l).then(function(r){e.state=teamspace.services.MessageSendState.Delivered;var a=r.originalarrivaltime;moment(new Date(r.originalarrivaltime)).isValid()||(s.logger.error("invalid originalarrivaltime : {0}",r.originalarrivaltime),a=Date.now()),!(u&&!s.enableSfBGateway&&s.settingsService.valueAsBoolean("sfbFixMessageOrder"))&&(s.useReplyChainStore(e.conversationId)?s.replyChainStore.updateClientLieItemsWithOriginalArrivalTime(e.conversationId,e.idUnion,a):s.cache.updateTempStreamItemsWithOriginalArrivalTime(e.conversationId,e.key,a)),e.originalarrivaltime=moment(new Date(a)).toISOString(),e.id=r.id,e.version=r.id;var o=_.findLastIndex(s.sendHistory,function(t){return t.clientId===e.clientmessageid});s.sendHistory[o].arrivalTime=s.parseDate(a);var c=s.sendHistory.slice(0,o).filter(function(e){return _.isUndefined(e.arrivalTime)}).length;if(i.mark(i.name+"_post_success",{clientId:e.clientmessageid,outOfOrder:c}),s.triggerMessageUpdate([e]),i.mark(i.name+"_change_broadcasted",{clientId:e.clientmessageid}),teamspace.services.MessagingUtilities.isClientLie(e.parentMessageId)&&(e.parentMessageId=r.id),s.localMessageStorageService.removeLocalConversationItem(e.clientmessageid),s.offlineActionService.cancelOfflineAction(t),i.mark(i.name+"_cleanup_success",{clientId:e.clientmessageid}),s.conversationsService.updateLastMessage(e.conversationId,e),i.mark(i.name+"_conversation_store_updated",{clientId:e.clientmessageid}),teamspace.services.SfBInteropUtilsService.isSfBConversation(e.conversationId)&&s.sfbInteropService.sendInviteEmail(e.conversationId),n&&s.endUrlPreviewFetch(n,e),i){var l=teamspace.services.SfBInteropUtilsService.isSfBGatewayConversation(e.conversationId)&&s.settingsService.valueAsBoolean(s.constants.settings.names.useChatsCoexistenceMode)?{clientId:e.clientmessageid,senderMode:s.sipUriCache[e.creator]&&s.sipUriCache[e.creator].coExistenceMode,receiverMode:s.sipUriCache[h]&&s.sipUriCache[h].coExistenceMode}:{clientId:e.clientmessageid};i.stop(l)}return{conversationId:e.conversationId,messageId:r.id}}).catch(function(t){if(s.logger.warn("Error occured while posting message for: {0}. Error: {1}",p,JSON.stringify(t)),413===t.statusCode||400===t.statusCode){if(r=!0,e.state=teamspace.services.MessageSendState.Error,s.enableMessageSendFailureNotification){var i=s.$injector.get("messageNotificationService");if(!s.offlineActionService.findOfflineAction(e))return i.messageSendFailedNotification(e)}}else-1!==t.statusCode||s.appStateService.isOnline||t._code||(t._code=s.constants.errorCodes.networkOffline);return s.$q.reject(t)})})})}).catch(function(t){return s.logger.warn("Error occured while posting message for: {0}. Error: {1}.",e.parentMessageId,JSON.stringify(t)),!t||t._errorCode!==s.constants.errorCodes.federatedUserResolutionFailed&&t._errorCode!==s.constants.errorCodes.federatedConversationAclCheckFailed&&t._errorCode!==s.constants.errorCodes.threadCreationFailed||(r=!0,l=!0),s.$q.reject(t)})}).catch(function(t){if(r){if(e.state=teamspace.services.MessageSendState.Error,teamspace.services.SfBInteropUtilsService.isSfBConversation(c))try{var i=s.findReasonInError(t);e.messageSendErrorReason=i?s.mapReasonToSfbMessageSendError(i.subcode||i.code):teamspace.services.SfBMessageSendError.Unknown}catch(t){e.messageSendErrorReason=teamspace.services.SfBMessageSendError.Unknown}s.triggerMessageUpdate([e])}if(l){var n=s.offlineActionService.findOfflineAction(e);n&&s.offlineActionService.cancelOfflineAction(n)}else s.saveOfflineActionMessage(e,null,!1,r).finally(function(){r||s.offlineActionService.replayNextAction()});return t&&angular.isObject(t)||(t={errorMessage:t}),t.conversationId=c,s.$q.reject(t)})},t.prototype.uploadCodeSnippets=function(e){var t=this;if(!this.codeSnippetService.isCodeSnippetEnabled||_.isEmpty(e.inputExtensionAttachments))return this.$q.resolve();var i=_(e.inputExtensionAttachments).reject(_.isNil).filter(function(e){return e.contentType===teamspace.Constants.Instance.bots.cards.types.codeSnippet}).map(function(i,n){var r=i.content;return t.codeSnippetService.upload(r,e.conversationId).then(function(e){var i=e.objectId;return t.logger.debug("CodeSnippets: sucessfully uploaded codesnippet at {0}",n),r.amsReferenceId=i,r.snippet=void 0,r.source=void 0,i})}).value();return this.$q.all(i).then(function(i){t.addAmsReferences.apply(t,[e].concat(i)),e.properties[SkypeX.Services.ChatServiceUtils.MessageProperty_Cards]=JSON.stringify(e.inputExtensionAttachments)})},t.prototype.uploadToAms=function(e,t,i){var n=this;void 0===i&&(i=!0);var r=e.amsreferences;e.amsreferences=[];var s=this.uploadInlineImagesAndUpdateMessage(e,r),a=this.updateAttachmentPreviews(e,t),o=this.uploadCodeSnippets(e);return i?this.$q.all([s.catch(function(e){return n.setErrorAndReject("uploadInlineImage",e)}),a.catch(function(e){return n.setErrorAndReject("imagePreview",e)}),o.catch(function(e){return n.setErrorAndReject("uploadCodeSnippets",e)})]):this.$q.all([s,a,o])},t.prototype.createMessage=function(e){var t=this;if(e&&e.conversationId===this.constants.p2p.newChatId){var i={errorCode:teamspace.services.NewChatErrorCodes.TooFewUsers,errorMessage:this.$translate.instant(this.resources.strings.chat_creationErrorTooFewUsers)};return this.$q.reject(i)}if(e.clientId){var n=void 0,r=function(t){return t.isFromMe&&t.clientmessageid===e.clientId};if(this.useReplyChainStore(e.conversationId))n=_.first(this.replyChainStore.getMessagesByConversationId(e.conversationId,r));else{var s=_.concat(this.cache.getStreamItems(e.conversationId),this.cache.getTempStreamItems(e.conversationId));n=_.find(s,r)}if(n){var a="Unable to send message because another message with the same client id sent by the logged-in user already exists. Client id: "+e.clientId+". Scenario: "+(e.scenario?e.scenario.name:"unknown");return this.logger.error(a),this.$q.reject(a)}}else e.clientId=SkypeX.Services.Utilities.newClientMessageId();var o=teamspace.services.SfBInteropUtilsService.isSfBConversation(e.conversationId),c=e.scenario?e.scenario:o?this.loggingService.newScenario(this.constants.scenarios.P2PSendNewMessageSfB):this.loggingService.newScenario(this.constants.scenarios.sendMessageUnknownSource);if(e.replyChainId&&!SkypeX.Services.ChatServiceUtils.isValidId(e.replyChainId)){var l="Cannot send message. Invalid Reply Chain Id:"+e.replyChainId;return this.logger.error(l),this.$q.reject(l)}var p=this.setViewAttachmentUrl(e);return this.$q.all(p).then(function(){var i=t.createTempMessage(e);return t.skypeXMembersService.getCurrentUser().then(function(n){return i.imdisplayname=e.imdisplayname||n.displayname||n.displayName,t.addTempStreamItem(i.conversationId,i).then(function(){var n=t.offlineActionService.findOfflineAction(i);n&&t.offlineActionService.cancelOfflineAction(n);var r={clientId:i.clientmessageid};return t.saveOfflineActionMessage(i,c,!0,!1).then(function(n){t.logger.info("----createMessage: conversationId: {0}, clientId: {1}, replyChainClientId: {2}",i.conversationId,i.clientmessageid,i.parentMessageId);var s=i.conversationId;return t.sendMessage(i,n,c,e).catch(function(n){return t.logger.warn("Error occured while posting message for: {0}. Error: {1}.",i.parentMessageId,n.errorMessage),e&&!e.scenario&&(teamspace.services.SfBInteropUtilsService.isSfBSdkConversation(s)&&teamspace.services.SfBInteropUtilsService.isExpectedFailure(n)?c.incomplete(_.extend(r,{errorInfo:n})):c.fail(_.extend(r,{errorInfo:n}))),n&&angular.isObject(n)||(n={errorMessage:n}),n.conversationId=s,n.hideBanner=!0,t.$q.reject(n)})})},function(e){return t.logger.warn("Error occured while adding new temporary messages: conversationId: {0}, clientId: {1}, replyChainClientId: {2}Error: {3}",i.conversationId,i.clientmessageid,i.parentMessageId,e.errorMessage),c.mark("add_temp_item_failed",{conversationId:i.conversationId,clientId:i.clientmessageid,error:e.errorMessage}),t.$q.reject(e)})})})},t.prototype.isMessageDeletedInCurrentSession=function(e){return!!this.messagesDeletedInCurrentSession[e]},t.prototype.ensureReplyChainsAreLoaded=function(e,t,i){var n=this,r=[],s=[];return t.forEach(function(t){var a=n.useReplyChainStore(e)?n.replyChainStore.isReplyChainLoaded(e,t.parentMessageId):n.cache.isReplyChainLoaded(e,t.parentMessageId);if(teamspace.services.MessagingUtilities.isClientLie(t.parentMessageId)||a&&t.parentMessage)s.push(t);else{n.logger.info("ensureReplyChainsAreLoaded: Reply Chain not loaded. Loading messages for {0} in conversation: {1}",t.parentMessageId,t.conversationId);var o=n.getReplyChain(e,t.parentMessageId,"",100,void 0,i);r.push(o)}}),this.$q.all(r).then(function(e){return _.filter(e&&e.length?s.concat(e):s)})},t.prototype.deleteOrUndoMessage=function(e,t,i,n){var r=this,s=i?this.chatServiceClient.deleteMessage(e,t):this.chatServiceClient.setMessageProperty(e,t,SkypeX.Services.ChatServiceUtils.MessageProperty_DeleteTime,null,!0),a=i?this.getMessage(e,t):this.$q.when(this.messagesDeletedInCurrentSession[e+"_"+t]);return n.mark(n.name+"_get_message",{conversationId:e,messageId:t}),a.then(function(a){if(a){i?r.messagesDeletedInCurrentSession[a.conversationIdMessageIdUnion]=a:delete r.messagesDeletedInCurrentSession[a.conversationIdMessageIdUnion];var o=i?void 0:Date.now()-a.deleteTime,c=a.deleteTime;return a.deleteTime=i?Date.now():void 0,n.mark(n.name+"_trigger_message_update",{conversationId:e,messageId:t}),r.triggerMessageUpdate([a]),s.toNgPromise(r.$q).then(function(){n.stop({conversationId:e,messageId:t,parentMessageId:a.parentMessageId,timeSinceDelete:o})}).catch(function(s){var o=a.clone();return o.hasMessageActionFailed=!0,o.deleteTime=c,i?delete r.messagesDeletedInCurrentSession[a.conversationIdMessageIdUnion]:r.messagesDeletedInCurrentSession[a.conversationIdMessageIdUnion]=a,r.triggerMessageUpdate([o]),a.deleteTime=c,r.logger.error("Error while {0} - ConversationId:{1} messageId:{2} Error:{3}",i?"deleting":"undoing delete",e,t,JSON.stringify(s)),n.fail({conversationId:e,messageId:t}),r.$q.reject(s)}).finally(function(){var t=r.conversationsService.getConversation(e);t&&t.lastMessageId===a.id&&r.conversationsService.updateLastMessage(e,a)})}r.logger.error("Message not found, cannot be (un)deleted.")})},t.prototype.retryFailedMessage=function(e,t){var i=this,n=this.loggingService.newScenario(this.constants.scenarios.channelRetryFailedMessage);return this.getMessage(e,t,!0).then(function(r){var s=i.offlineActionService.findOfflineAction(r);if(teamspace.services.MessagingUtilities.isClientLie(r.id))return r.state=teamspace.services.MessageSendState.Sending,n.mark("got_message",{conversationId:e,clientId:t}),i.triggerMessageUpdate([r]),(s?i.$q.when(s):i.saveOfflineActionMessage(r,n,!0,!1)).then(function(a){return n.mark("got_offlineAction",{conversationId:e,clientId:t}),s=a,i.sendMessage(r,s,n,null,!0).catch(function(n){return r.state=teamspace.services.MessageSendState.Error,i.triggerMessageUpdate([r]),i.logger.error("Error while {0} - ConversationId:{1} clientId:{2} Error:{3}","retrying",e,t,JSON.stringify(n)),i.$q.reject(n)})});i.logger.warn("Not a client lie anymore. id: {0}",r.clientmessageid),s&&i.offlineActionService.cancelOfflineAction(s),n.cancel({conversationId:e,clientId:t,parentMessageId:r.parentMessageId})}).catch(function(r){return i.logger.warn("Error occured while retrying offline message for: {0}. Error: {1}.",t,r.errorMessage),n.fail({conversationId:e,clientId:t,errorInfo:r}),i.$q.reject(r)})},t.prototype.deleteFailedMessage=function(e,t){var i=this,n=this.loggingService.newScenario(this.constants.scenarios.channelDeleteFailedMessage);return this.getMessage(e,t,!0).then(function(r){var s=i.offlineActionService.findOfflineAction(r);teamspace.services.MessagingUtilities.isClientLie(r.id)?(r.deleteTime=Date.now(),r.state=teamspace.services.MessageSendState.Deleted,r.isForceDelete=!0,i.triggerMessageUpdate([r]),s?(i.logger.warn("Item was resolved but still has an offline action. id: {0}",r.clientmessageid),i.offlineActionService.cancelOfflineAction(s)):(i.logger.warn("Offline action not found. id: {0}",r.clientmessageid),i.messageStore.removeClientLieMessage(e,r.parentMessageId,r.clientmessageid))):(i.logger.warn("Not a client lie anymore. id: {0}",r.clientmessageid),s&&i.offlineActionService.cancelOfflineAction(s)),n.stop({conversationId:e,messageId:t,parentMessageId:r.parentMessageId})}).catch(function(r){return i.logger.error("Error while {0} - ConversationId:{1} messageId:{2} Error:{3}","deleting",e,t,JSON.stringify(r)),n.fail({conversationId:e,messageId:t}),i.$q.reject(r)})},t.prototype.deleteMessageFailedAtGateway=function(e,t){var i=this,n=this.loggingService.newScenario(this.constants.scenarios.P2PDeleteFailedMessageSfb),r=this.getMessage(e,t);return n.mark(n.name+"_get_message",{conversationId:e,messageId:t}),r.then(function(r){return r?r.failedAtSfBGateway?(r.deleteTime=Date.now(),n.mark(n.name+"_trigger_message_update",{conversationId:e,messageId:t}),i.triggerMessageUpdate([r]),i.chatServiceClient.deleteMessage(e,t).toNgPromise(i.$q).then(function(){n.stop({conversationId:e,messageId:t,parentMessageId:r.parentMessageId})}).catch(function(s){var a=r.clone();return a.hasMessageActionFailed=!0,i.triggerMessageUpdate([a]),i.logger.error("Error while deleting message in gateway error - ConversationId:{1} messageId:{2} Error:{3}",e,t,JSON.stringify(s)),n.fail({conversationId:e,messageId:t}),i.$q.reject(s)})):(i.logger.error("Message did not fail at gateway."),void n.cancel({conversationId:e,messageId:t})):(i.logger.error("Message not found, cannot be deleted."),void n.cancel({conversationId:e,messageId:t}))})},t.prototype.deleteMessage=function(e,t,i){return i=i||this.loggingService.newScenario(this.constants.scenarios.channelDeleteMessage),this.deleteOrUndoMessage(e,t,!0,i)},t.prototype.undoDelete=function(e,t,i){return i=i||this.loggingService.newScenario(this.constants.scenarios.channelUndoDelete),this.deleteOrUndoMessage(e,t,!1,i)},t.prototype.editMessage=function(e,t,i,n){var r=this,s=this.createTempMessage(i);return s.editTime=Date.now(),s.versionNumber=Date.now(),s.version=s.versionNumber.toString(),this.getMessage(e,t).then(function(a){teamspace.services.MessagingUtilities.extendItem(s,a,r.editExclusionFields),teamspace.services.MessagingUtilities.extendItem(s.properties,a.properties,r.editPropertyExclusionFields),angular.isDefined(a.properties)&&_.each(r.editPropertyExclusionFields,function(e){angular.isDefined(a.properties[e])&&!angular.isDefined(s.properties[e])&&(s.properties[e]=null)}),s.content&&0!==s.content.length||(s.content="&nbsp;",s.messagetype=SkypeX.Services.ChatServiceUtils.MessageType_HTML),r.messageProcessingService.processRenderContent(s),r.useReplyChainStore(e)?r.replyChainStore.putMessages([s],{syncSource:SkypeX.Services.SkypeMessageSource.Local},r.conversationsStore.isPersisted(e)):(r.cache.putTempMessage(e,s),r.triggerMessageUpdate([s]));var o=r.uploadToAms(s,i,!1),c=r.shareAttachments(s);return r.$q.all([o,c]).then(function(){r.updatePreviewIfMessageNotSend(i,s);var a=s.prepareMessageForPosting();return r.constants.messages.codesnippetFindRegex.test(a.content)&&(a.content=r.codeSnippetService.removeCodeSnippetsFromDOMString(a.content)),delete a.properties[SkypeX.Services.ChatServiceUtils.MessageProperty_EditTime],n.mark(n.name+"_validate",{conversationId:e,messageId:t}),teamspace.services.MessagingUtilities.isClientLie(t)?r.$q.reject("Invalid messageId received"):(n.mark(n.name+"_begin_post",{conversationId:e,messageId:t}),r.chatServiceClient.editMessage(e,t,a).toNgPromise(r.$q).then(function(){s.state=teamspace.services.MessageSendState.Delivered,r.endUrlPreviewFetch(i,s),n.stop({conversationId:e,messageId:t})}))}).catch(function(i){var o="string"==typeof i?i:JSON.stringify(i),c=a.clone();return c.hasMessageActionFailed=!0,r.triggerMessageUpdate([c]),r.clearClientLies(e,[s]),r.logger.error("Error while editing message - ConversationId:{0} messageId:{1} Error:{2}",e,t,o),n.fail({errorInfo:o,conversationId:e,messageId:t}),r.$q.reject(i)}).finally(function(){var t=r.conversationsService.getConversation(e);t&&t.lastMessageId===s.id&&r.conversationsService.updateLastMessage(e,s)})})},t.prototype.removeUrlPreview=function(e,t){var i=this;return this.messageStore.getMessage(e,t).then(function(n){if(n){var r=n.properties[i.constants.skypeMessagePropertyName.links.name];if(r){var s=JSON.parse(r);if(_.isArray(s)){var a=s.filter(function(e){return e[i.constants.skypeMessagePropertyName.links.previewEnabled]});if(a.length&&a[0][i.constants.skypeMessagePropertyName.links.previewEnabled]){var o=i.loggingService.newScenario(i.constants.scenarios.urlPreview.removePreview);return a[0][i.constants.skypeMessagePropertyName.links.previewEnabled]=!1,i.setLinkPropertyLocalAndRemote(n,a).then(function(){o.stop({data:JSON.stringify({messageId:t,conversationId:e})})},function(e){return o.fail(),i.$q.reject(e)})}}}}else i.logger.warn("Trying to remove message from message {0} in conv {1} and the message doesn't exist",t,e)},function(e){return i.logger.error("Could not find message in message store while removing preview"),i.$q.reject(e)})},t.prototype.updatePreviewIfMessageNotSend=function(e,t){var i=this;this.updatePreview(e,t,function(e,t){return i.setLinkPropertyLocal(e,t)})},t.prototype.endUrlPreviewFetch=function(e,t){var i=this;this.updatePreview(e,t,function(t,n){return e.pendingUrlPreviewToResolve=null,i.setLinkPropertyLocalAndRemote(t,n)})},t.prototype.updatePreview=function(e,t,i){var n=this,r=e.pendingUrlPreviewToResolve;if(r){var s=this.urlPreviewCacheService.getPreviewPromise(r.objectUrl),a=t.properties[this.constants.skypeMessagePropertyName.links.name];if(s&&a){var o="string"==typeof a?JSON.parse(a):a,c=o.filter(function(e){return e[n.constants.skypeMessagePropertyName.links.url]===r.objectUrl&&e[n.constants.skypeMessagePropertyName.links.previewEnabled]});if(c.length){var l=c[0];s.then(function(e){n.populateLinkPreviewProperties(l,e.thumbnail,e.title,e.description,e.thumbnail_meta)},function(){n.populateLinkPreviewProperties(l,"","","")}).finally(function(){i(t,o)})}}}},t.prototype.setLinkPropertyLocal=function(e,t){return e.properties[this.constants.skypeMessagePropertyName.links.name]=JSON.stringify(t),this.messageProcessingService.processRenderContent(e),this.triggerMessageUpdate([e]),this.$q.when()},t.prototype.setLinkPropertyLocalAndRemote=function(e,t){var i=this,n=JSON.stringify(t);e.properties[this.constants.skypeMessagePropertyName.links.name]=n;var r=this.chatServiceClient.setMessageProperty(e.conversationId,e.id,this.constants.skypeMessagePropertyName.links.name,n).fail(function(e){i.logger.error("Error while updating the links message property {0}",e)});return this.messageProcessingService.processRenderContent(e),this.triggerMessageUpdate([e]),r.toNgPromise(this.$q)},t.prototype.setMeetupTitle=function(e,t,i){var n=this;return this.logger.info("Setting meetup title of message {0} in conversation: {1} to {2}",t,e,i),this.getMessage(e,t).then(function(r){var s=r.getMeetingProperties();return s=s||{},s[SkypeX.Services.ChatServiceUtils.MessageProperty_MeetingTitle]=i,n.chatServiceClient.setMessageProperty(e,t,SkypeX.Services.ChatServiceUtils.MessageProperty_Meeting,JSON.stringify(s)).toNgPromise(n.$q)})},t.prototype.getMeetupTitle=function(e,t){return this.logger.info("Getting meetup title of message {0} in conversation: {1}",t,e),this.getMessage(e,t).then(function(e){var t=e.getMeetingProperties();return t&&t[SkypeX.Services.ChatServiceUtils.MessageProperty_MeetingTitle]})},t.prototype.likeMessage=function(e,t){return this.addEmotionToMessage(e,t,this.constants.emotions.like)},t.prototype.unlikeMessage=function(e,t){return this.removeEmotionFromMessage(e,t,this.constants.emotions.like)},t.prototype.starMessage=function(e,t){return this.addEmotionToMessage(e,t,this.constants.emotions.star)},t.prototype.unstarMessage=function(e,t){return this.removeEmotionFromMessage(e,t,this.constants.emotions.star)},t.prototype.addEmotionToMessage=function(e,t,i){var n=new Date,r=JSON.stringify({key:i,value:n.getTime()});return this.logger.info("{0} message {1} in conversation: {2}",i,t,e),this.chatServiceClient.setMessageProperty(e,t,SkypeX.Services.ChatServiceUtils.MessageProperty_Emotions,r).toNgPromise(this.$q)},t.prototype.removeEmotionFromMessage=function(e,t,i){var n=JSON.stringify({key:i});return this.logger.info("un{0} message {0} in conversation: {1}",i,t,e),this.chatServiceClient.setMessageProperty(e,t,SkypeX.Services.ChatServiceUtils.MessageProperty_Emotions,n,!0).toNgPromise(this.$q)},t.prototype.markStarredMessageAsDeleted=function(e,t){var i=JSON.stringify({key:"isDeleted",value:"true"});return this.logger.info("Marking starred message {0} in conversation {1} as deleted",t,e),this.chatServiceClient.setMessageProperty(e,t,SkypeX.Services.ChatServiceUtils.MessageProperty_Starred,i).toNgPromise(this.$q)},t.prototype.markCallLogMessageAsDeleted=function(e,t){var i=this;return this.getMessage(e,t,!1).then(function(n){var r=n.properties&&n.properties[SkypeX.Services.ChatServiceUtils.MessageProperty_CallLog];if(r&&"string"==typeof r){i.logger.info("Marking call log message {0} in conversation {1} as deleted",t,e);try{var s=JSON.parse(r);s.isDeleted=!0,r=JSON.stringify(s)}catch(n){return i.logger.error("Failed reading or setting call log property while trying to mark a call log message {0} in conversation {1} as deleted: {2}",t,e,n),i.$q.reject(n)}return i.chatServiceClient.setMessageProperty(e,t,SkypeX.Services.ChatServiceUtils.MessageProperty_CallLog,r).toNgPromise(i.$q)}return i.logger.info("Ignoring attempt to mark call log message {0} in conversation {1} as deleted: no properties found, invalid call log",t,e),i.$q.reject()}).catch(function(n){return i.logger.error("Failed load message data while trying to mark a call log message {0} in conversation {1} as deleted: {2}",t,e,n),i.$q.reject(n)})},t.prototype.markReadStatus=function(e,t,i){return this.chatServiceClient.setMessageProperty(t,i,SkypeX.Services.ChatServiceUtils.MessageProperty_IsRead,e).toNgPromise(this.$q)},t.prototype.getLatestMessageInConversation=function(e){return this.messageStore.getLatestMessageInConversation(e)},t.prototype.createOrUpdateMessage=function(e){var t=this;if(e&&!_.isEmpty(e.messages)){this.logger.debug("createOrUpdateMessage, messages.length: {0}",e.messages.length);var i=_.groupBy(e.messages,function(e){return e.conversationId});_.each(i,function(i,n){var r,s=[];t.settingsService.valueAsBoolean(t.constants.settings.names.disablePerfTableLogging)||(r=t.loggingService.newCounter("loadReplyChainToCache")),_.each(i,function(i){if("-1"!==i.id&&(i.state=teamspace.services.MessageSendState.Received),!t.useReplyChainStore(n)){var a=e.isFromLongPoll||t.enableNewFullInputExtensions&&i.hasCardsProperties();t.messageProcessingService.processRenderContent(i,a),t.updateCacheEntry(n,i),t.cache.updateTempStreamItemsWithOriginalArrivalTime(n,i.key,i.originalArrivalTimeUtc);var o=t.cache.getEarliestReplyChainDeliveryTime(n);!t.cache.isReplyChainLoaded(n,i.parentMessageId)&&o&&i.originalArrivalTimeUtc>=o&&(r&&r.mark("loadReplyChain",{parentMessageId:i.parentMessageId,msgId:i.id}),t.logger.debug("CreateOrUpdateMessage: load additional reply chain: {0}",i.parentMessageId),s.push(t.utilityService.getPromiseWithTimeout(t.cache.loadReplyChainFromStore(i.conversationId,i.parentMessageId),t.defaultPromiseTimeout)))}if(i.clientmessageid&&!teamspace.services.MessagingUtilities.isClientLie(i.id)){var c=t.offlineActionService.findOfflineAction(i);c&&(t.logger.warn("Item was resolved but still has an offline action. id: {0}",i.clientmessageid),t.offlineActionService.cancelOfflineAction(c))}}),t.$q.all(s).then(function(){s.length>0&&(t.logger.debug("all additional reply chains loaded"),r&&r.stop()),t.clearClientLies(n,_.filter(i,function(e){return e.isFromMe})),t.broadcastMessages(n,i)}).catch(function(e){t.logger.error("Failed to load reply chain promises. {0}",e)})})}},t.prototype.getFilteredReplyChainItems=function(e,t,i){var n=this,r=_.groupBy(e,"parentMessageId"),s=_.map(_.values(r),function(e){return new SkypeX.Services.SkypeReplyChain(e,n.messagesDeletedInCurrentSession)});return this.logger.info("getFilteredReplyChainItems: {0} reply chains created from {1} messages",s.length,e.length),this.filterPagedStreamItems(s,"lastMessageTimeUtc",t,i)},t.prototype.filterPagedStreamItems=function(e,t,i,n){var r,s=this;if(""!==i){var a=this.parseDate(i);r=(e=e.filter(function(e){return s.parseDate(e[t])<a})).length}e=_.sortBy(e,function(e){return-s.parseDate(e[t])});var o=(e=_.reject(e,function(e){return e.allMessagesDeleted&&e.allMessagesDeleted()})).length,c=e.slice(0,n);return this.logger.info("filterPagedStreamItems: {0}length after delete filter {1}, length after slice {2}",r?"length after date time filter "+r+", ":"",o,c.length),c},t.prototype.updateCacheEntry=function(e,t){this.cache.putMessages(e,[t])},t.prototype.parseDate=function(e){return _.isString(e)?teamspace.services.MessagingUtilities.getTimeValue(e):_.isNumber(e)?e:0},t.prototype.getUniqueSendersForFederatedMessages=function(e){var t=this,i=this.sxConfig.getCurrentSkypeMri(),n=SkypeX.Services.ChatServiceUtils.MriNamespace_SkypeSpacesUser+SkypeX.Services.ChatServiceUtils.SkypeSpacesUserMriTag,r=[];return e.forEach(function(e){if(t.skypeXMembersService.hasUserIdInLink(e.from)&&e.from.indexOf(n)>0){var s=e.from.substr(e.from.indexOf(n));s!==i&&r.push(s)}}),_.uniq(r)},t.prototype.getUniqueSendersForNonFederatedMessages=function(e){var t=this,i=[];return _.forEach(e,function(e){if(t.skypeXMembersService.hasUserIdInLink(e.from))i.push(t.skypeXMembersService.getSkypeIdFromLink(e.from));else if(e.isConnectorMessage){if(e.onBehalfOf){var n=t.skypeXMembersService.getSkypeIdFromLink(e.onBehalfOf);i.push(n)}}else e.isBotMessage&&i.push(SkypeX.Services.ChatServiceUtils.getBotIdFromLink(e.from))}),_.uniq(i)},t.prototype.getLikerProfiles=function(e){var t=this,i={},n={},r=[];return _.forEach(e,function(e){if(e&&e.properties){var i=_(e.properties.emotions).filter(function(e){return"like"===e.key}).map(function(e){return e.users}).reject(_.isEmpty).flatten().map(function(e){var i=t.skypeXMembersService.getSkypeIdFromLink(e.mri);return SkypeX.Services.ChatServiceUtils.isMri(i)?i:SkypeX.Services.ChatServiceUtils.getMri(i)}).value();n[e.id]=i,r.push.apply(r,i)}}),r=_.uniq(r),_.isEmpty(r)?this.$q.resolve({}):this.peopleService.getAllShortPeopleProfile(r,"messageService - likers").then(function(e){for(var t=_.map(e,function(e){return{displayName:e.displayName,mri:e.mri}}),r=_.keyBy(t,function(e){return e.mri}),s=0,a=Object.entries(n);s<a.length;s++){var o=a[s],c=o[0],l=o[1];i[c]=_.map(l,function(e){return r[e]})}return i})},t.prototype.hydrateAndFilterMessages=function(e){var t=this;return this.hydrateMessages(e).then(function(e){return t.applySystemMessageHydratedContentFilter(e)})},t.prototype.hydrateMessages=function(e){var t=_.partition(e,function(e){return e.isHydrated}),i=t[0],n=t[1];if(_.isEmpty(n))return this.$q.when(i);var r=_.partition(n,function(e){return e.isRenderingKindSystem}),s=r[0],a=r[1],o=_.isEmpty(a)?this.$q.resolve([]):this.addSenderData(a),c=_.isEmpty(s)?this.$q.resolve([]):this.systemMessageHydrators.hydrate(s);return this.$q.all([o,c]).then(function(e){var t=e[0],n=e[1];return i.concat(t,n)})},t.prototype.applySystemMessageHydratedContentFilter=function(e){var i=this;return _.forEach(e,function(e){if(e.messagetype===SkypeX.Services.ChatServiceUtils.MessageType_AddMember&&e.hydratedContent){var t=_.first(e.hydratedProperties[teamspace.services.SystemMessageHydratedPropertyName.TargetMriPropertyName]);i.constants.outgoingWebhooks.interceptorBotMris.some(function(e){return e===t})&&(i.logger.log("Filtering out control message to add: {0} to the team",t),e.hydratedProperties={},e.hydratedContent=null)}}),_.filter(e,t.SystemMessageHydratedContentFilter)},t.prototype.addSenderData=function(e){return this.logger.info("Adding creator profiles to {0} messages",e.length),this.getCreatorProfiles(e).then(function(t){return e.forEach(function(e){e.creatorProfile=t[e.creatorProfileKey]||{}}),e})},t.prototype.getCreatorProfiles=function(e,t){var i=this;void 0===t&&(t=!0);var n={},r=[];if(_.isEmpty(e))return this.$q.resolve(n);var s=this.conversationsService.getConversation(_.first(e).conversationId),a=function(e){return _.pick(e,teamspace.middletier.ShortUserProfileFields)},o=_.filter(e,function(e){return!e.isRenderingKindSystem}),c=_.partition(o,function(e){return e.isFederatedChatMessage}),l=c[0],p=c[1],u=this.getUniqueSendersForFederatedMessages(l),h=this.getUniqueSendersForNonFederatedMessages(p),d=_.isEmpty(h)?this.$q.when([]):this.skypeXMembersService.resolveMembers(h),g=_.isEmpty(u)?this.$q.when([]):this.skypeXMembersService.resolveFederatedMembers(u),v=this.connectorService.getConnectorProfiles(s).then(function(e){return i.$q.all([d,g]).then(function(){return o.forEach(function(t){if(!n[t.creatorProfileKey])if(t.isConnectorMessage){c=i.getSenderDataForConnector(t,e);n[t.creatorProfileKey]=a(c)}else if(t.isBotMessage){var o=i.getSenderDataForBot(t,s).then(function(e){n[t.creatorProfileKey]=a(e)});r.push(o)}else{var c=i.getSenderDataForUser(t);n[t.creatorProfileKey]=a(c)}}),i.$q.all(r).then(function(){return n})})});return this.utilityService.getPromiseWithTimeout(v,5*this.constants.timeInMiliseconds.second,this.$q,"timeout",!0).catch(function(e){return"timeout"===e&&i.logger.warn("Resolving members took more than 5 seconds to complete, so continuing on."),t&&o.forEach(function(e){if(!n[e.creatorProfileKey]){var t=SkypeX.Services.UserAdapter.convert({mri:i.skypeXMembersService.getSkypeIdFromLink(e.from),displayname:e.imdisplayname});n[e.creatorProfileKey]=a(t)}}),n})},t.prototype.getSenderDataForUser=function(e){var t=this.skypeXMembersService.getSkypeIdFromLink(e.from),i=this.skypeXMembersService.getResolvedMember(t);return i&&(this.peopleService.isUnknownUser(i)||i.isAnonymousUser)&&(!e.imdisplayname||_.startsWith(e.imdisplayname,SkypeX.Services.ChatServiceUtils.SkypeSpacesUserMriTag)||_.startsWith(e.imdisplayname,SkypeX.Services.ChatServiceUtils.AnonymousUserMriTag)||(i.displayName=e.imdisplayname),i.mri=this.skypeXMembersService.normalizeSkypeIdToMri(t)),i},t.prototype.getSenderDataForConnector=function(e,t){var i=SkypeX.Services.ChatServiceUtils.getIntegrationIdFromLink(e.from);i=i.replace(SkypeX.Services.ChatServiceUtils.IntegrationPrefix,"");var n=t&&t[i]||{type:this.constants.connectors.type,avatarUrl:void 0};e.isEmailMessage&&(n.avatarUrl=this.constants.connectors.emailHookDefaultImageUri);var r=SkypeX.Services.UserAdapter.convert(n);if(e.imdisplayname&&(r.displayName=e.imdisplayname),e.onBehalfOf){var s=this.skypeXMembersService.getSkypeIdFromLink(e.properties.onbehalfof),a=this.skypeXMembersService.getResolvedMember(s);r.displayName+=" - "+a.displayName}if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableConnectorApps)&&e.properties&&e.properties.meta){var o=JSON.parse(e.properties.meta);o&&o.connectorSenderGuid&&(r.mri=o.connectorSenderGuid)}return r},t.prototype.getSenderDataForBot=function(e,t){var i=this,n=this.$q.resolve(null),r=SkypeX.Services.ChatServiceUtils.getBotIdFromLink(e.from);if(this.constants.outgoingWebhooks.interceptorBotMris.some(function(e){return e==r}))if(e.onBehalfOf){var s=JSON.parse(e.onBehalfOf);if(s.length>1)this.logger.error("messageService: getSenderData - Received a message from with more than 1 onbehalfof entities");else{var a=s[0].mri;n=this.outgoingWebhookService.getRegisteredWebhook(t.teamId,a).then(function(e){var t=null;return e&&(t={mri:e.id,description:e.description,displayName:e.name,imageUri:e.iconUrl,type:i.constants.atMentions.type.webhook}),t})}}else this.logger.error("messageService: getSenderData - Received a message from {0} without onBehalfOf",e.from);else n=this.$q.resolve(SkypeX.Services.UserAdapter.convert(this.skypeXMembersService.getResolvedMember(r)));return n},t.prototype.getCachedMessages=function(e,t){var i=this,n=[];if(this.useReplyChainStore(e)){var r=this.replyChainStore.getHeadView(e);r&&(n=_.flatten(_.map(r.replyChains,function(e){return e.messages})),n=t?_.filter(n,t):n,_.forEach(r.replyChains,function(e){_.forEach(e.messages,function(t){_.isEmpty(t.creatorProfile)&&e.creatorProfiles&&!_.isEmpty(e.creatorProfiles[t.creatorProfileKey])&&(t.creatorProfile=e.creatorProfiles[t.creatorProfileKey])})}))}else{if(!this.cache.isCached(e))return this.logger.warn("unable to find streamItems by convId: {0}",e),[];n=_.filter(this.cache.getStreamItems(e),t),_.filter(this.cache.getTempStreamItems(e),t).forEach(function(e){var t=_.findIndex(n,function(t){return teamspace.services.MessagingUtilities.matchSkypeIdOrClientId(t,e)});-1===t?n.push(e):e.editTime&&e.editTime!==n[t].editTime?n.splice(t,1,e):i.logger.warn("Found a duplicate client lie: {0} - {1}",e.conversationId,e.clientmessageid)})}return n.forEach(function(e){e.state=teamspace.services.MessagingUtilities.isClientLie(e.id)?e.state:teamspace.services.MessageSendState.Received}),n},t.prototype.getCachedMessagesByParentMessageId=function(e,t){var i=[];if(this.useReplyChainStore(e)){var n=SkypeX.Services.ChatServiceUtils.formatActivityId(e,t),r=this.replyChainStore.getHeadView(n);r&&(i=_.flatten(_.map(r.replyChains,function(e){return e.messages})))}return 0===i.length&&(i=this.getCachedMessages(e,function(e){return e.parentMessageId===t})),i},t.prototype.clearClientLies=function(e,t){this.useReplyChainStore(e)||this.cache.removeTempStreamItems(e,_.map(t,function(e){return e.clientmessageid}))},t.prototype.broadcastMessages=function(e,t){var i=this;return this.trigger(teamspace.services.MessageServiceEvents.EventType_RawMessages,e,t),this.hasKeyedSubscribers(e)?this.hydrateAndFilterMessages(t).then(function(){var n=_.values(_.groupBy(t,"parentMessageId")),r=_.partition(n,function(t){var n=i.isReplyChainSynced(t[0].parentMessageId,e),r=1===t.length&&teamspace.services.MessagingUtilities.isClientLie(t[0].parentMessageId);return n||r}),s=r[0],a=r[1],o=_.partition(s,function(e){var t=!!_.find(e,function(e){return e.id===e.parentMessageId}),i=1===e.length&&teamspace.services.MessagingUtilities.isClientLie(e[0].parentMessageId);return t||i}),c=o[0],l=o[1];c.length>0&&i.getCachedReplyChains(c).then(function(t){(t=_.filter(t))&&t.length>0&&(i.logger.info("broadcastMessages: conversationId: {0}, newReplyChains.length: {1}",e,t.length),i.triggerWithLogging(i.triggerLogger,teamspace.services.MessageServiceEvents.EventType_NewReplyChains,e,t))}),a&&a.length>0&&(i.logger.info("broadcastMessages: conversationId: {0}, unsyncedReplyChainGroup.length: {1}",e,a.length),i.trigger(teamspace.services.MessageServiceEvents.EventType_IncompleteReplyChains,e,a)),_.map(l,function(e){return new SkypeX.Services.SkypeReplyChain(e,i.messagesDeletedInCurrentSession)}).forEach(function(e){i.triggerMessageUpdate(e.messages)})}):this.$q.when()},t.prototype.triggerMessageUpdate=function(e){var t=this,i=_.groupBy(e,function(e){return e.parentMessageId});_.each(i,function(e){var i=_.first(e),n=i.conversationId,r=i.parentMessageId;t.trigger(teamspace.services.MessageServiceEvents.EventType_MessageUpdate,n,{conversationId:r,messages:e})})},t.prototype.getCachedReplyChains=function(e){var t=this;return this.$q.all(_.map(e,function(e){var i=_.first(e),n=i.conversationId,r=i.parentMessageId,s=t.getCachedMessagesByParentMessageId(n,r);return t.hydrateAndFilterMessages(s).then(function(e){return e&&e.length>0?new SkypeX.Services.SkypeReplyChain(e,t.messagesDeletedInCurrentSession):null})}))},t.prototype.getMessage=function(e,t,i){if(!_.isString(t))return this.$q.reject("Invalid message id provided: "+t);var n=i?_.first(this.getCachedMessages(e,function(e){return e.clientmessageid===t})):_.first(this.getCachedMessages(e,function(e){return e.id===t}));return n?this.$q.when(n):this.messageStore.getMessage(e,t)},t.prototype.getParentMessageIdByMessageId=function(e,t){var i=_.first(this.getCachedMessages(e,function(e){return e.id===t}));return i?this.$q.when(i.parentMessageId):this.messageStore.getParentMessageIdByMessageId(e,t)},t.prototype.getMessageByTime=function(e,t,i,n){return void 0===i&&(i=!1),this.messageStore.getMessagesForConversationAndReplyChainDeliveryTimeRange(e,0,t).then(function(e){return _(e).orderBy(function(e){return e.originalArrivalTimeUtc},"desc").find(function(e){return e&&!e.isDeleted&&(!i||e.isFromMe)&&(!n||e.creator!==n)&&e.originalArrivalTimeUtc<=t})})},t.prototype.addTempStreamItem=function(e,t){var i;if(this.enableBugFix72133){if(this.useReplyChainStore(e))i=this.replyChainStore.getLastMessage(e);else{o=this.cache.getStreamItems(e).concat(this.cache.getTempStreamItems(e));i=_.maxBy(o,"originalArrivalTimeUtc")}var n=_.isObject(i)?i.originalArrivalTimeUtc:0,r=this.conversationsService.getConversation(e),s=r&&r.lastMessageTimeUtc||0,a=Math.max(s,n)+1;t.originalarrivaltime=new Date(a).toISOString()}else{if(this.useReplyChainStore(e))i=this.replyChainStore.getLastMessage(e);else{var o=this.cache.getStreamItems(e);i=_.maxBy(o,"createdTime")}if(_.isObject(i)){var c=t.createdTime,l=i.createdTime;if(c<l){var p=SkypeX.Services.DateTimeHelper.add(l,0,0,0,0,1);t.originalarrivaltime=new Date(p).toISOString()}}}if(this.messageProcessingService.processRenderContent(t),this.useReplyChainStore(e))(u=_.first(this.replyChainStore.getMessagesByConversationId(e,function(e){return e.clientmessageid===t.clientmessageid&&teamspace.services.MessagingUtilities.isClientLie(e.id)})))?teamspace.services.MessagingUtilities.extendItem(u,t,[]):this.replyChainStore.putMessages([t],{syncSource:SkypeX.Services.SkypeMessageSource.Local},this.conversationsStore.isPersisted(e));else{var u=_.find(this.cache.getTempStreamItems(e),function(e){return e.clientmessageid===t.clientmessageid});u?teamspace.services.MessagingUtilities.extendItem(u,t,[]):this.cache.putTempMessage(e,t)}return this.broadcastMessages(e,[t])},t.prototype.useReplyChainStore=function(e){return this.conversationsStore.isCSAReplyChainApiSupported(e)},t.prototype.createTempMessage=function(e){var t=this,i=Date.now(),n="blah/"+SkypeX.Services.ChatServiceUtils.formatActivityId(e.conversationId,e.replyChainId),r=e.replyChainId?e.replyChainId:this.constants.MessageService.ClientLiePrefix+(e.clientId||SkypeX.Services.Utilities.newClientMessageId()),s=this.sxConfig.getCurrentSkypeMri(),a=e.properties||{},o=e.isHtml?SkypeX.Services.ChatServiceUtils.MessageType_HTML:SkypeX.Services.ChatServiceUtils.MessageType_Text,c=e.specialRenderingKind===SkypeX.Services.RenderingKind.ChatFile;if(e.fileAttachments&&e.fileAttachments.length>0)if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableExternalFileProviders)){var l=this.filesAttachmentAdapter.convertToMessageProps(e.fileAttachments);a.files=JSON.stringify(l)}else{var p=[];e.fileAttachments.forEach(function(e){var i={"@type":t.constants.semanticObjectSchemas.file,itemid:e.objectId,fileName:e.title,fileType:e.type,fileInfo:{fileUrl:e.objectUrl,siteUrl:e.siteUrl,serverRelativeUrl:e.serverRelativeUrl},chicletBreadcrumbs:e.chicletBreadcrumbs};e.thumbnail&&(i.filePreview={previewUrl:e.thumbnail.url,previewHeight:e.thumbnail.height,previewWidth:e.thumbnail.width}),e.serviceName&&e.state&&(i.fileChicletState={serviceName:e.serviceName,state:e.state}),p.push(i)}),a.files=JSON.stringify(p)}return e.skipFanoutToBots&&(a[this.constants.skypeMessagePropertyName.skipFanoutToBots]=!0),c&&(o="Spaces/File"),a[this.constants.skypeMessagePropertyName.importance]=e.importance||teamspace.components.ImportanceLevels.NORMAL,a[this.constants.skypeMessagePropertyName.subject]=e.messageSubject,this.populateLinkProperties(e,a),this.populateMentionProperties(e,a),this.populateCardProperties(e,a),new SkypeX.Services.SkypeMessageLocal({id:"-1",type:"Message",idUnion:e.clientId,conversationId:e.conversationId,conversationLink:n,creator:s,from:"blah/"+s,isFromMe:!0,createdTime:i,composetime:new Date(i).toISOString(),originalarrivaltime:new Date(i).toISOString(),properties:a,content:e.messageBody,messagetype:o,activitytype:"",contenttype:SkypeX.Services.ChatServiceUtils.ContentType_Text,imdisplayname:"",parentMessageId:r,clientmessageid:e.clientId.toString(),notificationLevel:SkypeX.Services.eNotificationLevel.Simple,convoCallId:"",convoCallUrl:"",replyChainLatestDeliveryTime:i,state:teamspace.services.MessageSendState.Sending,scenarioName:e.scenario&&e.scenario.name,version:"0",versionNumber:0,inlineImages:e.inlineImages,attachments:e.fileAttachments})},t.prototype.populateMentionProperties=function(e,t){var i=this;if(e.mentions&&e.mentions.length){var n=[],r=[];angular.forEach(e.mentions,function(e){e.userObjectId&&e.userType==i.constants.atMentions.type.webhook?r.push({itemid:e.itemid,mri:e.userObjectId,mentionType:e.userType,displayName:e.userDisplayName}):n.push({"@type":i.constants.semanticObjectSchemas.mention,itemid:e.itemid,mri:e.userObjectId,mentionType:e.userType,displayName:e.userDisplayName})}),t.mentions=JSON.stringify(n),r&&r.length>0&&(t.onbehalfof=JSON.stringify(r))}},t.prototype.populateCardProperties=function(e,t){e&&e.inputExtensionAttachments&&e.inputExtensionAttachments.length>0&&(t[SkypeX.Services.ChatServiceUtils.MessageProperty_Cards]=JSON.stringify(e.inputExtensionAttachments))},t.prototype.populateLinkProperties=function(e,t){if(e.embeddedLinks&&e.embeddedLinks.length){for(var i=[],n=0;n<e.embeddedLinks.length;n++){var r=e.embeddedLinks[n],s={};if(s["@type"]=this.constants.semanticObjectSchemas.hyperlink,s.itemid=n.toString(),s[this.constants.skypeMessagePropertyName.links.url]=r.objectUrl,s[this.constants.skypeMessagePropertyName.links.previewEnabled]=r.previewEnabled,r.previewEnabled)if(this.urlPreviewCacheService.isResolved(r.objectUrl)){var a=this.urlPreviewCacheService.getPreviewData(r.objectUrl);a?this.populateLinkPreviewProperties(s,a.thumbnail,a.title,a.description,a.thumbnail_meta):this.populateLinkPreviewProperties(s,"","","")}else{e.pendingUrlPreviewToResolve=r;var o=this.urlPreviewCacheService.getTrackingScenario(r.objectUrl);o&&o.mark(this.constants.scenarios.urlPreview.steps.postSendUpdate)}i.push(s)}t[this.constants.skypeMessagePropertyName.links.name]=JSON.stringify(i)}},t.prototype.populateLinkPreviewProperties=function(e,t,i,n,r){e[this.constants.skypeMessagePropertyName.links.preview]||(e[this.constants.skypeMessagePropertyName.links.preview]={});var s=e[this.constants.skypeMessagePropertyName.links.preview];s[this.constants.skypeMessagePropertyName.links.thumbnailUrl]=t,s[this.constants.skypeMessagePropertyName.links.thumbnailMeta]=r,s[this.constants.skypeMessagePropertyName.links.title]=i,s[this.constants.skypeMessagePropertyName.links.description]=n},t.prototype.saveOfflineActionMessage=function(e,t,i,n){var r=this.offlineActionService.findOfflineAction(e);return r?r.actionData=e:r={createdTime:e.createdTime,type:"postMessage",conversationId:e.conversationId,actionData:e,retryCount:0},r.isBlocked=!!n||r.isBlocked,r.isSending=i,teamspace.services.SfBInteropUtilsService.isSfBSdkConversation(r.conversationId)?this.$q.resolve(r):this.offlineActionService.saveOfflineAction(r).then(function(){return t&&t.mark(t.name+"_save_offline",{clientId:e.clientmessageid}),r}).toNgPromise(this.$q)},t.prototype.validateAMSLinkInImageElement=function(e){return e&&e.src&&this.utilityService.isAmsImage(e.src)},t.prototype.getAmsIdFromImageElement=function(e){return e.id||e.src.split("/")[5]},t.prototype.uploadInlineImagesAndUpdateMessage=function(e,t){var i=this,n=[];if(!e.isHtml)return this.$q.when();var r=$("<div/>").html(this.htmlSanitizer.sanitizeHtml(e.content)),s=jQuery.makeArray(r.find("img"));return s=_.filter(s,function(e){return i.validateAMSLinkInImageElement(e)}),e.inlineImages&&0!==e.inlineImages.length||0!==s.length?(_.each(s,function(r){var s=i.getAmsIdFromImageElement(r);s&&(!t||t.indexOf(s)<0?n.push(i.filesAsyncMediaService.forwardContent(s,e.conversationId).then(function(t){r.id=t.objectId,r.src=t.inlineSizeUrl,i.addAmsReferences(e,t.objectId)})):i.addAmsReferences(e,s))}),(e.inlineImages||[]).forEach(function(t){var s={containerId:e.conversationId},a="["+i.constants.files.strings.inlineImageIdAttr+"|="+t.imageId+"]",o=r.find(a);if(!t.uploaded&&o.length){var c=i.$q.defer();i.getBlobData(t).then(function(){i.filesAsyncMediaService.uploadItem(s,t).then(function(n){var s=r.find(a),o=$(a);o.parent().attr("href",n.inlineSizeUrl);var l=s.add(o),p=l.attr("src");l.attr("id",n.objectId),l.attr("src",n.inlineSizeUrl),l.attr("target-src",n.inlineSizeUrl),p&&p.startsWith("blob")&&URL.revokeObjectURL(p),l.attr("itemscope",t.type||""),l.attr("itemtype",i.constants.files.strings.inlineImageSchemaItemType),l.removeAttr(i.constants.files.strings.inlineImageIdAttr),l.removeAttr(i.constants.files.strings.inlineImageLenAttr),t.uploaded=!0,t.contentBase64=null,t.contentBytes=null,i.addAmsReferences(e,n.objectId),c.resolve()},function(e){c.reject(e)})},function(e){c.reject(e)}),n.push(c.promise)}}),this.$q.all(n).finally(function(){e.content=r.html(),i.messageProcessingService.processRenderContent(e),i.triggerMessageUpdate([e])})):this.$q.when()},t.prototype.getBlobData=function(e){if(!e||e.contentBytes)return this.$q.when(e);if(e.blobUrl&&!e.blobUrl.startsWith("blob"))return this.$q.when(e);var t=this.$q.defer();return this.utilityService.getBlobDataAsUint8Array(e.blobUrl).then(function(t){e.contentBytes=t}).finally(function(){t.resolve(e)}),t.promise},t.prototype.updateAttachmentPreviews=function(e,t){var i=this,n=[];return t&&t.fileAttachments&&0!==t.fileAttachments.length?(t.fileAttachments.forEach(function(r){if(r.imagePreview&&r.imagePreview.objectUrl){if(r.imagePreview.objectId)i.addAmsReferences(e,r.imagePreview.objectId);else{var s=i.utilityService.extractAmsIdFromUrl(r.imagePreview.objectUrl);s.length?i.addAmsReferences(e,s):i.logger.error("Could not find AMS id for thumbnail url")}r.imagePreview.permissionsUpdated||n.push(i.filesAsyncMediaService.updatePermissions(r.imagePreview.objectUrl,t.conversationId).then(function(){r.imagePreview.permissionsUpdated=!0}))}}),this.$q.all(n)):this.$q.when()},t.prototype.shareAttachments=function(e){var t=this;if(!e||!e.attachments||!e.attachments.length||e.parentMessageId===SkypeX.Services.ChatServiceUtils.ThreadProp_P2PChatFilesIndexId_Value)return this.$q.resolve([]);for(var i=[],n=0,r=e.attachments.filter(function(e){return e.serviceName===t.constants.files.serviceName.p2p});n<r.length;n++){var s=r[n],a=this.filesProviderFactory.deserialize(s.providerData);if(a){var o=this.filesUploadRouter.getFileUploadService(a);i.push(o.shareFile(s.serviceName,e.conversationId,s.objectId,s.siteUrl,s.objectUrl,s.title))}else this.logger.warn("Cannot find provider to share attachments for clientMessageId: {0}",e.clientmessageid)}return this.$q.all(i)},t.prototype.setViewAttachmentUrl=function(e){var t=this,i=[];return this.settingsService.valueAsBoolean(this.constants.settings.names.enableExternalFileProviders)&&e&&e.fileAttachments&&0!==e.fileAttachments.length?(e.fileAttachments.forEach(function(e){if(e.providerData){var n=t.filesProviderFactory.deserialize(e.providerData);if(n&&n.shouldFetchViewableURL()){var r=t.externalFilesRepositoryFactory.create(n);if(r){var s={itemId:e.objectId,itemName:e.title,provider:n,serviceName:void 0};i.push(r.getFileDetail(s).then(function(i){i&&i.openInTabUrl?e.hostViewUrl=i.openInTabUrl:t.logger.error("[setViewAttachmentUrl]: Could not fetch url.")}).catch(function(e){var i=e&&(e.errorCode||e.statusCode||e.internalErrorCode);t.logger.error("[setViewAttachmentUrl]: Failed to fetch file url. Error code: {0}",i)}))}else t.logger.error("[setViewAttachmentUrl]: unable to create repository for provider: {0}",e.providerData)}}}),i):i},t.prototype.isReplyChainSynced=function(e,t){var i=SkypeX.Services.ChatServiceUtils.formatActivityId(t,e),n=this.conversationsService.getConversation(t);return n&&this.syncStateService.isReplyChainSynced(n,i)},t.prototype.findReasonInError=function(e,t){if(void 0===t&&(t=0),t>7)return null;if(e.reason)return e.reason;if(e.hasOwnProperty("error")){t++;var i=this.findReasonInError(e.error,t);if(i)return i}return null},t.prototype.mapReasonToSfbMessageSendError=function(e){switch(e){case"Declined":return teamspace.services.SfBMessageSendError.Declined;case"DoNotDisturb":return teamspace.services.SfBMessageSendError.DoNotDisturb;case"TemporarilyUnavailable":return teamspace.services.SfBMessageSendError.TemporarilyUnavailable;case"Timeout":return teamspace.services.SfBMessageSendError.Timeout;case"Unreachable":return teamspace.services.SfBMessageSendError.Unreachable;case"FederationNotAllowed":return teamspace.services.SfBMessageSendError.FederationNotAllowed;case"Unknown":default:return teamspace.services.SfBMessageSendError.Unknown}},t.prototype.createChannelMessagePreview=function(e){var i;return i=e&&e.subject&&e.subject.length>0?this.$translate.instant(this.resources.strings.recent_conversations_preview_withDisplayName,{displayName:e.creatorProfile.displayName,message:e.subject}):this.createMessagePreviewWithFullName(e,e.attachments&&e.attachments.length>0||!1),this.utilityService.truncate(i,t.MessagePreviewLength,{withEllipsis:!0})+"&nbsp;"},t.prototype.createMessagePreviewWithFullName=function(e,t){return this.createMessagePreviewInternal(e,t,!0)},t.prototype.createMessagePreview=function(e,t,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!0),this.createMessagePreviewInternal(e,t,i,n)},t.prototype.createMessagePreviewWithoutDisplayName=function(e,t){return this.createMessagePreviewInternal(e,t,!1,!1)},t.prototype.createMessagePreviewInternal=function(e,t,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!0),e){if(e.creator&&0===e.creator.indexOf(SkypeX.Services.ChatServiceUtils.IntegrationPrefix)){var r=this.$translate.instant(this.resources.strings.recent_conversations_connector_message);return this.$translate.instant(this.resources.strings.recent_conversations_preview_withDisplayName,{displayName:e.creatorProfile.displayName,message:r})}return this.createTextMessagePreview(e,t,i,n)}return""},t.prototype.createTextMessagePreview=function(e,i,n,r){void 0===n&&(n=!1),void 0===r&&(r=!0);var s=e.content?e.content:"";if(this.shouldStripHTMLFromMessage(e)&&(s=this.settingsService.valueAsBoolean(this.constants.settings.names.enableMessagePreviewToHaveEmojiUnicodes)?this.htmlMessageBodyAdapterService.getPreviewContent(s):this.utilityService.stripHtml(s)),s=this.utilityService.truncate(s,t.MessagePreviewLength),""!==$.trim(s))return this.getTranslatedMessagePreview(e,s,n,r);if(i)return this.getTranslatedMessagePreview(e,this.$translate.instant(this.resources.strings.recent_conversations_sent_a_file),n,r);var a=e.content&&e.content.match(/<img/i);return a&&a.length>0?this.getTranslatedMessagePreview(e,this.$translate.instant(this.resources.strings.recent_conversations_sent_an_image),n,r):""},t.prototype.getTranslatedMessagePreview=function(e,t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!0);var r="",s=i?this.getFullDisplayNameForPreview(e):this.getDisplayNameForPreview(e);return r=n&&s?this.$translate.instant(this.resources.strings.recent_conversations_preview_withDisplayName,{displayName:s,message:t}):this.$translate.instant(this.resources.strings.recent_conversations_preview_withoutDisplayName,{message:t}),this.utilityService.stripHtml(r)},t.prototype.getDisplayNameForPreview=function(e){return e.creatorProfile?e.creatorProfile.givenName||e.creatorProfile.displayName:""},t.prototype.getFullDisplayNameForPreview=function(e){return e.creatorProfile&&e.creatorProfile.displayName||""},t.prototype.shouldStripHTMLFromMessage=function(e){switch(e.messagetype){case SkypeX.Services.ChatServiceUtils.MessageType_HTML:case SkypeX.Services.ChatServiceUtils.MessageType_MediaCard:return!0;default:return!1}},t.prototype.getAllCachedConversations=function(){var e=this;return this.conversationsService.getAllConversations(function(t){var i=e.useReplyChainStore(t.id)?e.replyChainStore.isViewCached(t.id):e.cache.isStreamItemsCached(t.id);return!t.isReplyChain()&&i&&e.conversationsStore.isPersisted(t.id)})},t.prototype.cleanupStreamItemsCache=function(){var e=this;if(!this.isCleaningStreamItemsCache){this.isCleaningStreamItemsCache=!0;var t=Date.now(),i=this.getAllCachedConversations(),n=this.chatSyncPriorityService.getPrioritizedConversationsToRetain(i,!0),r=_.difference(i,n),s=0,a=0,o=function(t,i){e.useReplyChainStore(t.id)?e.replyChainStore.removeHeadView(t.id,i):e.cache.removeConversation(t.id,i),t.isChannelConversation()?a++:t.isChat()&&s++};_.forEach(r,function(e){o(e)});var c=0,l=0;this.enableNonVisibleMessagesCleanup&&_.forEach(n,function(t){e.useReplyChainStore(t.id)||(t.isChannelConversation()?l+=e.cache.cleanupStaleItems(t.id,e.channelItemsCacheSize,e.getInvisibleMessages.bind(e)):c+=e.cache.cleanupStaleItems(t.id,e.chatItemsCacheSize,e.getInvisibleMessages.bind(e)))});var p=this.conversationsService.getAllConversations(function(t){var i=e.useReplyChainStore(t.id)?e.replyChainStore.isViewCached(t.id):e.cache.isStreamItemsCached(t.id);return!e.conversationsStore.isPersisted(t.id)&&!e.chatSyncPriorityService.isActiveConversation(t.id)&&i}),u=[];_.forEach(p,function(t){u.push(e.conversationsStore.clearAndPatchSyncState(t.id).then(function(){o(t,!0)}))}),this.$q.all(u).then(function(){if(e.isCleaningStreamItemsCache=!1,c+l+a+s>0){var i=Date.now()-t;e.loggingService.newScenario(e.constants.scenarios.messaging.cleanup).stop({chatMessages:c,channelMessages:l,channels:a,chats:s,delta:i,conversationMapSize:e.conversationsStore.getConversationMapSize(),conversationCloneSize:e.conversationsStore.getConversationClonesSize()})}else e.clearTimerInterval()}).catch(function(){e.isCleaningStreamItemsCache=!1,e.loggingService.newScenario(e.constants.scenarios.messaging.cleanup).fail({statusReason:"Failed to patch conversations"})})}},t.prototype.getInvisibleMessages=function(e,i,n){var r=_.filter(e,t.SystemMessageHydratedContentFilter),s=_.difference(e,r),a=this.getFilteredReplyChainItems(r,i,n);if(0==a.length)return[];var o=_.minBy(a,function(e){return e.lastMessageTimeUtc}),c=_.flatten(_.map(a,function(e){return e.messages})),l=_.difference(r,c),p=_.filter(s,function(e){return e.originalArrivalTimeUtc<o.lastMessageTimeUtc});return l.concat(p)},t.prototype.getSipUris=function(e,t,i){var n=this,r=Date.now();if(this.sipUriCache[e]&&this.sipUriCache[t]&&this.sipUriCache[e].expiryTime>r&&this.sipUriCache[t].expiryTime>r)return this.$q.resolve({fromSipUri:this.sipUriCache[e].sipAddress,toSipUri:this.sipUriCache[t].sipAddress});var s=this.peopleService.getAllPeopleProfile([e],"sfb-interop-post-message"),a=i?this.peopleService.searchFederatedUsersByMri([t],"message-service"):this.peopleService.getAllPeopleProfile([t],"sfb-interop-post-message");return this.$q.all([s,a]).then(function(r){if(!r[0][0]||!r[1][0])return n.$q.reject("One or both of these user profiles : "+t+", "+e+" not in cache");var s=r[0][0],a=r[1][0];if(n.peopleService.isUnknownUser(s)||n.peopleService.isUnknownUser(a))return n.logger.error("One or both of these user profiles : "+t+", "+e+" are marked as unknown"),n.$q.reject({message:"One or both of the user profiles is unknown",_errorCode:n.constants.errorCodes.unknownUserProfile});if(n.logIfMissingSipProxyAddress(s,"getAllPeopleProfile-fromUser"),n.logIfMissingSipProxyAddress(a,"getAllPeopleProfile-toUser"),!s.sipProxyAddress||!a.sipProxyAddress){var o=s.sipProxyAddress?n.$q.resolve([s]):n.peopleService.getAllLatestPeopleProfile([e],"sfb-interop-post-message",!1),c=i&&!a.sipProxyAddress?n.$q.resolve([a]):a.sipProxyAddress?n.$q.resolve([a]):n.peopleService.getAllLatestPeopleProfile([t],"sfb-interop-post-message",!1);return n.$q.all([o,c]).then(function(i){var r=i[0][0],s=i[1][0];n.logIfMissingSipProxyAddress(r,"getAllLatestPeopleProfile-fromUser"),n.logIfMissingSipProxyAddress(s,"getAllLatestPeopleProfile-toUser");var a,o,c=r.sipProxyAddress||r.userPrincipalName,l=s.sipProxyAddress||s.userPrincipalName;return n.settingsService.valueAsBoolean(n.constants.settings.names.useChatsCoexistenceMode)&&(a=r.featureSettings&&r.featureSettings.coExistenceMode,o=s.featureSettings&&s.featureSettings.coExistenceMode),n.cacheAndReturnSipProxyAddresses(e,c,t,l,a,o)})}var l,p,u=s.sipProxyAddress,h=a.sipProxyAddress;return n.settingsService.valueAsBoolean(n.constants.settings.names.useChatsCoexistenceMode)&&(l=s.featureSettings&&s.featureSettings&&s.featureSettings.coExistenceMode,p=a.featureSettings&&a.featureSettings&&a.featureSettings.coExistenceMode),n.cacheAndReturnSipProxyAddresses(e,u,t,h,l,p)})},t.prototype.cacheAndReturnSipProxyAddresses=function(e,t,i,n,r,s){t&&!t.startsWith(teamspace.services.SfBInteropUtilsService.SipPrefix)&&(t=teamspace.services.SfBInteropUtilsService.SipPrefix+t),n&&!n.startsWith(teamspace.services.SfBInteropUtilsService.SipPrefix)&&(n=teamspace.services.SfBInteropUtilsService.SipPrefix+n);var a=Date.now()+4*this.constants.timeInMiliseconds.hour;return this.sipUriCache[e]={sipAddress:t,coExistenceMode:r,expiryTime:a},this.sipUriCache[i]={sipAddress:n,coExistenceMode:s,expiryTime:a},{fromSipUri:this.sipUriCache[e].sipAddress,toSipUri:this.sipUriCache[i].sipAddress}},t.prototype.logIfMissingSipProxyAddress=function(e,t){e&&!e.sipProxyAddress&&this.logger.warn(t+" missing sipProxyAddress, mri: "+SkypeX.Services.ChatServiceUtils.scrubMri(e.mri)+", ")},t.prototype.setErrorAndReject=function(e,t){return angular.isObject(t)&&(t.errorMessage=t.errorMessage||e+" failed"),this.$q.reject(t)},t.prototype.clearTimerInterval=function(){this.cacheCleanupTimer&&(this.$interval.cancel(this.cacheCleanupTimer),this.cacheCleanupTimer=void 0)},t.prototype.addAmsReferences=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];e.amsreferences||(e.amsreferences=[]),e.amsreferences=_.union(e.amsreferences,t)},t.MessagePreviewLength=85,t.SystemMessageHydratedContentFilter=function(e){return!e.isRenderingKindSystem||!e.isHydrated||!_.isEmpty(e.hydratedContent)},t}(SkypeX.Services.ObservableBase);t.MessageService=s,angular.module("teamspace.messageService",["pascalprecht.translate","teamspace.analyticsService","teamspace.appState","teamspace.botCardFactory","skypeX.chatServiceClient","skypeX.chatSyncPriorityService","skypeX.chatSyncService","teamspace.config","teamspace.connectorService","teamspace.constants","teamspace.conversationsService","skypeX.conversationsStore","teamspace.eventingService","teamspace.services.files.modules.wopi.externalFilesRepositoryFactory","teamspace.filesAsyncMediaService","skypeX.adapters.filesAttachmentAdapter","teamspace.services.files.filesProviderFactory","teamspace.services.files.filesUploadRouter","teamspace.localMessageStorageService","teamspace.locales","teamspace.loggingService","teamspace.messageProcessingService","skypeX.messageStore","skypeX.offlineActionService","teamspace.orchestrationService","teamspace.outgoingWebhookService","teamspace.peopleService","skypeX.replyChainStore","teamspace.resourceManager","teamspace.settingsService","teamspace.sfbInteropService","teamspace.sfbInteropUtilsService","skypeX.skypeXMembersService","skypeX.sxConfig","teamspace.systemMessageHydrators","teamspace.urlPreviewCacheService","teamspace.utilityService","skypeX.mruChannelsService","teamspace.teamMembersCacheService","teamspace.channelMembershipPropertiesService","teamspace.teamMembershipPropertiesService","teamspace.htmlSanitizer","teamspace.htmlMessageBodyAdapterService"]).service("messageService",s)},function(e,t,i){(function(e,n){var r;!function(s){function a(e){throw new RangeError(E[e])}function o(e,t){for(var i=e.length,n=[];i--;)n[i]=t(e[i]);return n}function c(e,t){var i=e.split("@"),n="";return i.length>1&&(n=i[0]+"@",e=i[1]),n+o((e=e.replace(_,".")).split("."),t).join(".")}function l(e){for(var t,i,n=[],r=0,s=e.length;r<s;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<s?56320==(64512&(i=e.charCodeAt(r++)))?n.push(((1023&t)<<10)+(1023&i)+65536):(n.push(t),r--):n.push(t);return n}function p(e){return o(e,function(e){var t="";return e>65535&&(t+=R((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=R(e)}).join("")}function u(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:y}function h(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function d(e,t,i){var n=0;for(e=i?D(e/I):e>>1,e+=D(e/t);e>U*b>>1;n+=y)e=D(e/U);return D(n+(U+1)*e/(e+T))}function g(e){var t,i,n,r,s,o,c,l,h,g,v=[],m=e.length,f=0,T=k,I=w;for((i=e.lastIndexOf(P))<0&&(i=0),n=0;n<i;++n)e.charCodeAt(n)>=128&&a("not-basic"),v.push(e.charCodeAt(n));for(r=i>0?i+1:0;r<m;){for(s=f,o=1,c=y;r>=m&&a("invalid-input"),((l=u(e.charCodeAt(r++)))>=y||l>D((S-f)/o))&&a("overflow"),f+=l*o,h=c<=I?C:c>=I+b?b:c-I,!(l<h);c+=y)o>D(S/(g=y-h))&&a("overflow"),o*=g;I=d(f-s,t=v.length+1,0==s),D(f/t)>S-T&&a("overflow"),T+=D(f/t),f%=t,v.splice(f++,0,T)}return p(v)}function v(e){var t,i,n,r,s,o,c,p,u,g,v,m,f,T,I,A=[];for(m=(e=l(e)).length,t=k,i=0,s=w,o=0;o<m;++o)(v=e[o])<128&&A.push(R(v));for(n=r=A.length,r&&A.push(P);n<m;){for(c=S,o=0;o<m;++o)(v=e[o])>=t&&v<c&&(c=v);for(c-t>D((S-i)/(f=n+1))&&a("overflow"),i+=(c-t)*f,t=c,o=0;o<m;++o)if((v=e[o])<t&&++i>S&&a("overflow"),v==t){for(p=i,u=y;g=u<=s?C:u>=s+b?b:u-s,!(p<g);u+=y)I=p-g,T=y-g,A.push(R(h(g+I%T,0))),p=D(I/T);A.push(R(h(p,0))),s=d(i,f,n==r),i=0,++n}++i,++t}return A.join("")}"object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType;var m="object"==typeof n&&n;var f,S=2147483647,y=36,C=1,b=26,T=38,I=700,w=72,k=128,P="-",A=/^xn--/,M=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},U=y-C,D=Math.floor,R=String.fromCharCode;f={version:"1.4.1",ucs2:{decode:l,encode:p},decode:g,encode:v,toASCII:function(e){return c(e,function(e){return M.test(e)?"xn--"+v(e):e})},toUnicode:function(e){return c(e,function(e){return A.test(e)?g(e.slice(4).toLowerCase()):e})}},void 0!==(r=function(){return f}.call(t,i,t,e))&&(e.exports=r)}()}).call(t,i(51)(e),i(36))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.$rootScope=e,this.$injector=t,this.mBValue=1048576}return e.prototype.sizeofWindowReference=function(e){return this.sizeof(e,!1,!1,!1,!1,!0)},e.prototype.sizeOfRootScope=function(){return this.sizeof(this.$rootScope,!1,!0,!0,!0,!1)},e.prototype.sizeofScope=function(e){return this.sizeof(e,!1,!1,!0,!1,!1)},e.prototype.sizeofProvider=function(e){return this.sizeof(e,!1,!1,!1,!1,!1)},e.prototype.calcSize=function(e,t,i,n,r,s,a){var o=t.pop();if("boolean"==typeof o)e+=4;else if("string"==typeof o)e+=2*o.length;else if("number"==typeof o)e+=8;else if("object"==typeof o&&-1===i.indexOf(o)){i.push(o);for(var c in o)!o.hasOwnProperty||!o.hasOwnProperty(c)||!n&&this.$injector.has(c.replace("_",""))||!r&&o[c]instanceof jQuery||!s&&o[c]instanceof this.$rootScope.constructor||!(a||"$$childHead"!==c&&"$$childTail"!==c&&"$$nextSibling"!==c&&"$$prevSibling"!==c&&"$root"!==c&&"$parent"!==c&&"$state"!==c)||t.push(o[c])}return[e,t,i]},e.prototype.sizeof=function(e,t,i,n,r,s){void 0===t&&(t=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),void 0===s&&(s=!0);var a=[],o=[e],c=0;for(s||a.push(window);o.length;)c=(l=this.calcSize(c,o,a,t,i,n,r))[0],o=l[1],a=l[2];return c;var l},e}();t.MemoryCalculator=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getXpathTo=function(e,t,i){if(void 0===t&&(t=!0),t&&""!==e.id)return'id("'+e.id+'")';if(i&&i(e),e===document.body||e===document.documentElement)return e.tagName;var n=0;if(!e.parentElement)return this.getElementIdentifier(e);for(var r=e.parentElement.children,s=0;s<r.length;s++){var a=r[s];if(a===e)return this.getXpathTo(e.parentElement,t,i)+"/"+this.getElementIdentifier(e)+"["+(n+1)+"]";1===a.nodeType&&a.tagName===e.tagName&&n++}},e.prototype.getElementIdentifier=function(e){return e.tagName},e.prototype.walkDomTree=function(e,t,i){void 0===i&&(i=[]);var n=i,r=[e];do{var s=r.pop();t(s,n),_.forEach(s.children,function(e){r.push(e)})}while(r.length>0);return n},e}();t.DOMTreeWalker=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Excel=0]="Excel",e[e.OneDrive=1]="OneDrive",e[e.OneNote=2]="OneNote",e[e.Outlook=3]="Outlook",e[e.PowerPoint=4]="PowerPoint",e[e.SharePoint=5]="SharePoint",e[e.Teams=6]="Teams",e[e.Word=7]="Word",e[e.Yammer=8]="Yammer"}(t.WaffleAppType||(t.WaffleAppType={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.All=0]="All",e[e.Favorite=1]="Favorite"}(t.WikisFavoriteFilter||(t.WikisFavoriteFilter={}))},,,,,,,,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.POP_STEP=0]="POP_STEP",e[e.CLOSE_WIZARD=1]="CLOSE_WIZARD",e[e.SHOW_STEP=2]="SHOW_STEP",e[e.UPDATE_WIZARD=3]="UPDATE_WIZARD"}(t.WizardActionTypes||(t.WizardActionTypes={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return this.clientId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.scenarioName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestamps",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeoutMs",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.timeoutInMs=function(e){},Object.defineProperty(e.prototype,"service",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.createMark=function(e,t,i,n){void 0===i&&(i=!1)},e.prototype.mark=function(e,t,i){},e.prototype.markAggregateStart=function(e){},e.prototype.markAggregateStop=function(e){},e.prototype.pause=function(e){},e.prototype.resume=function(e){},e.prototype.stop=function(e,t,i){},e.prototype.stopAfterDigest=function(e,t){},e.prototype.fail=function(e,t){},e.prototype.failAfterDigest=function(e){},e.prototype.cancel=function(e,t){},e.prototype.cancelAfterDigest=function(e){},e.prototype.incomplete=function(e,t){},e.prototype.incompleteAfterDigest=function(e){},e.prototype.addCounter=function(e){},e.prototype.onCounterCompleted=function(e){},Object.defineProperty(e.prototype,"eventData",{get:function(){return{}},set:function(e){},enumerable:!0,configurable:!0}),e.prototype.appendEventData=function(e){},e}();t.ScenarioImplementationStub=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m){var f=this;this.$q=e,this.$window=t,this.constants=i,this.callingService=n,this.authenticationService=r,this.utilityService=s,this.dataManagerService=a,this.tenantService=o,this.loggingService=c,this.settingsService=l,this.brbV2DiagnosticDataProviderAggregator=p,this.brbV2UploadContentCollector=u,this.resources=h,this.ngDialog=d,this.desktopUtilityService=g,this.hwaServiceProvider=v,this.platformDetectService=m,this.electronSafeIpc=this.$window.electronSafeIpc,this.logger=this.loggingService.newLogger("BrBV2FeedbackService"),this.electronSafeIpc&&this.electronSafeIpc.on(this.constants.events.desktopApp.feedback.prepareLogsComplete,function(e,t){f.desktopUploadLogsDeferred&&f.desktopUploadLogsDeferred.resolve(t)});var S=new teamspace.services.DataManagerOptions("BrBV2FeedbackService",function(e){return e.id});S.isTransient=!0,S.usePutInsteadOfPatchForUpdates=!0,S.updateUrl="dummy_url_that_wont_be_used",S.useTeamspaceTokens=!1,S.obeysOrchestration=!1,this.dataManager=this.dataManagerService.registerManager(S)}return e.$inject=["$q","$window","constants","callingService","authenticationService","utilityService","dataManagerService","tenantService","loggingService","settingsService","brbV2DiagnosticDataProviderAggregator","brbV2UploadContentCollector","resources","ngDialog","desktopUtilityService","hwaServiceProvider","platformDetectService"],e.prototype.closeDialog=function(){this.ngDialog.closeAll()},e.prototype.getFeedbackCategories=function(){var e=this;if(this.platformDetectService.isRigel())return Object.values(this.constants.feedback.rigel.categories).map(function(t){return{id:t,title:e.resources.strings["teams_rigel_feedback_dialog_category_"+t]}});var t=[],i=function(t){switch(t){case e.constants.feedback.categories.cortana:return e.settingsService.valueAsBoolean(e.constants.settings.names.enableCortana)||e.settingsService.valueAsBoolean(e.constants.settings.names.enableCortanaInContext);default:return!0}};return _.each(Object.values(this.constants.feedback.categories),function(n){i(n)&&t.push({id:n,title:e.resources.strings["teams_feedback_dialog_category_"+n]})}),t},e.prototype.getClientBRBv2ConfigConstants=function(){if(this.settingsService.valueAsBoolean(this.constants.settings.names.isDesktopApp))switch(this.platformDetectService.getOS()){case this.constants.os.windows:return this.constants.BrBV2Service.desktopClient.win;case this.constants.os.mac:return this.constants.BrBV2Service.desktopClient.mac}else{if(this.platformDetectService.isSurfaceHub1())return this.constants.BrBV2Service.surfaceHub1Client;if(this.platformDetectService.isSurfaceHub2())return this.constants.BrBV2Service.surfaceHub2Client;if(this.desktopUtilityService.isDesktopHwa())return this.constants.BrBV2Service.desktopClient.hwa;switch(this.platformDetectService.getBrowser()){case this.constants.browser.edge:return this.constants.BrBV2Service.webClient.edge;case this.constants.browser.chrome:return this.constants.BrBV2Service.webClient.chrome;default:return this.constants.BrBV2Service.webClient.other}}return this.constants.BrBV2Service.webClient.other},e.prototype.sendFeedbackToBrbV2=function(e,t,i,n,r){var s=this;return this.logger.info("Asked to send feedback: {0} - {1}",e,t),this.getClientConfiguration(e,n,r).then(function(e){return s.sendFeedback(e,t,i)}).catch(function(e){return s.loggingService.error(e),s.$q.reject(e)})},e.prototype.openDialog=function(e,t,i){var n,r,s,a=this,o=this.calculatePreviewSize();n={template:"components/feedback-dialog-brb-v2/feedback-dialog-brb-v2.html",className:"ts-modal-dialog custom-width feedback-dialog-brb-v2",ariaLabelledById:"modalDialog-title",data:{feedbackCategories:this.getFeedbackCategories(),isCpuProfileDone:e,feedbackSelectedCategory:i,feedbackText:t,preActiveElementIds:this.getPreActiveElementIds()}};var c=this.callingService.getActiveCall();c&&c.isBackgroundBlurOn&&c.dumpVideoSourceImages().then(function(e){n.data.backgroundBlurImagesAvailable=e>0}),r=this.desktopUtilityService.getApplicationScreenshot(o.width,o.height,this.loggingService).then(function(e){n.data.feedbackScreenshot=e});var l={closeByEscape:!0,closeByDocument:!1,showClose:!1};_.assign(n,l),r.then(function(){(s=a.ngDialog.open(n)).closePromise.then(function(){a.logger.info("[dialogService] Trying to set focus back to original element.");var e=document.getElementById(n.data.preActiveElementIds[0]);e&&(a.logger.info("[dialogService] Setting focus to '"+n.data.preActiveElementIds[0]+"'"),e.focus())})})},e.prototype.getPreActiveElementIds=function(){return["feedback-button"]},e.prototype.ensureVersionIsInternal=function(e){if(!e)return this.getClientBRBv2ConfigConstants().clientVersion;var t=e.split(".");if(t.length<3)return this.getClientBRBv2ConfigConstants().clientVersion;this.desktopUtilityService.isHwa()&&t.length>3&&(t[3]=t[2]);return t[2]="84",t.join(".")},e.prototype.buildClientVersionString=function(e,t){return t+"_"+e},e.prototype.getClientVersion=function(){var e=this,t=this.$q.defer(),i=this.settingsService.getVersion().clientVersion,n=this.getClientBRBv2ConfigConstants().clientVersion;if(this.settingsService.valueAsBoolean(this.constants.settings.names.isDesktopApp))this.desktopUtilityService.getElectronClientVersion().then(function(n){t.resolve(e.buildClientVersionString(i,e.ensureVersionIsInternal(n)))}).catch(function(){t.resolve(e.buildClientVersionString(i,n))});else if(this.desktopUtilityService.isHwa()){var r=this.hwaServiceProvider.getAppInfo(),s=n;r&&r.appVersion&&(s=r.appVersion),t.resolve(this.buildClientVersionString(i,this.ensureVersionIsInternal(s)))}else t.resolve(this.buildClientVersionString(i,n));return t.promise},e.prototype.getRingId=function(){var e=this.settingsService.getRing();return e?e.id:this.getClientBRBv2ConfigConstants().devLocalRingId},e.prototype.getClientConfiguration=function(e,t,i){var n=this,r=this.$q.defer(),s={ring:this.getRingId(),categoryName:e,includeLogs:!0,includeScreenshot:!!t,includeBackgroundBlurImages:!!i};return this.getClientVersion().then(function(e){s.clientVersion=e}).finally(function(){r.resolve(_.defaults(s,n.getClientBRBv2ConfigConstants()))}),r.promise},e.prototype.sendFeedback=function(e,t,i){var n=this,r=this.$q.resolve([]);e.includeLogs&&(r=this.collectLogs(e));var s=this.loggingService.newScenario(this.constants.scenarios.brbFeedbackSubmitted),a=this.createBrbV2WorkItem(e,t,i);return a.catch(function(t){n.logger.error("Error obtaining a BRBv2 work item {0}",t),s.fail({destination:e.categoryName,message:t})}),a.then(function(t){return t&&t.SharedAccessSignature&&t.ContainerID?(n.logger.info("BRBv2 work item retrieved."),s.stop({destination:e.categoryName}),e.includeLogs?r.then(function(i){return n.logger.info("All content to upload collected."),n.sendLogs(t,e,i)}):(n.logger.info("Feedback submitted without logs. Releasing the BRBv2 container."),void n.releaseBrbV2Container(t.ContainerID))):(n.logger.error("BRBv2 work item not received or incomplete."),void s.fail({destination:e.categoryName,message:"Incomplete BRBv2 response."}))})},e.prototype.collectLogs=function(e){var t=this,i=[],n=this.$q.defer();this.logger.debug("Collecting content to upload as logs.");var r=this.desktopUtilityService.isHwa()&&!this.hwaServiceProvider.getBrbV2();return this.brbV2UploadContentCollector.collectUploadContent(e.categoryName,r,function(e){return t.logger.debug("Collected content to upload of type {0}",e.type),i.push(e),t.$q.resolve()},this.logger).then(function(){n.resolve(i)}).catch(function(e){t.logger.error("Error collecting content to upload as logs: {0}",e)}),n.promise},e.prototype.sendLogs=function(e,t,i){var n=this,r=1e3*this.settingsService.valueFor(this.constants.settings.names.brbv2LogsUploadTimeoutSecs),s=this.loggingService.newScenario(this.constants.scenarios.brbLogsUploaded,null,null,r);return this.logger.debug("Going to upload web content as files."),this.uploadWebContents(i,e.SharedAccessSignature).then(function(i){return n.logger.info("All web content uploaded as files."),n.logger.debug("Going to trigger the upload of desktop logs."),n.uploadDesktopLogsToBrbV2(e.SharedAccessSignature,e.ContainerID,t.includeScreenshot,t.includeBackgroundBlurImages).then(function(e){n.logger.info("Desktop logs uploads complete."),n.processLogUploadResultsForTelemetry(i,e,s)})}).catch(function(e){n.logger.error("Error uploading web or desktop logs: {0}",e);var t={webStatus:"failure",desktopStatus:"failure"};s.fail({message:e,terminatedReason:JSON.stringify(t)})}).finally(function(){n.logger.info("Releasing the BRBv2 container after attempting to upload logs."),n.releaseBrbV2Container(e.ContainerID)})},e.prototype.calculatePreviewSize=function(e){void 0===e&&(e=160);var t=this.$window.screen.width,i=this.$window.screen.height,n=Math.max(i,t);if(n<=e)return{width:t,height:i};var r=n/e;return t>i?{width:e,height:i/r}:{width:t/r,height:e}},e.prototype.processLogUploadResultsForTelemetry=function(e,t,i){var n={webStatus:"unavailable",desktopStatus:"unavailable"};n.webStatus=this.calculateLogUploadsOutcome(e),n.desktopStatus=this.calculateLogUploadsOutcome(t);var r={webLogs:e,desktopLogs:t};if("success"!==n.webStatus||"success"!==n.desktopStatus&&"unavailable"!==n.desktopStatus){s={terminatedReason:JSON.stringify(n),message:JSON.stringify(r)};i.fail(s)}else{var s={message:JSON.stringify(r)};i.stop(s)}},e.prototype.calculateLogUploadsOutcome=function(e){if(e){if(0===e.length)return"unavailable";var t=_.countBy(e,function(e){return e&&e.errorCode?"fail":"success"});return t.fail?t.fail===e.length?"failure":"partial":"success"}return"failure"},e.prototype.completeFeedbackTitle=function(e,t,i){return"ring1_5"===t.ring||"ring3"===t.ring?t.platform+": "+this.getCompanyNameFromUpn(i)+": "+e:e},e.prototype.getCompanyNameFromUpn=function(e){var t=e&&e.split("@")[1];return t&&t.substr(0,t.lastIndexOf("."))},e.prototype.addReportDataToBrbV2Request=function(e,t,i,n,r){var s=this.utilityService.generateUUID(),a={ReportTitle:this.completeFeedbackTitle(n,t,i),ReportDescription:""+(r?r.replace(/\r\n|\n/g,"<br>"):""),CategoryName:t.categoryName,UploadID:s};_.assign(e,a)},e.prototype.addClientDataToBrbV2Request=function(e,t){var i=this,n=this.utilityService.convertToSafeCachingGetter(function(){return i.desktopUtilityService.getSlimCoreVersion()},""),r={ClientID:t.clientId,ClientVersion:t.clientVersion,CorelibVersion:n(),Ring:t.ring};_.assign(e,r)},e.prototype.addUserDataToBrbV2Request=function(e,t,i){var n=t.profile.upn,r=t.profile.email,s=this.getCompanyNameFromUpn(n),a=this.tenantService.getCachedTenantNotification(),o={SkypeAuthToken:i.skypeToken,TenantName:s,TenantID:a&&a.length?a[0].tenantId:"",Email:r||n};if(_.assign(e,o),this.authenticationService.isMsInternalUser()){var c={MSAlias:n};_.assign(e,c)}},e.prototype.addDiagnosticDataToBrbV2Request=function(e){var t=this;return this.brbV2DiagnosticDataProviderAggregator.getDiagnosticText().then(function(t){return e.SystemInfo="<h3><strong>All the logs & screenshots (if attached) are available in the devlogs link which is present in the Links tab.</strong></h3>"+t}).then(function(){return t.brbV2DiagnosticDataProviderAggregator.getDiagnosticTags()}).then(function(t){return e.VsoTags=(t||[]).join(",")}).catch(function(e){t.logger.error("Failed to get diagnostic text and tags")})},e.prototype.createBrbV2WorkItem=function(e,t,i){var n=this;return this.logger.debug("Asking the BRBv2 service for a work item."),this.authenticationService.getUserInformation().then(function(r){return n.authenticationService.getSkypeTokens(!1).then(function(s){var a={};return n.addReportDataToBrbV2Request(a,e,r.profile.upn,t,i),n.addClientDataToBrbV2Request(a,e),n.addUserDataToBrbV2Request(a,r,s),n.addDiagnosticDataToBrbV2Request(a).then(function(){var e=JSON.stringify(a),t=new teamspace.services.DataManagerRequestOptions;t.skipApply=!0;var i={url:n.constants.BrBV2Service.baseUrl+n.constants.BrBV2Service.submitReportPath,data:e,method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"}};return n.dataManager.invoke(i,t)})})})},e.prototype.releaseBrbV2Container=function(e){var t=new teamspace.services.DataManagerRequestOptions;t.bypassAuth=!0,t.skipApply=!0;var i={url:""+this.constants.BrBV2Service.baseUrl+this.constants.BrBV2Service.releaseContainerPath+"?container="+e,method:"POST"};return this.dataManager.invoke(i,t)},e.prototype.uploadWebContents=function(e,t){var i=this;if(e.length){var n=e.map(function(e){return i.uploadFileContent(e,t)});return this.$q.all(n)}return this.$q.resolve([])},e.prototype.uploadFileContent=function(e,t){var i;return e.isBinary||"string"!=typeof e.content||(i=e.content.replace(this.constants.files.regexPatterns.pstnRegex,"4:PSTN")),this.uploadFileToBrbV2(i||e.content,e.fileName,t,e.isBinary).then(function(){return{type:e.type,url:e.fileName,size:""+e.content.length}}).catch(function(t){return{type:e.type,url:"",errorCode:t}})},e.prototype.uploadFileToBrbV2=function(e,t,i,n){var r=i.split("?");if(r.length<1)return this.$q.reject("BRBv2 returned an invalid SAS URL.");var s=r[0]+"/"+t+"?"+r.slice(1).join(),a=new teamspace.services.DataManagerRequestOptions;return a.bypassAuth=!0,a.httpConfigModifier=function(e){e.url=s,e.method="PUT",n?(e.transformRequest=[],e.headers["Content-Type"]=void 0):e.headers["Content-Type"]="application/json; charset=UTF-8",e.headers["x-ms-date"]=Date.now().toLocaleString(),e.headers["x-ms-version"]="2015-02-21",e.headers["x-ms-blob-type"]="BlockBlob",e.headers["x-ms-blob-content-disposition"]="body"},this.dataManager.update(e,a)},e.prototype.uploadDesktopLogsToBrbV2=function(e,t,i,n){var r=this;if(this.desktopUtilityService.isHwa()){var s=this.hwaServiceProvider.getBrbV2(),a=this.$q.defer();return s?(s.sendPlatformLogs(e).then(function(e){var t=r.adaptIIterable(e).map(function(e){return r.adaptHwaLogAttachment(e)});a.resolve(t)}),a.promise):this.$q.when([])}if(!this.electronSafeIpc)return this.$q.when([]);var o={account:e.split("/").slice(0,3).join("/"),container:t,sas:"?sv="+e.split("?sv=")[1]};return this.desktopUploadLogsDeferred=this.$q.defer(),this.electronSafeIpc.send(this.constants.events.desktopApp.feedback.prepareLogsForBrbV2,o,i,n),this.desktopUploadLogsDeferred.promise.finally(function(){r.desktopUploadLogsDeferred=null})},e.prototype.adaptIIterable=function(e){for(var t=[],i=e.first();i.hasCurrent;)t.push(i.current),i.moveNext();return t},e.prototype.adaptHwaLogAttachment=function(e){return{type:e.type,url:e.url,size:""+e.sizeBytes,errorCode:e.error}},e.sizeLimit=20*teamspace.Constants.Instance.bytes.mb,e}();t.BrBV2FeedbackService=n,angular.module("teamspace.brbV2FeedbackService",["teamspace.constants","teamspace.callingService","teamspace.authenticationService","teamspace.utilityService","teamspace.dataManagerService","teamspace.tenantService","teamspace.loggingService","teamspace.settingsService","teamspace.brbV2DiagnosticDataProviderAggregator","teamspace.brbV2UploadContentCollector","teamspace.desktopUtilityService","teamspace.hwaServiceProvider","teamspace.platformDetectService"]).service("brbV2FeedbackService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=SkypeX.Services.ChatServiceUtils,r=SkypeX.Services.SyncTasks;t.SettingEnableTailPruning="enableTailPruning",t.SettingEnableTailPruningRcApiSupported="enableTailPruningRcApiSupported",t.SettingPersistencePruningStandardPruneBatchSize="persistencePruningStandardPruneBatchSize",t.SettingPersistencePruningTailPruneBatchSize="persistencePruningTailPruneBatchSize",t.SettingRetentionAgeOutTimeSeconds="retentionAgeOutTimeSeconds",t.SettingReplyChainRetainCount="replyChainRetainCount",t.SettingRetentionPruningThrottleRateSeconds="retentionPruningThrottleRateSeconds",t.RetentionTailPruningScenarioName="retention_tail_pruning";var s=[n.ConversationType_Chat,n.ConversationType_Meeting,n.ConversationType_Team,n.ConversationType_Topic],a=function(){function e(e,t){this.appStateService=e,this.config=t,this.config=this.config||{}}return e.$inject=["appStateService","config"],e.prototype.execute=function(e){var t=this;return this.logger=e.loggingService.newLogger("PersistencePruningJob"),this.pruneConversations(e).then(function(){return t.tailPruneConversations(e)})},e.prototype.isValid=function(){return!0},e.prototype.resourceTags=function(){return[]},e.prototype.abort=function(){this.aborted=!0},e.prototype.pruneConversations=function(e){var i=this,n=_.chain(e.conversationsStore.dangerousGetAllConversationsMutable()).filter(function(t){return e.conversationsStore.isPersistencePrunable(t.id)}).map(function(e){return e.id}).value();if(0===n.length)return r.Resolved();var s=e.loggingService.newScenario(e.constants.scenarios.sync.prunePersistence),a=e.settingsService.valueFor(t.SettingPersistencePruningStandardPruneBatchSize)||5;return this.processInBatches(e,n,a,s,function(t){return i.pruneConversation(e,t)})},e.prototype.pruneConversation=function(e,t){return e.syncStateService.removeSyncState(t).then(function(){return SkypeX.Services.SyncTasks.fromNgPromise(e.conversationsStore.clearAndPatchSyncState(t,!0,!1))}).then(function(){return e.persistenceService.removeReplyChainsView(t)}).then(function(){return e.messageStore.removeMessages(t)})},e.prototype.tailPruneConversations=function(e){var i=this;if(!e.settingsService.valueAsBoolean(t.SettingEnableTailPruning))return r.Resolved();var n=e.settingsService.valueFor(t.SettingRetentionPruningThrottleRateSeconds)||0,a=Date.now()-1e3*n,o=this.getTargetedConversations(e),c=_.chain(o).filter(function(t){var i=e.syncStateService.getSyncState(t.id),n=!!i,r=s.includes(t.type),o=i&&i.tailPrunedTime&&i.tailPrunedTime>a;return n&&r&&!o}).map(function(e){return e.id}).value();if(0===c.length)return r.Resolved();var l=e.loggingService.newScenario(t.RetentionTailPruningScenarioName),p=e.settingsService.valueFor(t.SettingPersistencePruningTailPruneBatchSize)||5;return this.processInBatches(e,c,p,l,function(t){return i.tailPruneConversation(e,t)})},e.prototype.tailPruneConversation=function(i,n){var r=1e3*i.settingsService.valueFor(t.SettingRetentionAgeOutTimeSeconds);if(r){var s,a=Date.now()-r,o=new Date(a).toISOString();if(i.settingsService.valueAsBoolean(t.SettingEnableTailPruningRcApiSupported)&&i.conversationsStore.isCSAReplyChainApiSupported(n)){var c=i.settingsService.valueFor(t.SettingReplyChainRetainCount)||5;s=i.messageStore.removeMessagesRcApiSupported(n,function(e,t){return Number.parseInt(e.parentMessageId,10)<a||Number(t)>=c})}else s=i.messageStore.removeMessages(n,function(e){return e.originalarrivaltime<o});return s.then(function(t){if(t&&t.length>0){var r=_.max(_.map(t,function(e){return Number.parseInt(e.version,10)}));i.conversationsStore.patchConversation(n,function(t){e.updateSyncState(t,r),e.pruneReplyChainSyncMap(t,r,i.syncStateService)},!0,!1);var s=i.syncStateService.getSyncState(n);if(s)return e.updateSyncState(s,r),s.tailPrunedTime=Date.now(),i.syncStateService.addUpdateSyncState([s])}})}},e.prototype.getTargetedConversations=function(e){return this.config&&this.config.conversationIdOrIds?("string"==typeof this.config.conversationIdOrIds?[this.config.conversationIdOrIds]:this.config.conversationIdOrIds).map(function(t){return e.conversationsStore.dangerousGetConversationMutable(t)}):e.conversationsStore.dangerousGetAllConversationsMutable()},e.prototype.processInBatches=function(e,t,i,n,s){var a=this,o=0,c=0,l=_.chunk(t,i);return _.reduce(l,function(e,t){return e.then(function(){if(!(a.aborted||a.appStateService.appInUse&&!a.config.force))return r.whenAll(_.map(t,function(e){return s(e).then(function(){return o++}).fail(function(t){c++,a.logger.error(n.name+" failed for "+e+" - "+t)})})).then(function(){})})},r.Resolved()).then(function(){n.stop({data:JSON.stringify({prunableConversationsNumber:t.length,succeedCount:o,failedCount:c})}),a.logger.info(n.name+" completed: "+o+" succeeded, "+c+" failed")}).fail(function(e){n.fail({data:JSON.stringify({prunableConversationsNumber:t.length,succeedCount:o,failedCount:c,error:e})}),a.logger.error(n.name+" failed with message "+e)})},e.updateSyncState=function(e,t){e.clientCacheClearedAt=e.clientCacheClearedAt?Math.max(t,e.clientCacheClearedAt):t,e.messageHistoryStartTime&&(e.messageHistoryStartTime=Math.max(e.messageHistoryStartTime,t+1)),e.maxMessageVersion&&(e.maxMessageVersion=Math.max(e.maxMessageVersion,t+1)),e.isSyncedToStartOfTime=!1,e.continuationToken=null},e.pruneReplyChainSyncMap=function(e,t,i){_.values(i.getReplyChainSyncMap(e)).filter(function(e){var i=n.parseActivityId(e.replyChainId),r=!1;if(i.isValid&&i.topicId){var s=Number.parseInt(i.topicId,10);s&&s<=t&&(r=!0)}return r}).map(function(e){return e.replyChainId}).forEach(function(t){i.deleteReplyChainSyncState(e.id,t),delete e.replyChainSyncMap[t]})},e}();t.PersistencePruningJob=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=SkypeX.Services.SyncTasks;t.DefaultMaximumRetries=6,t.DefaultMinimumRetryIntervalMs=1e4,t.SettingRetryMinimumInterval="startupRetryMinimumInterval",t.SettingMaximumRetries="startupRetryMaximumRetries",t.TeamsStartupResourceTag="startup";var r=function(){function e(e,t,i,n,r,s){void 0===s&&(s={usePrefetchedStartupData:!1}),this.$q=e,this.peopleService=t,this.constants=i,this.eventingService=n,this.retryService=r,this.config=s}return e.$inject=["$q","peopleService","constants","eventingService","retryService","config"],e.prototype.execute=function(e){var t=this,i=performance.now(),r=n.Defer(),s=r.promise(),a=function(i){var n=_.isEmpty(i)?e.constants.scenarios.alt.timings.startupCleanDuration:e.constants.scenarios.alt.timings.startupDeltaDuration,s=performance.now(),a=t.getRetryIntervals(e.settingsService);t.retryOperation=t.retryService.retry("retry Startup API",function(){return e.teamsDataService.getStartupData(i).toNgPromise(t.$q).then(function(e){window[n]=performance.now()-s,r.resolve(e)}).catch(function(e){return t.isRetryableError(e)?t.$q.reject(e):(r.reject(e),t.$q.resolve())})},{forever:!0,retryIntervals:a,retryMaxTimeMs:1e3*e.settingsService.valueFor("syncIntervalSeconds")*2}),t.retryOperation.promise.catch(function(t){e.logger.warn("Startup retry catch: "+t),r.reject(t)})},o=function(){e.conversationsStore.getConversationListSyncState().then(function(e){a(e)}).fail(function(t){return e.logger.error(t)})};return this.config.usePrefetchedStartupData?(e.prefetchService.getStartupAggregatorData().then(function(t){null!==t?e.conversationsStore.getConversationListSyncState().then(function(i){i===e.conversationsStore.getConversationListSyncStateFromLocalStorage()?r.resolve(t):(e.logger.info("Startup data was prefetched with an inconsistent sync state"),a(i))},function(t){e.logger.info("Could not get sync state"),a(null)}):(e.logger.info("Prefetched startup data is not available"),o())},function(e){r.reject(e)}),s.finally(function(){e.prefetchService.cleanupStartupAggregatorData()})):o(),s.then(function(n){t.processStartupData(n,e,i),t.eventStatus({successful:!0,delta:performance.now()-i})}).fail(function(n){e.logger.error("Unable to fetch startup data: {0}",n),t.eventStatus({successful:!1,delta:performance.now()-i})})},e.prototype.isValid=function(){return!0},e.prototype.resourceTags=function(){return[t.TeamsStartupResourceTag]},e.prototype.abort=function(){this.retryOperation&&this.retryOperation.cancel()},e.prototype.getMtUsers=function(e,t){return _.map(e,function(e){return e.userType=e.userSubType,delete e.userSubType,_.has(e,"isEnabled")&&(e.accountEnabled=e.isEnabled),e})},e.prototype.loadPeople=function(e,t){var i;i=t.users?_.filter(t.users,function(e){return e}):_.chain((t.chats||[]).concat(t.teams||[])).map(function(e){return e.members}).flatten().filter(function(e){return e}).uniqBy(function(e){return e.mri}).value(),e.conversationsStore.addUsers(i)},e.prototype.eventStatus=function(e){var t={conversationId:void 0,jobType:SkypeX.Services.Sync.SyncJobType.STARTUP,successful:e.successful,delta:e.delta};this.eventingService.$emit(this.constants.events.syncService.syncStatus,t)},e.prototype.processStartupData=function(e,t,i){var n=performance.now(),r=e.chats&&e.chats.length,s=e.teams&&e.teams.length,a=e.channels&&e.channels.length+_.reduce(e.teams,function(e,t){return e+(t.channels&&t.channels.length)},0);if(t.logger.info("Retrieved startup info: {0} chats, {1} teams, {2} channels in {3} ms",r,s,a,performance.now()-i),this.shim(e),this.config.persistPeopleData){if(!_.isEmpty(e.users)){var o=this.getMtUsers(e.users,t.constants);this.peopleService.updateMultipleProfilesInIndexDbByMRI(o,!0)}}else this.loadPeople(t,e);var c=_.keyBy(e.users,function(e){return e.mri});this.$q.all([t.conversationsStore.addOrUpdateChats(e.chats,c),t.conversationsStore.addOrUpdateChannels(e.channels,c),t.conversationsStore.addOrUpdateTeams(e.teams,c),t.conversationsStore.addOrUpdatePrivateFeeds(e.privateFeeds)]).then(function(){var i=e.metadata&&e.metadata.syncToken;i?t.conversationsStore.saveConversationListSyncState(i):t.logger.error("Startup sync state is missing from start up data")},function(e){t.logger.error("Failed to save conversations to store: {0}",e)}),window[t.constants.scenarios.alt.timings.startupProcessingDuration]=performance.now()-n},e.prototype.shim=function(e){_.forEach(e.teams,function(e){_.forEach(e.channels,function(t){t.tenantId=e.tenantId})})},e.prototype.getRetryIntervals=function(e){for(var i=e.valueFor(t.SettingMaximumRetries)||t.DefaultMaximumRetries,n=[e.valueFor(t.SettingRetryMinimumInterval)||t.DefaultMinimumRetryIntervalMs];n.length<i;){var r=2*_.last(n);n.push(r)}return n},e.prototype.isRetryableError=function(e){switch(e.statusCode){case 400:case 401:case 403:return!1;case-1:case 500:case 503:case 429:default:return!0}},e}();t.TeamsStartupSyncJob=r},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=SkypeX.Services.MuteAllResult;!function(e){e[e.Desktop=1]="Desktop",e[e.Mobile=2]="Mobile"}(t.ChatServiceDeviceType||(t.ChatServiceDeviceType={}));var s=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d){var g=e.call(this,t.chatServiceConstants.useDogfood?"/"!==t.chatServiceConstants.dogfoodHost.substr(-1)?t.chatServiceConstants.dogfoodHost+"/":t.chatServiceConstants.dogfoodHost:"/"!==t.chatServiceConstants.productionHost.substr(-1)?t.chatServiceConstants.productionHost+"/":t.chatServiceConstants.productionHost,h,c,n,r,s,a,l)||this;return g.appConfig=t,g.$injector=i,g.$http=n,g.$q=r,g.$qNoApply=s,g.authenticationService=a,g.loggingService=o,g.constants=c,g.appStateService=l,g.geoRoutingService=p,g.messagingUtilities=u,g.settingsService=h,g.sxConfig=d,g.expiresArgument="expires=",g.BULK_MUTE_REQUEST_TIMEOUT_IN_MS=15e3,g.BULK_MUTE_BATCH_SIZE=200,g.BULK_MUTE_MAX_PARALLEL_REQUESTS=4,g.registrationToken=null,g._waitQueue=[],g.roleDictionary={},g.supportsSkipRosterFromThreads=g.constants.supportsSkipRosterFromThreadsViewParam,g.host=t.chatServiceConstants.useDogfood?t.chatServiceConstants.dogfoodHost:t.chatServiceConstants.productionHost,g.logger=g.loggingService.newLogger("ChatServiceClient"),g._rateRejects=0,g._redirectionFailures=0,g._maxPageSizeForConversations=h.valueFor(c.settings.names.maxPageSizeForConversations)||100,g._maxPageSizeForConvMessages=h.valueFor(c.settings.names.maxPageSizeForConvMessages)||100,g._maxPageSizeForTeamConversations=h.valueFor(c.settings.names.maxPageSizeForTeamConversations)||100,g.roleDictionary[1]=g.constants.RoleConstants.Admin,g.roleDictionary[2]=g.constants.RoleConstants.Guest,g.roleDictionary[0]=g.constants.RoleConstants.User,g._dcEndpointFailoversPerformed=0,g.enableSkypeAuthRegistrationTokenRenew=g.settingsService.valueAsBoolean(g.constants.settings.names.enableSkypeAuthRegistrationTokenRenew),g}return n(t,e),t.$inject=["appConfig","$injector","$http","$q","$qNoApply","authenticationService","loggingService","constants","appStateService","geoRoutingService","messagingUtilities","settingsService","sxConfig"],Object.defineProperty(t.prototype,"isLargeTeamsEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableLargeTeams)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxPageSizeForConversations",{get:function(){return this._maxPageSizeForConversations},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxPageSizeForConvMessages",{get:function(){return this._maxPageSizeForConvMessages},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxPageSizeForTeamConversations",{get:function(){return this._maxPageSizeForTeamConversations},enumerable:!0,configurable:!0}),t.prototype.addSkypeTokenHeader=function(e,t){return e=e||{},e[this.constants.headers.tokens.authentication]=this.constants.headers.skypeTokenPrefix+t,e},t.prototype.addRegistrationTokenHeader=function(e,t){return e=e||{},e[this.constants.headers.tokens.skypeRegistrationToken]=t,e},t.prototype.setRegistrationTokenFromResponse=function(e){if(e.headers&&e.headers[this.constants.headers.chatHeaderRegToken]){var t=e.headers[this.constants.headers.chatHeaderRegToken];if(t.toLowerCase().indexOf("endpointid=")>-1){var i=_.map(t.split(";"),function(e){return e.trim()});this.enableSkypeAuthRegistrationTokenRenew?this.parseRegistrationTokenContent(i):this.parseRegistrationTokenContentLegacy(i),this.refreshRegistrationToken=!1}}},t.prototype.parseRegistrationTokenContent=function(e){this.registrationToken="";for(var t=0;t<e.length;t++){var i=e[t];if(i)if(i.toLowerCase().startsWith(this.expiresArgument)){var n=Number(i.substring(this.expiresArgument.length)),r=isNaN(n)?void 0:1e3*n;r&&r>=Date.now()?this.registrationTokenExpiration=r:(this.registrationTokenExpiration=void 0,this.logger.warn("Received Skype Registration token that is not valid; expiration:{0}",r))}else this.registrationToken+=i,t<e.length-1&&(this.registrationToken+="; ")}},t.prototype.parseRegistrationTokenContentLegacy=function(e){this.registrationToken=_.filter(e,function(e){return 0!==e.toLowerCase().lastIndexOf("expires",0)}).join("; ")},t.prototype.getClientInfoHeader=function(){return this._clientInfo=this._clientInfo||this.messagingUtilities.getClientInfo(),this._clientInfo},t.prototype.addAuthTokenHeader=function(e,t,i){if(e=e||{},i&&(this.refreshRegistrationToken=!0),this.registrationToken&&(e=this.addRegistrationTokenHeader(e,this.registrationToken)),!this.registrationToken||this.refreshRegistrationToken){if(!t||!t.skypeToken)return this.$q.reject("Error no registration token exists in cache and auth service returned null SkypeToken. Unable to add auth headers to Chat service call.");e=this.addSkypeTokenHeader(e,t.skypeToken)}return this.$q.resolve(e)},t.prototype._getAuthHeaders=function(e){var t=this;void 0===e&&(e=!1);var i=void 0,n=!1;if(this.registrationTokenExpiration){var r=this.registrationTokenExpiration-this.constants.timeInMiliseconds.twoMinutes;n=r-Date.now()<=0}return!e&&!n||this.refreshRegistrationToken||(n&&this.logger.info("Skype registration token expired or near expiring. Renewing the token."),(i=this.loggingService.newScenario(this.constants.scenarios.auth.chatClientServiceGetNewRegistration)).eventData={registrationExpired:n},this.refreshRegistrationToken=!0,e=!1),this.authenticationService.getSkypeTokens(e).then(function(n){return t.addAuthTokenHeader({},n,e).then(function(e){return e.ClientInfo=t.getClientInfoHeader(),e.BehaviorOverride="redirectAs404",i&&i.stop(),e})}).catch(function(r){return i&&i.fail({errorMessage:r,forceRefresh:e,registrationExpired:n,refreshRegistrationToken:t.refreshRegistrationToken}),t.$q.reject(r)})},t.prototype._performApiCall=function(t,i,n,r){var s=this;void 0===r&&(r=null);var a=function(e){var a=SkypeX.Services.SyncTasks.Defer();return _.delay(function(){s._performApiCall(t,i,n,r).then(function(e){a.resolve(e)},function(e){a.reject(e)})},Math.min(1e3*Math.pow(e,1.5),s.constants.timeInMiliseconds.fiveMinutes)),a.promise()};return e.prototype._performApiCall.call(s,t,i,n,r).then(function(e){return s.setRegistrationTokenFromResponse(e),s._rateRejects=0,s._redirectionFailures=0,s._dcEndpointFailoversPerformed=0,SkypeX.Services.SyncTasks.Resolved(e)},function(e){if(429===e.statusCode)return s._rateRejects++,a(s._rateRejects);var t=n.url&&n.callType===s.constants.urls.longPollSubscription.type;if(404===e.statusCode&&e.headers&&e.headers.location&&!t){var i=SkypeX.Services.UrlUtils.getURIComponents(e.headers.location);if(i){var r=i.protocol+"://"+i.host,o=s.geoRoutingService.getCurrentRoutingTable();return s.loggingService.event("404_redirection",{error:e.statusCode,failovers:s._dcEndpointFailoversPerformed,oldUrl:o&&o.chatService,newUrl:r}),s.geoRoutingService.overrideRoutingTable({chatService:r}),s.setRegistrationTokenFromResponse(e),s._redirectionFailures++,a(s._redirectionFailures-1)}s.logger.error("Invalid location on 404 with redirect header - {0}",e.headers.location)}return s.settingsService.valueAsBoolean(s.constants.settings.names.enableChatServiceDcFailover)&&e.errorMessage!==s.constants.errorCodes.requestAborted&&e.errorMessage!==SkypeX.Services.ChatServiceUtils.BotFailureErrorCode.toString()&&!t&&(-1===e.statusCode||502===e.statusCode||503===e.statusCode)&&s.appStateService.isOnline&&s.geoRoutingService.hasRoutingTableOverrides()?(s.logger.warn("Received a generic network error for a DC specific endpoint."),s._dcEndpointFailoversPerformed++>=3?(o=s.geoRoutingService.getCurrentRoutingTable(),s.loggingService.event("chatserviceclient_dc_failover",{error:e.statusCode,failovers:s._dcEndpointFailoversPerformed,url:o&&o.chatService}),SkypeX.Services.SyncTasks.Rejected(e)):(s.geoRoutingService.revertAllRoutingTableOverrides(),a(s._dcEndpointFailoversPerformed))):SkypeX.Services.SyncTasks.Rejected(e)}).fail(function(e){return e&&e.headers&&e.headers[s.constants.headers.chatHeaderRegToken]&&(e.headers[s.constants.headers.chatHeaderRegToken]="**redacted**"),SkypeX.Services.SyncTasks.Rejected(e)}).finally(function(){s._waitQueue.length>0&&(s._waitQueue.forEach(function(e){e.resolve(void 0)}),s._waitQueue=[])})},t.prototype._augmentErrorResponse=function(e,t){t&&(t.errorCode&&(e.errorCode=t.errorCode),t.message&&(e.errorMessage=t.message))},t.prototype.getMyProperties=function(e){var t=this;return void 0===e&&(e=1),this.performApiGet("v1/users/ME/properties",{callType:this.constants.urls.myProperties.type,timeout:15e3}).fail(function(i){if(i&&404!==i.statusCode&&e>0)return t.getMyProperties(--e)})},t.prototype.setMyProperty=function(e,t){var i="v1/users/ME/properties?name="+encodeURIComponent(e),n={};return n[e]=t,this.performApiPut(i,{callType:this.constants.urls.myProperties.type},n)},t.prototype.setMyDogfoodState=function(e){return this.appConfig.chatServiceConstants.useDogfood&&!this.authenticationService.isAnonymous()?this.setMyProperty("dogfoodUser",e?"true":"false"):SkypeX.Services.SyncTasks.Resolved()},t.prototype.createEndpoint=function(e,t){return this.performApiPutDetailed("v1/users/ME/endpoints/"+t,{callType:this.constants.urls.endpoint.type,timeout:this.settingsService.valueFor("httpTimeoutMillisPutEndpoint"),retryAfterAuthRefresh:!1},{endpointFeatures:e}).then(function(e){return e.object})},t.prototype.publishEndpointPresence=function(e){return this.authenticationService.isAnonymous()?SkypeX.Services.SyncTasks.Resolved():this.performApiPut("v1/users/ME/endpoints/SELF/presenceDocs/messagingService",{callType:this.constants.urls.endpointPresence.type},{privateInfo:{epName:"skypex"},publicInfo:{capabilities:e.join("|"),typ:15,skypeNameVersion:this.sxConfig.getPlatformId()+"/"+this.sxConfig.getAppVersion()+"/SkypeX",nodeInfo:"xx",version:15}})},t.prototype.getMyPresence=function(){return this.performApiGet("v1/users/ME/presenceDocs/messagingService",{callType:this.constants.urls.myPresenceStatus.type})},t.prototype.setMyPresenceStatus=function(e){return this.performApiPut("v1/users/ME/presenceDocs/messagingService",{callType:this.constants.urls.myPresenceStatus.type},{status:SkypeX.Services.ChatServiceUtils.encodeStatus(e)})},t.prototype.createLongPollSubscriptionId=function(e){return this.performApiPostDetailed("v1/users/ME/endpoints/SELF/subscriptions",{callType:this.constants.urls.longPollSubscription.type},{channelType:"httpLongPoll",interestedResources:e}).then(function(e){return decodeURIComponent(e.headers.location&&_.last(e.headers.location.split("/")))})},t.prototype.updateLongPollInterestedResources=function(e,t){return this.performApiPut("v1/users/ME/endpoints/SELF/subscriptions/"+e+"?name=interestedResources",{callType:this.constants.urls.updateLongPollInterestedResources.type},{channelType:"httpLongPoll",interestedResources:t})},t.prototype.deleteLongPollSubscription=function(e){return this.performApiDelete("v1/users/ME/endpoints/SELF/subscriptions/"+encodeURIComponent(e),{callType:this.constants.urls.longPollSubscription.type})},t.prototype.pollSubscription=function(e,t){return this.performApiPost("v1/users/ME/endpoints/SELF/subscriptions/"+encodeURIComponent(e)+"/poll",{callType:this.constants.urls.longPollSubscription.type,timeout:t,responseType:this.constants.http.responseType.json},{}).then(function(e){return e?e.eventMessages:[]})},t.prototype.postActiveEndpoint=function(e,t){var i=this;return this.performApiPost("v1/users/"+e+"/endpoints/"+encodeURI(t)+"/active",{callType:this.constants.urls.postActiveEndpoint.type,timeout:this.settingsService.valueFor("httpTimeoutMillisPostActiveEndpoint")},{timeout:135}).then(function(e){i.logger.debug("resp:{0}",e)})},t.prototype.getMyConversations=function(e,t,i,n){if(void 0===e&&(e="All"),void 0===t&&(t=1),void 0===i&&(i=null),void 0===n&&(n=this.maxPageSizeForConversations),this.settingsService.valueAsBoolean("simulateChatServiceFailures"))return SkypeX.Services.SyncTasks.Rejected({statusCode:-1});var r="v1/users/ME/conversations?view=msnp24Equivalent";if(r+="&pageSize="+Math.min(n,this.maxPageSizeForConversations),i)r+="&syncState="+encodeURIComponent(i);else{if(t<1)throw"StartTime too low";r+="&startTime="+t,null!=e&&(r+="&targetType="+encodeURIComponent(e))}return this.performApiGet(r,{callType:this.constants.urls.myConversations.type,timeout:this.settingsService.valueFor("httpTimeoutMillisGetMyConversations")})},t.prototype.getTeamConversations=function(e,t,i){void 0===i&&(i=this.maxPageSizeForTeamConversations);var n="v1/threads/"+encodeURIComponent(e)+"/conversations?view=msnp24Equivalent";return n+="&pageSize="+Math.min(i,this.maxPageSizeForTeamConversations),n+=t?"&syncState="+encodeURIComponent(t):"&startTime=0&targetType=Thread",this.performApiGet(n,{callType:this.constants.urls.teamConversationView.type})},t.prototype.setConversationProperty=function(e,t,i,n,r,s){var a="v1/users/ME/conversations/"+encodeURIComponent(e)+"/properties?name="+encodeURIComponent(t);s&&(a+="&requirePermanentJoinedState="+s.toString());var o={};return o[t]=i,this.performApiPut(a,{callType:this.constants.urls.conversationProperty.type,counter:n,skipApply:r},o)},t.prototype.setConversationConsumptionHorizon=function(e,t,i){void 0===i&&(i=!1);var n=i?SkypeX.Services.ChatServiceUtils.ConversationProp_ConsumptionHorizonBookmark:SkypeX.Services.ChatServiceUtils.ConversationProp_ConsumptionHorizon,r=i?this.constants.counters.consumptionHorizonBookmark:this.constants.counters.consumptionHorizon;return this.setConversationProperty(e,n,t,r)},t.prototype.setConversationAlerts=function(e,t){return this.setConversationProperty(e,SkypeX.Services.ChatServiceUtils.ConversationProp_Alerts,t?"true":"false")},t.prototype.getConversationMessages=function(e,t){void 0===t&&(t={}),_.defaults(t,{maxResults:this.maxPageSizeForConvMessages,startTimeUtcMs:1});var i="v1/users/ME/conversations/"+encodeURIComponent(e)+"/messages?view=msnp24Equivalent";if(SkypeX.Services.ChatServiceUtils.isThread(e)&&(i+="|supportsMessageProperties"),i+="&pageSize="+Math.min(t.maxResults,this.maxPageSizeForConvMessages),t.syncState&&(i+="&syncState="+encodeURIComponent(t.syncState)),t.startTimeUtcMs<1)throw"StartTime too low";return i+="&startTime="+t.startTimeUtcMs,_.isUndefined(t.clientCacheClearedAt)||(i+="&clientCacheClearedAt="+t.clientCacheClearedAt),this.performApiGetDetailed(i,{callType:this.constants.urls.conversationMessage.type,eventData:{threadId:e},timeout:this.settingsService.valueFor("httpTimeoutMillisGetConversationMessages")}).then(function(e){return e.object._metadata.contextid=e.headers.contextid,e.object})},t.prototype.getConversationMessage=function(e,t){var i="v1/users/ME/conversations/"+encodeURIComponent(e)+"/messages/"+encodeURIComponent(t)+"?view=msnp24Equivalent|supportsMessageProperties";return this.performApiGetDetailed(i,{callType:this.constants.urls.conversationMessage.type,eventData:{threadId:e,messageId:t}}).then(function(e){return e.object})},t.prototype.getConversationConsumptionHorizons=function(e){var t="v1/threads/"+encodeURIComponent(e)+"/consumptionhorizons";return this.performApiGet(t,{callType:this.constants.urls.consumptionHorizon.type}).then(function(e){return e&&{conversationId:e.id,version:e.version,data:_.map(e.consumptionhorizons,function(e){return{mri:e.id,consumptionHorizon:e.consumptionhorizon}})}})},t.prototype.postMessageToConversation=function(e,t,i,n){return void 0===i&&(i=0),void 0===n&&(n=""),this.performApiPostDetailed("v1/users/ME/conversations/"+encodeURIComponent(e)+"/messages",{callType:this.constants.urls.messageToConversation.type+n,retries:i,eventData:{threadId:e}},t).then(function(e){return{id:e.headers.location&&_.last(e.headers.location.split("/")),originalarrivaltime:e.object&&e.object.OriginalArrivalTime}})},t.prototype.deleteMessage=function(e,t){var i="v1/users/ME/conversations/"+encodeURIComponent(e)+"/messages/"+encodeURIComponent(t)+"?behavior=softDelete";return this.performApiDelete(i,{callType:this.constants.urls.myConversationMessage.type,eventData:{threadId:e,messageId:t}})},t.prototype.editMessage=function(e,t,i){return this.performApiPut("v1/users/ME/conversations/"+encodeURIComponent(e)+"/messages/"+encodeURIComponent(t),{callType:this.constants.urls.messageToConversation.type+"_edit",eventData:{threadId:e,messageId:t}},i)},t.prototype.setMessageProperty=function(e,t,i,n,r){void 0===r&&(r=!1);var s="v1/users/ME/conversations/"+encodeURIComponent(e)+"/messages/"+encodeURIComponent(t)+"/properties?name="+encodeURIComponent(i),a={};a[i]=n;var o={callType:this.constants.urls.messageProperty.type,eventData:{threadId:e,messageId:t}};return r?this.performApiDelete(s,o,a):this.performApiPut(s,o,a)},t.prototype.createThread=function(e,t,i){void 0===i&&(i={}),t&&(i[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName]=t);var n={members:e.map(function(e){return{id:e.id,role:e.role}}),properties:i};return this.performApiPostDetailed("v1/threads",{callType:this.constants.urls.thread.type},n).then(function(e){return{status:e.statusCode,threadId:decodeURIComponent(e.headers.location&&_.last(e.headers.location.split("/")))}})},t.prototype.getThread=function(e){var t="v1/threads/"+encodeURIComponent(e)+"?view=msnp24Equivalent";return this.isLargeTeamsEnabled&&(t+="|"+this.supportsSkipRosterFromThreads),this.performApiGet(t,{callType:this.constants.urls.thread.type,eventData:{threadId:e}})},t.prototype.getThreads=function(e){var t="v1/threads?view=msnp24Equivalent";return this.isLargeTeamsEnabled&&(t+="|"+this.supportsSkipRosterFromThreads),t+="&threadIds="+encodeURIComponent(e.join(",")),this.performApiGet(t,{callType:this.constants.urls.threads.type,timeout:this.settingsService.valueFor("httpTimeoutMillisGetThreads")})},t.prototype.setThreadProperty=function(e,t,i,n){if(!SkypeX.Services.ChatServiceUtils.isThread(e))return SkypeX.Services.SyncTasks.Rejected();var r="v1/threads/"+encodeURIComponent(e)+"/properties?name="+encodeURIComponent(t),s={};return s[t]=i,this.performApiPut(r,{callType:this.constants.urls.threadProperty.type,counter:n,eventData:{threadId:e}},s)},t.prototype.addMemberToThread=function(e,t,i,n,r,s){void 0===i&&(i="Admin");var a="v1/threads/"+encodeURIComponent(e)+"/members/"+t,o={role:i};return _.isNil(r)||(o.shareHistoryTime=r),n&&(o.expiration=n),_.isNil(s)||(o.isFollowing=s),this.performApiPut(a,{callType:this.constants.urls.memberToThread.type,eventData:{threadId:e}},o)},t.prototype.addMembersToThread=function(e,t,i,n){if(!_.isEmpty(t)){var r="v1/threads/"+encodeURIComponent(e)+"/members",s=[];t.forEach(function(e){_.isNil(n)?s.push({id:e.id,role:e.role}):s.push({id:e.id,role:e.role,shareHistoryTime:n})});var a={members:s};return i&&(s.expiration=i),this.performApiPost(r,{callType:this.constants.urls.memberToThread.type,eventData:{threadId:e}},a)}},t.prototype.removeMemberFromThread=function(e,t){var i="v1/threads/"+encodeURIComponent(e)+"/members/"+t;return this.performApiDelete(i,{callType:this.constants.urls.memberToThread.type,eventData:{threadId:e}})},t.prototype.postInvoke=function(e){var t="v1/agents/"+e.botMri+"/invoke",i={value:e.value};return e.threadId&&(i.conversation={id:e.threadId}),e.clientMessageId&&(i.clientMessageId=e.clientMessageId),e.serverMessageId&&(i.serverMessageId=e.serverMessageId),e.messageType&&(i.messageType=e.messageType),e.text&&(i.text=e.text),e.name&&(i.name=e.name),e.imdisplayName&&(i.imdisplayname=e.imdisplayName),this.performApiPost(t,{callType:this.constants.urls.invoke.type},i)},t.prototype.setMemberMuted=function(e,t,i){var n="v1/threads/"+encodeURIComponent(e)+"/members/"+encodeURIComponent(t),r={isReader:i};return this.performApiPut(n,{callType:this.constants.urls.isReaderToMember.type},r)},t.prototype.setMembersMuted=function(e,t,i){var n=this,s=this.loggingService.newScenario(this.constants.scenarios.chatServiceClient.setMembersMuted),a=t.map(function(e){return{id:e,isReader:i}}),o=_.chunk(a,this.BULK_MUTE_BATCH_SIZE),c=_.chunk(o,this.BULK_MUTE_MAX_PARALLEL_REQUESTS);s.eventData.type=i?"Mute":"Unmute",s.eventData.size=t.length,this.logger.info("TeamId: {0}, Batch Count: {1}, Count of Sets of Batches: {2}",e,o.length,c.length);var l=this.$q.resolve(r.Success),p=0,u=0,h=0,d=0;return c.forEach(function(t){l=l.then(function(){return n.performBulkMuteRequestsForSetOfBatches(e,t).then(function(e){return d++,u+=e.successfulRequests,h+=e.partiallySuccessfulRequests,p+=e.failedRequests,n.logger.info("Batch set #{0} results- Success:{1}, Partial Success:{2}, Failure:{3}",d,e.successfulRequests,e.partiallySuccessfulRequests,e.failedRequests),r.Success})})}),l.then(function(){if(n.logger.info("Overall results - Success:{0}, Partial Success:{1}, Failure:{2}",u,h,p),0===h&&0===p)return s.stop(),r.Success;if(s.eventData.errorInfo=JSON.stringify({PartialSuccess:h,Failure:p}),0===h){var e=r.Failure;return s.fail({error:r[e]}),n.$q.reject(e)}var t=r.PartialFailure;return s.fail({error:r[t]}),n.$q.reject(t)})},t.prototype.getTeamMembers=function(e,t,i,n,r,s){void 0===t&&(t=null),void 0===i&&(i=100);var a,o={callType:this.constants.urls.isReaderToMember.type};return t?o.url=t:(a=this.getMembersApiPathForGet(e)+"&pageSize="+i,a+=this.getSelectMemberPropertiesUrlParam(n),a+=this.getSelectMemberRolesUrlParam(r),a+=_.isNil(s)?"":"&filterOnIsReader="+s),this.performApiGet(a,o)},t.prototype.getMembersPropertiesIfInTeam=function(e,t,i){var n="v1/threads/"+encodeURIComponent(e)+"/members?view=msnp24Equivalent";return i&&i.length>0&&(n+=this.getSelectMemberPropertiesUrlParam(i)),n+="&memberIds="+encodeURIComponent(t.join(",")),this.performApiGet(n,{callType:this.constants.urls.isReaderToMember.type})},t.prototype.getMemberPropertiesIfInTeam=function(e,t,i){var n="v1/threads/"+encodeURIComponent(e)+"/members/"+encodeURIComponent(t)+"?view=msnp24Equivalent";return i&&i.length&&(n+=this.getSelectMemberPropertiesUrlParam(i)),this.performApiGet(n,{callType:this.constants.urls.isReaderToMember.type})},t.prototype.getMembersApiPathForGet=function(e){return"v1/threads/"+encodeURIComponent(e)+"/members?view=msnp24Equivalent"},t.prototype.getSelectMemberPropertiesUrlParam=function(e){return e&&e.length?"&selectMemberProperties="+encodeURIComponent(_.map(e,function(e){return SkypeX.Services.MemberProperty[e]}).join("|")):""},t.prototype.getSelectMemberRolesUrlParam=function(e){var t=this;return e&&e.length?"&selectMemberRoles="+encodeURIComponent(_.map(e,function(e){return t.roleDictionary[e]}).join("|")):""},t.prototype.performBulkMuteRequestsForSetOfBatches=function(e,t){var i=this,n="v1/threads/"+encodeURIComponent(e)+"/members",r=[],s=0,a=0,o=0;return r=t.map(function(e){return i.performApiPutDetailed(n,{callType:i.constants.urls.isReaderToMember.type,timeout:i.BULK_MUTE_REQUEST_TIMEOUT_IN_MS},{members:e}).toNgPromise(i.$q)}),this.$q.allSettled(r).then(function(e){return e?e.forEach(function(e,t){if(teamspace.services.PromiseRejectedResult(e))o++;else{var n=e&&e.value?e.value.statusCode:void 0;207===n?a++:200===n?s++:(i.logger.warn("Resolved promise with statusCode: {0}",n),o++)}}):o++,{successfulRequests:s,partiallySuccessfulRequests:a,failedRequests:o}})},t}(SkypeX.Services.GenericRestClient);t.RealChatServiceClient=s},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=SkypeX.Services.ObservableBase,s=SkypeX.Services.SyncTasks,a=[],o=function(){function e(e,t){this.job=e,this.priority=t,this.continuationJobs=[],this.deferred=s.Defer(),this.isRunnable=!0,this.queueTime=Date.now()}return e.prototype.isAheadOf=function(e){return this.queueTime<=e.queueTime&&this.priority<=e.priority},Object.defineProperty(e.prototype,"promise",{get:function(){return this.deferred.promise()},enumerable:!0,configurable:!0}),e}(),c=function(e){function t(t,i,n,r,s){var o=e.call(this)||this;o.$injector=t,o.loggingService=i,o.resourceManager=n,o.settingsService=r,o._scheduledResources={},o.logger=o.loggingService.newLogger("SyncSchedulerService"),o.enableCoalescing=o.settingsService.valueAsBoolean("enableSyncJobCoalescing");var c=s||_.first(a);return c&&(o._activeStrategy=t.instantiate(c,{scheduler:o})),o}return n(t,e),t.$inject=["$injector","loggingService","resourceManager","settingsService","forceStrategy"],t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this.scheduleImpl(e,t)},t.prototype.start=function(e){this._activeStrategy&&this._activeStrategy.start(e)},t.prototype.pause=function(){this._activeStrategy&&this._activeStrategy.stop(),_.forEach(this._scheduledResources,function(e){return e.job.abort()})},Object.defineProperty(t.prototype,"scheduledResources",{get:function(){return this._scheduledResourceTags||(this._scheduledResourceTags=_.keys(this._scheduledResources)),this._scheduledResourceTags},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeStrategy",{get:function(){return this._activeStrategy},enumerable:!0,configurable:!0}),t.prototype.executeJob=function(e){var t;if(e.isRunnable&&e.job.isValid()){var i=this.getExecutionContext(e);(t=e.job.execute(i)).then(function(t){s.whenAll(_.map(e.continuationJobs,function(e){return e.promise})).then(function(){return e.deferred.resolve(t)}).fail(function(t){return e.deferred.reject(t)})}).fail(function(t){return e.deferred.reject(t)})}else this.logger.info("Scheduled job is not runnable/valid: {0}",_.join(e.job.resourceTags(),",")),e.job.abort(),e.deferred.reject("Scheduled job is not runnable/valid. The job was aborted."),t=s.Resolved();return t},t.prototype.getExecutionContext=function(e){var t=this,i={chatServiceClient:this.$injector.get("chatServiceClient"),prefetchService:this.$injector.get("dataPrefetchService"),teamsDataService:this.$injector.get("teamsDataService"),syncStateService:this.$injector.get("syncStateService"),conversationsStore:this.$injector.get("conversationsStore"),messageStore:this.$injector.get("messageStore"),replyChainStore:this.$injector.get("replyChainStore"),settingsService:this.$injector.get("settingsService"),loggingService:this.$injector.get("loggingService"),constants:this.$injector.get("constants"),logger:this.logger,pushFront:function(e){return null},schedule:function(e,t){return null},persistenceService:this.$injector.get("persistenceService")},n=0===e.priority?teamspace.services.TaskPriority.RealTime:teamspace.services.TaskPriority.Normal;return i.pushFront=function(i){var r=t.scheduleImpl(i,e.priority,n);e.continuationJobs.push(r)},i.schedule=function(i){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var s=t.schedule.apply(t,[i].concat(n));e.continuationJobs.push(s)},i},t.prototype.coalesceJob=function(e){var t=e.job.resourceTags()||[];if(1!==t.length)return!0;var i=_.first(t),n=this._scheduledResources[i],r=!0;return n&&n.isAheadOf(e)&&(n.promise.then(function(t){return e.deferred.resolve(t)}).fail(function(t){return e.deferred.reject(t)}),r=!1),r},t.prototype.scheduleImpl=function(e,t,i){var n=new o(e,t);return(!this.enableCoalescing||this.coalesceJob(n))&&(this.watchResource(n),this.enqueueOnResourceManager(n,i)),n},t.prototype.enqueueOnResourceManager=function(e,t){var i=this;_.isUndefined(t)&&(t=0===e.priority?teamspace.services.TaskPriority.RealTime:teamspace.services.TaskPriority.Background),e.rmTask=this.resourceManager.scheduleTask({task:function(){return i.executeJob(e)},priority:t,type:"sync",tag:e.job.resourceTags().join(",")})},t.prototype.watchResource=function(e){var t=this,i=function(){t._scheduledResourceTags=null,t.trigger()};_.forEach(e.job.resourceTags(),function(i){return t._scheduledResources[i]=e}),i(),e.deferred.promise().finally(function(){_.forEach(e.job.resourceTags(),function(e){return delete t._scheduledResources[e]}),i()})},t}(r);t.SyncSchedulerService=c,t.registerSyncStrategy=function(e){a.push(e)}},function(e,t,i){"use strict";function n(e){return"ReplyChainView:"+e}var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.getReplyChainViewId=n;var s=function(e){function t(t,i,n){var r=e.call(this)||this;return r.clientDatabase=t,r.loggingService=i,r.messageStore=n,r.logger=r.loggingService.newLogger("PersistenceService"),r}return r(t,e),t.$inject=["clientDatabase","loggingService","messageStore"],t.prototype.putReplyChains=function(e){if(!e||0===e.length)return SkypeX.Services.SyncTasks.Resolved();this.logger.debug("putReplyChains, replyChains.length: {0}",e.length);var t=_.flatten(_.map(e,function(e){return e.messages}));return this.messageStore.putMessagesToDb(t)},t.prototype.getReplyChains=function(e,t){return e&&t&&0!==t.length?this.messageStore.getReplyChains(e,t):SkypeX.Services.SyncTasks.Resolved([])},t.prototype.removeClientLieMessage=function(e,t,i){return this.messageStore.removeClientLieMessage(e,t,i)},t.prototype.removeReplyChainsView=function(e){var t=n(e);return this.clientDatabase.provider.remove(this.clientDatabase.schema.stores.internaldata.name,t)},t.prototype.putReplyChainsView=function(e,t){var i=this;return e&&t?this.messageStore.getWriteActionsQueue().schedule(function(){return i.clientDatabase.provider.put(i.clientDatabase.schema.stores.internaldata.name,{id:n(e),value:{replyChainIndexes:t.replyChainIndexes,earliestReplyChainDeliveryTime:t.earliestReplyChainDeliveryTime,cursorToken:t.cursorToken,headViewOptions:{conversationId:e,count:t.headViewOptions.count}}})}):SkypeX.Services.SyncTasks.Resolved()},t.prototype.getReplyChainsView=function(e){return this.clientDatabase.provider.get(this.clientDatabase.schema.stores.internaldata.name,n(e)).then(function(e){return e&&e.value})},t}(SkypeX.Services.SXStoreBase);t.PersistenceService=s,angular.module("skypeX.persistenceService",[]).service("persistenceService",s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=teamspace.services.CallingTelemetryService,r=teamspace.services.ContentSharingErrorCode,s=teamspace.services.SessionUtils,a=function(){function e(e,t,i,n,r,s,a,o,c,l){this.$q=e,this.settingsService=t,this.constants=i,this.tabService=n,this.extensionDefinitionService=r,this.dialogService=s,this.eventingService=a,this.meetingAppsUtilityService=o,this.resources=c,this.logger=l.newLogger("InvisionWhiteboardProvider")}return e.$inject=["$q","settingsService","constants","tabService","extensionDefinitionService","dialogService","eventingService","meetingAppsUtilityService","resources","loggingService"],e.prototype.getProvidedType=function(){return"invision_whiteboard"},e.prototype.whiteboardTabExtensionToSharingContent=function(e){return{type:"invision_whiteboard",url:e.context.url}},e.prototype.findExistingWhiteboard=function(e){var t=this;return this.tabService.getTabs(e).then(function(e){var i=e.find(function(e){return e.definitionId===t.constants.whiteboard.invisionAppId});return i?t.whiteboardTabExtensionToSharingContent(i):null})},e.prototype.ensureAppInstalled=function(e,t,i){var n=this;return this.meetingAppsUtilityService.isAppInstalled(e,t,i).then(function(r){return!!r||n.meetingAppsUtilityService.showAddAppDialog(e,t,i)}).then(function(e){return e?n.$q.resolve():n.$q.reject({code:teamspace.services.ContentSharingErrorCode.Cancelled,cause:"App was not installed by user"})})},e.prototype.createWhiteboard=function(e,t){var i,n=this,r=this.constants.whiteboard.invisionAppId;return this.tabService.getTabs(e).then(function(e){return n.tabService.setTabs(e)}).then(function(){return n.ensureAppInstalled(e,t,r)}).then(function(){return n.extensionDefinitionService.getExtensionDefinition(r)}).then(function(t){var i=new teamspace.services.ExtensionInstanceViewModel(t,n.constants);return n.dialogService.open(n.constants.dialogs.tabInstanceConfiguration,{tabDefinition:t,tabInstance:i,threadId:e,operationType:teamspace.components.DialogTabMenuOperationType.AddTabSettings,backToTabGallery:!1})}).then(function(e){return n.$q(function(t,r){var s;e.closePromise.then(function(){s||r({code:teamspace.services.ContentSharingErrorCode.Cancelled,cause:"User dismissed creation dialog"}),t(s)}),i=n.eventingService.unsafeOn(n.constants.events.tab.instance.created,function(e,t){var i=t.tab;i.definitionId===n.constants.whiteboard.invisionAppId&&(s=i)})})}).then(function(e){return n.whiteboardTabExtensionToSharingContent(e)}).finally(function(){i&&i(),n.tabService.setTabs(null)})},e.prototype.isPrivateMeeting=function(e){return!e||"0"===e},e.prototype.getShareContent=function(e){return this.meetingAppsUtilityService.getDefinition(e.conversationId,e.messageId,this.constants.whiteboard.invisionAppId).then(function(t){return[{type:"invision_whiteboard",url:null,icon:t.largeImageUrl,conversationId:e.conversationId,messageId:e.messageId}]})},e.prototype.onContentShareStarting=function(e,t){var i=this;return t.appendEventData({meetingType:this.isPrivateMeeting(e.messageId)?"private":"channel"}),e.url?this.$q.resolve():e.conversationId?this.findExistingWhiteboard(e.conversationId).then(function(n){return n||(t.pause({reason:"displaying UI to create whiteboard"}),i.createWhiteboard(e.conversationId,e.messageId))}).then(function(t){e.url=t.url}).finally(function(){return t.resume()}):this.$q.reject("No conversation id available")},e.prototype.verifyUrl=function(e){if(!e)return!1;try{return new RegExp(this.settingsService.valueFor(this.constants.settings.names.invisionWhiteboardUrlRegexp)).test(e)}catch(e){return!1}},e.prototype.contentShareToDto=function(e){return this.verifyUrl(e.url)?this.$q.resolve(_.cloneDeep(e)):this.$q.reject({code:teamspace.services.ContentSharingErrorCode.DtoCreationFailed,message:this.resources.strings.calling_contentsharing_error_message_presenter_generic_error,cause:"Invalid url found in DTO"})},e.prototype.dtoToSubject=function(e){},e.prototype.startSession=function(e,t){return this.$q.resolve(new teamspace.services.WhiteboardSharingSession(e.type,t.contentSharingGuid,e,t))},e.prototype.startOutgoingSession=function(e,t){return this.startSession(e,t)},e.prototype.startIncomingSession=function(e,t){return this.startSession(e,t)},e.prototype.handleStartError=function(e,t){e&&e.code===r.Cancelled?(this.logger.warn("start content sharing session cancelled: "+e.code),t.incomplete({reason:e.code})):(this.logger.error("cannot start content sharing session: "+(e&&e.code)),t.fail({reason:n.getErrorMessage(e&&e.cause||e),errorCode:e&&e.code}))},e.prototype.handleError=function(e,t,i){i.fail({reason:n.getErrorMessage(e&&e.cause||e),errorCode:e&&e.code}),t&&_.includes([0,1,3],t.contentSharingStatus)&&(this.logger.error("Error "+e.code+", terminating PPT sharing for session "+t.contentSharingGuid),s.safeCall(function(){return t.stopContentSharing()}))},e}();t.InvisionWhiteboardProvider=a,angular.module("teamspace.invisionWhiteboardProvider",["teamspace.settingsService","teamspace.constants","teamspace.tabService","teamspace.extensionDefinitionService","teamspace.dialogService","teamspace.eventingService","teamspace.loggingService","teamspace.meetingAppsUtilityService"]).service("invisionWhiteboardProvider",a)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=teamspace.services.CallingTelemetryService,s=teamspace.services.ContentSharingErrorCode,a=teamspace.services.SessionUtils;!function(e){e[e.FailedGettingOrganizerId=1e3]="FailedGettingOrganizerId",e[e.FailedGettingWhiteboardUrl=1001]="FailedGettingWhiteboardUrl",e[e.NoConversationId=1002]="NoConversationId"}(n=t.WhiteboardErrorCode||(t.WhiteboardErrorCode={}));var o=function(){function e(e,t,i,n,r,s,a,o,c,l){this.$q=e,this.$translate=t,this.settingsService=i,this.constants=n,this.whiteboardClient=r,this.conversationsService=s,this.messageService=a,this.authenticationService=o,this.resources=c,this.logger=l.newLogger("WhiteboardProvider")}return e.$inject=["$q","$translate","settingsService","constants","whiteboardClient","conversationsService","messageService","authenticationService","resources","loggingService"],e.prototype.getProvidedType=function(){return"whiteboard"},e.prototype.isPrivateMeeting=function(e){return!e||"0"===e},e.prototype.getOrganizerId=function(e,t){var i=this;if(this.isPrivateMeeting(t)){var r=this.conversationsService.getConversation(e);return this.$q.resolve(r&&_.get(r.threadProperties,"creator"))}return this.messageService.getReplyChain(e,t,"",1).then(function(e){return e&&e.firstMessage&&e.firstMessage.creator}).catch(function(e){return i.$q.reject({code:n.FailedGettingOrganizerId,message:i.$translate.instant(i.resources.strings.calling_contentsharing_error_message_presenter_generic_error),cause:e})})},e.prototype.getTenantId=function(e){var t=this.conversationsService.getConversation(e),i=t&&_.get(t.threadProperties,"tenantid");return i?this.$q.resolve(i):this.authenticationService.getUserInformation().then(function(e){return e.profile.tid})},e.prototype.getMeetingWhiteboard=function(e,t){var i=this;return this.$q.all([this.getOrganizerId(e,t),this.getTenantId(e)]).then(function(r){var s=r[0],a=r[1];return s?i.whiteboardClient.getWhiteboardUrl(e,t,s,a).then(function(e){return{type:"whiteboard",url:e}}).catch(function(e){return i.$q.reject({code:n.FailedGettingWhiteboardUrl,message:i.$translate.instant(i.resources.strings.calling_contentsharing_error_message_presenter_generic_error),cause:e})}):i.$q.reject({code:n.FailedGettingOrganizerId,message:i.$translate.instant(i.resources.strings.calling_contentsharing_error_message_presenter_generic_error),cause:"Organizer id is null"})})},e.prototype.getShareContent=function(e){return this.$q.resolve([{type:"whiteboard",url:null,conversationId:e.conversationId,messageId:e.messageId}])},e.prototype.onContentShareStarting=function(e,t){return t.appendEventData({meetingType:this.isPrivateMeeting(e.messageId)?"private":"channel"}),e.url?this.$q.resolve():e.conversationId?this.getMeetingWhiteboard(e.conversationId,e.messageId).then(function(t){e.url=t.url}):this.$q.reject({code:n.NoConversationId,message:this.$translate.instant(this.resources.strings.calling_contentsharing_error_message_presenter_generic_error),cause:"No conversation id provided"})},e.prototype.verifyUrl=function(e){if(!e)return!1;try{return new RegExp(this.settingsService.valueFor(this.constants.settings.names.whiteboardUrlRegexp)).test(e)}catch(e){return!1}},e.prototype.contentShareToDto=function(e){return this.verifyUrl(e.url)?this.$q.resolve(_.cloneDeep(e)):this.$q.reject({code:teamspace.services.ContentSharingErrorCode.DtoCreationFailed,message:this.$translate.instant(this.resources.strings.calling_contentsharing_error_message_presenter_generic_error),cause:"Invalid url found in DTO"})},e.prototype.dtoToSubject=function(e){},e.prototype.startSession=function(e,t){return this.$q.resolve(new teamspace.services.WhiteboardSharingSession(e.type,t.contentSharingGuid,e,t))},e.prototype.startOutgoingSession=function(e,t){return this.startSession(e,t)},e.prototype.startIncomingSession=function(e,t){return this.startSession(e,t)},e.prototype.handleStartError=function(e,t){e&&e.code===s.Cancelled?(this.logger.warn("start content sharing session cancelled: "+e.code),t.incomplete({reason:e.code})):(this.logger.error("cannot start content sharing session: "+(e&&e.code)),t.fail({reason:r.getErrorMessage(e&&e.cause||e),errorCode:e&&e.code}))},e.prototype.handleError=function(e,t,i){i.fail({reason:r.getErrorMessage(e&&e.cause||e),errorCode:e&&e.code}),t&&_.includes([0,1,3],t.contentSharingStatus)&&(this.logger.error("Error "+e.code+", terminating PPT sharing for session "+t.contentSharingGuid),a.safeCall(function(){return t.stopContentSharing()}))},e}();t.WhiteboardProvider=o,angular.module("teamspace.whiteboardProvider",["teamspace.settingsService","teamspace.constants","teamspace.whiteboardClient","teamspace.conversationsService","teamspace.messageService","teamspace.authenticationService","teamspace.locales","teamspace.loggingService"]).service("whiteboardProvider",o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Dequeue=0]="Dequeue",e[e.Peek=1]="Peek"}(n||(n={}));var r=function(){function e(e){var t=this;this.isDrainInProgress=!1,this.isDisposing=!1,this.disposeReason=null,this.list=[],this.readers=[],e&&e.forEach(function(e){t.list=t.list.concat(Promise.resolve(e))})}return e.prototype.enqueue=function(e){this.throwIfDispose(),this.enqueueFromPromise(Promise.resolve(e))},e.prototype.enqueueFromPromise=function(e){this.throwIfDispose(),this.list=this.list.concat(e),this.drain()},e.prototype.dequeue=function(){return this.addReaderRequest(n.Dequeue)},e.prototype.peek=function(){return this.addReaderRequest(n.Peek)},e.prototype.length=function(){return this.throwIfDispose(),this.list.length},e.prototype.isDisposed=function(){return!this.readers},e.prototype.drainAndDispose=function(e,t){var i=this;return this.isDisposed()||this.isDisposing?Promise.resolve(!0):(this.disposeReason=t,this.isDisposing=!0,this.readers.forEach(function(e){e.reject("disposed")}),this.readers=null,Promise.all(this.list).then(function(t){return e&&t.forEach(function(t){e(t)}),i.list=null,!0}))},e.prototype.dispose=function(e){this.drainAndDispose(null,e)},e.prototype.addReaderRequest=function(e){var t=this;return this.throwIfDispose(),new Promise(function(i,n){t.readers=t.readers.concat({type:e,resolve:i,reject:n}),t.drain()})},e.prototype.drain=function(){if(!this.isDrainInProgress&&!this.isDisposing){this.isDrainInProgress=!0;for(var e=this;this.list.length>0&&this.readers.length>0&&!this.isDisposing;)!function(){var t=e.readers.splice(0,1)[0];t.type===n.Peek?e.list[0].then(function(e){t.resolve(e)}):e.list.splice(0,1)[0].then(function(e){t.resolve(e)})}();this.isDrainInProgress=!1}},e.prototype.throwIfDispose=function(){if(this.isDisposed())throw new Error(this.disposeReason);if(this.isDisposing)throw new Error("disposing queue")},e}();t.Queue=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RIFFConstants={headerLength:46,riffChunkId:"RIFF",dataChunkId:"data"},t.RIFFHeadersOffset={riffHeaderId:0,fileSize:4,waveTag:8,waveFormatChunkLength:16,formatTag:20,channelCount:22,sampleRate:24,avgBytesPerSec:28,blockAlign:32,bitsPerSample:34,cbSize:36,dataChunkId:38,dataChunkLength:42}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.skillId=e,this.providerCallback=null}return e.prototype.registerCallback=function(e){this.providerCallback=e},e.prototype.clearCallback=function(){this.providerCallback=null},e.prototype.triggerConfigUpdated=function(){this.providerCallback&&this.providerCallback(this.skillId)},e}();t.CortanaConfigProviderBase=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CortanaJSEvents={listeningStarted:"listeningStarted",recognitionStarted:"recognitionStarted",recognitionEnded:"recognitionEnded",speechStartDetected:"speechStartDetected",speechEndDetected:"speechEndDetected",speechHypothesis:"speechHypothesis",speechPhrase:"speechPhrase",cortanaResponded:"cortanaResponded",clientSkillInvoked:"clientSkillInvoked"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecognitionStatus={Success:"Success",NoMatch:"NoMatch",InitialSilenceTimeout:"InitialSilenceTimeout",BabbleTimeout:"BabbleTimeout",Error:"Error",EndOfDictation:"EndOfDictation"};!function(e){e[e.Success=0]="Success",e[e.AudioSourceError=1]="AudioSourceError",e[e.AudioSourceTimeout=2]="AudioSourceTimeout",e[e.AuthTokenFetchError=3]="AuthTokenFetchError",e[e.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",e[e.UnAuthorized=5]="UnAuthorized",e[e.ConnectTimeout=6]="ConnectTimeout",e[e.ConnectError=7]="ConnectError",e[e.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",e[e.UnknownError=9]="UnknownError"}(t.RecognitionCompletionStatus||(t.RecognitionCompletionStatus={}))},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(22);t.RecognitionEvents={listeningStarted:"ListeningStartedEvent",recognitionStarted:"RecognitionStartedEvent",speechStartDetected:"SpeechStartDetectedEvent",speechHypothesis:"SpeechHypothesisEvent",speechEndDetected:"SpeechEndDetectedEvent",speechSimplePhrase:"SpeechSimplePhraseEvent",speechDetailedPhrase:"SpeechDetailedPhraseEvent",recognitionEnded:"RecognitionEndedEvent",cortanaResponded:"CortanaResponseEvent"};var s=function(){return function(e,t,i){this.eventName=e,this.eventId=r.CortanaUtilities.createNoDashGuid(),this.requestId=t,this.eventTime=(new Date).toISOString(),this.serviceTag=i}}();t.SpeechRecognitionEvent=s;var a=function(e){function t(t,i,n,r){var s=e.call(this,t,i,r)||this;return s.result=n,s}return n(t,e),t}(s);t.SpeechRecognitionResultEvent=a;var o=function(e){function i(i){return e.call(this,t.RecognitionEvents.listeningStarted,i)||this}return n(i,e),i}(s);t.ListeningStartedEvent=o;var c=function(e){function i(i,n){return e.call(this,t.RecognitionEvents.recognitionStarted,i,n)||this}return n(i,e),i}(s);t.RecognitionStartedEvent=c;var l=function(e){function i(i,n,r,s){return e.call(this,t.RecognitionEvents.recognitionEnded,i,{status:r,error:s},n)||this}return n(i,e),i}(a);t.RecognitionEndedEvent=l;var p=function(e){function i(i,n){return e.call(this,t.RecognitionEvents.speechStartDetected,i,n)||this}return n(i,e),i}(a);t.SpeechStartDetectedEvent=p;var u=function(e){function i(i,n){return e.call(this,t.RecognitionEvents.speechEndDetected,i,n)||this}return n(i,e),i}(a);t.SpeechEndDetectedEvent=u;var h=function(e){function i(i,n){return e.call(this,t.RecognitionEvents.speechHypothesis,i,n)||this}return n(i,e),i}(a);t.SpeechHypothesisEvent=h;var d=function(e){function i(i,n){return e.call(this,t.RecognitionEvents.speechSimplePhrase,i,n)||this}return n(i,e),i}(a);t.SpeechSimplePhraseEvent=d;var g=function(e){function i(i,n){return e.call(this,t.RecognitionEvents.speechDetailedPhrase,i,n)||this}return n(i,e),i}(a);t.SpeechDetailedPhraseEvent=g;var v=function(e){function i(i,n,r){return e.call(this,t.RecognitionEvents.cortanaResponded,i,r,n)||this}return n(i,e),i}(a);t.CortanaResponseEvent=v},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i){this.resources=e,this.$translate=t,this.localizationService=i}return e.$inject=["resources","$translate","localizationService"],e.prototype.updateDateSeparators=function(e){if(e&&!(e.length<2)){e.sort(teamspace.services.MessagingUtilities.sortByOrderTimeAscending);var t=Date.now(),i=new Date(t);i.setHours(0,0,0,0);var n=t-i.getTime(),r=null,s=null,a=!1,o=_.findIndex(e,function(e){return e.orderTimeMessage&&e.orderTimeMessage.hasBeenClientLie}),c=o>-1,l=e.length-1;if(c){l=o;for(p=o;p<e.length;p++)e[p].formatDate=null}for(var p=l;p>=0;p--){var u=e[p],h=new Date(u.orderTime).toDateString(),d=!1;if(r){var g=t-u.orderTime,v=t-r.orderTime,m=g<=n,f=v<=n,S=v<=n+864e5;c&&!a&&u.orderTimeMessage&&!u.orderTimeMessage.hasBeenClientLie&&!m||!c&&h!==s&&f?(u.formatDate=this.$translate.instant(this.resources.strings.activity_date_today),a=d=!0):(!c||c&&a)&&h!==s&&(u.formatDate=S?this.$translate.instant(this.resources.strings.activity_date_yesterday):this.localizationService.getDate(r.orderTime,"longDate"),d=!0)}d||(u.formatDate=null),r=u,s=h}}},e}();t.DateSeparatorService=n,angular.module("teamspace.dateSeparatorService",["pascalprecht.translate","teamspace.localizationService"]).service("dateSeparatorService",n)},function(e,t,i){"use strict";function n(e){switch(e.arrayFormat){case"index":return function(t,i,n){return null===i?[s(t,e),"[",n,"]"].join(""):[s(t,e),"[",s(n,e),"]=",s(i,e)].join("")};case"bracket":return function(t,i){return null===i?s(t,e):[s(t,e),"[]=",s(i,e)].join("")};default:return function(t,i){return null===i?s(t,e):[s(t,e),"=",s(i,e)].join("")}}}function r(e){var t;switch(e.arrayFormat){case"index":return function(e,i,n){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=i):n[e]=i};case"bracket":return function(e,i,n){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],i):n[e]=[i]:n[e]=i};default:return function(e,t,i){void 0!==i[e]?i[e]=[].concat(i[e],t):i[e]=t}}}function s(e,t){return t.encode?t.strict?o(e):encodeURIComponent(e):e}function a(e){return Array.isArray(e)?e.sort():"object"==typeof e?a(Object.keys(e)).sort(function(e,t){return Number(e)-Number(t)}).map(function(t){return e[t]}):e}var o=i(317),c=i(318),l=i(319);t.extract=function(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)},t.parse=function(e,t){var i=r(t=c({arrayFormat:"none"},t)),n=Object.create(null);return"string"!=typeof e?n:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach(function(e){var t=e.replace(/\+/g," ").split("="),r=t.shift(),s=t.length>0?t.join("="):void 0;s=void 0===s?null:l(s),i(l(r),s,n)}),Object.keys(n).sort().reduce(function(e,t){var i=n[t];return Boolean(i)&&"object"==typeof i&&!Array.isArray(i)?e[t]=a(i):e[t]=i,e},Object.create(null))):n},t.stringify=function(e,t){!1===(t=c({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=function(){});var i=n(t);return e?Object.keys(e).sort(t.sort).map(function(n){var r=e[n];if(void 0===r)return"";if(null===r)return s(n,t);if(Array.isArray(r)){var a=[];return r.slice().forEach(function(e){void 0!==e&&a.push(i(n,e,a.length))}),a.join("&")}return s(n,t)+"="+s(r,t)}).filter(function(e){return e.length>0}).join("&"):""},t.parseUrl=function(e,t){return{url:e.split("?")[0]||"",query:this.parse(this.extract(e),t)}}},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(35),s=i(46),a=function(){return function(e){this.default="#000000",this.subtle="#666666",e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)}}();t.TextColorDefinition=a;var o=function(){return function(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)}}();t.AdaptiveCardConfig=o;var c=function(){function e(e){this.imageSize=r.Size.Medium,this.maxImageHeight=100,e&&(this.imageSize=null!=e.imageSize?e.imageSize:this.imageSize,this.maxImageHeight=s.getValueOrDefault(e.maxImageHeight,100))}return e.prototype.toJSON=function(){return{imageSize:r.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},e}();t.ImageSetConfig=c;var l=function(){function e(e){this.size=r.TextSize.Default,this.color=r.TextColor.Default,this.isSubtle=!1,this.weight=r.TextWeight.Default,this.wrap=!0,e&&(this.size=s.parseHostConfigEnum(r.TextSize,e.size,r.TextSize.Default),this.color=s.parseHostConfigEnum(r.TextColor,e.color,r.TextColor.Default),this.isSubtle=e.isSubtle||this.isSubtle,this.weight=s.parseHostConfigEnum(r.TextWeight,e.weight,r.TextWeight.Default),this.wrap=null!=e.wrap?e.wrap:this.wrap)}return e.prototype.toJSON=function(){return{size:r.TextSize[this.size],color:r.TextColor[this.color],isSubtle:this.isSubtle,weight:r.TextWeight[this.weight],warp:this.wrap}},e}();t.FactTextDefinition=l;var p=function(e){function t(t){var i=e.call(this,t)||this;return i.maxWidth=150,i.weight=r.TextWeight.Bolder,t&&(i.maxWidth=null!=t.maxWidth?t.maxWidth:i.maxWidth),i}return n(t,e),t}(l);t.FactTitleDefinition=p;var u=function(){return function(e){this.title=new p,this.value=new l,this.spacing=10,e&&(this.title=new p(e.title),this.value=new l(e.value),this.spacing=e.spacing&&null!=e.spacing?e.spacing&&e.spacing:this.spacing)}}();t.FactSetConfig=u;var h=function(){function e(e){this.actionMode=r.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=r.ContainerStyle.Emphasis,e&&(this.actionMode=s.parseHostConfigEnum(r.ShowCardActionMode,e.actionMode,r.ShowCardActionMode.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:r.ContainerStyle.Emphasis)}return e.prototype.toJSON=function(){return{actionMode:r.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},e}();t.ShowCardActionConfig=h;var d=function(){function e(e){this.maxActions=5,this.spacing=r.Spacing.Default,this.buttonSpacing=20,this.showCard=new h,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=r.Orientation.Horizontal,this.actionAlignment=r.ActionAlignment.Left,e&&(this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=s.parseHostConfigEnum(r.Spacing,e.spacing&&e.spacing,r.Spacing.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new h(e.showCard),this.preExpandSingleShowCardAction=s.getValueOrDefault(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=s.parseHostConfigEnum(r.Orientation,e.actionsOrientation,r.Orientation.Horizontal),this.actionAlignment=s.parseHostConfigEnum(r.ActionAlignment,e.actionAlignment,r.ActionAlignment.Left))}return e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:r.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:r.Orientation[this.actionsOrientation],actionAlignment:r.ActionAlignment[this.actionAlignment]}},e}();t.ActionsConfig=d;var g=function(){function e(e){this.foregroundColors={default:new a,dark:new a,light:new a,accent:new a,good:new a,warning:new a,attention:new a},this.parse(e)}return e.prototype.getTextColorDefinitionOrDefault=function(e,t){return new a(e||t)},e.prototype.parse=function(e){e&&(this.backgroundColor=e.backgroundColor,e.foregroundColors&&(this.foregroundColors.default=this.getTextColorDefinitionOrDefault(e.foregroundColors.default,{default:"#333333",subtle:"#EE333333"}),this.foregroundColors.dark=this.getTextColorDefinitionOrDefault(e.foregroundColors.dark,{default:"#000000",subtle:"#66000000"}),this.foregroundColors.light=this.getTextColorDefinitionOrDefault(e.foregroundColors.light,{default:"#FFFFFF",subtle:"#33000000"}),this.foregroundColors.accent=this.getTextColorDefinitionOrDefault(e.foregroundColors.accent,{default:"#2E89FC",subtle:"#882E89FC"}),this.foregroundColors.good=this.getTextColorDefinitionOrDefault(e.foregroundColors.good,{default:"#54A254",subtle:"#DD54A254"}),this.foregroundColors.warning=this.getTextColorDefinitionOrDefault(e.foregroundColors.warning,{default:"#E69500",subtle:"#DDE69500"}),this.foregroundColors.attention=this.getTextColorDefinitionOrDefault(e.foregroundColors.attention,{default:"#CC3300",subtle:"#DDCC3300"})))},Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!0,configurable:!0}),e}();t.ContainerStyleDefinition=g;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!0,configurable:!0}),t}(g),m=function(){function e(e){if(this._allStyles={},this._allStyles[r.ContainerStyle.Default]=new v,this._allStyles[r.ContainerStyle.Emphasis]=new v,e){this._allStyles[r.ContainerStyle.Default].parse(e[r.ContainerStyle.Default]),this._allStyles[r.ContainerStyle.Emphasis].parse(e[r.ContainerStyle.Emphasis]);var t=e.customStyles;if(t&&Array.isArray(t))for(var i=0,n=t;i<n.length;i++){var s=n[i];if(s){var a=s.name;a&&"string"==typeof a&&(this._allStyles.hasOwnProperty(a)?this._allStyles[a].parse(s.style):this._allStyles[a]=new g(s.style))}}}}return e.prototype.toJSON=function(){var e=this,t=[];Object.keys(this._allStyles).forEach(function(i){e._allStyles[i].isBuiltIn||t.push({name:i,style:e._allStyles[i]})});var i={default:this.default,emphasis:this.emphasis};return t.length>0&&(i.customStyles=t),i},e.prototype.getStyleByName=function(e,t){return void 0===t&&(t=null),this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t},Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[r.ContainerStyle.Default]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[r.ContainerStyle.Emphasis]},enumerable:!0,configurable:!0}),e}();t.ContainerStyleSet=m;var f=function(){function e(e){this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new m,this.actions=new d,this.adaptiveCard=new o,this.imageSet=new c,this.factSet=new u,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder},this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new m(e.containerStyles),this.spacing={small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.actions=new d(e.actions||this.actions),this.adaptiveCard=new o(e.adaptiveCard||this.adaptiveCard),this.imageSet=new c(e.imageSet),this.factSet=new u(e.factSet))}return e.prototype.getEffectiveSpacing=function(e){switch(e){case r.Spacing.Small:return this.spacing.small;case r.Spacing.Default:return this.spacing.default;case r.Spacing.Medium:return this.spacing.medium;case r.Spacing.Large:return this.spacing.large;case r.Spacing.ExtraLarge:return this.spacing.extraLarge;case r.Spacing.Padding:return this.spacing.padding;default:return 0}},e}();t.HostConfig=f},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s){this.$qNoApply=e,this.constants=t,this.fileReaderAdapterFactory=i,this.utilityService=n,this.loggingService=r,this.googleFilesRepository=s,this.uploadStatusList={},this.uploadIdKey="upload_id"}return e.$inject=["$qNoApply","constants","fileReaderAdapterFactory","utilityService","loggingService","googleFilesRepository"],Object.defineProperty(e.prototype,"providerTypes",{get:function(){return[teamspace.services.files.FilesProviderType.Google]},enumerable:!0,configurable:!0}),e.prototype.upload=function(e){var t=this,i=this.$qNoApply.defer();if(!e||!e.fileName)return this.loggingService.error("[Upload Repository] the input is invalid. This is a bug."),this.$qNoApply.reject(this.getError(this.constants.files.error.unknown));if(!e.file||0===e.file.size)return this.loggingService.info("[Upload Repository] UploadId: "+e.uploadId+" file size is empty. Aborting upload."),this.$qNoApply.reject(this.getError(this.constants.files.error.fileEmpty));var n={id:e.uploadId,file:e.file,totalCalls:Math.ceil(e.file.size/this.constants.files.upload.externalFilesChunkSize),completedCalls:0,status:teamspace.services.files.modules.fileUpload.UploadState.UploadInProgress,serviceName:e.serviceName,channelId:e.channelId,folderRelativeUrl:e.parentServerRelativeUrl,fileName:e.fileName,fileType:e.file.type};this.uploadStatusList[e.uploadId]=n,this.loggingService.info("[Upload Repository] UploadId: "+e.uploadId+" Initiating file creation.");var r={itemId:"",itemName:e.fileName,provider:e.destinationProvider,serviceName:e.serviceName,parentFolderId:e.parentServerRelativeUrl,uploadId:"",uploadData:"",uploadDataLength:0,startingPosition:0,totalLength:0};return this.uploadToGoogle(e.uploadId,r).then(function(r){t.loggingService.info("[Upload Repository] UploadId: "+e.uploadId+" Upload to google succeeded."),n.status=teamspace.services.files.modules.fileUpload.UploadState.UploadCompleted;var s=t.buildUploadSuccessResults(n,r);t.uploadStatusList[e.uploadId]=void 0,i.resolve(s)},function(r){t.loggingService.info("[Upload Repository] UploadId: "+e.uploadId+" Upload to google failed."),n.status=teamspace.services.files.modules.fileUpload.UploadState.UploadCompleted,t.uploadStatusList[e.uploadId]=void 0,i.reject(r)},function(e){return i.notify(e)}),i.promise},e.prototype.cancelUpload=function(e){var t=this.uploadStatusList[e];return t&&(this.loggingService.info("[Upload Repository] UploadId: "+e+" Upload cancelled."),t.status=teamspace.services.files.modules.fileUpload.UploadState.UploadCancelled),this.$qNoApply.resolve()},e.prototype.generateThumbnail=function(e){return this.$qNoApply.resolve(void 0)},e.prototype.getFileFromSource=function(e,t,i){var n={itemId:e.id,itemName:t,serviceName:null,provider:i};return this.$qNoApply.resolve(this.googleFilesRepository.getFileContents(n))},e.prototype.deleteFile=function(e,t,i,n){var r={itemId:e,itemName:"",serviceName:null,provider:n},s={getId:function(){return e},getIsSubdirectory:function(){return!0},getExtension:function(){return null},getTitle:function(){return null},getSize:function(){return null}};this.googleFilesRepository.deleteItems(r,[s])},e.prototype.shareFile=function(e,t,i,n,r,s){return this.$qNoApply.resolve()},e.prototype.getFilesScenarioInfo=function(e){return this.googleFilesRepository.getFilesScenarioInfo(e,this.constants.files.scenarioActions.upload)},e.prototype.uploadToGoogle=function(e,t){var i=this,n=this.$qNoApply.defer(),r=function(e,t,s){var a=i.uploadStatusList[t];if(!a)return i.loggingService.warn("[Upload Repository] UploadId: "+t+" Cannot find the upload. It must have been cancelled."),void n.reject(i.getError(i.constants.files.error.unknown));i.googleFilesRepository.uploadItemChunk(e,a.file).then(function(o){a.status!==teamspace.services.files.modules.fileUpload.UploadState.UploadCancelled?(n.notify(i.getUploadProgressNotification(a,o.completed,o.bytesUploaded)),o.completed?n.resolve(o.id):(e.startingPosition=o.bytesUploaded,e.startingPosition++,e.uploadData=s.substr(e.startingPosition,i.constants.files.upload.externalFilesChunkSize),e.uploadDataLength=e.uploadData.length,r(e,t,s))):n.resolve()},function(e){a.status!==teamspace.services.files.modules.fileUpload.UploadState.UploadCancelled?(i.loggingService.info("[Upload Repository] UploadId: "+t+" Error during google operation."),i.uploadStatusList[t]=void 0,n.reject(e)):n.resolve()})},s=this.uploadStatusList[e];return s?this.fileReaderAdapterFactory.createFileReader().readAsBinaryString(s.file).then(function(a){t.startingPosition=0,t.totalLength=a.length,t.uploadData=a.substr(t.startingPosition,i.constants.files.upload.externalFilesChunkSize),t.uploadDataLength=t.uploadData.length,i.googleFilesRepository.getUploadUrl(t,s.file).then(function(s){s||(i.loggingService.error("[Upload Repository] UploadId: "+e+" Error during google operation."),i.uploadStatusList[e]=void 0,n.reject(i.getError(i.constants.files.error.unknown)));var o=i.mapQueryParamsFromUrl(s);t.uploadId=o[i.uploadIdKey],r(t,e,a)}).catch(function(t){i.loggingService.error("[Upload Repository] UploadId: "+e+" Error during google operation."),n.reject(i.getError(i.constants.files.error.getGoogleUploadUrlFailed))})}).catch(function(t){i.loggingService.error("[Upload Repository] UploadId: "+e+". Failure trying to load the reader with error: "+t),n.reject(i.getError(i.constants.files.error.fileReaderSerializationFailed))}):(this.loggingService.warn("[Upload Repository] UploadId: "+e+" Cannot find the upload. It must have been cancelled."),n.reject(this.getError(this.constants.files.error.unknown))),n.promise},e.prototype.mapQueryParamsFromUrl=function(e){var t={},i=e.split("?").pop().split("&");return _.forEach(i,function(e){var i=e.split("=");2===i.length&&(t[i[0]]=i[1])}),t},e.prototype.getUploadProgressNotification=function(e,t,i){e.completedCalls++;var n=t?1:i/e.file.size;return{uploadId:e.id,percentageComplete:n}},e.prototype.buildUploadSuccessResults=function(e,t){return{objectId:t,siteUrl:"",serverRelativeUrl:"",objectUrl:"https://drive.google.com/file/d/"+t+"/view",title:e.fileName,type:this.utilityService.getFileExtension(e.fileName),serviceName:e.serviceName,state:this.constants.files.fileChiclet.states.reference}},e.prototype.getError=function(e){var t=this.getFilesScenarioInfo({errorCode:e,statusCode:void 0});return{errorCode:e,isScenarioIncomplete:!!t&&t.isScenarioIncomplete()}},e}();t.GoogleFileUploadService=n,angular.module("teamspace.services.files.modules.fileUpload.googleFileUploadService",["teamspace.qNoApply","teamspace.loggingService","teamspace.utilityService","teamspace.constants","teamspace.services.fileReaderAdapterFactory","teamspace.services.files.modules.google.googleFilesRepository"]).service("googleFileUploadService",n)},function(e,t,i){(function(n){var r,s;!function(n,a){"use strict";void 0!==(s="function"==typeof(r=a)?r.call(t,i,t,e):r)&&(e.exports=s)}(0,function(){"use strict";function e(e){var t,i,r,s,a=new Uint8Array(2*e.length),o="";for(t=0,i=0,r=e.length;t<r;t++)s=e.charCodeAt(t),a[i++]=s>>8,a[i++]=255&s;for(t=0,r=a.length;t<r;t++)o+=String.fromCharCode(a[t]);return"",("undefined"!=typeof window&&btoa?btoa(o):new n(o,"binary").toString("base64")).replace(/=+$/,"")}function t(e){for(var t,i,n=0,r=0,s=0,a=new Uint8Array(Math.ceil(3*e.length/4)),o=0,c=e.length;o<c;o++){if((t=e.charCodeAt(o))>=65&&t<=90)i=t-65;else if(t>=97&&t<=122)i=t-97+26;else if(t>=48&&t<=57)i=t-48+52;else if(43===t)i=62;else{if(47!==t){if(61===t){r=0;continue}continue}i=63}n=n<<6|i,(r+=6)>=8&&(r-=8,a[s++]=n>>r,2===r?n&=3:4===r&&(n&=15))}return s<a.length?a.subarray(0,s):a}function i(e){for(var i=t(e),n=[],r=0,s=i.length;r<s;)n.push(String.fromCharCode(i[r++]<<8|i[r++]));return n.join("")}function r(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var s="A-Za-z0-9"+r("'(),-./:?"),a=r("!\"#$%&*;<=>@[]^_'{|}"),o=r(" \r\n\t"),c={},l=new RegExp("[^"+o+s+a+"]+","g");return{encode:function(t,i){return i||(i=""),c[i]||(c[i]=new RegExp("[^"+s+r(i)+"]+","g")),t.replace(c[i],function(t){return"+"+("+"===t?"":e(t))+"-"})},encodeAll:function(t){return t.replace(l,function(t){return"+"+("+"===t?"":e(t))+"-"})},decode:function(e){return e.replace(/\+([A-Za-z0-9\/]*)-?/gi,function(e,t){return""===t?"+":i(t)})},imap:{encode:function(t){return t.replace(/&/g,"&-").replace(/[^\x20-\x7e]+/g,function(t){return"&"+(t=("&"===t?"":e(t)).replace(/\//g,","))+"-"})},decode:function(e){return e.replace(/&([^-]*)-/g,function(e,t){return""===t?"&":i(t.replace(/,/g,"/"))})}}}})}).call(t,i(367).Buffer)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(93),r=i(94),s=function(){function e(e,t,i,r,s){this.constants=e,this.loggingService=t,this.webWorkerProxyService=i,this.storageService=r,this.settingsService=s,this.useBenchmarkStorageKey="shouldforceUsageOfBenchmarkOnWeb",this.maxAllowedWebGlRunTimeMs=200,this.logger=this.loggingService.newLogger("PerformanceDetectService:WebCombo"),this.enableForceBenchmarkPerfDetectStrategy=this.settingsService.valueAsBoolean(this.constants.settings.names.enableForceBenchmarkPerfDetectStrategy),this.useBenchmark="true"===this.storageService.get(this.useBenchmarkStorageKey,!1),this.strategyInUse=this.useBenchmark?this.createBenchmarkStrategy():new n.WebGlPerformanceDetectStrategy(this.constants,this.loggingService)}return e.prototype.detectPerformance=function(e){var t=this,i=Date.now();return!this.useBenchmark&&this.enableForceBenchmarkPerfDetectStrategy&&this.createBenchmarkStrategy().detectPerformance(e),this.strategyInUse.detectPerformance(e).then(function(n){var r=Date.now()-i;return e.appendEventData({comboWebGlDelta:r,webGlBlacklisted:t.useBenchmark}),!t.useBenchmark&&r>t.maxAllowedWebGlRunTimeMs&&(t.logger.warn("WebGl Performance Strategy just took an unusually long time to process ("+r+" ms). Blacklisting this strategy so it doesn't happen again!"),t.useBenchmark=!0,t.storageService.set(t.useBenchmarkStorageKey,!0,!1),t.strategyInUse=t.createBenchmarkStrategy()),Promise.resolve(n)})},e.prototype.getName=function(){return this.strategyInUse.getName()},e.prototype.createBenchmarkStrategy=function(){return new r.BenchmarkPerformanceDetectStrategy(this.loggingService,this.webWorkerProxyService,this.constants,this.settingsService)},e}();t.WebComboPerformanceDetectStrategy=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=teamspace.services,r=function(){function e(e,t){this.constants=e,this.loggingService=t,this.MaxStrategyTimeoutMs=200,this.logger=t.newLogger("PerformanceDetectService:WebPerformance")}return e.prototype.detectPerformance=function(e){var t=this,i=document.createElement("canvas"),r=Date.now(),s=n.PerformanceMode.Low,a=!1,o=!1,c=1;return this.createWebGlContext(i,"webgl",!0).then(function(e){return e||(o=Date.now()-r>t.MaxStrategyTimeoutMs)?e:(t.logger.info("Falling back and trying experimental webgl."),c++,t.createWebGlContext(i,"experimental-webgl",!0))}).then(function(e){if(o=o||Date.now()-r>t.MaxStrategyTimeoutMs,e&&!o)s=n.PerformanceMode.Normal,a=!0;else if(!o)return t.logger.info("No webgl context was retrieved using failIfMajorPerformanceCaveat."),c++,t.createWebGlContext(i,"webgl",!1);return e}).catch(function(e){t.logger.warn("Error occurred during performance detection, defaulting to normal performance. Error: "+e),t.loggingService.event(t.constants.events.performanceDetect.webStrategyError,{error:e}),s=n.PerformanceMode.Normal}).then(function(n){return o&&t.logger.warn("Strategy timed out with time elapse of: "+(Date.now()-r)),i&&i.remove&&i.remove(),e.appendEventData(t.createTelemetryPayload(n,a,o,c)),s})},e.prototype.getName=function(){return"WebPerformanceDetectStrategy"},e.prototype.createWebGlContext=function(e,t,i){return new Promise(function(n,r){var s={failIfMajorPerformanceCaveat:i,powerPreference:"low-power"};n(e.getContext(t,s))})},e.prototype.createTelemetryPayload=function(e,t,i,n){var r={hasContext:!!e,passedPerformanceCaveat:t,contextsCreated:n,hardwareConcurrency:navigator.hardwareConcurrency,maxTouchPoints:navigator.maxTouchPoints,vendor:navigator.vendor,resolutionHeight:window.screen.availHeight,resolutionWidth:window.screen.availWidth};if(i&&(r.timedOut=i),e){var s=e.getExtension("WEBGL_draw_buffers"),a=e.getExtension("WEBGL_debug_renderer_info");r.glVendor=e.getParameter(a.UNMASKED_VENDOR_WEBGL),r.glRenderer=e.getParameter(e.RENDERER),r.glDrawbuffers=s?e.getParameter(s.MAX_DRAW_BUFFERS_WEBGL):void 0,r.glUnmaskedRenderer=a?e.getParameter(a.UNMASKED_RENDERER_WEBGL):void 0,r.glUniformVectors=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),r.glMaxUniformVectors=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),r.glViewPortDims=e.getParameter(e.MAX_VIEWPORT_DIMS),r.glAntialias=!!e.getContextAttributes().antialias}return r},e}();t.WebGlPerformanceDetectStrategy=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=teamspace.services,r=function(){function e(t,i,n,r){this.loggingService=t,this.webWorkerProxyService=i,this.minPerformanceThresholdMs=r.valueFor(n.settings.names.minPerformanceThresholdMs)||e.defaultMinPerformanceThresholdMs,this.logger=this.loggingService.newLogger("PerformanceDetectService:BenchmarkPerformance")}return e.prototype.detectPerformance=function(e){var t=this,i="handleBenchMarkPerformanceDetectStrategy";return new Promise(function(r,s){t.webWorkerProxyService.isSupported()?(t.webWorkerProxyService.registerMessageHandler(i,function(s){if(s)if(e.appendEventData(t.createTelemetryPayload(s.elapse)),void 0!==s.elapse&&null!==s.elapse&&s.elapse>=0){var a=s.elapse<t.minPerformanceThresholdMs?n.PerformanceMode.Normal:n.PerformanceMode.Low;r(a)}else t.logger.warn("WebWorker failed to provide a performance mode in response, defaulting to fallback performance mode."),r(n.PerformanceMode.Low);else t.logger.warn("WebWorker returned an undefined params value! Defaulting back to default performance mode."),r(n.PerformanceMode.Normal);t.webWorkerProxyService.unRegisterMessageHandler(i)}),t.webWorkerProxyService.postMessage("runBenchMarkPerformanceDetectStrategy")):(t.logger.warn("WebWorker is not supported on this environment! Defaulting back to default performance mode."),r(n.PerformanceMode.Normal))}).catch(function(e){t.logger.warn("Encounter error from WebWorker:"+e+"."),t.webWorkerProxyService.unRegisterMessageHandler(i)})},e.prototype.getName=function(){return"BenchmarkPerformanceDetectStrategy"},e.prototype.createTelemetryPayload=function(e){return{delta:e,hardwareConcurrency:navigator.hardwareConcurrency,maxTouchPoints:navigator.maxTouchPoints,vendor:navigator.vendor,resolutionHeight:window.screen.availHeight,resolutionWidth:window.screen.availWidth}},e.defaultMinPerformanceThresholdMs=8,e}();t.BenchmarkPerformanceDetectStrategy=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(410),i(411)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o){"ngInject";this.counterName=e,this.parentService=t,this.counterData=i,this.parentScenario=n,this.telemetryKind=r,this.loggingContextService=s,this.rootScopePostDigestTerminator=a,this.ignoreLoggingContext=o,this.sequence=0,o||(this.loggingContextDefer=t.$q.defer()),this.counterData=this.counterData||{},this.absoluteStartTime=Date.now(),this.intervalTimestamp=this.relativeTimestamp=this.parentService.timestamp(),this.counterId=t.makeCounterId(),this._timestamps=[],t.phase&&(this.counterData.phase=t.phase),this.initialAppInUse=t.appInUse}return e.$inject=["counterName","parentService","counterData","parentScenario","telemetryKind","loggingContextService","rootScopePostDigestTerminator","ignoreLoggingContext"],Object.defineProperty(e.prototype,"id",{get:function(){return this.counterId},set:function(e){this.counterId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventData",{get:function(){return this.counterData},set:function(e){this.counterData=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.counterName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return this.parentService.timestamp()-this.relativeTimestamp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestamps",{get:function(){return this._timestamps.slice(0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kind",{get:function(){return this.telemetryKind},enumerable:!0,configurable:!0}),e.prototype.createMark=function(e,t,i,n){var r=this;void 0===i&&(i=!1);var s;t=t||{},this.counterData&&this.counterData!==t&&(t=angular.extend(t,this.counterData)),angular.isNumber(t.overrideTimestamp)?(s=this.relativeTimestamp+t.overrideTimestamp-this.absoluteStartTime,delete t.overrideTimestamp):(s=this.parentService.timestamp(),this._timestamps.push(s)),t["Scenario.Step"]=t.step=e,t.sequence=this.sequence,t.delta=angular.isNumber(t.delta)?t.delta:s-this.relativeTimestamp,t.stepDelta=angular.isNumber(t.stepDelta)?t.stepDelta:s-this.intervalTimestamp,this.intervalTimestamp=s,t.elapsed=angular.isNumber(t.elapsed)?t.elapsed:s,_.isNil(t[this.parentService.constants.categories.appInUse])&&(t[this.parentService.constants.categories.appInUse]=this.initialAppInUse===this.parentService.appInUse?this.initialAppInUse:"mixed");var a,o=function(){r.parentService.sendTelemetry(r.kind,r.counterName,t,r,i,r.parentScenario)};a=n?function(){n(t).finally(o)}:o,this.telemetryKind!==teamspace.services.TelemetryKind.Scenario&&this.telemetryKind!==teamspace.services.TelemetryKind.Perf||this.ignoreLoggingContext?a():this.getLoggingContext(i).then(function(e){if(e){var i=r.parentService.utilityService.flattenObject(e,".",!0);i&&angular.extend(t,i)}}).finally(function(){a()}),this.sequence+=1},e.prototype.getLoggingContext=function(e){var t=this;if(e){var i={};this.loggingContextService.getContext().then(function(e){i=e}).finally(function(){t.loggingContextDefer.resolve(i)})}return this.loggingContextDefer.promise},e.prototype.mark=function(e,t){this.createMark(e,t)},e.prototype.stop=function(e,t){this.parentService.settingsService.valueAsBoolean(this.parentService.constants.settings.names.disablePerfTableLogging)&&this.name==this.parentService.constants.counters.sfbInterop.waitForMessageSync||this.stopInternal(e,t)},e.prototype.stopInternal=function(e,t,i){var n=this,r=function(){return n.createMark("stop",e,!0,i)};t?t(r):r()},e.prototype.stopAfterDigest=function(e){this.stop(e,this.rootScopePostDigestTerminator)},e.prototype.fail=function(e,t){var i=this;if(!this.parentService.settingsService.valueAsBoolean(this.parentService.constants.settings.names.disablePerfTableLogging)||this.name!=this.parentService.constants.counters.sfbInterop.waitForMessageSync){var n=function(){return i.createMark("error",e,!0)};t?t(n):n()}},e.prototype.failAfterDigest=function(e){this.fail(e,this.rootScopePostDigestTerminator)},Object.defineProperty(e.prototype,"service",{get:function(){return this.parentService},enumerable:!0,configurable:!0}),e}();t.PerfCounterImplementation=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r){this.constants=e,this.$interval=t,this.storageService=i,this.loggingService=n,this.clientDatabase=r,this.storageUsageListeners=[],this.logger=this.loggingService.newLogger("StorageUsage")}return e.$inject=["constants","$interval","storageService","loggingService","clientDatabase"],e.prototype.registerStorageUsageListener=function(e,t){this.storageUsageListeners.push({name:e,listener:t})},e.prototype.unregisterStorageUsageListener=function(e){this.storageUsageListeners=this.storageUsageListeners.filter(function(t){return t&&t.name!==e})},e.prototype.startStorageUsageCollector=function(){var e=this;this.$interval(function(){var t=e.storageService.getUsage(),i=function(i){var n={localStorageUsed:t||{},indexedDBSize:i||{}};1===e.storageUsageListeners.length?e.storageUsageListeners[0].listener(n):_.forEach(e.storageUsageListeners,function(e){e&&e.listener(n)}),e.logStorageUsage(n)};e.clientDatabase.getUsageAndQuota().then(function(e){i(e)},function(t){e.logger.error("Error ocrrured collecting storage usage numbers for the user. Error:{0}",t),i()})},15*this.constants.timeConversion.numSecondInMinute*this.constants.timeConversion.numMsInSecond,0,!1)},e.prototype.logStorageUsage=function(e){var t={localStoragePercentUsed:e.localStorageUsed?e.localStorageUsed.percentOfQuota:void 0};e.indexedDBSize&&(angular.isDefined(e.indexedDBSize.percentOfQuota)&&(t[this.constants.events.memory.iDBPercentUsed]=e.indexedDBSize.percentOfQuota),angular.isDefined(e.indexedDBSize.grantedMB)&&(t[this.constants.events.memory.iDBTotalMBGranted]=e.indexedDBSize.grantedMB),angular.isDefined(e.indexedDBSize.usedMB)&&(t[this.constants.events.memory.iDBTotalMBUsed]=e.indexedDBSize.usedMB),angular.isDefined(e.indexedDBSize.dbCount)&&(t[this.constants.events.memory.iDBCount]=e.indexedDBSize.dbCount)),this.loggingService.event(this.constants.events.memory.storageConsumed,t)},e}();t.StorageUsageCollectionService=n,angular.module("teamspace.storageUsageCollectionService",["teamspace.constants","teamspace.storageService","teamspace.loggingService","skypeX.clientDatabase"]).service("storageUsageCollectionService",n)},function(e,t,i){"use strict";angular.module("teamspace.rootScopePostDigestTerminator",[]).factory("rootScopePostDigestTerminator",["$rootScope","$injector",function(e,t){if(!e||!e.$$postDigest)return function(e){t.get("loggingService").warn("Either root scope or $$postDigest is undefined. Executing logging service scenario action immediately."),e()};return function(t){return e.$$postDigest(function(){return t()})}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t,i){this.type=e,this.id=t,this.actionId=i}}();t.NotificationActionPayload=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.utilityService=e,this.constants=t}return e.prototype.mapNotificationActions=function(e,t,i){this.mapAction(e.sourceId,e,e.primaryAction,t),this.mapAction(e.sourceId,e,e.errorAction),this.mapAction(e.sourceId,e,e.dismissAction,i),this.mapAction(e.sourceId,e,e.timeoutAction),this.mapActions(e.sourceId,e)},e.prototype.mapAction=function(e,t,i,n){if(i){var r=this.mapActionPayload(e,t,i);r.deepLinkUrl=this.deepLinkUrl,i.id=r.actionId,i.actionString=JSON.stringify(r),n&&(i.action=function(){return n()})}},e.prototype.mapActions=function(e,t){var i=this;t.actions&&t.actions.length&&t.actions.forEach(function(n){return i.mapAction(e,t,n)})},e}();t.NotificationMapperBase=n},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(434),s=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S,y,C,b,T,I,w,k){var P=e.call(this,t,f,o,l,p,d,h,r,a,c,u,i,s)||this;return P.$injector=n,P.loggingService=l,P.$location=g,P.$rootScope=v,P.desktopUtilityService=m,P.hwaServiceProvider=S,P.navigationNotificationService=y,P.navigationService=C,P.notificationsStore=b,P.utilityService=T,P.callNotificationDataMapper=I,P.chatNotificationDataMapper=w,P.actionNotifications={},P.hwaServiceProvider.getNotificationManager()&&P.desktopUtilityService.isHwa()&&(P.notificationsStore.subscribe(function(e,t){P.createNotification(t)},SkypeX.Services.NotificationsStore.Type_NewActivitiesHydrated_Recent),P.eventingService.$on(P.$rootScope,P.constants.events.notifications.hwaNotificationWeb,function(e,t){P.handleNotification(e,t)}),P.eventingService.$on(P.$rootScope,P.constants.events.notifications.hwaNotificationPush,function(e,t){P.handleNotification(e,t)}),P.eventingService.$on(P.$rootScope,P.constants.events.notifications.hwaNotificationBackgroundCallPush,function(e,t){P.handleNotification(e,t)})),P}return n(t,e),t.$inject=["ringtoneSettingService","$translate","$injector","ariaLiveService","shortcutService","audioService","constants","conversationsService","loggingService","notificationSettingsStore","resources","routeUtilityService","settingsService","$location","$rootScope","desktopUtilityService","eventingService","hwaServiceProvider","navigationNotificationService","navigationService","notificationsStore","utilityService","callNotificationDataMapper","chatNotificationDataMapper","platformDetectService"],t.prototype.handleNotification=function(e,t){var i={};if(this.activationScenario=this.loggingService.findScenario(this.constants.hwaApp.telemetry.activation),this.activationScenario||(this.loggingService.warn("Notification service: could not find activation scenario"),this.activationScenario=this.loggingService.newScenario(this.constants.hwaApp.telemetry.handleNotification)),!t||!e||!e.name)return this.loggingService.error("HWA handle notification failed data or id is null or undefined"),i.result="HWA handle notification failed data or id is null or undefined",void this.activationScenario.fail(i);try{var n=JSON.parse(t);if(!n)return this.loggingService.error("Unable to parse HWA notification event"),i.result="Unable to parse HWA notification event",void this.activationScenario.fail(i);switch(this.loggingService.info("Received action on notification of type 0",e.name),e.name){case this.constants.events.notifications.hwaNotificationWeb:this.activationScenario.mark(this.constants.hwaApp.telemetry.handleNotificationWeb),this.handleNotificationWeb(n);break;case this.constants.events.notifications.hwaNotificationPush:this.activationScenario.mark(this.constants.hwaApp.telemetry.handleNotificationWns),this.handleNotificationWns(n);break;case this.constants.events.notifications.hwaNotificationBackgroundCallPush:this.activationScenario.mark(this.constants.hwaApp.telemetry.handleNotificationCall),this.handleNotificationBackgroundCallPush(n)}}catch(e){this.loggingService.error("HWA push notification error with exception {0}",e),i.result="HWA push notification error with exception "+e,this.activationScenario.fail(i)}},t.prototype.handleNotificationWns=function(e){var t=r.WnsNotificationUtility.parseNavigationData(e),i={};if(i[this.constants.telemetry.notification.property.id]=e.id,!t)return this.loggingService.error("HWA push notification error: unable to parse navigation data"),this.activationScenario.mark(this.constants.telemetry.notification.navigate.failed),void this.activationScenario.fail(i);i[this.constants.telemetry.notification.property.type]=t.linkState,this.navigationService.navigate(this.$rootScope,t.linkState,t.linkParams),this.loggingService.info("HWA Push Notification success navigated to notification."),this.activationScenario.mark(this.constants.telemetry.notification.navigate.success),this.activationScenario.stop(i)},t.prototype.handleNotificationWeb=function(e){switch(e.type){case 1:this.handleCallNotificationWeb(e);break;case 0:this.handleChatNotificationWeb(e)}},t.prototype.handleChatNotificationWeb=function(e){var t=this.navigateToNotification(e),i={};i[this.constants.telemetry.notification.property.id]=e.id,t?(this.loggingService.info("HWA Notification success navigated to notification."),this.activationScenario.mark(this.constants.telemetry.notification.navigate.success),this.activationScenario.stop(i)):(this.loggingService.error("Unable to navigate with this HWA notification event."),this.activationScenario.mark(this.constants.telemetry.notification.navigate.failed),this.activationScenario.fail(i))},t.prototype.handleCallNotificationWeb=function(e){var t=function(e){return!(!e||!e.action)&&(e.action(),!0)};if(this.actionNotifications&&this.actionNotifications[e.id]){this.logger.debug("Handling foreground call activation for call {0} (action: {1})",e.teamsCallId,e.actionKind);var i=this.actionNotifications[e.id];try{var n=!1;switch(e.actionKind){case teamspace.services.NotificationActionKind.ToastBody:n=t(i.primaryAction);break;case teamspace.services.NotificationActionKind.ToastDismiss:n=t(i.dismissAction);break;case teamspace.services.NotificationActionKind.TimeOut:n=t(i.timeoutAction);break;case teamspace.services.NotificationActionKind.Error:n=t(i.errorAction);break;case teamspace.services.NotificationActionKind.ToastButton:default:n=t(_.find(i.actions,function(t){return t.id==e.actionId}))}n?this.logger.info("Handling foreground call activation for call {0} complete",e.teamsCallId):this.logger.error("Handling foreground call activation for call {0} unsuccessful - handler not found",e.teamsCallId)}catch(t){this.logger.error("An error occured while attempting to handle foreground call activation for call {0}: {1}",e.teamsCallId,t)}}else this.logger.error("Handling call activation error - handler not found (callId: {0})",e.teamsCallId)},t.prototype.handleNotificationBackgroundCallPush=function(e){this.loggingService.info("Handling notification action from background call toast");var t={},i=this.$injector.get("callingUserActionService");if(i)switch(e.actionKind){case teamspace.services.BackgroundCallNotificationActionKind.Accept:this.loggingService.info("Accepting the call (callId: {0}, participantId: {1}, conversationId: {2}) in response to background calling toast",e.callId,e.participantId,e.conversationId),i.acceptCall(e.conversationId,null,!1,!1,e.callId,e.participantId),this.activationScenario.stop();break;case teamspace.services.BackgroundCallNotificationActionKind.AcceptWithVideo:this.loggingService.info("Accepting the call (callId: {0}, participantId: {1}, conversationId: {2}) with video in response to background calling toast",e.callId,e.participantId,e.conversationId),i.acceptCall(e.conversationId,null,!1,!0,e.callId,e.participantId),this.activationScenario.stop();break;case teamspace.services.BackgroundCallNotificationActionKind.JumpIn:this.loggingService.info("Jumping into the meetup (callId: {0}, participantId: {1}, conversationId: {2}) in response to background calling toast",e.callId,e.participantId,e.conversationId),i.acceptCall(e.conversationId,null,!0,!0,e.callId,e.participantId),this.activationScenario.stop();break;case teamspace.services.BackgroundCallNotificationActionKind.Reply:this.loggingService.info("Rejecting the call (callId: {0}, participantId: {1}, conversationId: {2}) and navigating to the notification in response to a background calling toast reply action",e.callId,e.participantId,e.conversationId),i.replyCall(e.callId,e.participantId);break;default:this.loggingService.warn("Unsupported background call notification action kind: {0}",e.actionKind),this.activationScenario.stop()}else this.loggingService.error("handleNotificationBackgroundCallPush: Failed to get CallingUserActionService from injector. Failed to accept callId "+e.callId),t.result="handleNotificationBackgroundCallPush: Failed to get CallingUserActionService from injector.",this.activationScenario.fail(t)},t.prototype.navigateToNotification=function(e){var t=!1;return e?((t=this.navigateWithDeepLink(e))||(t=this.navigateWithLinkState(e)),t||(t=this.navigateWithNotificationsList(e)),t&&this.removeNotificationFromList(e),t):t},t.prototype.navigateWithDeepLink=function(e){if(!e.deepLink)return!1;var t=this.utilityService.getDeeplinkUrl(e.deepLink,this.settingsService.getRootUri());return!!t&&(this.$location.url(t),!0)},t.prototype.navigateWithLinkState=function(e){return!!e.linkState&&(this.navigationService.navigate(this.$rootScope,e.linkState,e.linkParams),!0)},t.prototype.navigateWithNotificationsList=function(e){if(this.actionNotifications&&this.actionNotifications[e.id]){var t=this.actionNotifications[e.id],i=_.find(t.actions,function(t){return t.id==e.actionId});if(t.primaryAction&&t.primaryAction.id===e.actionId&&t.primaryAction.action)return t.primaryAction.action(),!0;if(i&&i.action)return i.action(),!0;if(t.notificationData)return this.navigationNotificationService.navigateWithNotificationData(t.notificationData,this.$rootScope),!0}return!1},t.prototype.removeNotificationFromList=function(e){this.actionNotifications&&this.actionNotifications[e.id]&&delete this.actionNotifications[e.id]},t.prototype.createNotificationWithActions=function(e){e?(this.callNotificationDataMapper.mapNotificationActionData(e),this.createHwaNotification(e)):this.loggingService.error("Unable to create notification, data is null or undefined.")},t.prototype.createHwaNotification=function(e){var t={};t[this.constants.telemetry.notification.property.id]=e.sourceId,t[this.constants.telemetry.notification.property.type]=e.trackingType,t[this.constants.telemetry.notification.property.hasHeader]=!!e.headerData,this.loggingService.event(this.constants.telemetry.notification.show,t),this.actionNotifications[e.sourceId]||(this.actionNotifications[e.sourceId]=e),this.hwaServiceProvider.getNotificationManager().showToast(JSON.stringify(e)),this.loggingService.info("HWA notification showing notification type {0}.",e.type)},t.prototype.createToast=function(e,t,i){var n=this;this.logger.info("Creating notification {0}",e.notificationType),this.chatNotificationDataMapper.mapNotificationData(e,this.parseTeamChannelFromLinkParams.bind(this),this.parseGroupNameFromNotification.bind(this),t,i).then(function(e){n.createHwaNotification(e)})},t.prototype.dismissNotification=function(e,t){},t}(teamspace.services.NotificationsService);t.NotificationsServiceHwaImplementation=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c,l,p){var u=this;this.eventingService=e,this.conversationsService=t,this.conversationsStore=i,this.notificationsStore=n,this.messageService=r,this.messageStore=s,this.loggingService=a,this.$q=o,this.orchestrationService=c,this.constants=l,this.settingsService=p,this.delayedRecalculateNewActivities=null,this.newActivitiesCount=0,this.isrenderDataFromCacheComplete=!1,this.isrenderDataFromServerComplete=!1,this.unregisterInitializeEvent=_.noop,this.pendingReadStatusChange={},this.logger=this.loggingService.newLogger("BellNotificationsService"),this.delayedRecalculateNewActivities=_.debounce(function(){return u.updateActivitiesOnChange()},250),this.notificationsStore.subscribe(function(e,t){return u.delayedRecalculateNewActivities()},SkypeX.Services.NotificationsStore.Type_NewActivitiesHydrated),this.conversationsService.subscribe(this.delayedRecalculateNewActivities.bind(this),teamspace.services.ConversationsServiceEvents.EventType_All,SkypeX.Services.ChatServiceUtils.NotificationsConversationId),this.orchestrationService.registerAction(this.constants.actions.bellNotificationsService.startup,function(){return u.initializeForScenarioMarkers()}),this.unregisterInitializeEvent=this.eventingService.unsafeOn(this.constants.events.feed.intializeNotificationsStore,function(){return u.initializeForScenarioMarkers()})}return e.$inject=["eventingService","conversationsService","conversationsStore","notificationsStore","messageService","messageStore","loggingService","$q","orchestrationService","constants","settingsService"],e.prototype.updateActivitiesOnChange=function(){this.calculateNewActivitiesCount()},e.prototype.getNotifications=function(){return this.notificationsStore.allNotifications},e.prototype.resetNewActivitiesCount=function(){var e=_.first(this.notificationsStore.allNotifications.notifications);if(e&&e.activity){var t=new Date(e.activity.activityTimestamp).getTime(),i=e.activity.activityId||"0";this.conversationsService.setConsumptionHorizon(SkypeX.Services.ChatServiceUtils.NotificationsConversationId,t,i,!1),this.delayedRecalculateNewActivities()}},e.prototype.changeReadStatus=function(e,t){var i=this,n=_.find(this.notificationsStore.allNotifications.notifications,function(t){return t.activity.activityId==e.activity.activityId});if(!n||!n.activity||!n.activity.activityTimestamp)return this.$q.when();this.logger.info("Marking activity as read/unread for id {0}",n.activity.sourceMessageId);var r=this.loggingService.newScenario(this.constants.scenarios.notifications.messagepropertyChangeRead),s=SkypeX.Services.NotificationType[e.notificationType];if(SkypeX.Services.NotificationUtility.isNullOrUndefined(s))return this.logger.error("changeReadStatus failed. notification.notificationType:{0} is invalid",e.notificationType),this.$q.reject("notificationType is invalid");e.isActivityRead=t;var a=SkypeX.Services.NotificationUtility.isNullOrUndefined(e.notificationSubType)?s:s.concat("_",SkypeX.Services.NotificationSubType[e.notificationSubType]),o=e.message.id+"_"+(t?1:0);if(void 0!==this.pendingReadStatusChange[o])return this.logger.warn("Duplicate call to change read status for activity: {0}, message: {1}, isRead: {2}",e.activity.activityId,e.message.id,t),this.$q.when();this.pendingReadStatusChange[o]=!0;var c=this.messageService.markReadStatus(t,e.message.conversationId,e.message.id).catch(function(t){return i.logger.error("Mark notification as read failed. id:{0} error:{1}",e.message.id,t),i.$q.reject(t)}),l=this.setReadStatusLocally(e,n,t).catch(function(t){return i.logger.error("Mark notification as read failed 2. id:{0} error:{1}",e.message.id,t),i.$q.reject(t)});return this.$q.all([c,l]).then(function(){r.stop({caller:a,readStatus:t})},function(e){r.fail({errormessage:e})}).finally(function(){delete i.pendingReadStatusChange[o]})},e.prototype.setReadStatusLocally=function(e,t,i){return t.message.properties[SkypeX.Services.ChatServiceUtils.MessageProperty_IsRead]=i,this.messageStore.putMessages([e.message],!1).toNgPromise(this.$q)},e.prototype.checkAndMarkAsReadByMessageId=function(e){var t=this;if(this.notificationsStore.unreadNotificationsByMessageId){var i=this.notificationsStore.unreadNotificationsByMessageId[e];if(i){var n=_.find(this.notificationsStore.allNotifications.notifications,function(e){return e.activity.activityId==i});this.changeReadStatus(n,!0).then(function(){delete t.notificationsStore.unreadNotificationsByMessageId[e],t.delayedRecalculateNewActivities()})}}},e.prototype.markSystemMessagesAsRead=function(e){var t=this;if(e){var i=_.filter(this.notificationsStore.allNotifications.notifications,function(t){return t.activity.sourceThreadId===e&&t.notificationType===SkypeX.Services.NotificationType.TeamMembershipChange&&(t.notificationSubType===SkypeX.Services.NotificationSubType.AddedToTeam||t.notificationSubType===SkypeX.Services.NotificationSubType.PromotedToTeamAdmin)});_.each(i,function(e){var i=e.message.id;t.changeReadStatus(e,!0).then(function(){delete t.notificationsStore.unreadNotificationsByMessageId[i],t.delayedRecalculateNewActivities()})})}},e.prototype.getNewActivitiesCount=function(){return this.newActivitiesCount},e.prototype.calculateNewActivitiesCount=function(){var e=this.conversationsStore.getConversation(SkypeX.Services.ChatServiceUtils.NotificationsConversationId),t=e?e.getConsumptionHorizonOriginalArrivalTime():0,i={};i.activity={},i.activity.activityTimestamp=t;for(var n=0,r=this.getSortedIndex(this.notificationsStore.allNotifications.notifications,i),s=0;s<r;s++){var a=this.notificationsStore.allNotifications.notifications[s];if(!a.isActivityRead){var o=SkypeX.Services.ChatServiceUtils.isBotMri(a.activity.sourceUserId,!1),c=SkypeX.Services.ChatServiceUtils.isConnectorMri(a.activity.sourceUserId),l=a.notificationType===SkypeX.Services.NotificationType.Inferred,p=a.notificationType===SkypeX.Services.NotificationType.Trending,u=a.notificationType===SkypeX.Services.NotificationType.LikeInChat;if(!this.settingsService.valueAsBoolean(this.constants.settings.names.enableThirdPartyNotificationReplyMention)&&o)continue;if(!this.settingsService.valueAsBoolean(this.constants.settings.names.enableThirdPartyNotificationConnectors)&&c)continue;if(!this.settingsService.valueAsBoolean(this.constants.settings.names.enableInferredNotification)&&l)continue;if(!this.settingsService.valueAsBoolean(this.constants.settings.names.enableTrendingNotification)&&p)continue;if(u&&a.activity&&a.activity.sourceThreadId){var h=this.conversationsService.getChatConversation(a.activity.sourceThreadId);if(h&&!h.isUserAlertsEnabled())continue}n++}}this.newActivitiesCount==n||0==n&&0==this.newActivitiesCount||(this.newActivitiesCount=n,this.eventingService.$emit(this.constants.events.notifications.bellCountUpdated,this.newActivitiesCount))},e.prototype.getSortedIndex=function(e,t){return _.sortedIndexBy(e,t,function(e){return-new Date(e.activity.activityTimestamp).getTime()})},e.prototype.initializeForScenarioMarkers=function(){var e=this;return this.initPromise?this.initPromise:(this.bellCountScenario=this.loggingService.newScenario(this.constants.scenarios.notifications.bellCount),this.notificationsStore.subscribe(function(){e.isrenderDataFromCacheComplete=!0,e.updateScenario(e.constants.scenarios.steps.renderDataFromCache)},SkypeX.Services.NotificationsStore.Type_ActivitiesWithDetailPopulatedFromCache),this.notificationsStore.subscribe(function(){e.isrenderDataFromServerComplete=!0,e.updateScenario(e.constants.scenarios.steps.renderDataFromServer)},SkypeX.Services.NotificationsStore.Type_PopulatedFromSync),this.initPromise=this.$q.when(),this.initPromise)},e.prototype.updateScenario=function(e){if(this.bellCountScenario&&(this.bellCountScenario.mark(e),this.isrenderDataFromCacheComplete&&this.isrenderDataFromServerComplete)){this.calculateNewActivitiesCount();var t={bellCountOnInitialLoad:this.newActivitiesCount};this.bellCountScenario.stop({data:JSON.stringify(t)}),this.unregisterInitializeEvent()}},e}();t.BellNotificationsServiceImplementation=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(439),i(440)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n){this.$translate=e,this.resources=t,this.$injector=i;var r=n.getUserInfo();this.currentTenantId=r?r.profile.tid:""}return Object.defineProperty(e.prototype,"callingService",{get:function(){return this._callingService||(this._callingService=this.$injector.get("callingService")),this._callingService},enumerable:!0,configurable:!0}),e.prototype.getProfilesFromCallingRoster=function(e){var t=this,i={};this.callingService.getAllCalls(!0).forEach(function(e){return e.participants.forEach(function(t){i[t.id]={participant:t,call:e}})});var n=this.currentTenantId,r={};return _.forEach(e,function(e){var s=i[e];if(s){var a=s.participant,o=s.call,c={};c.mri=e;var l=SkypeX.Services.ChatServiceUtils.isAnonymousUserMri(c.mri),p=a.role!==o.role&&!!o.role&&!!a.role,u=n!==a.tenantId&&!!n&&!!a.tenantId;c.isAnonymousB2bUser=(p||u)&&!l,c.isAnonymousUser=l||c.isAnonymousB2bUser,c.userPrincipalName=e,c.displayName=a.displayName||t.$translate.instant(t.resources.strings.calling_roster_guest_status),r[e]=c}}),r},e}();t.BasePeopleProfileProvider=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(106),r=function(){function e(t,i,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S){this.loggingService=t,this.settingsService=i,this.analyticsService=r,this.eventingService=s,this.appConfig=a,this.textEditorConfig=o,this.constants=c,this.$timeout=l,this.$rootScope=p,this.$window=u,this.hyperlinkHelper=h,this.$q=d,this.tooltipService=g,this.localizationService=v,this.id=m,this.options=f,this.enableResizeablePastedTables=S,this.ckEditorEventRegistrations=[],this.hasSearchResults=!1,this.semanticObjectHandlers=[],this.contextMenuHandlers=[],this.editorHooks=[],this.isDebugging=i.valueAsBoolean("debugTextEditor"),this.logger=this.loggingService.newLogger("TextEditor"),this.initStyles(),this.activeCommand=null,this.activeContextMenuHandler=null,this.commandSearchFailures=0,this.eventHandlingPauseCount=0,this.isDesktopApp=this.settingsService.valueAsBoolean(c.settings.names.isDesktopApp),e.overrideresourceLoaders(this.loggingService,this.$window,this.appConfig),this.textRangeHelper=new n.TextRangeHelper(this.loggingService)}return e.prototype.initStyles=function(){this.foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]},this.backStyle={element:"span",styles:{"background-color":"#(color)"}},this.fontSizeStyle={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]},this.selectionStyle={element:"span",styles:{"box-shadow":"inset 0 0 0 1000px rgba(0,0,0,.2)"}}},e.isResourcePreloaded=function(e,t){return t=t.toLowerCase(),_.findIndex(e,function(e){return t.indexOf(e)>0})>=0},e.stripPreloadedScripts=function(t,i,n){for(var r=0;r<t.length;)e.isResourcePreloaded(i,t[r])?(n.push(t[r]),t.splice(r,1)):r+=1},e.prototype.checkForSelectionChanged=function(){var e=this;this.$timeout(function(){var t=e.editor.getSelection();if(t){var i=t.getRanges();if(i.length){var n=i[0],r=n.startContainer,s=n.endContainer,a=n.startOffset,o=n.endOffset,c=!e.oldSelection||e.oldSelection.startContainer!==r||e.oldSelection.startOffset!==a||e.oldSelection.endOffset!==o||e.oldSelection.startContainer!==s;e.oldSelection={isCollapsed:t.isCollapsed(),startContainer:r,endContainer:s,startOffset:a,endOffset:o},c&&e.checkForInsertHyperlinkAllowed()}else e.oldSelection&&(e.oldSelection=null,e.checkForInsertHyperlinkAllowed())}else e.oldSelection&&(e.oldSelection=null,e.checkForInsertHyperlinkAllowed())},0,!1)},e.prototype.checkForInsertHyperlinkAllowed=function(){var e=this.editor.getSelection(),t=this.hyperlinkHelper.canInsertHyperlinkIntoSelection(e);t!==this.canInsertHyperlink&&(this.canInsertHyperlink=t,this.formatCommandEnabledChanged(this.constants.editor.commands.insertHyperlink,this.canInsertHyperlink))},e.overrideresourceLoaders=function(t,i,n){if(!e.ckEditorResourceOverride)if(CKEDITOR){if(CKEDITOR.document){var r=CKEDITOR.document.appendStyleSheet,s=n.rteConfig.preloaded.css;CKEDITOR.document.appendStyleSheet=function(i){e.isResourcePreloaded(s,i)?t.debug("CKEDITOR stylesheet already loaded, skipping: {0}",i):r.call(CKEDITOR.document,i),r.call(CKEDITOR.document,i)}}else t.debug("overrideresourceLoaders: not able to override ckEditor.document.appendStyleSheet");if(CKEDITOR.scriptLoader){var a=CKEDITOR.scriptLoader,o=n.rteConfig.preloaded.js;CKEDITOR.scriptLoader={load:function(t,i,n,r){var s=angular.isString(t);s&&(t=[t]);var c=[],l=[],p=function(e){i&&(s?i.call(n,e):i.call(n,c,l))};e.stripPreloadedScripts(t,o,c),0===t.length?p(!0):a.load(t,function(e,t){c=c.concat(e),l=l.concat(t),p(c.length>0)},n,r)},queue:a.queue}}else t.debug("overrideresourceLoaders: not able to override ckEditor.scriptLoader");e.ckEditorResourceOverride=!0}else t.error("CKEditor cannot be initialized if it has not been loaded yet")},e.prototype.initEditor=function(){var e=this.$q.defer();{if(CKEDITOR&&document.getElementById(this.id)){var t=this,i={on:{instanceReady:function(i){t.editor=this,t.editor.commands.source.disable(),t.attachEditorEvents(),t.setEditorOnAllHandlers(),t.editor.dataProcessor.htmlFilter.addRules({elements:{a:function(e){var t=e.attributes;t["data-cke-saved-href"]=t.href}},comment:function(){return!1}}),t.editor.getCommand("undo").on("afterUndo",t.handleUndoRedo.bind(t,teamspace.services.ChangeType.Undo)),t.editor.getCommand("redo").on("afterRedo",t.handleUndoRedo.bind(t,teamspace.services.ChangeType.Redo)),e.resolve()}}},n=angular.extend({},this.textEditorConfig.config,i,this.userOptions,this.options);return this.isDesktopApp?CKEDITOR.dom.element.prototype.disableContextMenu=function(){this.on("contextmenu",function(e){if(t.contextMenuHandlers.length>0)for(var i=0;i<t.contextMenuHandlers.length;i++)t.contextMenuHandlers[i].onContextMenu(e)})}:CKEDITOR.dom.element.prototype.disableContextMenu=angular.noop,CKEDITOR.dtd.$editable.input=1,delete CKEDITOR.dtd.$removeEmpty.span,CKEDITOR.replace(this.id,n),e.promise}this.logger.error("CKEditor cannot be initialized if it has not been loaded yet")}},e.prototype.setEditorOnAllHandlers=function(){this.setEditorOnHandlers(this.semanticObjectHandlers),this.setEditorOnHandlers(this.editorHooks)},e.prototype.setEditorOnHandlers=function(e){for(var t in e){var i=e[t];i.setEditor&&!i.isEditorSet&&i.setEditor(this.editor)}},Object.defineProperty(e.prototype,"lastKey",{get:function(){return this.lastKeyboardEvent||{type:"none",key:"",keyCode:0}},enumerable:!0,configurable:!0}),e.prototype.saveLastKey=function(e){try{if(e){if(e.data){var t=e.data.$||e.data.domEvent.$;if(t){var i={type:t.type,key:t.key,keyCode:t.keyCode,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey};if("Alt"!=i.key&&18!=i.keyCode&&"Control"!=i.key&&17!=i.keyCode&&"Shift"!=i.key&&16!=i.keyCode&&!(112<=i.keyCode&&i.keyCode<=123)){if(i.key)"Spacebar"===i.key&&(i.key=" ");else if(!i.altKey&&!i.ctrlKey)switch(i.keyCode){case 13:i.key="Enter";break;case 32:i.key=" ";break;case 51:i.key=i.shiftKey?"#":"3";break;case 56:i.key=i.shiftKey?"*":"8";break;case 189:i.key=i.shiftKey?"_":"-";break;case 190:i.key=i.shiftKey?">":".";break;case 192:i.key=i.shiftKey?"~":"`";break;default:48<=i.keyCode&&i.keyCode<=90&&(i.key=i.shiftKey?String.fromCharCode(i.keyCode).toUpperCase():String.fromCharCode(i.keyCode))}this.lastKeyboardEvent=i}}}}else this.lastKeyboardEvent=void 0}catch(e){this.logger.error("[saveLastKey]: exception happened")}},e.prototype.getEditableContentRoot=function(){return this.editor.editable().$},e.prototype.inspectContent=function(){var e=!0,t=!0,i=!1;if(this.editor){var n=this.editor.editable();if(n){var r=function(n,s){if(n)if(1==n.nodeType){if(!s)if("BR"==n.nodeName){if(i)return e=!1,void(t=!1);i=!0}else{if(n.attributes&&n.attributes.length)return e=!1,void(t=!1);if("DIV"!=n.nodeName&&"SPAN"!=n.nodeName)return e=!1,void(t=!1);if(n.nextSibling||n.previousSibling)return e=!1,void(t=!1)}if(n.childNodes&&n.childNodes.length)for(o=0;o<n.childNodes.length;o++)if(r(n.childNodes[o],!1),!e&&!t)return}else{if(3!=n.nodeType)return e=!1,void(t=!1);var a=n.nodeValue;if(a&&a.length)for(var o=0;o<a.length;o++)if(" "!=a[o]&&""!=a[o])return e=!1,void(i&&(t=!1))}};r(n.$,!0)}}return{isEmpty:e,isPlainText:t}},e.prototype.isEmpty=function(){return this.inspectContent().isEmpty},e.prototype.isPlainText=function(){return this.inspectContent().isPlainText},e.prototype.getHTML=function(){if(!this.editor)return"";var e;try{"wysiwyg"!==this.editor.mode&&this.editor.commands.source.exec(),e=this.editor.getData()}catch(t){e=this.editor.document.$.activeElement.innerHTML}return e=e.replace(/&#8203/g,"")},e.prototype.getText=function(){var e="";if(this.editor&&!this.isEmpty()){var t=this.editor.editable();t&&(e=t.getText())}return e},e.prototype.setData=function(e){if(this.editor)try{return this.unselectAll(),this.editor.setData(e)}catch(e){this.logger.warn("[setData]: exception happened")}},e.prototype.contentChanged=function(){this.editor&&this.editor.fire("change")},e.prototype.setCursorToEnd=function(e){if(void 0===e&&(e=!0),this.editor){var t=this.editor.createRange();t.moveToElementEditablePosition(this.editor.editable(),e),this.editor.getSelection().selectRanges([t])}},e.prototype.cancelEvent=function(e){e.data&&e.data.preventDefault&&e.data.preventDefault(!0),e.cancel&&e.cancel()},e.prototype.disposeEditor=function(){this.saveLastKey(null),this.editor.pasteFilter&&this.editor.pasteFilter.destroy&&this.editor.pasteFilter.destroy(),this.editor.pasteFilter=null,this.editor.element&&this.editor.element.$&&this.editor.element.$.form?this.editor.element.$.form.submit=null:this.logger.warn("TextEditor: Form submit not present in editor")},e.prototype.attachEditorEvents=function(){var e=this;if(this.editor){this.ckEditorEventRegistrations.push(this.editor.on("key",function(t){e.onKey(t)},null,null,1)),this.ckEditorEventRegistrations.push(this.editor.on("keypress",function(t){e.onKeyPress(t)},null,null,1)),this.ckEditorEventRegistrations.push(this.editor.editable().on("keydown",function(t){e.onKeyDown(t)},null,null,-2)),this.ckEditorEventRegistrations.push(this.editor.editable().on("keyup",function(t){e.onKeyUp(t)})),this.ckEditorEventRegistrations.push(this.editor.editable().on("compositionstart",function(t){e.isImeCompositionInProgress=!0})),this.ckEditorEventRegistrations.push(this.editor.editable().on("compositionupdate",function(t){e.isImeCompositionInProgress=!0,e.onChange(t)})),this.ckEditorEventRegistrations.push(this.editor.editable().on("compositionend",function(t){e.isImeCompositionInProgress=!1})),this.ckEditorEventRegistrations.push(this.editor.editable().on("mouseup",function(t){e.checkForSelectionChanged()})),this.ckEditorEventRegistrations.push(this.editor.editable().on("mousedown",function(t){e.tooltipService.clearAllTooltips()})),this.ckEditorEventRegistrations.push(this.editor.editable().on("click",function(t){e.saveLastKey(null),e.isEventHandlingPaused()||(e.handleClickOnReadonlyElement(t),e.handleClickOnHyperLink(t))})),this.ckEditorEventRegistrations.push(this.editor.on("beforeSubmit",function(t){e.callObjectHandlers(t)})),this.ckEditorEventRegistrations.push(this.editor.on("dataReady",function(t){e.callObjectHandlers(t)})),this.ckEditorEventRegistrations.push(this.editor.on("change",function(t){e.onChange(t)})),this.ckEditorEventRegistrations.push(this.editor.on("selectionChange",function(t){if(!e.isEventHandlingPaused()){if(t.data.selection.isFake){var i=t.data.selection.getSelectedElement();e.setElementSelectionHighlight(i&&i.$)}else e.setElementSelectionHighlight(null),e.adjustSelectionForInlineSemanticObjects(t);e.callObjectHandlersForSelectionChange(t),e.activeCommand&&!e.isSelectionInActiveCommand()&&e.resetActiveHandler()}})),this.ckEditorEventRegistrations.push(this.editor.on("focus",function(t){e.onFocus(t)})),this.ckEditorEventRegistrations.push(this.editor.on("blur",function(t){e.saveLastKey(null)}));this.ckEditorEventRegistrations.push(this.editor.on("paste",function(t){if(!e.isEventHandlingPaused()){e.pauseEventHandling(),e.analyticsService.eventTrack(e.constants.usage.pasteOccurred),e.saveLastKey(null);var i=!1,n=t.data&&t.data.dataValue,r=n,s=n&&jQuery.parseHTML(n);s&&1===s.length&&s[0].tagName&&"ts-text-command"===s[0].tagName.toLowerCase()&&(r=s[0].textContent),e.activeCommand&&e.activeCommand.handler&&!e.activeCommand.handler.canHandlePaste(r)&&e.resetActiveHandler();for(var a in e.semanticObjectHandlers){var o=e.semanticObjectHandlers[a];if(o.shouldUpcastOnPaste(t,s)){o.upcastOnPaste(t,s),i=!0;break}}i&&t.stop()}},null,{editor:this.editor})),this.ckEditorEventRegistrations.push(this.editor.on("afterPaste",function(t){e.callObjectHandlers(t)})),this.attachStyleStateChange(this.constants.editor.styles.bold),this.attachStyleStateChange(this.constants.editor.styles.italic),this.attachStyleStateChange(this.constants.editor.styles.underline),this.attachStyleStateChange(this.constants.editor.styles.numberedlist),this.attachStyleStateChange(this.constants.editor.styles.bulletedlist),this.attachStyleStateChange(this.constants.editor.styles.hyperlink),this.attachStyleStateChange(this.constants.editor.styles.h1),this.attachStyleStateChange(this.constants.editor.styles.h2),this.attachStyleStateChange(this.constants.editor.styles.h3),this.attachStyleStateChange(this.constants.editor.styles.div),this.attachStyleStateChange(this.constants.editor.styles.blockquote),this.attachStyleStateChange(this.constants.editor.styles.pre)}},e.prototype.attachStyleStateChange=function(e){var t=this,i=new CKEDITOR.style({element:e},null);i&&this.editor.attachStyleStateChange(i,function(i){t.styleStateChangeCallback&&t.styleStateChangeCallback(e,i)})},e.prototype.registerStyleStateChangeCallback=function(e){this.styleStateChangeCallback=e},e.prototype.registerOnKeyDownCallback=function(e){this.onKeyDownCallback=e},e.prototype.registerFormatCommandEnabledChanged=function(e){this.formatCommandEnabledChanged=e},e.prototype.registerFormatCommandOptionsChanged=function(e){this.formatCommandOptionsChanged=e},e.prototype.onKey=function(e){if(this.saveLastKey(e),e.data.parent=e,this.overrideLeftRightArrows(e.data))this.preventEventPropagation(e.data);else{if(this.activeContextMenuHandler)try{if(this.activeContextMenuHandler.onKeyDownEvent(e.data))return void this.preventEventPropagation(e.data)}catch(e){this.logger.error("[onKey]: exception happened")}if(this.adjustSelectionForInlineSemanticObjects(e),this.activeCommand)try{this.activeCommand.handler.onKeyDownEvent(e.data)}catch(e){this.logger.error("[onKey]: exception happened")}}},e.prototype.onKeyPress=function(e){if(this.saveLastKey(e),e.data.parent=e,this.overrideLeftRightArrows(e.data))this.preventEventPropagation(e.data);else{if(this.activeContextMenuHandler)try{if(this.activeContextMenuHandler.onKeyDownEvent(e.data))return void this.preventEventPropagation(e.data)}catch(e){this.logger.error("[onKeyPress]: exception happened")}if(this.activeCommand)try{this.activeCommand.handler.onKeyDownEvent(e.data)}catch(e){this.logger.error("[onKeyPress]: exception happened")}}},e.prototype.onFocus=function(e){var t=document.getSelection();t&&t.containsNode(e.sender.container.$,!0)&&(e.sender.container.$.contains(t.anchorNode)||this.setCursorToEnd())},e.prototype.onKeyDown=function(e){if(this.saveLastKey(e),this.adjustSelectionForInlineSemanticObjects(e),!(e.data.$.altKey||e.data.$.ctrlKey||e.data.$.metaKey||1!=e.data.$.key.length&&e.data.$.keyCode!==this.constants.keyCodes.enter&&e.data.$.keyCode!==this.constants.keyCodes.delete&&e.data.$.keyCode!==this.constants.keyCodes.backspace)){var t=this.getDomRangeFromSelection();if(t&&!t.collapsed){var i=/\<[^>]+\sitemscope/,n=this.textRangeHelper.serializeRange(t);i.test(n)&&(t.deleteContents(),this.resetSelectionFormat())}}this.isImeCompositionInProgress||(this.activeCommand&&this.activeCommand.handler?(this.activeCommand.handler.onEditingEvent(e),this.activeCommand.handler.shouldStopImmediatePropagationWhileActive(e.data.$)||this.callObjectHandlers(e)):this.callObjectHandlers(e),this.onKeyDownCallback&&this.onKeyDownCallback(e&&e.data&&e.data.$))},e.prototype.onKeyUp=function(e){if(this.saveLastKey(e),this.checkForSelectionChanged(),!this.isImeCompositionInProgress)if(this.activeCommand)try{this.activeCommand.handler.onKeyUpEvent(e.data)}catch(e){this.logger.error("[onKeyUp]: exception happened")}else this.callObjectHandlers(e)},e.prototype.onChange=function(e){this.editor.undoManager.hasRedo||this.isEventHandlingPaused()||(this.activeCommand&&!this.isSelectionInActiveCommand()&&this.resetActiveHandler(),this.adjustSelectionForInlineSemanticObjects(),this.callObjectHandlers(e),this.handleCommand())},e.prototype.callObjectHandlers=function(e){for(var t=0;t<this.semanticObjectHandlers.length;t++){if(e.data&&e.data.$&&e.data.$.defaultPrevented)return;this.semanticObjectHandlers[t].onEditingEvent(e)}},e.prototype.callObjectHandlersForSelectionChange=function(e){for(var t=0;t<this.semanticObjectHandlers.length;t++){if(e.data&&e.data.$&&e.data.$.defaultPrevented)return;this.semanticObjectHandlers[t].onSelectionChange(e)}},e.prototype.isEventHandlingPaused=function(){return this.eventHandlingPauseCount>0},e.prototype.pauseEventHandling=function(){this.eventHandlingPauseCount=this.eventHandlingPauseCount>=0?this.eventHandlingPauseCount+1:1,this.deferResumeEventHandling(!0)},e.prototype.resumeEventHandling=function(e){void 0===e&&(e=!1),e?this.eventHandlingPauseCount=0:this.eventHandlingPauseCount--},e.prototype.deferResumeEventHandling=function(e){var t=this;void 0===e&&(e=!1),this.$timeout(function(){t.resumeEventHandling(e)},0,!1)},e.prototype.preventEventPropagation=function(e){var t=e.domEvent.$;t.preventDefault(),t.stopPropagation(),e.parent.stop(),e.parent.cancel()},e.prototype.cleanNodeOfFC=function(e){void 0===e&&(e=this.getEditableContentRoot());try{for(var t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT),i=/\u200b/g;t.nextNode();){var n=t.currentNode;n.nodeValue.startsWith("")&&(n.nodeValue=n.nodeValue.replace(i,""),""===n.nodeValue&&n.parentNode.removeChild(n))}}catch(e){this.logger.error("[cleanupFC]: exception happened")}},e.prototype.handleUndoRedo=function(e){_.forEach(this.semanticObjectHandlers,function(t){t.onUndoOrRedo(e)})},e.prototype.cleanupFC=function(){this.cleanNodeOfFC()},e.prototype.handleCommand=function(){if(this.activeCommand&&this.isSelectionInActiveCommand()){this.activeCommand.wrapper&&this.activeCommand.range.selectNodeContents(this.activeCommand.wrapper);try{n=this.getCommandText(this.activeCommand);if(this.activeCommand.handler.canHandleText(n))return void this.activeCommand.handler.handleText(n)}catch(e){this.logger.error("[handleCommand]: exception happened")}}this.resetActiveHandler();for(var e in this.semanticObjectHandlers){var t=this.semanticObjectHandlers[e];if(!this.isImeCompositionInProgress||t.shouldHandleWhenIMEComposing()){var i=this.getCommand(t);if(i){this.logger.debug("commandRange is truthy");var n=this.getCommandText(i);if(this.lastInvalidCommand&&this.lastInvalidCommand.length&&n.startsWith(this.lastInvalidCommand))continue;try{if(t.canHandleText(n)){if(this.activeCommand=i,!t.options.noWrapper){var r=i.range.commonAncestorContainer;t instanceof teamspace.services.LinkTextHandler&&(r=i.range.startContainer);var s=r.nodeType==Node.ELEMENT_NODE?r:r.parentNode;t.canHandleElement(s)?this.activeCommand.wrapper=s:this.wrapCommand()}this.commandSearchFailures=0,this.activeCommand.handler.handleText(n);break}}catch(e){this.logger.error("[handleCommand]: exception happened")}}}}},e.prototype.commandSearchResultsChanged=function(e){if(this.activeCommand)if(e.length)this.commandSearchFailures=0,this.setCommandValid(!0),this.hasSearchResults=!0;else{if(this.activeCommand.handler instanceof teamspace.services.PeoplePickerHandler){var t=this.getCommandText(this.activeCommand);!this.isImeCompositionInProgress&&this.isInvalidCommand(++this.commandSearchFailures,t)?(this.lastInvalidCommand=t,this.resetActiveHandler()):this.setCommandValid(!1)}else this.resetActiveHandler();this.hasSearchResults=!1}},e.prototype.isInvalidCommand=function(t,i){return!!i&&(t>e.maxCommandSearchFailures&&i.length>e.maxCommandSearchFailures||this.lastKey.keyCode===this.constants.keyCodes.enter&&i!==this.activeCommand.handler.invokeCharacter)},e.prototype.teardownEditor=function(e){if(void 0===e&&(e=!1),this.editor){e&&this.editor.setData("");try{this.hasActiveHandler()&&this.resetActiveHandler(),this.styleStateChangeCallback=null,this.onKeyDownCallback=null,this.formatCommandEnabledChanged=null,this.formatCommandOptionsChanged=null;for(var t=0;t<this.ckEditorEventRegistrations.length;t++)this.ckEditorEventRegistrations[t].removeListener();this.ckEditorEventRegistrations=[],CKEDITOR.currentInstance=null,this.disposeEditor(),this.editor.editable()&&this.editor.editable().removeAllListeners(),this.editor.destroy(),this.editor=null}catch(e){this.logger.error("Exception while tearing down editor")}this.semanticObjectHandlers.forEach(function(e){return e.dispose()}),this.semanticObjectHandlers=null,this.editorHooks.forEach(function(e){return e.dispose()}),this.editorHooks=null,this.activeCommand=null}},e.prototype.hasActiveHandler=function(){return!!this.activeCommand},e.prototype.resetActiveHandler=function(){if(this.activeCommand){try{this.activeCommand.handler.reset()}catch(e){this.logger.error("[resetActiveHandler]: exception happened")}this.activeCommand=null,this.commandIsValid=!1,this.commandWasValid=!1,this.commandSearchFailures=0,this.unwrapCommand(),this.resetSelectionFormat()}},e.prototype.resetCommandWrapper=function(){this.activeCommand&&(this.activeCommand.range=null,this.activeCommand.wrapper=null)},e.prototype.resetSelectionFormat=function(){var e=document.getSelection();if(e&&e.rangeCount){var t=e.getRangeAt(0);e.removeAllRanges(),t&&this.selectRange(t),this.editor.getSelection().reset()}},e.prototype.deregisterHandler=function(e){e&&_.pull(this.semanticObjectHandlers,e)},e.prototype.registerHandler=function(e){e&&!_.find(this.semanticObjectHandlers,function(t){return t==e})&&this.semanticObjectHandlers.push(e)},e.prototype.registerContextMenuHandler=function(e){e&&!_.find(this.contextMenuHandlers,function(t){return t==e})&&this.contextMenuHandlers.push(e)},e.prototype.setActiveContextMenuHandler=function(e){this.activeContextMenuHandler=e},e.prototype.onBeforeSubmit=function(){this.editor.fire(this.constants.events.messages.beforeSubmit)},e.prototype.deregisterHook=function(e){e&&_.pull(this.editorHooks,e)},e.prototype.registerHook=function(e){e&&!_.find(this.editorHooks,function(t){return t==e})&&this.editorHooks.push(e)},e.prototype.isUnstylable=function(e){return"false"==e.getAttribute("contentEditable")||e.getAttribute("data-nostyle")},e.prototype.setColor=function(e,t){var i=this;this.editor.fire("saveSnapshot");var n=e===this.constants.editor.commands.back?this.backStyle:this.foreStyle;this.editor.removeStyle(new CKEDITOR.style(n,{color:"inherit"})),t&&(n.childRule=e==this.constants.editor.commands.back?function(e){return i.isUnstylable(e)}:function(e){return!(e.is("a")||e.getElementsByTag("a").count())||i.isUnstylable(e)},this.editor.applyStyle(new CKEDITOR.style(n,{color:t}))),this.editor.fire("saveSnapshot")},e.prototype.setFontSize=function(e){this.editor.fire("saveSnapshot"),this.editor.removeStyle(new CKEDITOR.style(this.fontSizeStyle,{size:"inherit"})),this.editor.applyStyle(new CKEDITOR.style(this.fontSizeStyle,{size:e})),this.editor.fire("saveSnapshot")},e.prototype.editCommand=function(e,t){switch(e){case this.constants.editor.commands.fore:this.setColor(this.constants.editor.commands.fore,t);break;case this.constants.editor.commands.clearFore:this.editor.removeStyle(new CKEDITOR.style(this.foreStyle,{color:"inherit"}));break;case this.constants.editor.commands.clearBack:this.editor.removeStyle(new CKEDITOR.style(this.backStyle,{color:"inherit"}));break;case this.constants.editor.commands.back:this.setColor(this.constants.editor.commands.back,t),this.collapseSelection();break;case this.constants.editor.commands.fontSize:this.setFontSize(t);break;case this.constants.editor.commands.blockquote:this.editor.execCommand("blockquote");break;case this.constants.editor.styles.h1:case this.constants.editor.styles.h2:case this.constants.editor.styles.h3:case this.constants.editor.styles.div:case this.constants.editor.styles.pre:case this.constants.editor.styles.blockquote:this.toggleStyle(e);break;case this.constants.editor.commands.insertHyperlink:this.insertHyperlink(t);break;case this.constants.editor.commands.prepareInsertHyperlink:this.prepareForInsertHyperlink();break;case this.constants.editor.commands.finishInsertHyperlink:this.finishInsertHyperlink();break;default:this.editor.execCommand(e)}},e.prototype.finishInsertHyperlink=function(){var e=this.editor.getSelection();e&&e.getRanges().length&&new CKEDITOR.style(this.selectionStyle,null).removeFromRange(e.getRanges()[0],this.editor),this.unlockUndo()},e.prototype.prepareForInsertHyperlink=function(){this.saveUndoSnapshot(!0),this.lockUndo(!0);var e=this.editor.getSelection(),t=null;if(e&&e.getRanges().length){var i=e.getRanges()[0],n=i.startContainer;n.type===CKEDITOR.NODE_ELEMENT&&(n=n.getChild(i.startOffset)),t=$(n.$).closest(teamspace.accessibility.Helpers.ElementUtils.Selectors.newComposeBox+" a")[0]}t&&e.selectElement(new CKEDITOR.dom.element(t));var r;if(!e||e.isCollapsed())r={displayText:"",url:""};else{var s="";t&&(s=t.href),r={displayText:e.getSelectedText().replace(/\n|\r/g,""),url:s},this.editor.applyStyle(new CKEDITOR.style(this.selectionStyle,null))}this.formatCommandOptionsChanged(this.constants.editor.commands.insertHyperlink,r)},e.prototype.insertHyperlink=function(e){this.lockUndo(!0);var t=this.hyperlinkHelper.buildHyperlink(e.url,e.displayText),i=this.editor.getSelection(),n=CKEDITOR.dom.element.createFromHtml(t);if(i&&i.getRanges().length&&!i.isCollapsed()){var r=i.getRanges()[0];r.shrink(CKEDITOR.SHRINK_TEXT),this.editor.extractSelectedHtml(),this.editor.insertElement(n),new CKEDITOR.style(this.selectionStyle,null).removeFromRange(r,this.editor),r.moveToElementEditEnd(n)}else this.editor.insertElement(n);this.unlockUndo(),this.saveUndoSnapshot()},e.prototype.toggleStyle=function(e){if(e){var t=new CKEDITOR.style({element:e,type:CKEDITOR.STYLE_BLOCK},null);t.checkActive(this.editor.elementPath(),this.editor)?this.editor.removeStyle(t):(this.editor.applyStyle(t),e===this.constants.editor.styles.pre&&this.formatCodeSnippetBlock())}},e.prototype.formatCodeSnippetBlock=function(){var e=this.analyzeSelection();if(e.inEmptyBlockElement){var t=new CKEDITOR.dom.element("BR");this.editor.insertElement(t);var i=document.createRange();i.selectNodeContents(e.startElement),i.collapse(!0),this.selectRange(i),this.cleanupFC()}},e.prototype.focus=function(e){var t=this,i=(void 0===e?{preserveSelectionRange:!1}:e).preserveSelectionRange,n=function(){if(i){var e=t.editor.getSelection().getRanges()[0];t.editor.focus(),e.select()}else t.editor.focus()};this.editor?this.blurPromise?this.blurPromise.then(function(){return n()}):n():this.logger.warn("Editor was undefined, focus skipped.")},e.prototype.addElement=function(e){return this.addNode(e)},e.prototype.addNodes=function(e){var t=this;e.forEach(function(e){return t.addNode(e)})},e.prototype.addNode=function(e){if(e.nodeType==Node.TEXT_NODE)return this.editor.insertText(e.nodeValue),e;if(e.nodeType==Node.ELEMENT_NODE)try{var t=new CKEDITOR.dom.element(e);return this.editor.insertElement(t),t.$}catch(e){this.logger.error(e.message)}else this.logger.error("unexpected node type "+e.nodeType);return null},e.prototype.saveUndoSnapshot=function(e){void 0===e&&(e=!1),this.pauseEventHandling(),this.editor.fire("saveSnapshot",{contentOnly:!e})},e.prototype.lockUndo=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.editor.undoManager&&this.editor.undoManager.lock(e,t)},e.prototype.unlockUndo=function(){this.editor.undoManager&&this.editor.undoManager.unlock()},e.prototype.insertCommandResult=function(e,t){var i=this;if(void 0===t&&(t=!0),this.activeCommand&&this.activeCommand.range){if(this.pauseEventHandling(),this.editor.focus(),this.activeCommand.wrapper&&this.activeCommand.range.selectNodeContents(this.activeCommand.wrapper),t){this.saveUndoSnapshot(!0);a=document.createTextNode("");this.activeCommand.wrapper?(this.activeCommand.wrapper.parentElement.insertBefore(a,this.activeCommand.wrapper),this.activeCommand.wrapper.parentElement.removeChild(this.activeCommand.wrapper)):(this.activeCommand.range.deleteContents(),this.activeCommand.range.insertNode(a));var n=a.parentNode;if(e)for(c=0;c<e.length;c++)n.insertBefore(e[c],a);this.resetActiveHandler();var r=document.createRange();r.selectNode(a),r.deleteContents();var s=this.ckeditorRangeFromDOMRange(r);s.select(),this.adjustSelectionForInlineSemanticObjects({}),this.saveUndoSnapshot(!0)}else if(this.activeCommand.range.deleteContents(),e){var a=document.createTextNode("");this.activeCommand.range.insertNode(a);for(var o=a.parentNode,c=0;c<e.length;c++)o.insertBefore(e[c],a);(s=document.createRange()).selectNode(a),this.selectRange(s),s.deleteContents()}else this.selectRange(this.activeCommand.range);this.contentChanged(),setTimeout(function(){i.editor.focus()},0)}else this.logger.error("no active command")},e.prototype.getCommand=function(e){var t=e.invokeExpression,i=e.prefixExpression,n=e.options;if(null==t)return null;var r=this.getSelectionBoundaryElement();if(!r)return null;if("CODE"===r.tagName)return null;var s=this.getBlockElement(r);if(s&&"PRE"===s.tagName)return null;if(n.rangeOptions&&n.rangeOptions.stopAtBlocks&&this.getBlockElement(this.getSelectionBoundaryElement(!1))!==s)return null;var a,o,c=n.rangeOptions||{};c.notForward=!0,c.getText=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTextBuilderWhileExpandingToPattern);var l=this.getDomRangeFromSelection();if(!l)return null;var p=this.textRangeHelper.expandRangeToPattern(l,t,c);if(p&&(a=-p.startMoved,o=-p.endMoved,null!=i)){var u=l.cloneRange();if(u.collapse(!0),0!=this.textRangeHelper.extendRange(u,!0,"character",-1)){var h=u.toString().replace(/\u200b/g,"");if(!i.test(h))return null}}return l.collapsed?null:{range:l,selectionStartOffset:a,selectionEndOffset:o,handler:e}},e.prototype.getCommandText=function(e){return e&&e.range&&e.range.toString().replace(/\u200b/g,"")},e.prototype.wrapCommand=function(){try{this.lockUndo(!0);var e=document.createElement("ts-text-command");this.activeCommand.handler instanceof teamspace.services.EmoticonPickerHandler||(e.className="ts-is-valid"),e.appendChild(this.activeCommand.range.extractContents()),this.activeCommand.range.insertNode(e),this.cleanNodeOfFC(e),this.activeCommand.wrapper=e;var t=document.createRange();return t.selectNodeContents(e),this.textRangeHelper.extendRange(t,!0,"character",this.activeCommand.selectionStartOffset,{stopAtElements:!1,stopAtBlocks:!0}),this.textRangeHelper.extendRange(t,!1,"character",this.activeCommand.selectionEndOffset,{stopAtElements:!1,stopAtBlocks:!0}),this.selectRange(t),this.unlockUndo(),this.activeCommand.wrapper}catch(e){this.logger.error("[wrapCommand]: exception happened")}},e.prototype.insertText=function(e){this.editor.insertText(e)},e.prototype.getActiveCommand=function(){return this.activeCommand&&{range:this.activeCommand.range,wrapper:this.activeCommand.wrapper,handler:this.activeCommand.handler}},e.prototype.setActiveCommand=function(e,t){this.resetActiveHandler(),this.activeCommand={range:t,wrapper:null,handler:e},this.wrapCommand()},e.prototype.setActiveCommandRange=function(e){if(this.activeCommand.wrapper)throw new Error("cannot override command range when wrapper element is used");this.activeCommand.range=e},e.prototype.setActiveCommandElement=function(e){this.activeCommand&&(this.activeCommand.wrapper&&this.activeCommand.wrapper!=e&&this.unwrapCommand(),this.activeCommand.wrapper=e,this.activeCommand.range||(this.activeCommand.range=document.createRange()),this.activeCommand.range.selectNodeContents(e))},e.prototype.setCommandValid=function(e){e?(this.commandIsValid=!0,this.commandWasValid=!0,this.activeCommand.wrapper&&$(this.activeCommand.wrapper).addClass("ts-is-valid")):(this.commandIsValid=!1,this.activeCommand.wrapper&&$(this.activeCommand.wrapper).removeClass("ts-is-valid"))},e.prototype.isSelectionInActiveCommand=function(){if(this.activeCommand){var e=document.getSelection().getRangeAt(0),t=e&&e.startContainer;if(t)if(this.activeCommand.wrapper){if(t==this.activeCommand.wrapper||3==t.nodeType&&t.parentNode==this.activeCommand.wrapper)return!0}else if(this.activeCommand.range&&this.activeCommand.range.compareBoundaryPoints(Range.START_TO_START,e)<=0&&this.activeCommand.range.compareBoundaryPoints(Range.END_TO_END,e)>=0)return!0}return!1},e.prototype.handleClickOnHyperLink=function(e){var t=this.$window.CKEDITOR.plugins.link.getSelectedLink(this.editor);t&&(e.data.$.metaKey||e.data.$.ctrlKey)&&this.$window.open(t.$.href)},e.prototype.handleClickOnReadonlyElement=function(e){var t=e.data.getTarget();if(!t.isEditable()){for(;!t.getParent().isEditable();)t=t.getParent();var i=t.getDocumentPosition().x,n=i+t.getSize("width",!0),r=e.data.getPageOffset().x,s=null;if(r<(i+n)/2?r<i+10&&(s="before"):r>n-10&&(s="after"),s){var a=this.editor.createRange();a.moveToClosestEditablePosition(t,"after"===s)&&a.select()}}},e.prototype.overrideLeftRightArrows=function(e){if(e.keyCode===this.constants.keyCodes.left||e.keyCode===this.constants.keyCodes.right){var t=this.localizationService.langDirection===this.constants.languageDirectionStrings.rtl?e.keyCode===this.constants.keyCodes.left:e.keyCode===this.constants.keyCodes.right,i=this.editor.getSelection().getRanges()[0];if(i&&i.collapsed&&!this.doWeHaveAnyContentToSelectOrMoveTo(this.editor.editable().$,i.startContainer.$,i.startOffset,t))return!0}return!1},e.prototype.isCollapsibleWhitespaceCharacter=function(e){switch(e){case" ":case"\t":case"\n":case"\r":case"":return!0;default:return!1}},e.prototype.doWeHaveAnyContentToSelectOrMoveTo=function(e,t,i,n){for(var r=!1;t;){if(t.nodeType==Node.TEXT_NODE)if(n)for(;i<t.length;){if(!this.isCollapsibleWhitespaceCharacter(t.nodeValue[i]))return!0;i++}else for(;i>0;){if(!this.isCollapsibleWhitespaceCharacter(t.nodeValue[i-1]))return!0;i--}else if(n){if(i<t.childNodes.length){if((t=t.childNodes[i]).nodeType==Node.TEXT_NODE){i=0;continue}if(!n||"BR"!=t.nodeName)return!0;if(r)return!0;r=!0}}else if(i>0){if((t=t.childNodes[i-1]).nodeType==Node.TEXT_NODE){i=t.length;continue}return!0}if(t==e)t=null;else{for(var s=0,a=t;a=a.previousSibling;)s++;t=t.parentNode,i=n?s+1:s}}return!1},e.prototype.adjustSelectionForInlineSemanticObjects=function(e){if(this.editor){var t=e&&e.data&&e.data.selection;t||(t=this.editor.getSelection());var i=t&&t.getRanges()[0];if(i){var n=this.isReverseSelection(t.getNative()),r=this.adjustSelectionEdgeForInlineSemanticObjects({node:i.startContainer.$,offset:i.startOffset}),s=this.adjustSelectionEdgeForInlineSemanticObjects({node:i.endContainer.$,offset:i.endOffset});if(r.node!=i.startContainer.$||r.offset!=i.startOffset||s.node!=i.endContainer.$||s.offset!=i.endOffset){var a=t.getNative();n&&a.setBaseAndExtent?(a.setBaseAndExtent(s.node,s.offset,r.node,r.offset),this.editor.getSelection().reset()):(i.setStart(new CKEDITOR.dom.node(r.node),r.offset),i.setEnd(new CKEDITOR.dom.node(s.node),s.offset),i.select())}}}},e.prototype.isReverseSelection=function(e){if(!e||e.isCollapsed||!e.anchorNode||!e.extentNode)return!1;var t=document.createRange();t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.anchorNode,e.anchorOffset);var i=document.createRange();return i.setStart(e.extentNode,e.extentOffset),i.setEnd(e.extentNode,e.extentOffset),!!t.compareBoundaryPoints&&1===t.compareBoundaryPoints(Range.START_TO_START,i)},e.prototype.adjustSelectionEdgeForInlineSemanticObjects=function(e){for(var t=this.getEditableContentRoot(),i=e.node;i&&i!=t;){if(i.attributes&&i.attributes.itemtype&&(i.attributes.itemtype.value==this.constants.semanticObjectSchemas.mention||i.attributes.itemtype.value==this.constants.semanticObjectSchemas.inputExtension)){for(var n=0,r=i;r=r.previousSibling;)n++;if(i.attributes.itemtype.value==this.constants.semanticObjectSchemas.mention){var s=document.createRange();if(this.setDomRange(s,i.parentNode,n,e.node,e.offset),""==s.toString()){e.node=i.parentNode,e.offset=n;break}if(s.setStart(e.node,e.offset),s.setEnd(i.parentNode,n+1),""==s.toString()){e.node=i.parentNode,e.offset=n+1;break}break}if(i.attributes.itemtype.value==this.constants.semanticObjectSchemas.inputExtension){e.node=i.parentNode,e.offset=n+1;break}}i=i.parentNode}for(;3==e.node.nodeType&&(""===e.node.nodeValue||""===e.node.nodeValue);)if(0==e.offset&&e.node.previousSibling&&3==e.node.previousSibling.nodeType)e.node=e.node.previousSibling,e.offset=e.node.length;else{if(e.offset!=e.node.length||!e.node.nextSibling)break;for(var n=0,r=e.node;r=r.previousSibling;)n++;e.node=e.node.parentNode,e.offset=n+1}return e},e.prototype.unwrapCommand=function(){var e=this.activeCommand&&this.activeCommand.wrapper;if(!e){var t=$("ts-text-command");t.length&&(e=t[0])}if(e){try{this.logger.debug("unwrapping text command"),this.lockUndo(!1);var i=e.parentNode;if(i){var n=this.bookmarkSelectionInContainer(e),r=e;_.forEachRight(e.childNodes,function(e){return r=i.insertBefore(e,r)}),i.removeChild(e),this.selectContainerBookmark(n)}}catch(e){this.logger.error("error unwrapping command")}this.unlockUndo()}this.activeCommand&&(this.activeCommand.wrapper=null,this.activeCommand.range=null)},e.prototype.splitElement=function(e,t,i){var n=document.createRange();n.selectNodeContents(e),n.setStart(t,i);var r=n.extractContents(),s=document.createElement(e.tagName);return s.appendChild(r),e.parentNode.insertBefore(s,e.nextSibling),n.selectNode(e),n.collapse(!1),n},e.prototype.selectElement=function(e){this.isDebugging&&this.logger.debug("select: "+e.nodeName);var t=new CKEDITOR.dom.element(e);this.editor.getSelection().selectElement(t)},e.prototype.selectElementContent=function(e){this.isDebugging&&this.logger.debug("selectContent: "+e.nodeName);var t=document.createRange();t.selectNodeContents(e),this.selectRange(t)},e.prototype.bookmarkTextPositionInContainer=function(e,t){this.isDebugging&&this.logger.debug("Inside bookmarkTextPositionInContainer");for(var i=e.parentNode,n=0,r=e;r=r.previousSibling;)n++;var s=document.createRange();return this.setDomRange(s,e,0,t.node,t.offset),{containerNode:i,containerOffset:n,textOffset:s.toString().length}},e.prototype.getTextPositionFromContainerBookmark=function(e){if(this.isDebugging&&this.logger.debug("Inside getTextPositionFromContainerBookmark"),e.textOffset){var t=document.createRange();return this.setDomRange(t,e.containerNode,e.containerOffset,e.containerNode,e.containerOffset),this.textRangeHelper.extendRange(t,!0,"character",e.textOffset,{stopAtElements:!1,root:e.containerNode}),{node:t.endContainer,offset:t.endOffset}}return{node:e.containerNode,offset:e.containerOffset}},e.prototype.bookmarkSelectionInContainer=function(e,t){void 0===t&&(t=!1),this.isDebugging&&this.logger.debug("attempting to bookmark selection in container");var i=this.editor.getSelection().getRanges();if(i&&i.length){var n=i[0],r=this.bookmarkTextPositionInContainer(e,{node:n.startContainer.$,offset:n.startOffset});return{start:r,end:t?r:this.bookmarkTextPositionInContainer(e,{node:n.endContainer.$,offset:n.endOffset}),collapsed:t}}return null},e.prototype.selectContainerBookmark=function(e){if(this.isDebugging&&this.logger.debug("Attempting to select container bookmark"),e){var t=this.getTextPositionFromContainerBookmark(e.start),i=e.collapsed?t:this.getTextPositionFromContainerBookmark(e.end),n=this.editor.createRange();n.setStart(new CKEDITOR.dom.node(t.node),t.offset),n.setEnd(new CKEDITOR.dom.node(i.node),i.offset),this.pauseEventHandling(),n.select(),this.isDebugging&&this.logger.debug("range selected between start offset={0} and end offset={1}",t.offset,i.offset)}},e.prototype.setElementSelectionHighlight=function(e){this.lockUndo(!1),$(".ts-element-selection").removeClass("ts-element-selection"),e&&$(e).addClass("ts-element-selection"),this.unlockUndo()},e.prototype.analyzeSelection=function(){var e=this.editor&&this.editor.editable().$,t=this.getDomRangeFromSelection();if(!t)return this.isDebugging&&this.logger.warn("no selection"),{};var i=t.startContainer,n=t.startOffset,r=t.endContainer,s=t.endOffset,a=t.collapsed,o=1==t.startContainer.nodeType?t.startContainer:t.startContainer.parentNode,c=this.getBlockElement(o),l=1==t.endContainer.nodeType?t.endContainer:t.endContainer.parentNode,p=this.getBlockElement(l),u=!0,h=!0,d=!0,g=!1,v=!1;if(this.textRangeHelper.extendRange(t,!0,"character",-1,{stopAtBlocks:!0,stopAtElements:!1,root:e}))u=!1,h=!1;else if(this.textRangeHelper.extendRange(t,!0,"character",-1,{brAsText:!0,stopAtBlocks:!0,stopAtElements:!1,root:c}))v=!0,h=!1;else if(i.nodeType==Node.TEXT_NODE)for(var m=i.previousSibling;m;m=m.previousSibling)if(m.nodeType==Node.ELEMENT_NODE){h=!1;break}return h&&this.textRangeHelper.extendRange(t,!0,"character",-1,{brAsText:!0,stopAtBlocks:!1,stopAtElements:!1,root:c})&&(h=!1),this.textRangeHelper.extendRange(t,!1,"character",1,{stopAtBlocks:!0,stopAtElements:!1,root:e})?(u=!1,d=!1):this.textRangeHelper.extendRange(t,!1,"character",1,{brAsText:!0,stopAtBlocks:!0,stopAtElements:!1,root:p})&&(g=!0,this.textRangeHelper.extendRange(t,!1,"character",1,{brAsText:!0,stopAtBlocks:!1,stopAtElements:!1,root:p})&&(d=!1)),d&&this.textRangeHelper.extendRange(t,!1,"character",1,{brAsText:!0,stopAtBlocks:!1,stopAtElements:!1,root:p})&&(d=!1),{startNode:i,startOffset:n,endNode:r,endOffset:s,collapsed:a,startElement:o,startBlockElement:c,endElement:l,endBlockElement:p,atStartOfBlockElement:h,atEndOfBlockElement:d,inEmptyBlock:u,inEmptyBlockElement:a&&h&&d,beforeBr:g,afterBr:v}},e.prototype.isFocusOnFirstLine=function(){return!this.editor.getSelection().getRanges()[0].getPreviousNode()},e.prototype.getDomRangeFromSelection=function(){var e=document.getSelection();return e.rangeCount&&e.getRangeAt(0).cloneRange()},e.prototype.ckeditorRangeFromDOMRange=function(e){this.isDebugging&&this.logger.debug("Creating CKEditor Range from Document Range"),e&&this.isDebugging&&this.logger.debug("for the domRange given startOffset={0}, endOffset={1}",e.startOffset,e.endOffset);var t;return e&&e.startContainer&&e.endContainer&&e.startOffset>=0&&e.endOffset>=0&&(t=this.editor.createRange())&&(t.setStart(new CKEDITOR.dom.node(e.startContainer),e.startOffset),t.setEnd(new CKEDITOR.dom.node(e.endContainer),e.endOffset)),t},e.prototype.normalizeDomRange=function(e){if(e){if(e.startContainer&&e.startContainer.nodeType==Node.TEXT_NODE&&e.startOffset>=e.startContainer.length){for(var t=0,i=e.startContainer;i.previousSibling;i=i.previousSibling,t++);e.setStart(e.startContainer.parentNode,e.startContainer.length?t+1:t)}if(e.endContainer&&e.endContainer.nodeType==Node.TEXT_NODE&&e.endOffset>=e.endContainer.length){for(var t=0,i=e.endContainer;i.previousSibling;i=i.previousSibling,t++);e.setEnd(e.endContainer.parentNode,e.endContainer.length?t+1:t)}}},e.prototype.setDomRange=function(e,t,i,n,r){t?n?t.parentNode||t.nodeType==Node.DOCUMENT_NODE?n.parentNode||n.nodeType==Node.DOCUMENT_NODE?(3==t.nodeType?e.selectNode(t):e.selectNodeContents(t),i=Math.min(i,3==t.nodeType?t.length:t.childNodes.length),r=Math.min(r,3==n.nodeType?n.length:n.childNodes.length),e.setStart(t,i),e.setEnd(n,r),this.normalizeDomRange(e)):this.logger.error("endContainer not in tree"):this.logger.error("startContainer not in tree"):this.logger.error("no endContainer"):this.logger.error("no startContainer")},e.prototype.getBlockElement=function(e){for(var t=this.editor.editable().$,i=e.nodeType==Node.ELEMENT_NODE?e:e.parentNode;i&&i!=t;){var n=getComputedStyle(i).display;if("none"!=n&&"inline"!=n)break;i=i.parentElement}return i},e.prototype.isAtStart=function(e,t){for(var i=e;i;i=i.parentNode){if(i==t)return!0;if(i.previousSibling)break}return!1},e.prototype.isAtEnd=function(e,t){for(var i=e;i;i=i.parentNode){if(i==t)return!0;if(i.nextSibling)break}return!1},e.prototype.findContainerOfType=function(e,t,i){for(i||(i=this.editor&&this.editor.editable().$);e&&e!=i;){if(t.indexOf(e.tagName)>=0)return e;e=e.parentElement}return null},e.prototype.selectRange=function(e){this.normalizeDomRange(e),document.getSelection().removeAllRanges(),document.getSelection().addRange(e),this.editor.getSelection().reset()},e.prototype.collapseSelection=function(e){void 0===e&&(e=!1);var t=this.editor.getSelection();if(t){var i=t.getRanges();if(i&&i.length>0){var n=i[0];n.collapsed||(n.collapse(e),t.selectRanges([n]))}}},e.prototype.unselectAll=function(){var e=document.getSelection();e&&e.removeAllRanges();var t=this.editor.getSelection();t&&t.reset()},e.prototype.getTextBeforeSelection=function(){var e="";if(this.editor){var t=this.editor.editable();if(t&&""!==t.$.textContent){var i=this.editor.getSelection().getRanges()[0],n=this.editor.createRange();n.selectNodeContents(t),i&&n.setEnd(i.startContainer,i.startOffset),e=n.cloneContents().$.textContent}}return e},e.prototype.getSelectionBoundaryElement=function(e){void 0===e&&(e=!0);var t=document.getSelection();if(!t.rangeCount)return null;var i=t.getRangeAt(0),n=e?i.startContainer:i.endContainer;return n.nodeType==Node.TEXT_NODE?n.parentNode:n},e.prototype.getSelectedText=function(){return this.editor.getSelection().getSelectedText()},e.prototype.checkAndSelectCurrentWord=function(){var e=this.getDomRangeFromSelection(),t=this.textRangeHelper.expandRangeToPattern(e,/\w+/);if(!t)return!1;var i=e.startOffset+t.startMoved,n=e.endOffset+t.endMoved,r=!1;return this.$window.spellCheckHandler&&this.$window.spellCheckHandler.isMisspelled(this.getText().substring(i,n))&&(this.selectRange(e),r=!0),r},e.prototype.spellCheckSelectedText=function(e){return!(e.indexOf(" ")>=0)&&!(!this.$window.spellCheckHandler||!this.$window.spellCheckHandler.isMisspelled(e))},e.ckEditorResourceOverride=!1,e.maxCommandSearchFailures=2,e}();t.TextEditor=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.logger=e.newLogger("TextRangeHelper"),this.isDebugging=!!t}return e.prototype.findTextForward=function(e,t,i){this.isDebugging&&this.logger.log("Attempting to find text forward");for(var n,r;e&&"break"!==function(){if(e.nodeType==Node.TEXT_NODE&&t<e.length)return n=e,r=t,"break";if(i.stopAtPosition&&e==i.stopAtPosition.node&&t==i.stopAtPosition.offset)return"break";if(e.childNodes&&t<e.childNodes.length)e=e.childNodes[t],t=0;else{if(e===i.root)return"break";t=_.indexOf(e.parentNode.childNodes,e)+1,e=e.parentNode}if(!e)return"break";if(e.nodeType==Node.ELEMENT_NODE){var s=t>=e.childNodes.length?e:e.childNodes[t].nodeType==Node.ELEMENT_NODE?e.childNodes[t]:null;if(s){if(i.stopAtElements)return"break";if(i.elementsToSkip&&_.find(i.elementsToSkip,function(e){return e===s}))return"continue";if("IMG"==s.tagName||i.brAsText&&"BR"==s.tagName)return n=s.parentNode,r=_.indexOf(s.parentNode.childNodes,s),"break";if(i.stopAtBlocks&&"BR"==s.tagName)return"break";var a=getComputedStyle(s);if("inline-block"==a.display)return n=s.parentNode,r=_.indexOf(s.parentNode.childNodes,s),"break";if(i.stopAtBlocks&&"none"!=a.display&&"inline"!=a.display)return"break"}}}(););return{node:n,offset:r}},e.prototype.findTextBackward=function(e,t,i){this.isDebugging&&this.logger.log("Attempting to find text backward");for(var n,r;e&&"break"!==function(){if(e.nodeType==Node.TEXT_NODE&&t>0)return n=e,r=t,"break";if(i.stopAtPosition&&e==i.stopAtPosition.node&&t==i.stopAtPosition.offset)return"break";if(e.childNodes&&t>0)t>e.childNodes.length&&(t=e.childNodes.length),e=e.childNodes[t-1],t=e.nodeType==Node.TEXT_NODE?e.length:e.childNodes?e.childNodes.length:0;else{if(e===i.root)return"break";t=_.indexOf(e.parentNode.childNodes,e),e=e.parentNode}if(!e)return"break";if(e.nodeType==Node.ELEMENT_NODE){var s=0==t?e:e.childNodes[t-1].nodeType==Node.ELEMENT_NODE?e.childNodes[t-1]:null;if(s){if(i.stopAtElements)return"break";if(i.elementsToSkip&&_.find(i.elementsToSkip,function(e){return e===s}))return"continue";if("IMG"==s.tagName||i.brAsText&&"BR"==s.tagName)return n=s.parentNode,r=_.indexOf(s.parentNode.childNodes,s)+1,"break";if(i.stopAtBlocks&&"BR"==s.tagName)return"break";var a=getComputedStyle(s);if("inline-block"==a.display)return n=s.parentNode,r=_.indexOf(s.parentNode.childNodes,s)+1,"break";if(i.stopAtBlocks&&"none"!=a.display&&"inline"!=a.display)return"break"}}}(););return{node:n,offset:r}},e.prototype.moveByVisibleCharacters=function(e,t,i,n){this.isDebugging&&this.logger.log("Trying to Move by visible characters");var r={node:e,offset:t},s=function(){var e=0,t="",i=n&&n.getText,r=function(e){i&&(t+=e)};return{count:function(){return e},result:function(){return t},incrementCount:function(t){e++,r(t)},decrementCount:function(t){e--,r(t)}}}();if(i>=0)for(a=this.findTextForward(r.node,r.offset,n);s.count()<i&&a.node&&(!n.stopAtPosition||a.node!=n.stopAtPosition.node||a.offset!=n.stopAtPosition.offset);)if(a.node.nodeType==Node.TEXT_NODE){o=a.node;a.offset<o.length&&((n.withZws||""!=o.nodeValue[a.offset])&&s.incrementCount(o.nodeValue[a.offset]),a.offset++,r=a),a.offset>=o.length&&(a=this.findTextForward(a.node,a.offset,n))}else a.offset++,s.incrementCount(" "),r=a,a=this.findTextForward(a.node,a.offset,n);else for(var a=this.findTextBackward(r.node,r.offset,n);s.count()>i&&a.node&&(!n.stopAtPosition||a.node!=n.stopAtPosition.node||a.offset!=n.stopAtPosition.offset);)if(a.node.nodeType==Node.TEXT_NODE){var o=a.node;a.offset>0&&((n.withZws||""!=o.nodeValue[a.offset-1])&&s.decrementCount(o.nodeValue[a.offset-1]),a.offset--,r=a),a.offset||(a=this.findTextBackward(a.node,a.offset,n))}else a.offset--,s.decrementCount(" "),r=a,a=this.findTextBackward(a.node,a.offset,n);return{node:r.node,offset:r.offset,countMoved:s.count(),text:s.count()>0?s.result():s.result().split("").reverse().join("")}},e.prototype.extendRange=function(e,t,i,n,r){switch(this.isDebugging&&this.logger.log("Attempting to extend range"),r||(r={}),r.root||r.stopAtBlocks||(r.stopAtElements=!0),i){case"character":if(t){if((s=this.moveByVisibleCharacters(e.startContainer,e.startOffset,n,r))&&0!=s.countMoved)return e.setStart(s.node,s.offset),s.countMoved}else{var s=this.moveByVisibleCharacters(e.endContainer,e.endOffset,n,r);if(s&&0!=s.countMoved)return e.setEnd(s.node,s.offset),s.countMoved}}return 0},e.prototype.shrinkRangeToText=function(e){var t=this.findTextForward(e.startContainer,e.startOffset,{stopAtPosition:{node:e.endContainer,offset:e.endOffset}});t&&t.node&&(t.node!=e.startContainer||t.offset!=e.startOffset)&&e.setStart(t.node,t.offset);var i=this.findTextBackward(e.endContainer,e.endOffset,{stopAtPosition:{node:e.startContainer,offset:e.startOffset}});i&&i.node&&(i.node!=e.endContainer||i.offset!=e.endOffset)&&e.setEnd(i.node,i.offset)},e.prototype.expandRangeToPattern=function(e,t,i){this.isDebugging&&this.logger.log("Attempting to extend range to pattern"),i||(i={}),i.root||i.stopAtBlocks||(i.stopAtElements=!0),i.stopAtBlocks=!0;var n=i.notBackward?{node:e.startContainer,offset:e.startOffset,countMoved:0,text:""}:this.moveByVisibleCharacters(e.startContainer,e.startOffset,-2e3,i),r=i.notForward?{node:e.endContainer,offset:e.endOffset,countMoved:0,text:""}:this.moveByVisibleCharacters(e.endContainer,e.endOffset,2e3,i);if(0!=n.countMoved||0!=r.countMoved){var s=e.cloneRange();s.setStart(n.node,n.offset),s.setEnd(r.node,r.offset);var a=e.toString(),o=i.getText?n.text+a+r.text:s.toString();i.withZws||(a=a.replace(/\u200b/g,""),o=o.replace(/\u200b/g,""));for(var c=new RegExp(t.source,t.ignoreCase?"gi":"g"),l=-n.countMoved,p=l+a.length,u=void 0;u=c.exec(o);){if(u.index+u[0].length>=l){if(u.index>l)return null;var h=u.index-l,d=u.index+u[0].length-p;if(h<0){var g=this.moveByVisibleCharacters(e.startContainer,e.startOffset,h,i);e.setStart(g.node,g.offset)}var v=this.moveByVisibleCharacters(e.startContainer,e.startOffset,u[0].length,i);return e.setEnd(v.node,v.offset),{startMoved:h,endMoved:d}}c.lastIndex=u.index+1}}return null},e.prototype.clearElementEdges=function(e,t,i){if(e.collapsed){if(!1!==i)for(;e.startContainer!=t&&e.startOffset>=(e.startContainer.nodeType==Node.TEXT_NODE?e.startContainer.length:e.startContainer.childNodes.length);)e.setStart(e.startContainer.parentNode,_.indexOf(e.startContainer.parentNode.childNodes,e.startContainer)+1);if(!0!==i)for(;e.endContainer!=t&&0==e.endOffset;)e.setEnd(e.endContainer.parentNode,_.indexOf(e.endContainer.parentNode.childNodes,e.endContainer))}},e.prototype.getLeafNode=function(e,t){for(this.isDebugging&&this.logger.log("getLeafNode");e&&e.nodeType!=Node.TEXT_NODE&&e.childNodes&&t<e.childNodes.length;)e=e.childNodes[t],t=0;return e},e.prototype.isEmpty=function(e){if(e.nodeType==Node.TEXT_NODE)return!e.length;if("BR"==e.nodeName||"HR"==e.nodeName||"IMG"==e.nodeName)return!1;var t=getComputedStyle(e);if("none"!=t.display&&"inline"!=t.display&&"block"!=t.display)return!1;for(var i=e.firstChild;i;i=i.nextSibling)if(!this.isEmpty(i))return!1;return!0},e.prototype.serializeRange=function(e){var t=e.cloneContents(),i=$("<div>");return i.append(t),i.html()},e}();t.TextRangeHelper=n},function(e,t,i){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,i,n,r,s,a){var o=this;this.$q=e,this.$timeout=t,this.$document=i,this.$window=n,this.uuid=r,this.constants=s,this.appConfig=a,this.enableParseUrlDomElements=!1,this.deferred=new Set,this.getFileExtension=function(e){var t=/(?:\.([^.]+))?$/.exec(e)[1];return _.toLower(t)},this.getFileName=function(e){if(void 0===e||null==e)return"";if(-1==e.indexOf("."))return e;var t=/(.+)\.[^.]+$/.exec(e);if(null==t)return e;var i=t[1];return void 0!=i?i:""},this.getIconClass=function(e){var t="boolean"==typeof e.additionalParameter&&typeof e.additionalParameter,i=o.constants,n="";switch(e&&e.type&&e.type.toLowerCase()){case"docx":case"doc":case"docm":case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/vnd.openxmlformats-officedocument.wordprocessingml.template":case"application/vnd.ms-word.document.macroEnabled.12":case"application/vnd.ms-word.template.macroEnabled.12":n=i.css.fileIcons.word;break;case"xlsx":case"xlsb":case"xls":case"xlsm":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.openxmlformats-officedocument.spreadsheetml.template":case"application/vnd.ms-excel.sheet.macroEnabled.12":case"application/vnd.ms-excel.template.macroEnabled.12":case"application/vnd.ms-excel.addin.macroEnabled.12":case"application/vnd.ms-excel.sheet.binary.macroEnabled.12":n=i.css.fileIcons.excel;break;case"pptx":case"potm":case"ppt":case"pptm":case"application/vnd.ms-powerpoint":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.openxmlformats-officedocument.presentationml.template":case"application/vnd.openxmlformats-officedocument.presentationml.slideshow":case"application/vnd.ms-powerpoint.addin.macroEnabled.12":case"application/vnd.ms-powerpoint.presentation.macroEnabled.12":case"application/vnd.ms-powerpoint.template.macroEnabled.12":case"application/vnd.ms-powerpoint.slideshow.macroEnabled.12":n=i.css.fileIcons.powerpoint;break;case"pdf":case"application/pdf":n=i.css.fileIcons.pdf;break;case"vsdx":case"vsdm":case"vsd":n=i.css.fileIcons.visio;break;case"txt":n=i.css.fileIcons.txt;break;case"zip":n=i.css.fileIcons.zip;break;case"one":case"onepkg":case"notebk":n=i.css.fileIcons.onenote;break;case"image/png":case"image/jpg":case"image/gif":case"png":case"jpg":case"gif":case"image/jpeg":case"jpeg":case"tif":case"tiff":n=i.css.fileIcons.picture;break;case"folder":case"channel":case"directory":n=i.css.fileIcons.folder;break;case"mp3":case"wav":case"aav":n=i.css.fileIcons.audio;break;case"mp4":case"mov":case"mpg":case"mpeg":n=i.css.fileIcons.video;break;case"link":n="ts-links";break;default:n=i.css.fileIcons.generic}switch(e&&e.iconSize){case 25:n+="x25";break;case-1:n+="-placeholder"}return t&&(n+="-create-new"),n},this.getSVGBase=function(e,t){var i="";switch((e||"").toLowerCase()){case"docx":case"doc":case"docm":case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/vnd.openxmlformats-officedocument.wordprocessingml.template":case"application/vnd.ms-word.document.macroEnabled.12":case"application/vnd.ms-word.template.macroEnabled.12":i=t.replace("{type}","msft-word");break;case"xlsx":case"xlsb":case"xls":case"xlsm":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.openxmlformats-officedocument.spreadsheetml.template":case"application/vnd.ms-excel.sheet.macroEnabled.12":case"application/vnd.ms-excel.template.macroEnabled.12":case"application/vnd.ms-excel.addin.macroEnabled.12":case"application/vnd.ms-excel.sheet.binary.macroEnabled.12":i=t.replace("{type}","msft-xl");break;case"pptx":case"potm":case"ppt":case"pptm":case"application/vnd.ms-powerpoint":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.openxmlformats-officedocument.presentationml.template":case"application/vnd.openxmlformats-officedocument.presentationml.slideshow":case"application/vnd.ms-powerpoint.addin.macroEnabled.12":case"application/vnd.ms-powerpoint.presentation.macroEnabled.12":case"application/vnd.ms-powerpoint.template.macroEnabled.12":case"application/vnd.ms-powerpoint.slideshow.macroEnabled.12":i=t.replace("{type}","msft-ppt");break;case"vsdx":case"vsdm":case"vsd":i=t.replace("{type}","msft-visio");break;case"js":case"cs":case"html":case"htm":case"cmd":case"c":case"class":case"xml":case"cpp":i=t.replace("{type}","code");break;case"sketch":i=t.replace("{type}","sketch");break;case"ai":case"ait":case"eps":i=t.replace("{type}","files-illustrator");break;case"fla":case"swf":case"as":i=t.replace("{type}","files-flash");break;case"psd":case"pdd":i=t.replace("{type}","files-photoshop");break;case"indd":case"indl":case"indt":case"indb":i=t.replace("{type}","files-indesign");break;case"aep":case"aet":case"aaf":case"aepx":i=t.replace("{type}","files-aftereffects");break;case"pdf":i=t.replace("{type}","pdf");break;case"vsdx":i=t.replace("{type}","files-document");break;case"txt":i=t.replace("{type}","txt");break;case"zip":case"rar":i=t.replace("{type}","zip");break;case"one":case"onenote":case"onepkg":case"notebk":case"onetoc2":i=t.replace("{type}","msft-onenote");break;case"image/png":case"image/jpg":case"png":case"jpg":case"image/jpeg":case"jpeg":case"bmp":case"tiff":i=t.replace("{type}","image");break;case"image/gif":case"gif":i=t.replace("{type}","gif");break;case"folder":case"directory":i=t.replace("{type}","folder");break;case"channel":i=t.replace("{type}","channel");break;case"team":i=t.replace("{type}","team");break;case"mp3":case"wav":case"aav":case"flac":case"m4a":case"wma":case"alac":case"wv":case"aiff":case"au":case"ape":i=t.replace("{type}","files-sound");break;case"mp4":case"mov":case"mpg":case"mpeg":case"wmv":case"webm":case"ogv":i=t.replace("{type}","mov");break;case"link":i=t.replace("{type}","files-link");break;default:i=t.replace("{type}","files-document")}return i},this.getSVGClass=function(e){var t="boolean"==typeof e.additionalParameter&&typeof e.additionalParameter,i=o.getSVGBase(e.type,"icons-{type}");switch(t&&(i+="-new"),e.iconSize){case 25:i+=" ts-svg-small";break;case 32:i+=" ts-svg";break;case-1:i+="-placeholder"}return i},this.getSVG=function(e){var t="boolean"==typeof e.additionalParameter&&typeof e.additionalParameter,i=o.getSVGBase(e.type,"svg/icons-{type}.html");return t&&(i+="-new"),i},this.getSVGTitle=function(e){var t=o.getSVGBase(e.type,"{type}");switch(t){case"files-illustrator":return"files_illustrator";case"files-flash":return"files_flash";case"files-photoshop":return"files_photoshop";case"files-indesign":return"files_indesign";case"files-aftereffects":return"files_aftereffects";case"files-sound":return"files_sound";case"channel":return"search_filterChannelText";case"team":return"teams_title";case"mov":return"icons_mov";case"files-link":return"icons_link";case"files-document":return"icons_document";default:return"icons_"+t.replace("-","_")}}}return e.$inject=["$q","$timeout","$document","$window","uuid","constants","appConfig"],e.prototype.fastParseXML=function(e,t){for(var i="",n="",r=!1,s=0;s<e.length;s++)if("<"!==e[s])if(r){if(">"===e[s]){r=!1,n="";continue}i+=e[s]}else n+=e[s];else{if("/"===e[s+1]){if(n){var a=t[i];a&&a(n),n=""}do{s++}while(">"!==e[s]);continue}i="",r=!0}},e.prototype.deferOnce=function(e){for(var t=this,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];this.deferred.has(e)||(this.deferred.add(e),_.defer(function(){t.deferred.delete(e),e.apply(void 0,i)}))},e.prototype.getPageVisibility=function(){var e=this,t=["","moz","ms","webkit"],i=!0,n=function(i){var n=_.findIndex(t,function(t){return void 0!==e.$document.prop(t+i)});return n>=0?t[n]+i:null},r=n("visibilityState");if(r)i="visible"===this.$document.prop(r);else{var s=n("hidden");i=!s||!this.$document.prop(s)}return i},e.prototype.tryParseJSON=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}},e.prototype.getItemprops=function(e,t){var i=$(e),n=i.attr("data-itemprops"),r=n&&this.tryParseJSON(n)||{};return i.find("[itemprop]").each(function(e,t){var i=$(t),n=i.attr("itemprop");if(n){var s=i.attr("content")||i.text();r[n]=s}}),t&&!r[t]&&(r[t]=this.removeZeroWidthSpaces(i.text())),r},e.prototype.convertStringToBoolean=function(e){return/true/i.test(e)},e.prototype.generateUUID=function(){return this.uuid.v4()},e.prototype.generateUUIDNormalized=function(){return this.generateUUID().replace(/-/g,"")},e.prototype.jitter=function(e,t){return void 0===t&&(t=.15),e*(1+_.random(-t,t,!0))},e.prototype.asArray=function(e){return angular.isArray(e)?e:null},e.prototype.asArrayT=function(e){return angular.isArray(e)?e:null},e.prototype.flattenObject=function(e,t,i,n){if(void 0===t&&(t="."),void 0===i&&(i=!1),void 0===n&&(n=5),!angular.isObject(e)||angular.isDate(e))return e;var r=0,s={},a=function(e,o){if(r++,!angular.isObject(e)||angular.isDate(e))s[o]=e;else{if(angular.isArray(e)&&r>n+1)return;if(!angular.isArray(e)&&r>n)return;for(var c in e){var l=c;i&&(l=l[0].toUpperCase()+(l.length>1?l.substr(1):""));var p=o?o+t+l:l;a(e[c],p)}}r--};return a(e,""),s},e.prototype.asString=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;if("string"===t)return e;if("number"===t||"boolean"===t)return String(e);if("function"===t)return"";if(_.isDate(e))return e.toISOString();try{return JSON.stringify(e)}catch(t){return teamspace.services.UtilityServiceStatics.safeJsonStringify(e)}},e.prototype.removeZeroWidthSpaces=function(e){return e.replace(/\u200b/g,"")},e.prototype.formatV=function(e,t,i){return i=i||this.asString,e=this.formatInternal(e,t,i),1===t.length&&"object"==typeof t[0]&&(e=this.formatInternal(e,t[0],i)),e},e.prototype.format=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.formatV(e,t)},e.prototype.formatUri=function(e){for(var t=this,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return this.formatV(e,i,function(e){return encodeURIComponent(t.asString(e))})},e.prototype.formatInternal=function(e,t,i){for(var n in t)t.hasOwnProperty(n)&&(e=e.replace("{"+n+"}",i(t[n])));return this.unleakString(e)},e.prototype.validateEmails=function(e){for(var t=0;t<e.length;t++){var i=e[t].email||e[t].userPrincipalName;if(!validator.isEmail(i))return!1}return!0},e.prototype.isDomain=function(e){return e&&e.length&&e.length<=this.constants.domain.maxDomainNameLength&&validator.isURL("http://"+e)},e.prototype.bytesToMb=function(e,t,i){return void 0===t&&(t=3),void 0===i&&(i="MB"),((e||0)/1048576).toFixed(t)+i},e.prototype.removeLeadingSection=function(e){var t="";if(e){var i=e.lastIndexOf("/");i=-1==i?e.length:i+1,t=e.substring(0,i)}return t},e.prototype.getUrlRootContext=function(){var e=this.$window.location.hash.replace(/^#\//,"").split("/").shift()||"";return"my"===e.toLowerCase()?decodeURI(this.$window.location.hash.replace(/^#\//,"").replace(/\?.*/,"")):e},e.prototype.isValidUrl=function(e){return!!e&&this.constants.validationRegEx.url.test(e)},e.prototype.isMetaKeyPressed=function(e){return e.metaKey||"Meta"===e.key},e.prototype.validateUrl=function(e){return e&&e.startsWith("https")&&this.isValidUrl(e)},e.prototype.validateUrlForWebsites=function(e){if(!e)return!1;var t=encodeURI(e);return t&&t.startsWith("https")&&(this.constants.validationRegExWeb.url.test(e)||this.constants.validationRegExWeb.url.test(t))},e.prototype.combineUriComponents=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e&&0!==e.length?_.reduce(e,function(e,t){if(!e||!t)return e||t;var i="/"===e.charAt(e.length-1);return"/"===t.charAt(0)?i&&(t=t.substr(1)):i||(e+="/"),e+t},""):""},e.prototype.parseUrl=function(e){var t=this;this.parser&&this.defaultParser&&this.enableParseUrlDomElements||(this.parser=this.$document.get(0).createElement("a"),this.defaultParser=this.$document.get(0).createElement("a")),this.parser.href=e;var i=this.parser.host,n=this.parser.port;this.defaultParser.href=this.parser.protocol+"//"+this.parser.hostname,this.parser.port===this.defaultParser.port&&(i=this.parser.hostname,n="");var r=this.parser.pathname;r&&"/"!=r[0]&&(r="/"+r);var s=this.parseUrlSearchQuery(this.parser.search),a={protocol:this.parser.protocol,host:i,hostname:this.parser.hostname,port:n,pathname:r,hash:this.parser.hash,search:this.parser.search,searchParams:s,origin:this.parser.protocol+"//"+i,href:this.parser.href,toString:function(){return t.parser.toString()}};return this.enableParseUrlDomElements||(this.removeParserElement(this.parser),this.removeParserElement(this.defaultParser)),a},e.prototype.parseUtilitySettings=function(e){e&&(e[this.constants.settings.names.enableParseUrlDomElements.toLowerCase()]||e[this.constants.settings.names.enableParseUrlDomElements])?this.enableParseUrlDomElements=!0:this.enableParseUrlDomElements=!1},e.prototype.parseUrlSearchQuery=function(e){if(!e)return{};var t=e.substring(e.indexOf("?")+1)||"",i=_.map(t.split("&"),function(e){var t,i=e.split("="),n=JSON.stringify(i[0]);if(i[1]){var r=null;try{r=decodeURIComponent(i[1]),t=JSON.parse(r)}catch(e){t=r}}else t=null;return n+": "+JSON.stringify(t)});return i.length>0?JSON.parse("{ "+i.join(", ")+" }"):{}},e.prototype.removeParserElement=function(e){for(var t=document.getElementsByTagName("body")[0];e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);e.style.display="none",t.appendChild(e),t.removeChild(e)},e.prototype.scrubSiteUrl=function(e){var t=this.parseUrl(e),i=new teamspace.services.PIIString(t.origin),n=t.pathname.replace(/(^\/|\/$)/g,"");if(n.length>0){var r=n.split("/");if(r.length>0){i=i.append("/").append(r[0]);for(var s=1;s<r.length;s++)i=i.append("/").append(new teamspace.services.PIIValue(r[s],microsoft.applications.telemetry.datamodels.PIIKind.GenericData))}}return i},e.prototype.escapeForRegExp=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},e.prototype.toDashCase=function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},e.prototype.whenAllAllowFailures=function(e){var t=this.$q.defer(),i=e.length,n=[];if(0===e.length)t.resolve(n);else{var r=function(){0===--i&&t.resolve(n)};angular.forEach(e,function(t,i){var s=new teamspace.services.PromiseResult;n.push(s),e[i].then(function(e){s.wasResolved=!0,s.result=e,r()},function(e){s.result=e,r()})})}return t.promise},e.prototype.getFileNameWithExtension=function(e){if(!e)return"";var t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)},e.prototype.removeFileNameFromPath=function(e){if(e)return e.substring(0,e.lastIndexOf("/"))},e.prototype.getHostNameFromUrl=function(e){return teamspace.services.UtilityServiceStatics.getHostNameOrPathFromUrl(e,!0,!1)},e.prototype.getMask=function(e){return _.reduce(e,function(e,t){return e^t})},e.prototype.bitsAreEnabledInMask=function(e,t){var i=this.getMask(t);return(e&i)===i},e.prototype.downloadFromUrl=function(e,t){return this.isValidUrl(e)?t?this.$window&&this.$window.electronSafeIpc?(this.$window.electronSafeIpc.send(this.constants.events.desktopApp.fileDownload.desktopFileDownload,e),this.$q.resolve(e)):this.$q.reject("electronSafeIpc not available"):(this.triggerLocationHref(e),this.$q.resolve(e)):this.$q.reject({internalErrorCode:this.constants.files.internalErrorCodes.common.invalidUrl})},e.prototype.triggerLocationHref=function(e){this.$window.location.href=e},e.prototype.formatIfPstnMri=function(e){return e?0===e.indexOf(this.constants.pstn.keyPrefix)?e.replace(/-|\(|\)|\s|\+/g,""):e:""},e.prototype.pstnBackgroundColorClass=function(e){if(!e)return"";var t=this.djb2_hash(e)%this.constants.callingAvatar.avatarBackgroundLength;return this.constants.callingAvatar.avatarClassPrefix+t},e.prototype.isImageType=function(e){return this.getIconClass({type:e})==this.constants.css.fileIcons.picture},e.prototype.extractAmsIdFromUrl=function(e){if(e&&this.isAmsImage(e)){this.amsIdRegex||(this.amsIdRegex=new RegExp(this.constants.files.attachments.amsImageSuffix+"/([\\w|\\-]+)","i"));var t=e.match(this.amsIdRegex);return t?t[1]||"":""}return""},e.prototype.isAmsSupportedImageType=function(e){switch((e||"").toLowerCase()){case"image/png":case"image/jpg":case"image/jpeg":case"image/gif":case"png":case"jpg":case"jpeg":case"gif":return!0;default:return!1}},e.prototype.isAmsDomain=function(e){return teamspace.services.UtilityServiceStatics.isAmsDomain(this.constants,e)},e.prototype.isAmsImage=function(e){return teamspace.services.UtilityServiceStatics.isAmsImage(this.constants,e)},e.prototype.isDocumentType=function(e){switch(this.getIconClass({type:e})){case this.constants.css.fileIcons.picture:case this.constants.css.fileIcons.generic:case this.constants.css.fileIcons.zip:case this.constants.css.fileIcons.txt:case this.constants.css.fileIcons.audio:case this.constants.css.fileIcons.video:case this.constants.css.fileIcons.pdf:return!1;default:return!0}},e.prototype.isSupportedInUnifiedApp=function(e){switch(this.getIconClass({type:e})){case this.constants.css.fileIcons.word:case this.constants.css.fileIcons.powerpoint:case this.constants.css.fileIcons.excel:case this.constants.css.fileIcons.visio:return!0;default:return!1}},e.prototype.isVisioFile=function(e){return this.constants.fileExtensions.visio.includes(e)},e.prototype.isEditableVisioFileExtension=function(e){return"vsdx"===e},e.prototype.isOneNoteBook=function(e){return e===this.constants.fileExtensions.onenote[0]},e.prototype.canDocumentOpenInWAC=function(e){return this.isDocumentType(e)&&"xls"!==e.toLowerCase()},e.prototype.canDocumentOpenInViewer=function(e){e=e||"";var t=this.getIconClass({type:e})===this.constants.css.fileIcons.pdf;return this.canDocumentOpenInWAC(e)||t},e.prototype.fileSizeSI=function(e,t,i,n,r){return(t=Math,i=t.log,n=1e3,r=i(e)/i(n)|0,e/t.pow(n,r)).toFixed(2)+" "+(r?"KMGTPEZY"[--r]+"B":"Bytes")},e.prototype.fileSizeIEC=function(e,t,i,n,r){return(t=Math,i=t.log,n=1024,r=i(e)/i(n)|0,e/t.pow(n,r)).toFixed(2)+" "+(r?"KMGTPEZY"[--r]+"iB":"Bytes")},e.prototype.asBoolean=function(e,t,i){return void 0===e&&void 0!==typeof t&&(e=t),!i||null!==e&&void 0!==e?1==e||1==e||"true"==e||"True"==e||"TRUE"==e||"1"==e:e},e.prototype.camelCaseToSpaces=function(e){return e.replace(/(?!^)([A-Z])/g," $1")},e.prototype.createSemaphore=function(e){var t=Array(),i=e,n=this.$q;return{acquireSemaphore:function(){var i=n.defer();return 0===e?t.push(i):(e--,i.resolve()),i.promise},releaseSemaphore:function(){if(e=Math.min(e+1,i),t.length>0){var n=t.shift();e--,n.resolve()}}}},e.prototype.objectExists=function(e){return void 0!==e&&null!=e},e.prototype.setAnchorMailbox=function(e,t){this.objectExists(t.team)&&(e.anchorMailbox=t.team.smtpAddress)},e.prototype.appendToQueryString=function(e,t,i){var n=t+"="+i;return this.objectExists(e)&&""!==e?e+"&"+n:"?"+n},e.prototype.removeFromQueryString=function(e,t){if(!e||!t)return e;var i=e.indexOf("?");if(i<0)return e;var n=e.indexOf("#");n<0&&(n=e.length);for(var r=e.substring(n),s=e.substring(0,i),a=e.substring(i+1,n),o=encodeURIComponent(t)+"=",c=a.split(/[&;]/g),l=c.length;l-- >0;)-1!==c[l].lastIndexOf(o,0)&&c.splice(l,1);return s+(c.length>0?"?"+c.join("&"):"")+r},e.prototype.removeHashFromQueryString=function(e){return e&&e.indexOf("#")>=0?e.substring(0,e.indexOf("#")):e},e.prototype.appendToPIIQueryString=function(e,t,i){var n,r=teamspace.services.PIIString.isPIIString(e)?e:new teamspace.services.PIIString(e);return n=""===r.value?"?"+t+"=":"&"+t+"=",r.append(n).append(i)},e.prototype.encodeUriComponentIncludingApostrophe=function(e){return encodeURIComponent(e).replace(/'/g,"%27")},e.prototype.odataEncodeUriComponent=function(e){return e.replace(/'/g,"''")},e.prototype.ensureLeadingSlash=function(e){return"/"!=e.charAt(0)&&(e="/"+e),e},e.prototype.getQueryString=function(e){var t="";if(e.serviceName===this.constants.files.serviceName.teams?(t=this.appendToQueryString(t,this.constants.files.parameters.smtpAddress,e.team.smtpAddress),this.objectExists(e.channel)&&(t=this.appendToQueryString(t,this.constants.files.parameters.channelId,e.channel.objectId),e.channel.displayName&&(t=this.appendToQueryString(t,this.constants.files.parameters.channelName,this.encodeUriComponentIncludingApostrophe(e.channel.displayName)))),void 0!==e.containerId&&""!==e.containerId&&(t=this.appendToQueryString(t,this.constants.files.parameters.containerId,e.containerId),t=this.appendToQueryString(t,this.constants.files.parameters.removeon404,"true"))):e.serviceName===this.constants.files.serviceName.customspo?t=this.appendToQueryString(t,this.constants.files.parameters.siteUrl,this.encodeUriComponentIncludingApostrophe(e.siteUrl)):e.serviceName!==this.constants.files.serviceName.recent&&e.serviceName!==this.constants.files.serviceName.p2p||(e.serviceName===this.constants.files.serviceName.p2p&&e.p2pEmail&&(t=this.appendToQueryString(t,"P2PUserEmail",e.p2pEmail)),e.team&&(t=this.appendToQueryString(t,this.constants.files.parameters.smtpAddress,e.team.smtpAddress)),void 0!=e.objectUrl&&""!==e.objectUrl&&(t=this.appendToQueryString(t,this.constants.files.parameters.documentUrl,this.encodeUriComponentIncludingApostrophe(e.objectUrl))),"boolean"==typeof e.additionalParameter&&(t=this.appendToQueryString(t,this.constants.files.parameters.mruLocations,e.additionalParameter.toString()))),e.folder&&e.folder.serverRelativeUrl){var i=this.encodeUriComponentIncludingApostrophe(e.folder.serverRelativeUrl);t=this.appendToQueryString(t,this.constants.files.parameters.parentServerRelativeUrl,i)}return t},e.prototype.getLocalDateTime=function(){var e=new Date,t=-e.getTimezoneOffset(),i=t>=0?"+":"-",n=function(e){var t=Math.abs(Math.floor(e));return(t<10?"0":"")+t};return e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds())+"."+(e.getMilliseconds()/1e3).toFixed(3).slice(2,5)+i+n(t/60)+":"+n(t%60)},e.prototype.getQueryStringWithService=function(e){var t=this.getQueryString(e);return e.serviceName&&(t=this.appendToQueryString(t,this.constants.files.parameters.service,e.serviceName)),t},e.prototype.getQueryStringByName=function(e,t){var i=t||window.location.href,n=new RegExp("[?&]"+e+"=([^&#]*)","i").exec(i);return n?n[1]:null},e.prototype.getQueryParameters=function(e){var t={};return e&&(e=e.startsWith("?")?e=e.substr(1):e,angular.forEach(e.split("&"),function(e){var i=e.indexOf("=");if(-1!==i){var n=e.substr(0,i),r=e.substring(i+1);t[n]=r}})),t},e.prototype.stripHtml=function(e){if(e){e=(e=e.replace(teamspace.services.UtilityServiceStatics.StripHtmlRegex,"")).replace("<","").replace(">","");var t=document.createElement("div");t.innerHTML=e,e=t.textContent||t.innerText}return e},e.prototype.escapeHtml=function(e){return e?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g,"&nbsp;"):""},e.prototype.decodeHtml=function(e){return e?e.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," "):""},e.prototype.replaceNewlines=function(e){return e?e.replace(/\n|\r\n|\r/g,"<br/>"):""},e.prototype.getUnixEpochTimestamp=function(){return Math.floor((new Date).getTime()/1e3)},e.prototype.convertUnixEpochTimestampToDate=function(e){var t=null;if(!e)return t;try{t=new Date(1e3*parseInt(e))}catch(e){}return t},e.prototype.truncate=function(e,t,i){if(void 0===i&&(i={}),e.length<=t)return e;var n=e.substr(0,t);return i.withEllipsis&&(n+=""),n},e.prototype.convertBase64ImageToBytes=function(e){for(var t=e.split(","),i=atob(t[1]),n=new Uint8Array(i.length),r=0;r<i.length;r++)n[r]=i.charCodeAt(r);return n},e.prototype.convertBase64ToBytes=function(e){for(var t=atob(e),i=new Uint8Array(t.length),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i},e.prototype.getPromiseWithTimeout=function(e,t,i,n,r){void 0===i&&(i=this.$q);var s=i.defer(),a=n||this.constants.promise.timedOutMessage;return e.then(s.resolve,s.reject),this.$timeout(function(){return s.reject(r?a:new Error(a))},t,!1),s.promise},e.prototype.waitFor=function(e,t,i){void 0===t&&(t=void 0),void 0===i&&(i=250);var n=this.$q.defer(),r=void 0,s=setInterval(function(){e()&&(n.resolve(),clearTimeout(r),clearInterval(s))},i);return"number"==typeof t&&(r=setTimeout(function(){n.reject(),clearInterval(s)},t)),n.promise},e.prototype.requestIdlePromise=function(){var e=this.$q.defer();return this.$window.requestIdleCallback(function(){e.resolve()}),e.promise},e.prototype.getDeeplinkUrl=function(e,t){if(!e||!t)return null;if(t.endsWith("/")||(t+="/"),e.toLowerCase().startsWith(t.toLowerCase())){var i=(e=e.substr(t.length)).indexOf("#");if(i>=0){if(i>1)return null;e.length>1&&(e=e.substr(i+1))}return e}return null},e.prototype.getDeeplinkUrlFromProtocol=function(e,t){return e&&t&&e.toLowerCase().startsWith(t.toLowerCase())?e.substr(t.length):null},e.prototype.abortHttpRequest=function(e){e.promise.aborting=!0,e.resolve()},e.prototype.isElementInView=function(e,t,i){if(void 0===i&&(i=!1),!e)return!1;t||(t=$("body"));var n=t.offset().top,r=n+t.height(),s=null;if(e.each(function(e,t){var i=$(t),a=i.offset().top,o=a+i.height();if(a>n&&o<r)return s=i,!1}),s){if(i){var a=this.generateUUID();return s.addClass(a),a}return!0}return!1},e.prototype.isElementBelowViewport=function(e,t){return!(!e||!t)&&t.getBoundingClientRect().bottom<e.getBoundingClientRect().top},e.prototype.scrollMessageIntoView=function(e,t,i){var n=this;if(void 0===i&&(i=!1),e&&t){var r=function(){var e=angular.element("#"+teamspace.services.MessagingUtilities.getFormattedMessageId(t));e&&e.length&&n.scrollElementIntoView(e[0],n.constants.utilities.scroll.bottom)};i?e.$broadcast(this.constants.events.virtualRepeat.customScroll,{callback:r,stickToBeginning:!1}):e.$emit(this.constants.events.virtualRepeat.customScroll,{callback:r,stickToBeginning:!1})}},e.prototype.scrollElementIntoView=function(e,t,i){void 0===t&&(t=this.constants.utilities.scroll.top);for(var n=e,r=e.parentElement;r;){var s=window.getComputedStyle(r).overflowY;if("auto"==s||"scroll"==s)break;n=r,r=r.parentElement}if(r&&n){var a=$(r),o=$(n),c=$(e),l=a.offset().top,p=a.innerHeight(),u=a[0].scrollTop,h=o.offset().top,d=c.offset().top,g=c.outerHeight(),v=u;switch(t){case this.constants.utilities.scroll.top:(i||d<l)&&(v=d-h);break;case this.constants.utilities.scroll.bottom:(i||l+p<d+g)&&(v=d-h+g-p)}if(console.log("scrollElementIntoView:\n    scrollTop="+u+"\n    scrollHeight="+a[0].scrollHeight+"\n    scrollableTop="+h+"\n    scrollableHeight="+o.outerHeight()+"\n    elementTop="+d+"\n    elementHeight="+g+"\n... scroll to "+v),v!=u&&(a.scrollTop(v),a[0].scrollTop!=v))return console.warn("could not scroll to "+v+", actual scrollTop "+a[0].scrollTop),!1}return!0},e.prototype.isLeftRailVisible=function(){return angular.element('body [data-tid="left-rail"]:visible').length>0},e.prototype.isSelectionChanged=function(e,t){return!e||!t||e.startContainer!==t.startContainer||e.startOffset!==t.startOffset||e.endContainer!==t.endContainer||e.endOffset!==t.endOffset},e.prototype.constrainTextSelection=function(e,t){var i,n=this,r=function(e){if(1==e.nodeType){var t=window.getComputedStyle(e);return"none"!==(t.msUserSelect?t.msUserSelect:t.webkitUserSelect?t.webkitUserSelect:t.userSelect)}return 3==e.nodeType},s=function(e){var t=document.getSelection();if(t&&t.rangeCount){var n=t.getRangeAt(0);if(!(n.collapsed||i&&i.startContainer===n.startContainer&&i.startOffset==n.startOffset&&i.endContainer===n.endContainer&&i.endOffset==n.endOffset)){var s=n.commonAncestorContainer;if(!r(s)){var a=void 0,o=n.endContainer===t.anchorNode,c=o?n.endContainer:n.startContainer,l=o?n.endOffset:n.startOffset;for(a=c.hasChildNodes()&&l<c.childNodes.length?c.childNodes[l]:c;r(a.parentNode);)a=a.parentNode;o?n.setStart(a,0):n.setEnd(a,a.hasChildNodes()?a.childNodes.length:3==a.nodeType?a.length:0),t.removeAllRanges(),t.addRange(n)}i=n}}else i=null},a=_.debounce(function(e){s(),n.$timeout(function(){s()},100,!1)},100);t.addEventListener&&(t.addEventListener("mousemove",a),t.addEventListener("touchmove",a),t.addEventListener("keyup",a),t.addEventListener("click",a),e&&e.$on("$destroy",function(){t.removeEventListener("mousemove",a),t.removeEventListener("touchmove",a),t.removeEventListener("keyup",a),t.removeEventListener("click",a)}))},e.prototype.compareVersions=function(e,t){if(e===t)return 0;for(var i=[e,t].map(function(e){return e.split(".")}),n=i.map(function(e){return e.length}),r=n[0],s=n[1],a=Math.min(r,s),o=0;o<a;o++){var c=function(e){var t=i.map(function(t){return parseInt(t[e])}),n=t[0],r=t[1];return n===r?"continue":{value:n>r?1:-1}}(o);if("object"==typeof c)return c.value}return r>s?1:r<s?-1:0},e.prototype.markPerfInfo=function(e,t,i,r){var s=e.perfInfo;if(s&&!s.isCompleted){var a=e.timestamps?e.timestamps[e.timestamps.length-1]:Date.now(),o=void 0===i?t.startsWith("total")?a-s.startTime:a-s.lastStepTime:i;s.displayData+=t+": "+o+"ms ",s.displayDataJson||(s.displayDataJson=[]),s.displayDataJson[t]=o,s.lastStepTime=a,s.steps&&s.steps.push(n({step:t,delta:o},r))}},e.prototype.djb2_hash=function(e){for(var t=5381,i=0;i<e.length;i++)t=(t<<5)+t+e.charCodeAt(i);return t>>>0},e.prototype.stopEvent=function(e){this.preventDefault(e),this.stopPropagation(e)},e.prototype.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},e.prototype.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e.prototype.getBlobDataAsUint8Array=function(e){var t=this.$q.defer();e&&e.startsWith("blob")||t.reject("undefinedBlobUrl");var i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType=this.constants.http.responseType.arraybuffer,i.onload=function(e){200===i.status?t.resolve(new Uint8Array(i.response)):t.reject({status:i.status,statusText:i.statusText})},i.send(),t.promise},e.prototype.copyToClipboard=function(e,t){var i=this.$document[0];t||(t=i.body);var n=i.createElement("textarea");n.value=e,n.style.color="transparent",n.style.outline="none",n.style.boxShadow="none",n.style.background="transparent",n.setAttribute("aria-hidden","true"),t.appendChild(n),n.select();var r=i.execCommand("copy");if(t.removeChild(n),!r)throw new Error("The copy command is not supported or enabled")},e.prototype.copyHtmlToClipboard=function(e,t){void 0===t&&(t=!1);var i,n=this.$document[0];if(t){var r=$("<iframe />"),s=r[0];r.css({height:"100%",width:"100%",pointerEvents:"none",padding:"0",margin:"0",border:"none",opacity:"0",visibility:"visible"}),r.attr("src","about:blank"),this.$document.find("body").append(r);var a=e.outerHTML;s.contentWindow.document.open("text/html","replace"),s.contentWindow.document.write(a),s.contentDocument.execCommand("selectAll"),i=s.contentDocument.execCommand("copy"),r.remove()}else{var o=n.createRange(),c=n.createElement("div");c.appendChild(e),c.style.outline="none",c.style.boxShadow="none",c.style.background="transparent",c.style.top="0",c.style.left="-9999px",c.style.position="absolute",n.body.appendChild(c),o.selectNodeContents(c);var l=n.getSelection();l.removeAllRanges(),l.addRange(o),i=n.execCommand("copy"),n.body.removeChild(c)}if(!i)throw new Error("The copy command is not supported or enabled")},e.prototype.copyMultipleFormatsToClipboard=function(e){if(e)if(this.isIE(!0))window.clipboardData.setData("Text",e[teamspace.services.UtilityServiceStatics.ClipboardFormats.Text]);else if(this.$document.one("copy",function(t){t.stopPropagation(),t.preventDefault();var i=t.originalEvent.clipboardData;for(var n in teamspace.services.UtilityServiceStatics.ClipboardFormats)if(teamspace.services.UtilityServiceStatics.ClipboardFormats.hasOwnProperty(n)){var r=teamspace.services.UtilityServiceStatics.ClipboardFormats[n];e[r]&&i.setData(r,e[r])}}),!document.execCommand("copy"))throw new Error("The copy command is not supported or enabled")},e.prototype.isIE=function(e){return void 0===e&&(e=!1),"undefined"!=typeof document&&null!==document.all&&document.documentMode<=11||!e&&"undefined"!=typeof navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Edge/")},e.prototype.useNgIncludeForIcon=function(e){return e.endsWith(".html")},e.prototype.digest=function(e){!e||e.$$phase||e.$root&&e.$root.$$phase||e.$digest()},e.prototype.createDefer=function(){return new s},e.prototype.deparams=function(e){var t=this;if(!e)return{};var i={};return e.replace(/(^\?)/,"").split("&").forEach(function(e){var n=e.split("=");2===n.length&&n[0]&&n[1]&&t.setParamValue(i,n[0].split("."),n[1])}),i},e.prototype.getTenantSwitchUrl=function(e,t,i){if(!e||!t)return null;var n=this.deparams(this.$window.location.search);return n.tenantId=e.tenantId,i?(i.indexOf("meetup-join")>0&&(e.useNewIpc=!0),t+"?"+decodeURIComponent($.param(n,!0))+i):t+"?"+decodeURIComponent($.param(n,!0))},e.prototype.isSfbDesktopRunning=function(){if(_.isUndefined(this.$window.isSfbDesktopRunning)){var e=this.$window.getSfbDesktopSignInState&&this.$window.getSfbDesktopSignInState();return e&&0!==e.state}return this.$window.isSfbDesktopRunning()},e.prototype.isHidDisabledInSfB=function(){return!_.isUndefined(this.$window.isHidDisabledInSfB)&&this.$window.isHidDisabledInSfB()},e.prototype.setParamValue=function(e,t,i){var n=t[0];1===t.length?e[n]?(_.isArray(e[n])||(e[n]=[e[n]]),e[n].push(i)):e[n]=i:(e[n]||(e[n]={}),t.shift(),this.setParamValue(e[n],t,i))},e.prototype.convertToSafeCachingGetter=function(e,t){var i=function(){try{var n=e();return n&&(i=function(){return n}),n}catch(e){return t}};return function(){return i()}},e.prototype.addScript=function(e){var t=this;return new Promise(function(i,n){var r=!1;if(t.appConfig.validScriptSourcePaths)for(var s=0,a=t.appConfig.validScriptSourcePaths.split(",");s<a.length;s++){var o=a[s];if(0===e.indexOf(o.trim())){r=!0;break}}r||n("The script: "+e+" does not belong to the valid scripts list");var c=document.head||document.getElementsByTagName("head")[0],l=document.querySelector('script[src="'+e+'"]');l&&c.removeChild(l);var p=document.createElement("script");c.appendChild(p),p.src=e,p.defer=!0,p.onload=function(){i()},p.onerror=function(e){n(e)}})},e.prototype.addStyle=function(e){var t=document.head||document.getElementsByTagName("head")[0];if(!document.querySelector('link[href="'+e+'"]')){var i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,t.appendChild(i)}},e.prototype.getHostName=function(e){if(!e||0!==e.indexOf("http"))throw Error("Cannot get the host name from the url: "+e||"");var t=e.split("/"),i="";if(t.length<3)return i;for(var n=0;n<3;n++)i+=t[n]+"/";return i},e.prototype.canShowPerfProfiler=function(e){var t=this.getQueryStringByName(this.constants.DevDebugPanel.queryParam,e||window.location.href);return t===teamspace.components.DebugPanelState.PerfProfilerWithAutoStart.toString()||t===teamspace.components.DebugPanelState.PerfProfiler.toString()},e.prototype.addDebugPanelQPToUrl=function(e,t){var i=(e||window.location.href).split("#"),n=i[0]||"",r=i[1]||"",s=this.constants.DevDebugPanel.queryParam;return n=this.removeFromQueryString(n.replace(this.constants.DevDebugPanel.dashboardSetting,""),s),t&&(n=[n,-1===n.indexOf("?")?"?":n.endsWith("?")?"":"&",s,"=",t,this.constants.DevDebugPanel.dashboardSetting].join("")),[n,"#",r].join("")},e.prototype.isKeyCodePrintable=function(e){return 32===e||e>=48&&e<=57||e>=65&&e<=90||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222},e.prototype.race=function(e){var t=this,i=this.$q.defer();return _.each(e,function(e){t.$q.when(e).then(i.resolve,i.reject)}),i.promise},e.prototype.unleakString=function(e){return null===e||void 0===e||0==e.length?e:(" "+e).substr(1)},e.prototype.preconnectUrl=function(e){if((e=this.extractBaseUrl(e))&&e.length>0){var t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}},e.prototype.extractBaseUrl=function(e){if(e&&e.length>0){var t=e.indexOf("//");if(t>-1){var i=[e.indexOf("/",t+2),e.indexOf("?",t+1),e.length],n=Math.min.apply(Math,_.without(i,-1));return e.slice(0,n)}}return e},e.prototype.isUrlInDomainList=function(e,t){for(var i=this.parseUrl(e).href,n=0;n<t.length;n++){for(var r="",s=t[n].split("."),a=0;a<s.length;a++)r+=(a>0?"[.]":"")+s[a].replace("*","[^/^.]+");var o=new RegExp("^https://"+r+"((/|\\?).*)?$","i");if(e.match(o)||i.match(o))return!0}return!1},e.prototype.decodeSearchTerm=function(e){return e.replace("~2F","/")},e}();t.UtilityServiceImplementation=r;var s=function(){function e(){var e=this;this.syncTaskPromise=new Promise(function(t,i){e.resolveFunc=t,e.rejectFunc=i})}return e.prototype.resolve=function(e){return this.resolveFunc(e),this.promise()},e.prototype.reject=function(e){return this.rejectFunc(e),this.promise()},e.prototype.promise=function(){return this.syncTaskPromise},e}();t.DeferredTask=s,angular.module("teamspace.utilityService",["angular-uuid","teamspace.constants","teamspace.config"]).service("utilityService",r)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.currentCount=0,this.$q=e,this.logger=t}return e.prototype.enqueue=function(e,t){var i=this;return++this.currentCount>5?this.logger.error("Function Queue - Queue backed up. Queueing function for data:{0}, queue count:{1}",t,this.currentCount):this.logger.info("Function Queue - Queueing function for data:{0}, queue count:{1}",t,this.currentCount),this.current?this.current=this.current.then(function(){return i.logger.info("Function Queue - Previous function succeeded. Executing function for data:{0}",t),e()},function(n){return i.logger.info("Function Queue - Previous function failed due to Error:{0}. Executing function for data:{1}",n,t),e()}):(this.logger.info("Function Queue - Executing function for data:{0}, queue count:{1}",t,this.currentCount),this.current=e()),this.current.finally(function(){i.currentCount--,0===i.currentCount&&(i.current=null),i.logger.info("Function Queue - Dequeuing function for data:{0}, current queue count:{1}",t,i.currentCount)}),this.current},e.prototype.isExecuting=function(){return this.currentCount>0},e}();t.AsyncFunctionQueue=n},function(e,t,i){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,i,n,r,s,a){this.loggingService=e,this.constants=t,this.appConfig=i,this.$interval=n,this.$rootScope=r,this.authenticationService=s,this.broadcastMeetingService=a,this.connectionStopRequested=!1,this.logger=this.loggingService.newLogger("SignalRConnectionSubscriber"),this.signalRConnectionTrackingScenario=this.loggingService.newScenario(this.constants.scenarios.broadcast.signalRConnectionTracking,null,null,this.constants.timeInMiliseconds.day),this.signalRConnectionTrackingScenario.cancelIfOffline=!0,this.isSuppressingConnectionLogs=this.appConfig.broadcastSettings.attendee.signalRSettings.isSuppressingConnectionLogs,this.connectAttempt=0}return e.prototype.initializeConnection=function(e){var t=this;return this.signalRConnectionTrackingScenario&&(this.signalRConnectionTrackingScenario.eventData[this.constants.counters.eventNames.correlationId]=this.attendeeMeeting&&this.attendeeMeeting.correlationId),new Promise(function(i,n){e&&e.url&&e.querystrings&&t.hubConnectionName||(t.logger.error("invalid signalRConnectionInfo object"),n("invalid signalRConnectionInfo object")),t.startReconnectTimer(e),i(t.startConnection(e))})},e.prototype.stopConnection=function(){this.signalRConnectionTrackingScenario&&(this.isConnectionStateConnected()?this.signalRConnectionTrackingScenario.stop(this.getScenarioData()):this.signalRConnectionTrackingScenario.fail(this.getScenarioData()),this.signalRConnectionTrackingScenario=null),this.teamsHubProxy&&(this.unsubscribeToHubEvents(),this.teamsHubProxy=null),this.connectionStopRequested=!0,this.stopReconnectTimer(),this.isConnectionStateConnected()&&(this.connection.stop(!0,!0),$(this.connection).unbind(),this.logger.info("SignalR connection stopped")),this.connection=null},e.prototype.isConnectionStateConnected=function(){return this.connection&&1===this.connection.state},e.prototype.startReconnectTimer=function(e){var t=this;this.stopReconnectTimer(),this.reconnectTimer=this.$interval(function(){return t.startConnection(e)},this.appConfig.broadcastSettings.attendee.signalRSettings.connectionTimeOut,0,!1)},e.prototype.stopReconnectTimer=function(){this.reconnectTimer&&this.$interval.cancel(this.reconnectTimer)},e.prototype.startConnection=function(e){var t=this;return new Promise(function(i,n){if(t.isConnectionStateConnected())return i(!0);t.connectAttempt++,t.isSuppressingConnectionLogs||t.logger.info("startConnection: connecting signalR. ConnectAttempt: "+t.connectAttempt+", "+t.getSignalRConnectionInformation()),t.authenticationService.isAnonymous()?i(t.connect(e)):t.broadcastMeetingService.setSignalRAuth(e.setCookieUrl).then(function(){i(t.connect(e))}).catch(function(e){t.$rootScope.$broadcast(t.constants.events.broadcast.signalRConnectionFailure),n(e)})})},e.prototype.connect=function(e){var t=this;return new Promise(function(i,r){return t.connection=$.hubConnection(e.url),t.connection||(t.logger.error("startConnection: failed to connect to the url: "+e.url),r("startConnection: failed to connect to the url: "+e.url)),t.connection.qs=n({},e.querystrings),t.teamsHubProxy=t.connection.createHubProxy(t.hubConnectionName),t.logger.info("startConnection: created teams hub proxy: "+t.hubConnectionName),t.subscribeToHubEvents(),t.subscribeToConnectionEvents(e),t.connection.start().done(function(){t.stopReconnectTimer(),t.invokeHubMethods(),t.signalRConnectionTrackingScenario&&t.signalRConnectionTrackingScenario.mark(t.constants.scenarios.broadcast.signalr.startConnectionSuccess),t.logger.info("startConnection: signalR connection state is: "+t.getSignalRConnectionInformation()),i(1===t.connection.state)}).fail(function(e){t.isSuppressingConnectionLogs||t.logger.error("startConnection: signalR channel failed to connect. Error: "+JSON.stringify(e)),t.signalRConnectionTrackingScenario&&t.signalRConnectionTrackingScenario.mark(t.constants.scenarios.broadcast.signalr.startConnectionFailure,t.getScenarioData(e)),t.$rootScope.$broadcast(t.constants.events.broadcast.signalRConnectionFailure),i(!1)})})},Object.defineProperty(e.prototype,"connectionId",{get:function(){return this.isConnectionStateConnected()?this.connection.id||"":""},enumerable:!0,configurable:!0}),e.prototype.subscribeToConnectionEvents=function(e){var t=this;$(this.connection).unbind("onConnectionSlow"),this.connection.connectionSlow(function(){t.isSuppressingConnectionLogs||(t.signalRConnectionTrackingScenario&&t.signalRConnectionTrackingScenario.mark(t.constants.scenarios.broadcast.signalr.connectionSlow),t.logger.info("SignalR connection is slow. "+t.getSignalRConnectionInformation()))}),$(this.connection).unbind("onReconnecting"),this.connection.reconnecting(function(){t.isSuppressingConnectionLogs||(t.signalRConnectionTrackingScenario&&t.signalRConnectionTrackingScenario.mark(t.constants.scenarios.broadcast.signalr.reconnecting),t.logger.info("SignalR connection is lost. "+t.getSignalRConnectionInformation()))}),$(this.connection).unbind("onReconnected"),this.connection.reconnected(function(){t.signalRConnectionTrackingScenario&&t.signalRConnectionTrackingScenario.mark(t.constants.scenarios.broadcast.signalr.reconnected),t.logger.info("SignalR connection is reconnected. "+t.getSignalRConnectionInformation())}),$(this.connection).unbind("onDisconnected"),this.connection.disconnected(function(){if(t.connectionStopRequested)t.signalRConnectionTrackingScenario&&t.signalRConnectionTrackingScenario.mark(t.constants.scenarios.broadcast.signalr.disconnected,t.getScenarioData());else{var i=t.connection&&t.connection.lastError?t.connection.lastError.message:"";t.isSuppressingConnectionLogs||t.logger.info("SignalR disconnected. Reason: "+i+", "+t.getSignalRConnectionInformation()),t.signalRConnectionTrackingScenario&&t.signalRConnectionTrackingScenario.mark(t.constants.scenarios.broadcast.signalr.disconnected,t.getScenarioData(i)),i.toLowerCase().indexOf("error during negotiation request")>=0?(t.logger.error("SignalR: stop attempting reconnect since it will continue to fail"),t.stopReconnectTimer(),t.$rootScope.$broadcast(t.constants.events.broadcast.signalRConnectionFailure),t.signalRConnectionTrackingScenario&&(t.signalRConnectionTrackingScenario.fail(t.getScenarioData(i)),t.signalRConnectionTrackingScenario=null)):t.startReconnectTimer(e)}}),$(this.connection).unbind("onError"),this.connection.error(function(e){t.logger.error("SignalR connection error: "+JSON.stringify(e)+", "+t.getSignalRConnectionInformation()),t.signalRConnectionTrackingScenario&&(t.signalRConnectionTrackingScenario.mark(t.constants.scenarios.broadcast.signalr.connectionError),t.signalRConnectionTrackingScenario.fail(t.getScenarioData(e)),t.signalRConnectionTrackingScenario=null)})},e.prototype.getSignalRConnectionInformation=function(){return this.connection?JSON.stringify({connectionId:this.connection.id,connectionState:this.connection.state,connectionStopRequested:this.connectionStopRequested}):""},e.prototype.getBroadcastRole=function(){return this.attendeeMeeting&&this.attendeeMeeting.signalR?this.hubConnectionName===this.attendeeMeeting.signalR.eventTeamHubName?"producer":"attendee":null},e.prototype.getScenarioData=function(e){var t=(i={},i[this.constants.categories.broadcastRole]=this.getBroadcastRole(),i[this.constants.scenarioDataPropNames.data]=this.getSignalRConnectionInformation(),i);return e&&(t[this.constants.scenarioDataPropNames.error]=e),t;var i},e}();t.SignalRConnectionSubscriber=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(37),r=i(2),s=function(){function e(e,t,i){this.loggingService=e,this.scenario=this.loggingService.newScenario(t),this._isClosed=!1,this.additionalEventData=i||{}}return e.dataForContext=function(t){return e.dataForItem(t,void 0)},e.dataForItem=function(e,t){var i={};return e&&(i.channelId=e.channelGuid,e.isMeetingNotes()&&(i.isMeetingNotes=!0)),t&&(t.canvasId&&t.pageId?(i.canvasId=t.canvasId,i.pageId=t.pageId,i.sectionId=t.id):t.canvasId?(i.canvasId=t.canvasId,i.pageId=t.id):i.canvasId=t.id),i},e.prototype.addInfo=function(e){_.assign(this.additionalEventData,e)},e.prototype.stop=function(e){this.close(n.ScenarioOperation.stop,e)},e.prototype.fail=function(e){this.close(n.ScenarioOperation.fail,e)},e.prototype.incomplete=function(e){this.close(n.ScenarioOperation.incomplete,e)},e.prototype.close=function(e,t){var i=this.transformWikiEventData(t);switch(e){case n.ScenarioOperation.incomplete:this.scenario.incomplete(i);break;case n.ScenarioOperation.fail:this.scenario.fail(i);break;case n.ScenarioOperation.stop:this.scenario.stop(i)}this._isClosed=!0},e.prototype.mark=function(e,t,i){var n=this.transformWikiEventData(i);this.scenario.mark(e,n,t)},e.prototype.isClosed=function(){return this._isClosed},e.prototype.transformWikiEventData=function(e){var t={};if(_.assign(t,this.additionalEventData,e),t.error){var i=r.WikiError.sanitize(t.message+r.WikiError.extractErrorMessage(t.error));t.message=i,t.error=i}return 0===Object.keys(t).length&&(t=void 0),t},e}();t.WikiScenario=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(577),r=function(){function e(e,t,i){this.resolveDependencies=e,this.replacements={};var r=t+"_imageCache";this.imageCache=new n.WikiImageCache(void 0,r,i)}return e.prototype.loadForViewer=function(e){var t=e.ctx,i=e.sanitizedContent,n=e.viewer;return this.resolveDependencies().wikiImageLoader.loadImagesAsync(t.beginOperation(),this.imageCache,i,n)},e.prototype.loadForEditor=function(e,t){return this.resolveDependencies().wikiImageLoader.preloadImages(e.beginOperation(),this.imageCache,t)},e.prototype.applyImageSources=function(e,t){for(var i=this.resolveDependencies().wikiImageLoader.getContentWithImages(e,this.imageCache,t),n=0,r=i.images;n<r.length;n++){var s=r[n];this.replacements[s.replacedUrl]=s.originalUrl}return i.content},e.prototype.onImageInserted=function(e,t){this.replacements[t]=e,this.imageCache.registerInsertedImage(this.resolveDependencies().$window,e,t)},e.prototype.restoreImageSources=function(e){return _.forOwn(this.replacements,function(t,i){e=e.split(i).join(""),e=e.split(_.escape(i)).join("")}),e},e.prototype.releaseCache=function(){this.imageCache.reset()},e}();t.WikiCachedImageHandler=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.resolveDependencies=e}return e.prototype.loadForViewer=function(e){e.ctx;var t=e.sanitizedContent;e.viewer;return t},e.prototype.loadForEditor=function(e,t){return this.resolveDependencies().$q.resolve()},e.prototype.applyImageSources=function(e,t){return t},e.prototype.onImageInserted=function(e,t){this.resolveDependencies().$window.URL.revokeObjectURL(t)},e.prototype.restoreImageSources=function(e){return e},e.prototype.releaseCache=function(){},e}();t.WikiPlainImageHandler=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.BroadcastForSelectedPages=0]="BroadcastForSelectedPages",e[e.NotificationAboutSelectedPage=1]="NotificationAboutSelectedPage",e[e.NotificationAboutSelectedPageLeft=2]="NotificationAboutSelectedPageLeft"}(n=t.PresenceIndicatorEventType||(t.PresenceIndicatorEventType={}));var r=function(){function e(e,t,i,r,s){this.channelGuid=t,this.canvasId=i,this.pageId=r,this.user=s,this.eventType=n[e]}return e.isTypeOf=function(e){var t=e.eventType;return void 0!==n[t]},e}();t.PresenceIndicatorEventData=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.collectPresenceData=function(e,t){if(!e||!e.model||!e.model.canvas)return{};var i=e.model.canvas,n=t||i.selectedPage;if(!n)return{};var r={};return r.count=n.activeUsers.length+1,r.numSections=n.sections.length,r.numLockedSections=this.getLockedSectionsCount(n),r.totalCount=this.getCanvasActiveUsersCount(i)+1,r.numPages=i.pages.length,r},e.getLockedSectionsCount=function(e){return e&&e.sections?e.sections.map(function(e){return e.isLockedFromDifferentSession?1:0}).reduce(function(e,t){return e+t},0):0},e.getCanvasActiveUsersCount=function(e){return e.pages.map(function(e){return e.activeUsers.length}).reduce(function(e,t){return e+t},0)},e}();t.WikiStatisticsDataCollector=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(55),r=function(){function e(){}return e.adaptTabInstance=function(e){return{id:e.internalTabInstanceId,name:e.tabName,defaultTab:e.wikiTabContext.wikiDefaultTab,wikiTabId:e.wikiTabContext.wikiTabId,channelId:e.channelId||"",channelName:e.channelName||"",teamId:e.teamId||"",teamName:e.teamName||"",teamGroupId:e.groupId||""}},e.filterTabInstances=function(e,t){return t===n.WikisFavoriteFilter.All?e:_.filter(e,function(e){return e.channelIsFavorite})},e}();t.WikisListProviderUtils=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(151),i(152),i(153),i(154),i(155),i(156),i(157),i(158),i(159),i(162),i(163),i(164),i(165),i(166),i(167),i(168),i(169),i(170),i(73),i(173),i(174),i(175),i(176),i(177),i(178),i(179),i(180),i(12),i(181),i(182),i(183),i(184),i(185),i(186),i(187),i(188),i(189),i(190),i(191),i(192),i(201),i(209),i(230),i(231),i(233),i(234),i(239),i(244),i(285),i(287),i(87),i(288),i(291),i(292),i(293),i(294),i(296),i(297),i(298),i(299),i(300),i(301),i(302),i(303),i(309),i(310),i(340),i(341),i(372),i(375),i(376),i(377),i(378),i(379),i(380),i(381),i(395),i(396),i(397),i(398),i(399),i(17),i(400),i(401),i(402),i(93),i(92),i(94),i(403),i(404),i(405),i(407),i(408),i(409),i(95),i(412),i(416),i(98),i(422),i(423),i(424),i(425),i(427),i(429),i(438),i(103),i(441),i(442),i(443),i(447),i(448),i(449),i(453),i(467),i(468),i(469),i(470),i(471),i(472),i(477),i(478),i(479),i(480),i(481),i(482),i(483),i(484),i(494),i(497),i(498),i(499),i(500),i(504),i(505),i(506),i(107),i(508),i(103),i(95),i(98),i(87),i(509),i(510),i(511),i(108),i(512),i(513),i(514),i(515),i(516),i(517),i(518),i(519),i(520),i(521),i(522),i(523),i(530),i(531),i(532),i(533),i(534),i(536),i(537),i(97),i(550),i(551),i(552),i(553),i(555),i(556),i(557),i(558),i(559),i(560),i(561),i(562),i(563),i(564),i(597),i(598),i(599),i(600),i(601),i(602),i(603),i(604),i(605),i(606),i(610),i(611),i(612),i(613),i(614),i(615),i(616)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r){this.conversationsStore=e,this.constants=t,this.eventingService=i,this.loggingService=n,this.settingsService=r,this.logger=this.loggingService.newLogger("skipRosterSettingService"),this.isLargeTeamsEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enableLargeTeams),this.handleSettingsServiceUpdate()}return e.$inject=["conversationsStore","constants","eventingService","loggingService","settingsService"],e.prototype.handleSettingsServiceUpdate=function(){var e=this;this.eventingService.unsafeOn(this.constants.events.settings.updated,function(){var t=e.settingsService.valueAsBoolean(e.constants.settings.names.enableLargeTeams);t!==e.isLargeTeamsEnabled&&(e.isLargeTeamsEnabled=t,e.logger.info("LargeTeams flag state is change to "+t),e.conversationsStore.ensureRosterStateInSync())})},e}();t.SkipRosterSettingServiceImplementation=n,angular.module("teamspace.skipRosterSettingService",["teamspace.constants","teamspace.eventingService","teamspace.loggingService"]).service("skipRosterSettingService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h,d){this.$qNoApply=e,this.$timeout=t,this.$window=i,this.channelMembershipPropertiesService=n,this.channelService=r,this.chatServiceClient=s,this.constants=a,this.conversationsStore=o,this.eventingService=c,this.loggingService=l,this.settingsService=p,this.teamsMembersLruStore=u,this.teamMembershipPropertiesService=h,this.utilityService=d,this.mostRecentTeam={},this.isTeamsMembersCacheInit=this.settingsService.valueAsBoolean(this.constants.settings.names.enableLargeTeams)||this.settingsService.valueAsBoolean(this.constants.settings.names.enableUsingAtMentionService),this.logger=this.loggingService.newLogger("teamMembersCacheService"),this.handleSettingsServiceUpdate(),this.isTeamsMembersCacheInit&&this.init()}return e.$inject=["$qNoApply","$timeout","$window","channelMembershipPropertiesService","channelService","chatServiceClient","constants","conversationsStore","eventingService","loggingService","settingsService","teamsMembersLruStore","teamMembershipPropertiesService","utilityService"],Object.defineProperty(e.prototype,"totalTeamsCanBeCached",{get:function(){return this.settingsService.valueFor(this.constants.settings.names.teamMemberCacheCountLimit)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalMemberPerTeamLimit",{get:function(){return this.settingsService.valueFor(this.constants.settings.names.teamMemberCacheSizeLimit)},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.initCacheProperties(),this.isTeamsMembersCacheInit?this.subscribeToEvents():this.unsubscribeFromEvents()},e.prototype.initCacheProperties=function(){this.teamMembersCache=[],this.activeValidationRequests=new Map,this.bufferedSelectedMembers=new Map,this.readTeamFromDBOnGoing=new Set},e.prototype.subscribeToEvents=function(){var e=this;this.unsubscribeToChannelMemberSelect=this.eventingService.unsafeOn(this.constants.events.channels.channelMemberSelected,function(t,i){e.addMemberToCache(i.targetId,i.mri)}),this.unsubscribeToChannelSwitch=this.eventingService.unsafeOn(this.constants.events.syncService.setActiveConversation,function(t,i){e.$window.requestIdleCallback(function(){var t=e.conversationsStore.getConversation(i);if(t&&t.isChannelConversation()){var n=e.isPrivateChannelContext(t.id)?t.id:t.getTeamId();e.primeForTeam(n)}})}),this.unsubscribeToRemoveMemberMessage=this.eventingService.unsafeOn(this.constants.events.pushEvents.messageStore.createOrUpdateMessage,function(t,i){i.isFromLongPoll&&e.handleRemoveSystemMessages(i.messages)})},e.prototype.unsubscribeFromEvents=function(){this.unsubscribeToChannelMemberSelect&&(this.unsubscribeToChannelMemberSelect(),this.unsubscribeToChannelMemberSelect=null),this.unsubscribeToChannelSwitch&&(this.unsubscribeToChannelSwitch(),this.unsubscribeToChannelSwitch=null),this.unsubscribeToRemoveMemberMessage&&(this.unsubscribeToRemoveMemberMessage(),this.unsubscribeToRemoveMemberMessage=null)},e.prototype.handleSettingsServiceUpdate=function(){var e=this;this.eventingService.unsafeOn(this.constants.events.settings.updated,function(){var t=e.settingsService.valueAsBoolean(e.constants.settings.names.enableLargeTeams),i=e.settingsService.valueAsBoolean(e.constants.settings.names.enableUsingAtMentionService),n=t||i;n!==e.isTeamsMembersCacheInit&&(e.logger.info("cache initialization state is change to "+n),e.isTeamsMembersCacheInit=n,e.init())})},e.prototype.handleRemoveSystemMessages=function(e){var t=this;if(this.teamMembersCache.length){var i=new Map,n=[];_.forEach(e,function(e){if(e&&e.messagetype===SkypeX.Services.ChatServiceUtils.MessageType_DeleteMember){var n=e.conversationId,r=null,s=-1;if(i.has(n))r=t.teamMembersCache[i.get(n).pos];else for(var a=0;a<t.teamMembersCache.length;a++)if(t.teamMembersCache[a].conversationId===n){s=a,r=t.teamMembersCache[a];break}if(r){var o,c=[];if(t.utilityService.fastParseXML(e.content,{target:function(e){return c.push(e.trim())},rosterVersion:function(e){return o=e&&parseInt(e)}}),!o||o<=r.rosterVersion)return;if(_.forEach(c,function(e){var i=t.getMemberIndex(r,e);i>-1&&r.mris.splice(i,1)}),i.has(n)){var l=i.get(n);l.version<o&&(l.version=o)}else i.set(n,{pos:s,version:o})}}}),i.forEach(function(e){var i=e.pos;t.teamMembersCache[i].mris&&t.teamMembersCache[i].mris.length&&(t.teamMembersCache[i].rosterVersion=e.version,n.push(t.teamMembersCache[i]))}),n.length&&this.$window.requestIdleCallback(function(){return t.commitCacheToIndexDb(n)})}},e.prototype.primeForTeam=function(e){var t=this;if(!this.isTeamsMembersCacheInit)return this.$qNoApply.reject("[TeamsMembersCacheService]: Large teams is not enabled.");var i=this.loggingService.newScenario(this.constants.scenarios.teamMembersCache.addTeamToCache),n=(r={},r[this.constants.scenarioDataPropNames.threadId]=e,r[this.constants.scenarios.teamMembersCache.eventPropNames.teamCount]=this.teamMembersCache.length,r);return this.mostRecentTeam.conversationId===e||this.moveTeamToBottom(e)?(n[this.constants.scenarios.teamMembersCache.eventPropNames.cacheHit]=!0,i.stop(n),this.$qNoApply.resolve(!0)):(this.readTeamFromDBOnGoing.has(e)&&this.loggingService.warn("teamId: {0} - DB read happening during an ongoing DB read for the team",e),n[this.constants.scenarios.teamMembersCache.eventPropNames.cacheHit]=!1,this.readTeamFromDBOnGoing.add(e),this.teamsMembersLruStore.get(e).then(function(r){if(r)return t.isTeamCacheValid(r)?(t.consumeBufferedSelectedMembers(r,!0),t.pushTeamToBottom(r),i.stop(n),!0):(t.$timeout(function(){t.updateCache(r).then(function(){t.pushTeamToBottom(r)})},0,!1),i.stop(n),!1);var s={conversationId:e,mris:[],rosterVersion:t.getLocalRosterVersion(e)};return t.consumeBufferedSelectedMembers(s,!0),t.pushTeamToBottom(s),i.stop(n),!0}).catch(function(e){return i.fail(n),t.logger.error("[teamMembersCache] primeForTeam failed with {0}",e),!1}).finally(function(){return t.readTeamFromDBOnGoing.delete(e)}));var r},e.prototype.getMembers=function(e){var t=this;if(!this.isTeamsMembersCacheInit)return this.$qNoApply.reject("[TeamsMembersCacheService]: Large teams is not enabled.");var i=this.loggingService.newScenario(this.constants.scenarios.teamMembersCache.getMembers),n=(r={},r[this.constants.scenarioDataPropNames.threadId]=e,r);return this.primeForTeam(e).then(function(e){return e?(n[t.constants.scenarios.teamMembersCache.eventPropNames.memberCount]=t.mostRecentTeam.mris.length,i.stop(n),t.mostRecentTeam.mris):(n[t.constants.scenarios.teamMembersCache.eventPropNames.memberCount]=0,i.stop(n),[])});var r},e.prototype.addMemberToCache=function(e,t,i){var n=this;if(void 0===i&&(i=!0),this.isTeamsMembersCacheInit){var r=_.filter(this.teamMembersCache,function(t){return t.conversationId===e})[0];r?(this.addMemberToCacheItemInternal(r,t),i&&this.$window.requestIdleCallback(function(){return n.commitCacheToIndexDb([r])})):(this.bufferedSelectedMembers.has(e)?this.bufferedSelectedMembers.get(e).push(t):this.bufferedSelectedMembers.set(e,[t]),this.readTeamFromDBOnGoing.has(e)||this.activeValidationRequests.has(e)||this.primeForTeam(e))}},e.prototype.addMemberToCacheItemInternal=function(e,t){var i=this.loggingService.newScenario(this.constants.scenarios.teamMembersCache.addMemberToCache),n=e.mris,r=this.getMemberIndex(e,t),s=(a={},a[this.constants.scenarioDataPropNames.threadId]=e.conversationId,a[this.constants.scenarios.teamMembersCache.eventPropNames.userToBeAdded]=t,a[this.constants.scenarios.teamMembersCache.eventPropNames.memberCount]=n.length,a);r>-1?(n.push(n.splice(r,1)[0]),s[this.constants.scenarios.teamMembersCache.eventPropNames.cacheHit]=!0):(n.push(t),n.length>this.totalMemberPerTeamLimit&&n.shift(),s[this.constants.scenarios.teamMembersCache.eventPropNames.cacheHit]=!1),i.stop(s);var a},e.prototype.getMemberIndex=function(e,t){return e.mris&&e.mris.length?e.mris.indexOf(t):-1},e.prototype.updateCache=function(e){var t=this,i=e.conversationId;if(e.mris&&e.mris.length){var n=this.activeValidationRequests.get(i);if(n)return n;var r=e.mris,s=this.chatServiceClient.getMembersPropertiesIfInTeam(i,r).toNgPromise(this.$qNoApply).then(function(i){return i.length===r.length?t.$qNoApply.resolve():(e.mris=_.map(i,function(e){return e.id}),t.consumeBufferedSelectedMembers(e),t.commitCacheToIndexDb([e]))}).catch(function(e){return t.logger.error("Failed to verify members from chat service. Error: {0}",JSON.stringify(e)),t.$qNoApply.reject()}).finally(function(){return t.activeValidationRequests.delete(i)});return this.activeValidationRequests.set(i,s),s}return this.$qNoApply.resolve()},e.prototype.consumeBufferedSelectedMembers=function(e,t){var i=this;void 0===t&&(t=!1);var n=this.bufferedSelectedMembers.get(e.conversationId);if(n&&n.length){for(var r=0;r<n.length;r++)this.addMemberToCacheItemInternal(e,n[r]);this.bufferedSelectedMembers.delete(e.conversationId),t&&this.$window.requestIdleCallback(function(){return i.commitCacheToIndexDb([e])})}},e.prototype.commitCacheToIndexDb=function(e){return this.teamsMembersLruStore.addOrUpdate(e)},e.prototype.isTeamCacheValid=function(e){return e.rosterVersion===this.getLocalRosterVersion(e.conversationId)},e.prototype.getLocalRosterVersion=function(e){return this.isPrivateChannelContext(e)?this.channelMembershipPropertiesService.getRosterVersion(e):this.teamMembershipPropertiesService.getRosterVersion(e)},e.prototype.isPrivateChannelContext=function(e){var t=this.channelService.getChannelByObjectId(e);return t&&t.channelType===teamspace.services.ChannelType.Private},e.prototype.moveTeamToBottom=function(e){var t=this.takeFromCache(e);return!!t&&(this.teamMembersCache.push(t),this.mostRecentTeam=this.teamMembersCache[this.teamMembersCache.length-1],!0)},e.prototype.pushTeamToBottom=function(e){this.teamMembersCache.push(e),this.teamMembersCache.length>this.totalTeamsCanBeCached&&this.teamMembersCache.shift(),this.mostRecentTeam=this.teamMembersCache[this.teamMembersCache.length-1]},e.prototype.takeFromCache=function(e){for(var t,i=0;i<this.teamMembersCache.length;i++)if(this.teamMembersCache[i].conversationId===e)return t=this.teamMembersCache.splice(i,1)[0];return t},e}();t.TeamMembersCacheService=n,angular.module("teamspace.teamMembersCacheService",["teamspace.channelService","teamspace.eventingService","teamspace.loggingService","teamspace.settingsService","teamspace.teamsMembersLruStore"]).service("teamMembersCacheService",n)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n,r,s,a,o,c){var l=e.call(this,o.valueFor(s.settings.names.userProfileServiceConstants).host+o.valueFor(s.settings.names.userProfileServiceConstants).latestVersion,o,s,n,t,i,r,c)||this;return l.$q=t,l.$qNoApply=i,l.loggingService=a,l}return n(t,e),t.$inject=["$q","$qNoApply","$http","authenticationService","constants","loggingService","settingsService","appStateService"],t.prototype.search=function(e,t,i,n,r){if(void 0===r&&(r=null),!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLargeTeams)&&!this.settingsService.valueAsBoolean(this.constants.settings.names.enableUsingAtMentionService))return SkypeX.Services.SyncTasks.Rejected("Large Team Or AtMentionService is not enabled");if(!e||!t)return this.loggingService.error("[TeamMemberProfileSearchClient]]: profileSearch - channelId or keyword was undefined"),SkypeX.Services.SyncTasks.Rejected("Invalid parameter");n||(n=this.settingsService.valueFor(this.constants.settings.names.atMentionDefaultSearchResultCount)||5);var s=this.settingsService.valueFor(this.constants.settings.names.userProfileServiceConstants),a=s.endpoints.profileSearch.params,o=i&&i.includeDL&&i.includeDL.toString()||"false",c=i&&i.includeGuest&&i.includeGuest.toString()||"false",l=s.endpoints.profileSearch.url.replace("{channelId}",encodeURIComponent(e));l+=a.top.replace("{top}",n.toString()),l+=a.includeDLs.replace("{includeDLs}",o),l+=a.includeBots.replace("{includeBots}","false"),l+=a.enableGuest.replace("{enableGuest}",c);var p={keyword:t};return this.performApiPost(l,_.defaults(r,{callType:"at-mention"}),p)},t.prototype._getAuthHeaders=function(e){return void 0===e&&(e=!1),this.authenticationService.getAuthHeaders()},t}(SkypeX.Services.GenericRestClient);t.TeamMemberProfileSearchClientImplementation=r,angular.module("teamspace.teamMemberProfileSearchClient",["teamspace.qNoApply","teamspace.constants","teamspace.loggingService","teamspace.authenticationService","teamspace.settingsService"]).service("teamMemberProfileSearchClient",r)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n){this.loggingService=e,this.teamsMembersDatabase=t,this.constants=i,this.$qNoApply=n,this.membersLruStoreName=this.teamsMembersDatabase.schema.stores.memberslru.name}return e.$inject=["loggingService","teamsMembersDatabase","constants","$qNoApply"],e.prototype.openDB=function(){var e=this;if(this.dbOpenPromise)return this.loggingService.info("[TeamsMembersLruStore]: teams_members DB was attempted to open already."),this.dbOpenPromise;var t=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.teamsMembersDbOpen);return this.dbOpenPromise=this.teamsMembersDatabase.open().toNgPromise(this.$qNoApply).then(function(){return t.stop(),e.$qNoApply.resolve()}).catch(function(){return t.fail(),e.loggingService.error("[TeamsMembersLruStore]: opening of teams_members DB failed."),e.$qNoApply.reject()}),this.dbOpenPromise},e.prototype.addOrUpdate=function(e){var t=this;return this.openDB().then(function(){return t.teamsMembersDatabase.provider.put(t.membersLruStoreName,e).toNgPromise(t.$qNoApply)}).catch(function(i){return t.loggingService.error("[TeamsMembersLruStore]: addOrUpdate failed for team id {0} : ",JSON.stringify(e)),t.$qNoApply.reject()})},e.prototype.remove=function(e){var t=this;return this.openDB().then(function(){return t.teamsMembersDatabase.provider.remove(t.membersLruStoreName,e).toNgPromise(t.$qNoApply)}).catch(function(i){return t.loggingService.error("[TeamsMembersLruStore]: delete failed for team ids {0} : ",e.join(",")),t.$qNoApply.reject()})},e.prototype.get=function(e){var t=this;return this.openDB().then(function(){return t.teamsMembersDatabase.provider.get(t.membersLruStoreName,e).toNgPromise(t.$qNoApply)}).catch(function(i){return t.loggingService.error("[TeamsMembersLruStore]: get failed for team id {0} : ",e),t.$qNoApply.reject()})},e}();t.TeamsMembersLruStoreImplementation=n,angular.module("teamspace.teamsMembersLruStore",["skypeX.clientDatabase","teamspace.qNoApply","teamspace.loggingService","teamspace.constants"]).service("teamsMembersLruStore",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i){this.constants=e,this.settingsService=t,this.sxConfig=i,this.membershipDictionary=new Map}return e.$inject=["constants","settingsService","sxConfig"],Object.defineProperty(e.prototype,"isLargeTeamsEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableLargeTeams)},enumerable:!0,configurable:!0}),e.prototype.getRosterVersion=function(e){if(!this.checkIfNullOrNotPresent(e))return this.membershipDictionary.get(e).rosterVersion},e.prototype.getRole=function(e){if(!this.checkIfNullOrNotPresent(e))return this.membershipDictionary.get(e).role},e.prototype.isAdmin=function(e){return this.getRole(e)===this.constants.RoleConstants.Admin},e.prototype.isMuted=function(e){if(!this.checkIfNullOrNotPresent(e))return this.membershipDictionary.get(e).isMuted},e.prototype.getBotCount=function(e){var t=this.getSummaryInternal(e);return t?t.botCount:void 0},e.prototype.getReaderCount=function(e){var t=this.getSummaryInternal(e);return t?t.readerCount:void 0},e.prototype.getAdminCount=function(e){var t=this.getSummaryInternal(e);return t?t.roleCounts.Admin||0:void 0},e.prototype.getMemberCount=function(e){var t=this.getSummaryInternal(e);return t?(t.roleCounts.User||0)-t.botCount:void 0},e.prototype.getGuestCount=function(e){var t=this.getSummaryInternal(e);return t?t.roleCounts.Guest||0:void 0},e.prototype.getTotalUserCount=function(e,t){void 0===t&&(t=!0);var i=this.getSummaryInternal(e);if(i)return i.memberCount-(t?i.botCount:0)},e.prototype.getSummaryInternal=function(e){if(!this.checkIfNullOrNotPresent(e))return this.membershipDictionary.get(e).rosterSummary},e.prototype.updateMembershipProperties=function(e,t){if(e){var i=void 0,n=void 0,r=void 0,s=void 0;if(!this.isLargeTeamsEnabled&&t.members){var a=this.sxConfig.getCurrentSkypeMri(),o=t.members.filter(function(e){return e.id===a});o.length>0&&(i=o[0].role,s=o[0].isReader)}else this.isLargeTeamsEnabled&&t.memberProperties&&(i=t.memberProperties[SkypeX.Services.ChatServiceUtils.MemberProp_Role],s=t.memberProperties[SkypeX.Services.ChatServiceUtils.MemberProp_Reader],n=t.rosterVersion,r=new teamspace.services.RosterSummaryLocal(t.rosterSummary));var c=this.membershipDictionary.get(e);c?(c.role=i,c.rosterVersion=n,c.rosterSummary=r,c.isMuted=s):this.membershipDictionary.set(e,{role:i,rosterSummary:r,rosterVersion:n,isMuted:s})}else this.membershipDictionary.has(t.id)&&this.membershipDictionary.delete(t.id)},e.prototype.checkIfNullOrNotPresent=function(e){return!e||!this.membershipDictionary.has(e)},e}();t.MembershipPropertiesService=n,angular.module("teamspace.membershipPropertiesService",["teamspace.channelConversationAdapterService"]).service("membershipPropertiesService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r){var s=this;this.channelConversationAdapterService=e,this.constants=t,this.membershipPropertiesService=i,this.teamMembershipPropertiesService=n,this.settingsService=r,this.channelConversationAdapterService.subscribe(function(e,t){return s.addOrUpdateTeamChannels(t)},this.constants.ChannelConversationAdapterService.Type_ChannelConversationsChanged)}return e.$inject=["channelConversationAdapterService","constants","membershipPropertiesService","teamMembershipPropertiesService","settingsService"],Object.defineProperty(e.prototype,"isMembershipPropertiesServiceEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableTeamChannelMembershipService)},enumerable:!0,configurable:!0}),e.prototype.getRosterVersion=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getRosterVersion(this.getChannelContainer(e));var t=this.channelConversationAdapterService.getChannelById(e);return t?t.channelType===teamspace.services.ChannelType.Private?this.membershipPropertiesService.getRosterVersion(this.getChannelContainer(e)):this.teamMembershipPropertiesService.getRosterVersion(t.parentTeamId):void 0},e.prototype.getRole=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getRole(this.getChannelContainer(e));var t=this.channelConversationAdapterService.getChannelById(e);return t?t.channelType===teamspace.services.ChannelType.Private?this.membershipPropertiesService.getRole(this.getChannelContainer(e)):this.teamMembershipPropertiesService.getRole(t.parentTeamId):void 0},e.prototype.isAdmin=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.isAdmin(this.getChannelContainer(e));var t=this.channelConversationAdapterService.getChannelById(e);return t?t.channelType===teamspace.services.ChannelType.Private?this.membershipPropertiesService.isAdmin(this.getChannelContainer(e)):this.teamMembershipPropertiesService.isAdmin(t.parentTeamId):void 0},e.prototype.isMuted=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.isMuted(this.getChannelContainer(e));var t=this.channelConversationAdapterService.getChannelById(e);return t?t.channelType===teamspace.services.ChannelType.Private?this.membershipPropertiesService.isMuted(this.getChannelContainer(e)):this.teamMembershipPropertiesService.isMuted(t.parentTeamId):void 0},e.prototype.getBotCount=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getBotCount(this.getChannelContainer(e));var t=this.channelConversationAdapterService.getChannelById(e);return t?t.channelType===teamspace.services.ChannelType.Private?this.membershipPropertiesService.getBotCount(this.getChannelContainer(e)):this.teamMembershipPropertiesService.getBotCount(t.parentTeamId):void 0},e.prototype.getReaderCount=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getReaderCount(this.getChannelContainer(e));var t=this.channelConversationAdapterService.getChannelById(e);return t?t.channelType===teamspace.services.ChannelType.Private?this.membershipPropertiesService.getReaderCount(this.getChannelContainer(e)):this.teamMembershipPropertiesService.getReaderCount(t.parentTeamId):void 0},e.prototype.getAdminCount=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getAdminCount(this.getChannelContainer(e));var t=this.channelConversationAdapterService.getChannelById(e);return t?t.channelType===teamspace.services.ChannelType.Private?this.membershipPropertiesService.getAdminCount(this.getChannelContainer(e)):this.teamMembershipPropertiesService.getAdminCount(t.parentTeamId):void 0},e.prototype.getMemberCount=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getMemberCount(this.getChannelContainer(e));var t=this.channelConversationAdapterService.getChannelById(e);return t?t.channelType===teamspace.services.ChannelType.Private?this.membershipPropertiesService.getMemberCount(this.getChannelContainer(e)):this.teamMembershipPropertiesService.getMemberCount(t.parentTeamId):void 0},e.prototype.getGuestCount=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getGuestCount(this.getChannelContainer(e));var t=this.channelConversationAdapterService.getChannelById(e);return t?t.channelType===teamspace.services.ChannelType.Private?this.membershipPropertiesService.getGuestCount(this.getChannelContainer(e)):this.teamMembershipPropertiesService.getGuestCount(t.parentTeamId):void 0},e.prototype.getTotalUserCount=function(e,t){if(void 0===t&&(t=!0),this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getTotalUserCount(this.getChannelContainer(e),t);var i=this.channelConversationAdapterService.getChannelById(e);return i?i.channelType===teamspace.services.ChannelType.Private?this.membershipPropertiesService.getTotalUserCount(this.getChannelContainer(e),t):this.teamMembershipPropertiesService.getTotalUserCount(i.parentTeamId,t):void 0},e.prototype.updateMembershipProperties=function(e,t){this.membershipPropertiesService.updateMembershipProperties(this.getChannelContainer(e),t)},e.prototype.addOrUpdateTeamChannels=function(e){if(e&&_.isArray(e)&&e.length)for(var t=0;t<e.length;t++){var i=e[t];i.isLinkedChannel&&i.isLinkedChannel()&&this.updateMembershipProperties(i.id,i)}},e.prototype.getChannelContainer=function(e){var t=this.channelConversationAdapterService.getChannelById(e);return t?t.membersContainerId:void 0},e}();t.ChannelMembershipPropertiesService=n,angular.module("teamspace.channelMembershipPropertiesService",["teamspace.channelConversationAdapterService","teamspace.membershipPropertiesService"]).service("channelMembershipPropertiesService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n){var r=this;this.channelConversationAdapterService=e,this.constants=t,this.membershipPropertiesService=i,this.settingsService=n,this.isMembershipPropertiesServiceEnabled&&this.channelConversationAdapterService.subscribe(function(e,t){return r.addOrUpdateTeams(t)},this.constants.ChannelConversationAdapterService.Type_ChannelConversationsChanged)}return e.$inject=["channelConversationAdapterService","constants","membershipPropertiesService","settingsService"],Object.defineProperty(e.prototype,"isMembershipPropertiesServiceEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableTeamChannelMembershipService)},enumerable:!0,configurable:!0}),e.prototype.getRosterVersion=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getRosterVersion(e);var t=this.channelConversationAdapterService.getTeamById(e);return t&&t.rosterVersion},e.prototype.getRole=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getRole(e);var t=this.channelConversationAdapterService.getTeamById(e);return t&&t.userRole},e.prototype.isAdmin=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.isAdmin(e);var t=this.channelConversationAdapterService.getTeamById(e);return t&&t.adminView},e.prototype.getBotCount=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getBotCount(e);var t=this.channelConversationAdapterService.getTeamById(e);return t&&t.botCount},e.prototype.isMuted=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.isMuted(e);var t=this.channelConversationAdapterService.getTeamById(e);return t&&t.muteView},e.prototype.getReaderCount=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getReaderCount(e);var t=this.channelConversationAdapterService.getTeamById(e);return t&&t.readerCount},e.prototype.getAdminCount=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getAdminCount(e);var t=this.channelConversationAdapterService.getTeamById(e);return t&&t.adminCount},e.prototype.getMemberCount=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getMemberCount(e);var t=this.channelConversationAdapterService.getTeamById(e);return t&&t.userCount},e.prototype.getGuestCount=function(e){if(this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getGuestCount(e);var t=this.channelConversationAdapterService.getTeamById(e);return t&&t.guestCount},e.prototype.getTotalUserCount=function(e,t){if(void 0===t&&(t=!0),this.isMembershipPropertiesServiceEnabled)return this.membershipPropertiesService.getTotalUserCount(e,t);var i=this.channelConversationAdapterService.getTeamById(e);return i&&i.totalUserCount(t)},e.prototype.updateMembershipProperties=function(e,t){this.isMembershipPropertiesServiceEnabled&&this.membershipPropertiesService.updateMembershipProperties(e,t)},e.prototype.addOrUpdateTeams=function(e){if(e&&_.isArray(e)&&e.length)for(var t=0;t<e.length;t++){var i=e[t];i.isTeam&&i.isTeam()&&this.updateMembershipProperties(i.id,i)}},e}();t.TeamMembershipPropertiesService=n,angular.module("teamspace.teamMembershipPropertiesService",["teamspace.channelConversationAdapterService","teamspace.membershipPropertiesService","teamspace.settingsService"]).service("teamMembershipPropertiesService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a){this.$q=e,this.teamMemberProfileSearchClient=t,this.constants=i,this.loggingService=n,this.peopleService=r,this.settingsService=s,this.teamMembersCacheService=a}return e.$inject=["$q","teamMemberProfileSearchClient","constants","loggingService","peopleService","settingsService","teamMembersCacheService"],e.prototype.searchForUserProfileInChannel=function(e,t,i,n,r,s){var a=this;if(void 0===r&&(r=!1),!e||!t)return this.loggingService.error("AtMentionService: profileSearch - either channelId or keyword was undefined. channelId - {0}, keyword - {1}",e,t&&t.length||0),this.$q.resolve([]);if(r)return this.loggingService.info("AtMentionService: profileSearch - skipping cache and invoking atMention service."),this.searchUsingAtMentionApi(e,t,i,s);if(t===this.constants.events.atMention.emptyAtMentionSearch)return this.loggingService.info("AtMentionService: profileSearch - emptyAtMentionSearch event, showing existing team members from cache."),this.readFromCacheAndResolveProfile(e,i);n||(n=this.settingsService.valueFor(this.constants.settings.names.atMentionCacheHitLimit)||3);var o=this.$q.defer();return this.readFromCacheAndResolveProfile(e,i).then(function(r){var c=r||[],l=a.matchContactsBySearchFields(c,t);if(t.length<a.settingsService.valueFor(a.constants.settings.names.atMentionMinKeywordLenToHitService)||l.length>n)return a.loggingService.info("[AtMentionService] returning matches from team member cache only. #matched contacts - {0}, keyword length - {1}",l.length,t.length),void o.resolve(l);l.length>0&&o.notify(l),a.searchUsingAtMentionApi(e,t,i,s).then(function(e){e&&e.length?o.resolve(_.uniqBy(l.concat(e),function(e){return e.mri})):o.resolve(l)})}).catch(function(e){a.loggingService.error("[searchForUserProfileInChannel] Following error occured in searching for user profile - {0}",JSON.stringify(e)),o.resolve([])}),o.promise},e.prototype.matchContactsBySearchFields=function(e,t,i){var n=this;void 0===i&&(i=["displayName","email"]);var r=[];return i.length?(e.forEach(function(e){n.matchContactBySearchFields(e,t,i)&&r.push(e)}),r):r},e.prototype.matchContactBySearchFields=function(e,t,i){var n=this;if(void 0===i&&(i=["displayName","email"]),!i.length)return null;var r=_.escapeRegExp(t);return _.some(i,function(t){return n.checkRegExMatchAtStart(e[t],r)})?e:_.some(i,function(t){return n.checkRegExMatchAfterStart(e[t],r)})?e:null},e.prototype.searchUsingAtMentionApi=function(e,t,i,n){var r=this,s=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.teamMemberProfileSearch);return this.teamMemberProfileSearchClient.search(e,t,i,n).toNgPromise(this.$q).then(function(t){return r.loggingService.info("[profileSearch] Successfully fetched {1} users for channel {0}",e,t&&t.length),s.stop(),r.peopleService.filterSearchResults(i,t)}).catch(function(t){return s.fail((i={},i[r.constants.scenarioDataPropNames.teamId]=e,i[r.constants.scenarioDataPropNames.error]=JSON.stringify(t),i)),r.loggingService.error("[AtMentionService] Following error occured in searching for user profile - {0}",JSON.stringify(t)),r.$q.resolve([]);var i})},e.prototype.readFromCacheAndResolveProfile=function(e,t){var i=this;return this.teamMembersCacheService.getMembers(e).then(function(e){return i.peopleService.getAllShortPeopleProfile(e,"at-mention-service",!1,t)}).catch(function(e){return i.loggingService.error("[readFromCacheAndResolveProfile] Following error occured in searching for user profile in cache - {0}",JSON.stringify(e)),i.$q.resolve([])})},e.prototype.checkRegExMatchAtStart=function(e,t){return new RegExp("^"+t,"gi").test(e)},e.prototype.checkRegExMatchAfterStart=function(e,t){return new RegExp(" "+t,"gi").test(e)},e}();t.AtMentionServiceImplementation=n,angular.module("teamspace.atMentionService",["teamspace.teamMemberProfileSearchClient","teamspace.loggingService","teamspace.peopleService","teamspace.constants","teamspace.teamMembersCacheService"]).service("atMentionService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(160),i(161)},function(e,t,i){"use strict";function n(){return c("#navigation-buttons button")}function r(){return c("#newchat-button")}function s(){return c("button[cortana-button]")}function a(){return c("calling-screen button[ngsf-toggle-fullscreen]")}function o(){return c("calling-monitor #calling-screen-buttons .skype-action")}function c(e){for(var t=document.querySelectorAll(e),i=0;i<t.length;i++)if(t[i].focus(),document.activeElement===t[i])return!0;return!1}var l=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(t,i,n,r,s){var a=e.call(this)||this;return a.platformDetectService=t,a.$window=i,a.$timeout=n,a.settingsService=r,a.constants=s,a.keyboardNavigationModeClass="acc-keyboard-mode",a.inputClasses=["acc-keyboard-input","cke_editable"],a.keyboardNavigationMode=!1,a._focusEditorOnInit=!1,a.enabled=!0,a.keyboardNavigationKeys=[a.constants.keyCodes.tab,a.constants.keyCodes.enter,a.constants.keyCodes.escape,a.constants.keyCodes.space,a.constants.keyCodes.pageUp,a.constants.keyCodes.pageDown,a.constants.keyCodes.end,a.constants.keyCodes.home,a.constants.keyCodes.left,a.constants.keyCodes.right,a.constants.keyCodes.up,a.constants.keyCodes.down,a.constants.keyCodes.f6,a.constants.keyCodes.alt],a.inputFieldKeys=[a.constants.keyCodes.enter,a.constants.keyCodes.space,a.constants.keyCodes.pageUp,a.constants.keyCodes.pageDown,a.constants.keyCodes.end,a.constants.keyCodes.home,a.constants.keyCodes.left,a.constants.keyCodes.right,a.constants.keyCodes.up,a.constants.keyCodes.down],a.keyboardNavigationLocked=!1,a}return l(t,e),t.$inject=["platformDetectService","$window","$timeout","settingsService","constants"],t.prototype.init=function(e){this.enabled=!this.settingsService.valueAsBoolean(this.constants.settings.names.accessibilityDisabled),this.enabled&&(this.element=e,this.initOutlining(),this.settingsService.valueAsBoolean(this.constants.settings.names.isDesktopApp)&&this.initFocusRestoration())},t.prototype.isChromeOrSafari=function(){return this.platformDetectService.getBrowser()===this.constants.browser.chrome||this.platformDetectService.getBrowser()===this.constants.browser.safari},t.prototype.isInKeyboardNavigationMode=function(){return this.keyboardNavigationMode},t.prototype.lockKeyboardNavigation=function(){this.keyboardNavigationLocked=!0,this.keyboardNavigationMode&&(this.keyboardNavigationMode=!1,this.element.classList.remove(this.keyboardNavigationModeClass),this.trigger(teamspace.services.AccessibilityServiceEvents.EventType_KeyboardModeChange,teamspace.services.AccessibilityServiceEvents.Key_KeyboardModeDisabled))},t.prototype.unLockKeyboardNavigation=function(e){this.keyboardNavigationLocked=!1,this.keyboardNavigationMode!==e&&(this.keyboardNavigationMode=e,e?(this.element.classList.add(this.keyboardNavigationModeClass),this.trigger(teamspace.services.AccessibilityServiceEvents.EventType_KeyboardModeChange,teamspace.services.AccessibilityServiceEvents.Key_KeyboardModeEnabled)):(this.element.classList.remove(this.keyboardNavigationModeClass),this.trigger(teamspace.services.AccessibilityServiceEvents.EventType_KeyboardModeChange,teamspace.services.AccessibilityServiceEvents.Key_KeyboardModeDisabled)))},t.prototype.waitForElementAndSetFocus=function(e,t){var i=this;t=t||3e3;var n,r=function(){var s=$(e);0===s.length||0===s[0].getBoundingClientRect().width||0===s[0].getBoundingClientRect().height?(n=i.$window.requestAnimationFrame(r),i.$timeout(function(){i.$window.cancelAnimationFrame(n)},t)):(i.isElementTabbableNatively(s[0])||s[0].hasAttribute("tabindex")||s[0].setAttribute("tabindex","-1"),s[0].focus(),event&&event.stopPropagation())};r()},t.prototype.isElementTabbableNatively=function(e){return"BUTTON"===e.tagName},t.prototype.initOutlining=function(){this.addListener(this.element,"click",this.onClick.bind(this),!0),this.addListener(this.element,"keydown",this.onKey.bind(this),!0)},t.prototype.initFocusRestoration=function(){this.addListener(document.body,"keydown",this.onBodyKeydown.bind(this))},t.prototype.addListener=function(e,t,i,n){void 0===n&&(n=!1),e.addEventListener(t,i,n),angular.element(e).on("$destroy",function(){return e.removeEventListener(t,i,n)})},t.prototype.onBodyKeydown=function(e){if((e.keyCode||e.which)===this.constants.keyCodes.tab&&!e.defaultPrevented&&e.target===document.body){for(var t=0,i=[a,o,n,r,s];t<i.length&&!(0,i[t])();t++);e.preventDefault()}},t.prototype.onClick=function(e){if(!teamspace.accessibility.Helpers.ElementUtils.isFiredByEnterKey(e)&&!this.isSimulatedClick(e)){var t=e.target;t&&t.parentElement&&t.parentElement.hasAttribute("inControl")?this.lockKeyboardNavigation():this.unLockKeyboardNavigation(!1)}},t.prototype.onKey=function(e){if(!this.keyboardNavigationLocked&&!this.keyboardNavigationMode){var t=e.keyCode;-1!==this.keyboardNavigationKeys.indexOf(t)&&(this.isInputField()&&this.inputFieldKeys.indexOf(t)>-1||(this.keyboardNavigationMode=!0,this.element.classList.add(this.keyboardNavigationModeClass),this.trigger(teamspace.services.AccessibilityServiceEvents.EventType_KeyboardModeChange,teamspace.services.AccessibilityServiceEvents.Key_KeyboardModeEnabled)))}},t.prototype.isSimulatedClick=function(e){return this.platformDetectService.getBrowser()===this.constants.browser.ie?e&&0===e.pointerId:e&&0===e.detail},t.prototype.isInputField=function(){var e=document.activeElement;if(!e||!e.tagName||!e.classList)return!1;if("INPUT"===e.tagName)return!0;for(var t=0;t<this.inputClasses.length;t++)if(e.classList.contains(this.inputClasses[t]))return!0;return!1},Object.defineProperty(t.prototype,"focusEditorOnInit",{get:function(){return this._focusEditorOnInit},set:function(e){this._focusEditorOnInit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipFocusEditorDuringFre",{get:function(){return this._skipFocusEditorDuringFre},set:function(e){this._skipFocusEditorDuringFre=e},enumerable:!0,configurable:!0}),t.prototype.focusEditorOnInitAndReset=function(){var e=this.focusEditorOnInit;return this.focusEditorOnInit=!1,e},t.prototype.skipFocusEditorDuringFreAndReset=function(){var e=this.skipFocusEditorDuringFre;return this.skipFocusEditorDuringFre=!1,e},t}(SkypeX.Services.ObservableBase);t.AccessibilityServiceImplementation=p,angular.module("teamspace.accessibilityService",[]).service("accessibilityService",p)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.$document=e}return e.$inject=["$document"],e.prototype.update=function(e,t){void 0===t&&(t=!1);if(this.assertive||(this.assertive=this.$document.find("#aria-live-assertive")[0]),this.polite||(this.polite=this.$document.find("#aria-live-polite")[0]),this.polite&&this.assertive){var i=t?this.assertive:this.polite;i.innerText="",_.delay(function(){i.innerText=e},50)}},e}();t.AriaLiveService=n,angular.module("teamspace.ariaLiveService",[]).service("ariaLiveService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.uploadDispatcher=e}return e.$inject=["uploadDispatcher"],e.prototype.dispatch=function(e,t){this.uploadDispatcher.dispatch({actionType:e,payload:t})},e.prototype.uploadFile=function(e){this.dispatch(teamspace.services.actions.files.upload.UploadActionTypes.UPLOAD_FILE,e)},e.prototype.cancelUpload=function(e){this.dispatch(teamspace.services.actions.files.upload.UploadActionTypes.UPLOAD_CANCELLED,e)},e.prototype.getUploads=function(e){this.dispatch(teamspace.services.actions.files.upload.UploadActionTypes.UPLOAD_VIEW,e)},e.prototype.initializeStore=function(){this.dispatch(teamspace.services.actions.files.upload.UploadActionTypes.UPLOAD_STORE_INITIALIZE)},e.prototype.migrate=function(e){this.dispatch(teamspace.services.actions.files.upload.UploadActionTypes.MIGRATE,e)},e.prototype.updateRetention=function(e){this.dispatch(teamspace.services.actions.files.upload.UploadActionTypes.UPLOAD_RETENTION_CHANGE,e)},e.prototype.shareExistingFile=function(e){this.dispatch(teamspace.services.actions.files.upload.UploadActionTypes.SHARE_EXISTING_FILE,e)},e}();t.UploadActionsImpl=n,angular.module("teamspace.services.actions.files.uploadActions",["teamspace.services.dispatcher"]).service("uploadActions",n)},function(e,t,i){"use strict";var n=function(){function e(e){this.teamTemplatingDispatcher=e}return e.$inject=["teamTemplatingDispatcher"],e.prototype.cloneTeam=function(e){this.dispatch(teamspace.services.actions.teamTemplating.TeamTemplatingActionTypes.CLONE_TEAM,e)},e.prototype.verifyJob=function(e){this.dispatch(teamspace.services.actions.teamTemplating.TeamTemplatingActionTypes.VERIFY_JOB,e)},e.prototype.updateJob=function(e){this.dispatch(teamspace.services.actions.teamTemplating.TeamTemplatingActionTypes.UPDATE_JOB,e)},e.prototype.dispatch=function(e,t){this.teamTemplatingDispatcher.dispatch({actionType:e,payload:t})},e}();angular.module("teamspace.teamTemplatingActions",["teamspace.services.dispatcher"]).service("teamTemplatingActions",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(71),r=function(){function e(e){this.wizardDispatcher=e}return e.$inject=["wizardDispatcher"],e.prototype.dispatch=function(e,t){this.wizardDispatcher.dispatch({actionType:e,payload:t})},e.prototype.popStep=function(){this.dispatch(n.WizardActionTypes.POP_STEP)},e.prototype.showStep=function(e){this.dispatch(n.WizardActionTypes.SHOW_STEP,e)},e.prototype.updateWizard=function(e){this.dispatch(n.WizardActionTypes.UPDATE_WIZARD,e)},e.prototype.close=function(){this.dispatch(n.WizardActionTypes.CLOSE_WIZARD)},e}();angular.module("teamspace.wizard.actions",["teamspace.services.dispatcher"]).service("wizardActions",r)},function(e,t,i){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h){var d=this;this.constants=e,this.loggingService=t,this.$rootScope=i,this.$window=n,this.settingsService=r,this.eventingService=s,this.$pageVisibility=a,this.orchestrationService=o,this.$timeout=c,this.appStateService=l,this.desktopUtilityService=p,this.hwaServiceProvider=u,this.utilityService=h,this.isScenarioComplete=!1,this.hasSentAltCommunicationToDesktop=!1,this.stepStartMap={},this.allowedSteps={},this.orchestrationStageStarts={},this.orchestrationStageEnds={},this.commonEventData={alt_route:"",startReason:"",pageVisible:null,hwaNavigationContext:"",sessionDesktopId:"",isFRE:null,isFavorite:null},this.unregisterAppStateChangedEvent=_.noop,this.unregisterWebPageVisibleListener=_.noop,this.removedIpcRendererListener=!1,this.altScenarioStatus=this.constants.scenarioStepStatus.success,this.appLoadStartProperty="app-load-start-timestamp",this.authstrapDurationProperty="ts.redirect_authstrap_duration",this.resourcePrefixesToTrack=["0-angular-jquery.min","1-vendor.min","2-vendor.min","3.1-app.min","3.2-app.min","3.3-app.min","4-app.desktop.min"],this.appFailStates=[teamspace.services.ApplicationState.Disabled,teamspace.services.ApplicationState.Disconnected,teamspace.services.ApplicationState.Offline],this.CLEAR_ALT_STATE_TIMEOUT=18e5,this.allowedSteps=_.reduce(this.constants.scenarios.alt.markers,function(e,t,i){return e[t]=t,e},{}),this.unregisterOrchestrationCallbacks=this.orchestrationService.registerOrchestrationEventListener(this.constants.startUpOrchestrationPlans.default,{onlyCriticalStages:!0,stageExecutionCallback:function(e,t,i){switch(t){case teamspace.services.OrchestrationStageExecutionInfo.Start:d.orchestrationStageStarts[e]=window.performance.now();break;case teamspace.services.OrchestrationStageExecutionInfo.Stop:d.orchestrationStageEnds[e]=window.performance.now();break;case teamspace.services.OrchestrationStageExecutionInfo.Failure:d.failScenario(i)}}}),this.isDesktopElectronApp=r.valueAsBoolean(e.settings.names.isDesktopApp),this.isRunningScenarioTests=r.valueAsBoolean(e.settings.names.runningscenariotests),this.isDesktopHwaApp=!this.isDesktopElectronApp&&this.desktopUtilityService.isDesktopHwa(),this.isSurfaceHubHwaApp=this.desktopUtilityService.isSurfaceHub(),this.isHwaApp=this.isDesktopHwaApp||this.isSurfaceHubHwaApp,this.pendingWebMarkers=[],this.isDesktopElectronApp?(this.safeIpc=this.$window.electronSafeIpc,this.safeIpc&&(this.electronPageVisibleEventHandler=function(e,t){d.removedIpcRendererListener||t&&(d.commonEventData.pageVisible=!1,d.safeIpc.removeListener(d.constants.events.desktopApp.windowVisible,d.electronPageVisibleEventHandler),d.removedIpcRendererListener=!0)},this.safeIpc.on(this.constants.events.desktopApp.windowMinimize,this.electronPageVisibleEventHandler))):this.unregisterWebPageVisibleListener=this.$pageVisibility.$on("pageBlurred",function(){d.commonEventData.pageVisible=!1,d.unregisterWebPageVisibleListener()}),this.commonEventData.pageVisible=!!this.isDesktopElectronApp||this.appStateService.pageVisible,this.$timeout(function(){d.stopAltDesktopListener(),d.unregisterEventListeners(),d.clearState()},this.CLEAR_ALT_STATE_TIMEOUT,!1)}return e.$inject=["constants","loggingService","$rootScope","$window","settingsService","eventingService","$pageVisibility","orchestrationService","$timeout","appStateService","desktopUtilityService","hwaServiceProvider","utilityService"],e.prototype.startScenario=function(e){var t=this;if(!this.altScenario&&window.performance&&window.performance.timing){var i=this.$rootScope.$on(this.constants.events.ng.$stateChangeStart,function(){t.abandonScenario(),i()});if(this.isHwaApp&&this.eventingService.$once(this.$rootScope,this.constants.scenarios.alt.events.hwaAppSuspending,function(){t.abandonScenario(t.constants.scenarios.alt.events.hwaAppSuspending)}),this.commonEventData.alt_route=e,this.altScenario=this.loggingService.newScenario(this.constants.scenarios.alt.name,null,null,this.constants.timeInMiliseconds.tenMinutes),this.altScenario.eventData=this.commonEventData,this.isRunningScenarioTests&&this.altScenario&&this.altScenario.timestamps&&!this.altScenario.perfInfo&&(this.altScenario.perfInfo={displayData:"",startTime:this.altScenario.timestamps[0],lastStepTime:this.altScenario.timestamps[0],steps:[]}),this.isDesktopElectronApp)this.safeIpc.once(this.constants.scenarios.alt.events.altDesktopData,function(e,i,n){t.desktopElectronAltMarkers=i,n&&(t.commonEventData.startReason=n.startReason)}),this.sendMessageToDesktop();else if(this.isHwaApp){var n=this.hwaServiceProvider.getAppInfo();if(n&&n.altPerfScenario){var r=n.altPerfScenario,s=r.getMarkers();if(s){this.desktopHwaAltStepDeltas={};for(var a=s.first();a.hasCurrent;){var o=a.current;this.desktopHwaAltStepDeltas[o.stepName]=[o.stepDelta],a.moveNext()}this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.stop)&&this.abandonScenario()}else this.abandonScenario();r.stop()}}this.unregisterAppStateChangedEvent=this.eventingService.unsafeOn(this.constants.events.appState.changed,function(e,i){_.includes(t.appFailStates,i.newState)&&t.setCurrentScenarioStatus(t.getOverwriteStatus(i.newState))})}},e.prototype.getOverwriteStatus=function(e){var t;switch(e){case teamspace.services.ApplicationState.Disabled:t="disabled";break;case teamspace.services.ApplicationState.Disconnected:t="disconnected";break;case teamspace.services.ApplicationState.Offline:t="offline";break;default:t="success"}return t},e.prototype.stopScenario=function(e){if(this.isActiveScenario()){this.stepStartMap[this.constants.scenarios.alt.markers.syncConversations]&&this.stopMarker(this.constants.scenarios.alt.markers.syncConversations),this.isScenarioComplete=!0;var t=this.getWebDelta(),i=this.getDesktopElectronDelta(),r=this.getDesktopHwaDelta(),s=t;this.isDesktopElectronApp?s+=i:this.isHwaApp&&(s+=r),e&&(this.commonEventData.isFRE=!!e.isFRE,this.commonEventData.isFavorite=!!e.isFavorite);var a=n({},this.commonEventData,e||{},{delta:s});this.trackAllEvents(s),this.isDesktopElectronApp?(i&&this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.desktopAlt,i,s),this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.webAlt,t,s)):this.isHwaApp&&(r&&this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopHwaMarkers.hwaAlt,r,s),this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.webAlt,t,s)),this.altScenario.stop(a,null,this.getCurrentScenarioStatus()),this.clearState(),this.isRunningScenarioTests&&(this.utilityService.markPerfInfo(this.altScenario,"total",s),window.perfApplicationLaunchTime=this.altScenario.perfInfo),this.unregisterEventListeners(),window.performance.mark&&window.performance.measure&&(window.performance.mark(this.constants.scenarios.alt.name+"-stop"),window.performance.measure(this.constants.scenarios.alt.name,"navigationStart",this.constants.scenarios.alt.name+"-stop"))}},e.prototype.failScenario=function(e){this.isActiveScenario()&&(this.setCurrentScenarioStatus(this.constants.scenarioStepStatus.failure),this.stopFailedScenario(!0,e))},e.prototype.abandonScenario=function(e){this.isActiveScenario()&&(this.setCurrentScenarioStatus(this.constants.scenarioStepStatus.abandoned),this.stopFailedScenario(!1,e))},e.prototype.stopFailedScenario=function(e,t){if(this.isActiveScenario()){var i=this.getWebDelta(),r=this.getDesktopElectronDelta(),s=this.getDesktopHwaDelta(),a=i;this.isDesktopElectronApp?a+=r:this.isHwaApp&&(a+=s),this.trackAllEvents(a);var o=n({},this.commonEventData,{errorMessage:t||"",delta:a});e?this.altScenario.fail(o):this.altScenario.cancel(o),this.isScenarioComplete=!0,this.clearState(),this.unregisterEventListeners()}},e.prototype.startMarker=function(e){this.isActiveScenario()&&this.allowedSteps[e]&&!this.isActiveStep(e)&&(this.stepStartMap[e]=window.performance.now())},e.prototype.stopMarker=function(e,t){this.isActiveScenario()&&this.allowedSteps[e]&&this.isActiveStep(e)&&(this.pendingWebMarkers.push({stepName:e,stepDelta:window.performance.now()-this.stepStartMap[e]}),this.stepStartMap[e]=null)},e.prototype.isActiveScenario=function(){return this.altScenario&&!this.isScenarioComplete},e.prototype.isActiveStep=function(e){return!!this.stepStartMap[e]},e.prototype.markStepWithCommonEventData=function(e,t,i,r){this.altScenario.mark(e,n({},this.commonEventData,{stepDelta:parseInt(t.toString()),delta:i}),this.getCurrentScenarioStatus()),this.isRunningScenarioTests&&this.utilityService.markPerfInfo(this.altScenario,e,parseInt(t.toString()),r)},e.prototype.trackResourceDownload=function(e){var t,i=this,n=window.performance.timing;if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableResourceTimingAPI)&&(t=window[this.constants.scenarios.alt.resourceTimingCache]),(t=t||window.performance.getEntriesByType("resource"))&&t.length>0){var r,s=0,a=t.length>this.constants.scenarios.alt.maxResourcesToCheck?this.constants.scenarios.alt.maxResourcesToCheck:t.length;_.times(a,function(n){var a=t[n];"script"===a.initiatorType&&_.each(i.resourcePrefixesToTrack,function(t){if(a.name&&a.name.indexOf(t)>=0)return r=r?a.startTime<r?a.startTime:r:a.startTime,s=a.responseEnd>s?a.responseEnd:s,i.markStepWithCommonEventData(t,a.duration,e,{encodedBodySize:a.encodedBodySize,decodedBodySize:a.decodedBodySize,transferSize:a.transferSize}),!1})}),this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.downloadScripts,r?s-r:s,e);var o=s>0?n.navigationStart+s:window[this.appLoadStartProperty];this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.evalScripts,n.loadEventStart-o,e)}},e.prototype.trackDesktopElectronData=function(e){if(this.isDesktopElectronApp&&this.desktopElectronAltMarkers){var t=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.mainjsStart),i=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.appStartInit),n=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.mainWindowStart),r=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.desktopAuthStart),s=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.desktopAuthStop),a=this.desktopElectronAltMarkers[this.constants.scenarios.alt.desktopElectronMarkers.preloadStart],o=this.desktopElectronAltMarkers[this.constants.scenarios.alt.desktopElectronMarkers.preloadStop],c=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.desktopSsoWindowShown),l=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.desktopSsoWindowClosed);if(t&&i&&this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopElectronMarkers.mainjs,i-t,e),n&&i&&this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopElectronMarkers.appStart,n-i,e),r&&n&&this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopElectronMarkers.mainWindow,r-n,e),r&&s){var p=0;c&&l&&(p=l-c),this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopElectronMarkers.desktopAuth,s-r-p,e)}if(c&&l&&this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopElectronMarkers.desktopSsoWindow,l-c,e),a&&o){for(var u=void 0,h=0;h<a.length;h++){var d=a[h],g=o[h];u=g,d&&g&&this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopElectronMarkers.preload,g-d,e)}u&&u<performance.timing.navigationStart&&teamspace.services.UtilityServiceStatics.getSsoDisabledError(this.constants)&&this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopElectronMarkers.webAuth,performance.timing.navigationStart-u,e)}}},e.prototype.trackDesktopHwaData=function(e){if(this.isHwaApp&&this.desktopHwaAltStepDeltas){var t=this.isDesktopHwaApp?this.constants.scenarios.alt.desktopHwaMarkers.hwaWamAuthStart:this.constants.scenarios.alt.surfaceHubMarkers.surfaceHubNativeAuthStart,i=this.isDesktopHwaApp?this.constants.scenarios.alt.desktopHwaMarkers.hwaWamAuthStop:this.constants.scenarios.alt.surfaceHubMarkers.surfaceHubNativeAuthStop,n=this.isDesktopHwaApp?this.constants.scenarios.alt.desktopHwaMarkers.hwaNaviWebApp:this.constants.scenarios.alt.surfaceHubMarkers.surfaceHubNaviWebApp,r=this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationRegisterEventsStart)||0,s=this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationRegisterEventsStop)||0,a=this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationOrchestrateStart)||0,o=this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationOrchestrateStop)||0;this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationRegisterEventsStart,r,e),this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationRegisterEventsStop,s,e),this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationOrchestrateStart,a,e),this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationOrchestrateStop,o,e);var c=this.safeGetDesktopHwaMarkers(t),l=this.safeGetDesktopHwaMarkers(i),p=this.safeGetDesktopHwaMarkers(n),u=this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.hwaNaviWebAppViaWebView);c&&this.markStepWithCommonEventData(t,c,e),l&&this.markStepWithCommonEventData(i,l,e),p?(this.commonEventData.hwaNavigationContext=this.constants.scenarios.alt.navigatationContext.altHwaDirect,this.markStepWithCommonEventData(n,p,e)):u&&(this.commonEventData.hwaNavigationContext=this.constants.scenarios.alt.navigatationContext.altHwaWebView,this.markStepWithCommonEventData(this.constants.scenarios.alt.desktopHwaMarkers.hwaNaviWebAppViaWebView,u,e))}},e.prototype.trackAuthstrapEvent=function(e){var t=sessionStorage.getItem(this.authstrapDurationProperty);t&&this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.authStrap,parseInt(t),e)},e.prototype.trackStartupEvent=function(e){window[this.constants.scenarios.alt.timings.serviceAuthDuration]&&this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.serviceAuth,window[this.constants.scenarios.alt.timings.serviceAuthDuration],e),window[this.constants.scenarios.alt.timings.skypeAuthDuration]&&this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.skypeAuth,window[this.constants.scenarios.alt.timings.skypeAuthDuration],e),window[this.constants.scenarios.alt.timings.endpointCreateDuration]&&this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.endpointCreate,window[this.constants.scenarios.alt.timings.endpointCreateDuration],e),window[this.constants.scenarios.alt.timings.startupCleanDuration]&&this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.startupCleanCall,window[this.constants.scenarios.alt.timings.startupCleanDuration],e),window[this.constants.scenarios.alt.timings.startupDeltaDuration]&&this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.startupDeltaCall,window[this.constants.scenarios.alt.timings.startupDeltaDuration],e),window[this.constants.scenarios.alt.timings.startupProcessingDuration]&&this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.startupProcessing,window[this.constants.scenarios.alt.timings.startupProcessingDuration],e)},e.prototype.trackWebMarkers=function(e){var t=this;_.each(this.pendingWebMarkers,function(i){t.markStepWithCommonEventData(i.stepName,i.stepDelta,e)})},e.prototype.trackDomEvents=function(e){var t=window.performance.timing;t.loadEventEnd<=0||this.markStepWithCommonEventData(this.constants.scenarios.alt.markers.windowOnLoad,t.loadEventEnd-t.loadEventStart,e)},e.prototype.trackOrchestrationEvents=function(e){var t=this;_.each(this.orchestrationStageStarts,function(i,n){t.orchestrationStageEnds[n]&&t.markStepWithCommonEventData(t.constants.scenarios.alt.markers.orchestrationStage+n,t.orchestrationStageEnds[n]-t.orchestrationStageStarts[n],e)})},e.prototype.clearState=function(){this.pendingWebMarkers=[],this.desktopElectronAltMarkers={},this.desktopHwaAltStepDeltas={},this.stepStartMap={},this.allowedSteps={},sessionStorage.removeItem(this.authstrapDurationProperty),window[this.constants.scenarios.alt.timings.endpointCreateDuration]=void 0,window[this.constants.scenarios.alt.timings.serviceAuthDuration]=void 0,window[this.constants.scenarios.alt.timings.skypeAuthDuration]=void 0,window[this.constants.scenarios.alt.timings.startupCleanDuration]=void 0,window[this.constants.scenarios.alt.timings.startupDeltaDuration]=void 0,window[this.constants.scenarios.alt.timings.startupProcessingDuration]=void 0,this.settingsService.valueAsBoolean(this.constants.settings.names.persistResourceTimingCache)||(window[this.constants.scenarios.alt.resourceTimingCache]=void 0),this.orchestrationStageStarts={},this.orchestrationStageEnds={}},e.prototype.getWebDelta=function(){return Date.now()-performance.timing.navigationStart},e.prototype.getDesktopElectronDelta=function(){if(!this.isDesktopElectronApp)return 0;var e=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.desktopAuthStop),t=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.desktopSsoWindowShown),i=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.desktopSsoWindowClosed),n=this.safeGetDesktopElectronMarkers(this.constants.scenarios.alt.desktopElectronMarkers.mainjsStart);if(e&&n){var r=0;return t&&i&&(r=i-t),e-n-r}return 0},e.prototype.getDesktopHwaDelta=function(){if(!this.isHwaApp)return 0;var e=this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationRegisterEventsStart)||0,t=this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationRegisterEventsStop)||0,i=this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationOrchestrateStart)||0,n=this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.hwaOrchestrationOrchestrateStop)||0,r=this.safeGetDesktopHwaMarkers(this.isDesktopHwaApp?this.constants.scenarios.alt.desktopHwaMarkers.hwaWamAuthStart:this.constants.scenarios.alt.surfaceHubMarkers.surfaceHubNativeAuthStart),s=this.isDesktopHwaApp?this.constants.scenarios.alt.desktopHwaMarkers.hwaNaviWebApp:this.constants.scenarios.alt.surfaceHubMarkers.surfaceHubNaviWebApp,a=this.safeGetDesktopHwaMarkers(s)||this.safeGetDesktopHwaMarkers(this.constants.scenarios.alt.desktopHwaMarkers.hwaNaviWebAppViaWebView);return r&&a?e+t+i+n+r+a:0},e.prototype.getCurrentScenarioStatus=function(){return this.hasIncompleteDesktopElectronMarkerData()||this.hasIncompleteDesktopHwaMarkerData()?this.constants.scenarioStepStatus.incomplete:this.commonEventData.pageVisible?this.altScenarioStatus:this.isDesktopElectronApp||this.isDesktopHwaApp?this.constants.scenarioStepStatus.appMinimized:this.constants.scenarioStepStatus.tabSwitch},e.prototype.setCurrentScenarioStatus=function(e){this.altScenarioStatus=e},e.prototype.trackAllEvents=function(e){this.trackDesktopElectronData(e),this.trackDesktopHwaData(e),this.trackAuthstrapEvent(e),this.trackResourceDownload(e),this.trackDomEvents(e),this.trackOrchestrationEvents(e),this.trackStartupEvent(e),this.trackWebMarkers(e)},e.prototype.hasIncompleteDesktopElectronMarkerData=function(){return this.isDesktopElectronApp&&(!this.desktopElectronAltMarkers||0===Object.keys(this.desktopElectronAltMarkers).length)},e.prototype.hasIncompleteDesktopHwaMarkerData=function(){return this.isHwaApp&&(!this.desktopHwaAltStepDeltas||0===Object.keys(this.desktopHwaAltStepDeltas).length)},e.prototype.safeGetDesktopElectronMarkers=function(e){return this.desktopElectronAltMarkers&&this.desktopElectronAltMarkers[e]&&this.desktopElectronAltMarkers[e][0]},e.prototype.safeGetDesktopHwaMarkers=function(e){return this.desktopHwaAltStepDeltas&&this.desktopHwaAltStepDeltas[e]&&this.desktopHwaAltStepDeltas[e][0]},e.prototype.stopAltDesktopListener=function(){this.sendMessageToDesktop()},e.prototype.sendMessageToDesktop=function(){this.isDesktopElectronApp&&!this.hasSentAltCommunicationToDesktop&&this.safeIpc&&this.safeIpc.send&&(this.safeIpc.send(this.constants.scenarios.alt.events.altWebStart),this.hasSentAltCommunicationToDesktop=!0)},e.prototype.unregisterEventListeners=function(){this.unregisterAppStateChangedEvent(),this.unregisterWebPageVisibleListener(),this.safeIpc&&this.safeIpc.removeListener&&this.safeIpc.removeListener(this.constants.events.desktopApp.windowVisible,this.electronPageVisibleEventHandler),this.unregisterOrchestrationCallbacks()},e}();t.AltScenarioService=r,angular.module("teamspace.altScenarioService",["teamspace.constants","teamspace.loggingService","angular-page-visibility","teamspace.desktopUtilityService","teamspace.hwaServiceProvider","teamspace.utilityService"]).service("altScenarioService",r)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c){this.settingsService=e,this.constants=t,this.$document=i,this.loggingService=n,this.utilityService=r,this.loggingContextService=s,this.analyticsStateService=a,this.$state=o,this.$q=c,this.logger=n.newLogger("Analytics service"),this.enabled=!e.valueAsBoolean(t.settings.names.analyticsDisabled)}return e.$inject=["settingsService","constants","$document","loggingService","utilityService","loggingContextService","analyticsStateService","$state","$q"],e.prototype.eventTrack=function(e,t,i){},e.prototype.onPanelView=function(e,t){this.enabled&&e.$emit(this.constants.telemetry.analytics.panelView,t)},e.prototype.sendPanelView=function(e){this.enabled&&(this.validatePanelViewData(e),this.sendEvent(e,this.constants.telemetry.analytics.panelView))},e.prototype.onPanelAction=function(e,t){this.enabled&&e.$emit(this.constants.telemetry.analytics.panelAction,t)},e.prototype.sendPanelAction=function(e){this.enabled&&(this.validatePanelActionData(e),this.sendEvent(e,this.constants.telemetry.analytics.panelAction))},e.prototype.getAnalyticsPanelActionEventData=function(e,t){var i=this;try{var n={launchMethod:teamspace.components.LaunchMethod.nav};this.analyticsStateService.setLaunchMethodState(n);var r=this.analyticsStateService.getPanelViewState(t);r&&r.panel||(this.logger.warn("Panel data not present to populate panel action, falling back to main"),r=this.analyticsStateService.getPanelViewState(teamspace.PanelRegion.main));var s;r&&r.panel?s={type:r.panel.type,uri:this.$state.current.name,uriParams:this.loggingService.hashUriParamsPII(this.$state.params),viewId:r.panel.viewId}:this.logger.error("Panel data not present to populate panel action.");var a=angular.extend(e.action,{gesture:e.action.gesture}),o={type:e.module.type?e.module.type.toString():"undefined",name:e.module.name,state:e.module.state,summary:e.module.summary};return i.$q.when(e.asyncDataBag).then(function(t){return{panel:s,action:a,module:o,dataBag:t?angular.extend({},e.dataBag,t):e.dataBag,app:e&&e.app?e.app:r?r.app:void 0,bot:e&&e.bot?e.bot:r?r.bot:void 0,composeExtension:e?e.composeExtension:void 0,tab:e&&e.tab?e.tab:r?r.tab:void 0,team:e&&e.team?e.team:void 0}})}catch(e){this.logger.error("Error in attempting to track event. Error: {0}",e)}},e.prototype.validatePanelViewData=function(e){var t=[];e?e.panel?(e.panel.launchMethod||t.push("panel.launchMethod"),e.panel.viewId||t.push("panel.viewId"),e.panel.type||t.push("panel.type"),e.panel.region||t.push("panel.region"),e.panel.uri||t.push("panel.uri"),e.panel.uriParams||t.push("panel.uriParams")):t.push("viewdata.panel"):t.push("panel view event data"),t.length>0&&this.loggingService.event("analytics_validation_failed",{failedProperties:t.join(",")})},e.prototype.validatePanelActionData=function(e){var t=[];e?(e.action?(e.action.outcome=teamspace.shared.AttributeHelper.tryGetEnumString(e.action.outcome,teamspace.components.PanelActionOutcome),e.action.gesture=teamspace.shared.AttributeHelper.tryGetEnumString(e.action.gesture,teamspace.components.PanelActionGesture),e.action.gesture||t.push("action.gesture")):t.push("data.action"),e.module?(e.module.name||t.push("module.name"),e.module.type||t.push("module.type")):t.push("data.module"),e.panel?(e.panel.type||t.push("panel.type"),e.panel.uri||t.push("panel.uri"),e.panel.uriParams||t.push("panel.uriParams"),e.panel.viewId||t.push("panel.viewId")):t.push("data.panel")):t.push("panel action event data"),t.length>0&&this.loggingService.event("analytics_validation_failed",{failedProperties:t.join(",")})},e.prototype.sendEvent=function(e,t){var i=this;try{var n=this.cleanupAnalyticsData(e);this.settingsService.valueAsBoolean(this.constants.settings.names.enableBIPrettyPrint)&&(console.info("Analytics: EventType:"+t),n["Panel.Region"]&&console.info("Analytics: Region:"+n["Panel.Region"]),console.info("Analytics: Type:"+n["Panel.Type"]),console.info("Analytics: Payload",n),console.info("Analytics: \n")),n.pageWidth=this.$document.width(),n.pageHeight=this.$document.height(),this.loggingContextService.getContext().then(function(e){if(e){var t=i.utilityService.flattenObject(e,".",!0);t&&(n=_.defaults(n,t))}}).finally(function(){i.loggingService.customEvent(teamspace.services.TelemetryKind.UserBI,t,n)})}catch(e){this.logger.error("Error occurred in attempting to send event. Error: {0}",e)}},e.prototype.cleanupAnalyticsData=function(e){var t=e.dataBag;if(t){for(var i in t)t.hasOwnProperty(i)&&(angular.isDefined(e[i])||(e["dataBag."+i]=t[i]));delete e.dataBag}var n=this.utilityService.flattenObject(e,".",!0)||{};for(var r in n)null!==n[r]&&void 0!==n[r]||delete n[r];return n},e}();t.AnalyticsService=n,angular.module("teamspace.analyticsService",["teamspace.analyticsStateService"]).service("analyticsService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i){this.constants=t,this.$location=i,this.panelStates={},this.launchMethodState={launchMethod:teamspace.components.LaunchMethod.direct},this.logger=e.newLogger("AnalyticsPanelService")}return e.$inject=["loggingService","constants","$location"],e.prototype.setPanelViewState=function(e,t){t.panel?this.panelStates[e]=t:this.logger.error("Panel data not populated in analytics panel view data. This is required.")},e.prototype.getPanelViewState=function(e){return this.panelStates[e]},e.prototype.getPreviousRoute=function(){return this.previousRouteState},e.prototype.setPreviousRoute=function(e){this.previousRouteState=angular.copy(e)},e.prototype.getLaunchMethodState=function(){return this.launchMethodState},e.prototype.setLaunchMethodState=function(e){this.launchMethodState=e},e.prototype.setLaunchMethodFromCurrentState=function(){var e=this.$location.search(),t=e[this.constants.telemetry.analytics.queryParameter.lm];if(t)if(null!=teamspace.components.LaunchMethod[t]){var i={launchMethod:teamspace.components.LaunchMethod[t],launchSource:e[this.constants.telemetry.analytics.queryParameter.lmsrc],emailTrackingId:e[this.constants.telemetry.analytics.queryParameter.emltid],emailType:e[this.constants.telemetry.analytics.queryParameter.emltype],linkType:e[this.constants.telemetry.analytics.queryParameter.linktype],linkPos:e[this.constants.telemetry.analytics.queryParameter.linkpos],campaignId:e[this.constants.telemetry.analytics.queryParameter.cmpid]};this.setLaunchMethodState(i)}else this.logger.warn("An attempt was made to set launch method state to unsupported state")},e}();t.AnalyticsStateService=n,angular.module("teamspace.analyticsStateService",[]).service("analyticsStateService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s){this.constants=e,this.loggingService=t,this.desktopUtilityService=i,this.hwaServiceProvider=n,this.hwaBannerService=r,this.$window=s,this.logger=null,this.logger=this.loggingService.newLogger("AppInfoService")}return e.$inject=["constants","loggingService","desktopUtilityService","hwaServiceProvider","hwaBannerService","$window"],e.prototype.getVersionInfo=function(){this.logger.log("Received call to display version info."),this.desktopUtilityService.isElectron()?this.getVersionInfoElectron():this.desktopUtilityService.isDesktopHwa()&&this.getVersionInfoHwa()},e.prototype.getVersionInfoElectron=function(){null!=this.$window.electronSafeIpc&&this.$window.electronSafeIpc.send(this.constants.events.desktopUpdateNotification.getAboutInfo)},e.prototype.getVersionInfoHwa=function(){var e=this.hwaServiceProvider.getAppInfo();if(e){var t=e.appVersion;this.hwaBannerService.showBannerForVersionInfo(t)}else this.logger.error("Could not get version info: AppInfo could not be found.")},e}();t.AppInfoService=n,angular.module("teamspace.appInfoService",["teamspace.constants","teamspace.loggingService","teamspace.desktopUtilityService","teamspace.hwaServiceProvider","teamspace.hwaBannerService"]).service("appInfoService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.AppBarClick=0]="AppBarClick",e[e.PowerBarClick=1]="PowerBarClick",e[e.PowerBarTyping=2]="PowerBarTyping",e[e.PowerBarNewChatClick=3]="PowerBarNewChatClick",e[e.ChannelListScroll=4]="ChannelListScroll",e[e.ComposeMessageTyping=5]="ComposeMessageTyping",e[e.ChatListScroll=6]="ChatListScroll",e[e.MessageListScroll=7]="MessageListScroll"}(n||(n={}));var r=function(){function e(e,t,i,n,r){this.$window=e,this.$timeout=t,this.constants=i,this.settingsService=n,this.loggingService=r,this.maxAllowedRafRecordCount=1e3,this.rafRecords=new Map,this.userActions=new Map,this.validActions=new Map,this.strategies=[{name:"TwoRafStrategy",lowestAllowedRafs:2,allowStopTimeOverwrite:!1},{name:"OneRafStrategy",lowestAllowedRafs:1,allowStopTimeOverwrite:!1},{name:"TwoRafAndLimitedStopTimeStrategy",lowestAllowedRafs:2,allowStopTimeOverwrite:!0},{name:"OneRafAndLimitedStopStrategy",lowestAllowedRafs:1,allowStopTimeOverwrite:!0}],this.initSettings(),this.registerValidActions(),this.clearTelemetry()}return e.$inject=["$window","$timeout","constants","settingsService","loggingService"],e.prototype.registerValidActions=function(){this.validActions.set(this.formatActionKey(this.constants.events.appResponsiveness.source.appbar,this.constants.events.jQuery.click),n.AppBarClick),this.validActions.set(this.formatActionKey(this.constants.events.appResponsiveness.source.powerbar,this.constants.events.jQuery.click),n.PowerBarClick),this.validActions.set(this.formatActionKey(this.constants.events.appResponsiveness.source.powerbar,this.constants.events.jQuery.keyup),n.PowerBarTyping),this.validActions.set(this.formatActionKey(this.constants.events.appResponsiveness.source.powerbarNewChat,this.constants.events.jQuery.click),n.PowerBarNewChatClick),this.validActions.set(this.formatActionKey(this.constants.events.appResponsiveness.source.channelList,this.constants.events.jQuery.scroll),n.ChannelListScroll),this.validActions.set(this.formatActionKey(this.constants.events.appResponsiveness.source.composeMessage,this.constants.events.jQuery.keyup),n.ComposeMessageTyping),this.validActions.set(this.formatActionKey(this.constants.events.appResponsiveness.source.chatList,this.constants.events.jQuery.scroll),n.ChatListScroll),this.validActions.set(this.formatActionKey(this.constants.events.appResponsiveness.source.messageList,this.constants.events.jQuery.scroll),n.MessageListScroll)},e.prototype.registerRafCallback=function(){var e=this;this.rafCallbackId||(this.measurementStartTime=window.performance.now(),this.rafCallbackId=this.$window.requestAnimationFrame(function(){return e.measureRaf()}))},e.prototype.unregisterRafCallback=function(){this.rafCallbackId&&(this.$window.cancelAnimationFrame(this.rafCallbackId),this.rafCallbackId=null,this.rafRecords.clear())},e.prototype.clearTelemetry=function(){var e=this;this.userActions.clear(),this.clearTelemetryTimeout&&this.$timeout.cancel(this.clearTelemetryTimeout),this.clearTelemetryTimeout=this.$timeout(function(){e.clearTelemetry()},this.constants.timeInMiliseconds.tenMinutes,!1)},e.prototype.getTelemetry=function(){var e=this,t={};this.userActions.forEach(function(i,r){if(void 0!==n[r]){var s={};i.scores.forEach(function(t,i){s[i]=e.getAri(t)}),t[n[r]]=s}});var i=null;if(this.userActions.size>0)try{i=JSON.stringify(t)}catch(e){this.loggingService.error("[AppResponsivenessService]: unexpected error parsing log object. Likely because of circular reference.")}return i},e.prototype.getAri=function(e){return e&&0!==e.totalIntervalCount?Math.round(e.passIntervalCount/e.totalIntervalCount*1e3)/1e3:0},e.prototype.trackEvent=function(e,t,i){var n=this.getUserActionType(e,t);void 0!==n&&this.measureResponsiveness(n,i.timeStamp)},e.prototype.initSettings=function(){var e=this.settingsService.valueFor("appResponsivenessConstants");this.blinkInterval=e&&e.blinkInterval?e.blinkInterval:100,this.indexTimeInterval=e&&e.indexTimeInterval?e.indexTimeInterval:1e3},e.prototype.getUserActionType=function(e,t){return this.validActions.get(this.formatActionKey(t,e))},e.prototype.formatActionKey=function(e,t){if(e&&t)return e+"_"+t},e.prototype.measureResponsiveness=function(e,t){var i=this;this.stopPreviousActionIfNeeded(),this.registerRafCallback();var n=this.userActions.get(e);void 0===n&&(n={scores:new Map,startTime:0,type:e},this.userActions.set(e,n)),n.startTime=t?this.getTimeSlot(t):this.getCurrentTimeSlot(),this.previousUserActionType=e,this.currentUserActionTimeout=this.$timeout(function(){var e=n.startTime+i.indexTimeInterval;i.finalizeMeasurement(n,e),i.currentUserActionTimeout=null},this.indexTimeInterval,!1)},e.prototype.stopPreviousActionIfNeeded=function(){if(this.currentUserActionTimeout){var e=this.userActions.get(this.previousUserActionType);void 0!==e&&(this.$timeout.cancel(this.currentUserActionTimeout),this.currentUserActionTimeout=null,this.finalizeMeasurement(e))}},e.prototype.finalizeMeasurement=function(e,t){var i=this;this.strategies.forEach(function(n){var r=t&&n.allowStopTimeOverwrite?t:i.getCurrentTimeSlot(),s=i.getResponsivenessScore(e.startTime,r,n),a=e.scores.get(n.name);a?(a.passIntervalCount+=s.passIntervalCount,a.totalIntervalCount+=s.totalIntervalCount):e.scores.set(n.name,{totalIntervalCount:s.totalIntervalCount,passIntervalCount:s.passIntervalCount})}),this.unregisterRafCallback(),this.loggingService.debug("measureResponsiveness - finalizeMeasurement: {0}",JSON.stringify(e))},e.prototype.measureRaf=function(){var e=this,t=this.getCurrentTimeSlot(),i=this.rafRecords.get(t);void 0===i?i=1:i++,this.rafRecords.size>this.maxAllowedRafRecordCount&&(this.stopPreviousActionIfNeeded(),this.rafRecords.clear()),this.rafRecords.set(t,i),this.rafCallbackId=this.$window.requestAnimationFrame(function(){return e.measureRaf()})},e.prototype.getCurrentTimeSlot=function(){var e=window.performance.now();return this.getTimeSlot(e)},e.prototype.getTimeSlot=function(e){var t=e-this.measurementStartTime;return t<0&&(t=Math.abs(t)>=this.blinkInterval?-1*this.blinkInterval:Math.abs(t)),Math.floor(t/this.blinkInterval)*this.blinkInterval},e.prototype.getResponsivenessScore=function(e,t,i){for(var n=0,r=0;e<t;){var s=this.rafRecords.get(e);r+=void 0!==s&&s>=i.lowestAllowedRafs?1:0,n++,e+=this.blinkInterval}return{passIntervalCount:r,totalIntervalCount:n}},e}();t.AppResponsivenessService=r,angular.module("teamspace.appResponsivenessService",["teamspace.constants","teamspace.settingsService","teamspace.loggingService"]).service("appResponsivenessService",r)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(171),i(172)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.appConfig=t,this.authInfo={isMsa:!1,isExternallyAuthenticated:!1,userRole:teamspace.services.UserRole.member},this.className="ClientAuthenticationServiceProvider.",this.anonymousPrefix="A:",this.anonymousStatusMismatchDesktopAndWeb=!1,this.isAnon=!1;var i=window;if(this.authEventData={},this.ssoEnabledByConfig=i.enableSso,this.isSurfaceHubOs=this.isRunningInSurfaceHubUniversalAppContainer(),this.ssoEnabledByConfig)if(i.enableParseDesktopToken){var n=teamspace.services.UtilityServiceStatics.getCookie(e.desktopApp.desktopTsAuthCookie);this.authenticatedUser=this.getAuthenticatedUser(n,"Electron")}else this.authenticatedUser=this.getDesktopUserProfile(e.desktopApp.desktopUserProfile);if(this.ssoError=teamspace.services.UtilityServiceStatics.getSsoDisabledError(e),this.ssoEnabled=this.getSsoEnabledState(this.authenticatedUser),this.authEventData.ssoError=this.ssoError,this.authEventData.ssoEnabledByConfig=!!this.ssoEnabledByConfig,this.authEventData.ssoUserDefined=!!this.authenticatedUser,this.clientType=this.getClientType(),this.clientType===teamspace.services.ClientType.desktopHwa&&"undefined"!=typeof Microsoft&&Microsoft.Teams&&Microsoft.Teams.Hwa.Common&&Microsoft.Teams.Hwa.Common.ShellServiceProvider&&Microsoft.Teams.Hwa.Common.Constants.Components.appSettings){var r=Microsoft.Teams.Hwa.Common.ShellServiceProvider.instance.resolve(Microsoft.Teams.Hwa.Common.Constants.Components.appSettings);r&&r.getSetting("hwaTestWebAuth")&&(this.clientType=teamspace.services.ClientType.web)}switch(this.clientType){case teamspace.services.ClientType.electron:if(this.ssoEnabled)this.authConstants=t.authConstants.client.sso;else{this.authConstants=t.authConstants.client.adal;var s=localStorage.getItem(e.authentication.adalIdTokenLocation);this.authenticatedUser=this.getAuthenticatedUser(s,"Adal"),this.authEventData.adalUserDefined=!!this.authenticatedUser}break;case teamspace.services.ClientType.desktopHwa:this.authConstants=t.authConstants.client.hwa;var a=teamspace.services.UtilityServiceStatics.getCookie(t.authConstants.teamsSSOAuthCookieName);this.authenticatedUser=this.getAuthenticatedUser(a,"Hwa");break;case teamspace.services.ClientType.surfaceHub1:default:this.authConstants=t.authConstants.client.adal;var o=localStorage.getItem(e.authentication.adalIdTokenLocation);this.authenticatedUser=this.getAuthenticatedUser(o,"Adal"),this.authEventData.adalUserDefined=!!this.authenticatedUser}this.electronSafeIpc=i.electronSafeIpc,this.meetupJoinLocationKey=e.storageNames.meetupJoinLocation,this.isAnon=this.isAnonymousUser(e,this.authenticatedUser),this.userOid=this.getUserOid(e,this.isAnon,this.authenticatedUser)}return e.$inject=["constants","appConfig"],e.prototype.getConfiguredUserOid=function(){return this.userOid},e.prototype.config=function(e,t,i){if(this.ssoEnabled)this.authEventData.provider="SSO";else if(this.isAnon)this.authEventData.provider="ANONYMOUS";else if(this.clientType==teamspace.services.ClientType.desktopHwa)this.authEventData.provider="WAM";else if(this.isSurfaceHubOs)this.authEventData.provider="SURFACEHUBNATIVE";else{this.authEventData.provider="ADAL";var n=t+this.appConfig.authConstants.redirectRoute;e.init({instance:this.appConfig.authConstants.instance,clientId:this.authConstants.id,redirectUri:n,postLogoutRedirectUri:n,endpoints:this.appConfig.authConstants.resources,extraQueryParameter:this.appConfig.authConstants.extraQueryParameter,cacheLocation:this.appConfig.authConstants.cacheLocation,globalResource:this.appConfig.authConstants.removeAuthGlobalResource?void 0:this.appConfig.authConstants.globalResource,expireOffsetSeconds:this.authConstants.expireOffsetSeconds,isOffline:this.isOffline})}i.setEventData(this.authEventData)},e.prototype.replaceUrl=function(e){window.location.replace(e)},e.prototype.isAnonymousUser=function(e,t){var i=!1,n=window.sessionStorage?window.sessionStorage.getItem(this.meetupJoinLocationKey):"";return!t||t&&!t.profile?(teamspace.services.UtilityServiceStatics.isMeetupJoinUrl(window.location.href)?i=!0:teamspace.services.UtilityServiceStatics.isMeetupJoinUrl(n)&&(this.replaceUrl(n),console.log("not a valid anonymous url, using previous anonymous url: "+n),i=!0),i?(this.authInfo.userRole=teamspace.services.UserRole.anonymous,window.sessionStorage.setItem(this.meetupJoinLocationKey,window.location.href)):this.checkSsoStatusForAnonymous(e)):t&&(teamspace.services.UtilityServiceStatics.isMeetupJoinUrl(n,!1)&&(this.replaceUrl(n),console.log("Login as regular user and redirect to : "+n)),window.setTimeout(this.removeMeetupJoinLocation(),5e3)),i},e.prototype.getUserOid=function(e,t,i){var n="";return!t&&i&&i.profile&&(angular.isDefined(i.profile.altsecid)&&0===i.profile.altsecid.indexOf("1:")&&(n=e.authentication.msaDefaultOid),i.profile.oid&&(n=i.profile.oid)),n},e.prototype.resolveUserRole=function(e,t,i){var n=i.valueAsBoolean(e.settings.names.enableUserRoleFromTokenClaim);!this.isAnon&&t&&t.profile&&(n&&(this.authInfo.userRole=1===t.profile.acct?teamspace.services.UserRole.guest:teamspace.services.UserRole.member),angular.isDefined(t.profile.altsecid)&&0===t.profile.altsecid.indexOf("1:")?(n||(this.authInfo.userRole=teamspace.services.UserRole.guest),this.authInfo.isExternallyAuthenticated=!0,this.authInfo.isMsa=!0):angular.isDefined(t.profile.iss)&&angular.isDefined(t.profile.idp)&&t.profile.iss!==t.profile.idp&&(n||(this.authInfo.userRole=teamspace.services.UserRole.guest),this.authInfo.isExternallyAuthenticated=!0))},e.prototype.removeMeetupJoinLocation=function(){window.sessionStorage&&(window.sessionStorage.removeItem(this.meetupJoinLocationKey),console.log("Cleaned the join location"))},e.prototype.checkSsoStatusForAnonymous=function(e){var t=teamspace.services.UtilityServiceStatics.getCookie(e.desktopApp.ssoStatusCookie);if(t&&t.toUpperCase().startsWith(this.anonymousPrefix)&&this.electronSafeIpc){this.anonymousStatusMismatchDesktopAndWeb=!0;var i=window.sessionStorage.getItem(this.meetupJoinLocationKey);this.electronSafeIpc.send(e.events.desktopApp.sso.loginPrompt,{correlationId:"",silent:!1,hardRefresh:!1,tenantId:teamspace.services.UtilityServiceStatics.parseTenantIdFromAnonymousUrl(i)});var n={name:"not_anonymous_user_need_sign_in"};this.electronSafeIpc.send(e.events.desktopApp.telemetryEvent,n)}},e.prototype.isOffline=function(e){return!e.get("appStateService").isOnline},e.prototype.$get=function(t,i,n,r){var s=i.newLogger();this.logAuthState(i,s,n,this.authenticatedUser),this.resolveUserRole(n,this.authenticatedUser,r);var a={authConstants:this.authConstants,logger:s,authInfo:this.authInfo};if(this.authInfo.userRole===teamspace.services.UserRole.anonymous)return a[e.userOidString]=this.getConfiguredUserOid(),t.instantiate(teamspace.services.authentication.AnonymousAuthenticationProviderImplementation,a);if(this.ssoEnabled)return a[e.currentUserString]=this.authenticatedUser,t.instantiate(teamspace.services.authentication.ElectronAuthenticationProviderImplementation,a);switch(this.clientType){case teamspace.services.ClientType.desktopHwa:return a[e.currentUserString]=this.authenticatedUser,t.instantiate(teamspace.services.authentication.HwaProviderImplementation,a);case teamspace.services.ClientType.surfaceHub1:return a[e.currentUserString]=this.authenticatedUser,t.instantiate(teamspace.services.authentication.SurfaceHubNativeAuthenticationProviderImplementation,a)}return t.instantiate(teamspace.services.authentication.AdalAuthenticationProviderImplementation,a)},e.prototype.$get.$inject=["$injector","authenticationLoggingService","constants","settingsService"],e.prototype.getSsoEnabledState=function(e){return this.ssoEnabledByConfig&&!this.ssoError&&angular.isDefined(e)},e.prototype.logAuthState=function(e,t,i,n){var r=this.className+"logAuthState",s=angular.isDefined(n);if(e.newScenario(i.scenarios.auth.providerUsed).stop(),this.ssoError)this.ssoError.startsWith(i.ssoFailedPrefix.error)?(e.authErrorEvent(r,"Sso error found in local storage will fallback to adal Reason:{0}",this.ssoError),e.newScenario(i.scenarios.auth.ssoError).stop()):(t.warn("Sso disabled found in local storage will fallback to adal Reason:{0}",this.ssoError),e.newScenario(i.scenarios.auth.ssoDisabled).stop()),s||e.authErrorEvent(r,"Undefined or invalid ADAL user profile found in local storage. Unable to fallback.");else if(this.ssoEnabledByConfig&&!s)e.authErrorEvent(r,"Undefined or invalid user profile found. This should have been injected into cookie TSAUTHCOOKIE from electron shell for sso. Will fall back to adal");else if(this.clientType===teamspace.services.ClientType.surfaceHub1)t.info("App is running in universal container for surface hub OS");else{var a=this.getAnonymousData();this.authInfo.userRole===teamspace.services.UserRole.anonymous?(e.event("auth_join_as_anonymous_user",a),t.info("User join as Anonymous User")):this.anonymousStatusMismatchDesktopAndWeb?(e.event("anonymous_mismatch_between_desktop_and_webclient",a),t.info("Requires user sign in from desktop again")):t.info("Sso auth state is good. No errors found, user profile exists")}},e.prototype.getAnonymousData=function(){var e=window.sessionStorage.getItem(this.meetupJoinLocationKey);return{anonymous_tid:teamspace.services.UtilityServiceStatics.parseTenantIdFromAnonymousUrl(e)}},e.prototype.getDesktopUserProfile=function(e){var t;try{var i=teamspace.services.UtilityServiceStatics.getCookie(e);if(angular.isDefined(i)&&null!==i&&i.trim().length>0){var n=JSON.parse(i);null===n?this.authEventData.error='Error parsing Electron desktop user profile, the cookie was found to be "null"':t=n}}catch(e){this.authEventData.error="Exception caught, error parsing Electron desktop user profile or it was not present"}return t},e.prototype.getAuthenticatedUser=function(e,t){var i;if(angular.isDefined(e)&&null!==e&&e.trim().length>0)try{var n=teamspace.services.UtilityServiceStatics.parseJwt(e);if(n){var r=n.JWSPayload,s=teamspace.services.UtilityServiceStatics.base64DecodeStringUrlSafe(r);if(s){var a=JSON.parse(s);a&&(i={profile:a,isAuthenticated:!0,userName:a.upn})}else this.authEventData.error="Error window.atob not defined or unable to decode "+t+" id token"}else this.authEventData.error="The returned id_token is not parseable with regex configured in client auth provider."}catch(e){this.authEventData.error="Exception caught, error parsing "+t+" id_token it could not be decoded"}return i},e.prototype.isRunningInSurfaceHubUniversalAppContainer=function(){var e=window,t=!!(e.Microsoft&&e.Microsoft.PPISkype&&e.Microsoft.PPISkype.Authentication&&e.OAuthToken);return t&&(t=e.Microsoft.PPISkype.Authentication.CredentialsHandler.getInstance().isRunningInPPIOs()),t},e.prototype.getClientType=function(){return this.isSurfaceHubOs?teamspace.services.ClientType.surfaceHub1:this.isDesktopHwa()?teamspace.services.ClientType.desktopHwa:this.isElectron()?teamspace.services.ClientType.electron:teamspace.services.ClientType.web},e.prototype.isDesktopHwa=function(){var e=window;return void 0!==e.Windows&&void 0!==e.Microsoft&&void 0!==e.Microsoft.Teams&&void 0!==e.Microsoft.Teams.Hwa&&void 0!==e.Microsoft.Teams.Hwa.Desktop},e.prototype.isElectron=function(){return window.navigator.userAgent.contains("Electron")},e.currentUserString="currentUser",e.userOidString="userOid",e}();t.ClientAuthenticationServiceProvider=n,angular.module("teamspace.clientAuthenticationService",["teamspace.constants","teamspace.config","teamspace.authenticationService","angular-uuid"]).provider("clientAuthenticationService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(72),r=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S,y,C,b){var T=this;this.authenticationLoggingService=e,this.settingsService=t,this.$q=i,this.constants=n,this.$window=r,this.$interval=s,this.$timeout=a,this.sxConfig=o,this.retryCollectionService=c,this.appStateService=l,this.orchestrationService=p,this.$injector=u,this.storageService=h,this.eventingService=d,this.resources=g,this.signoutHelperServiceFactory=v,this.utilityService=m,this.clientAuthenticationService=f,this.crossTabService=S,this.guestAccessSettingsService=y,this.errorRedirectService=C,this.$translate=b,this.useTokenClaim=!1,this.loginDeferred=null,this.tokenRefreshIntervalPromise=null,this.className="AuthenticationServiceImplementation.",this.authLogger=this.authenticationLoggingService.newLogger(),this.authConstants=this.settingsService.valueFor("authConstants"),this.appResources=this.authConstants.resources,this.appResources&&1==this.appResources.length||this.authLogger.error("appResources expected to have a single resource, current: {0}",this.appResources),this.isDesktopApp=this.settingsService.valueAsBoolean(n.settings.names.isDesktopApp),this.useTokenClaim=this.settingsService.valueAsBoolean(this.constants.settings.names.enableUserRoleFromTokenClaim),this.electronIpc=this.$window.electronSafeIpc,this.skypeAuthenticationProvider=u.instantiate(teamspace.services.authentication.SkypeAuthenticationProvider,{parentService:this,userRole:f.getConfiguredUserRole()}),this.subscribeForProviderEvents(),this.registerForOrchestration(),this.subscribeDesktopGetTokens(),this.disallowForceRefreshSkypeToken=this.settingsService.valueAsBoolean(this.constants.settings.names.disallowForceRefreshSkypeToken),this.appMaxLogOutTimer=this.settingsService.valueFor(this.constants.settings.names.appMaxLogOutTimer)||5e3,this.disableAuthUserPeopleBackfill=this.settingsService.valueAsBoolean(this.constants.settings.names.disableAuthUserPeopleBackfill),this.disableAdalAuthErrorHandlerv2=this.settingsService.valueAsBoolean(this.constants.settings.names.disableAdalAuthErrorHandlerv2),this.eventingService.unsafeOn(this.constants.events.appState.unsuspended,function(){T.tokenRefreshIntervalPromise&&T.verifySiteToken("unsuspended")}),this.eventingService.unsafeOn(this.constants.events.adal.clearAdalCache,function(e,t){T.authenticationLoggingService.authErrorEvent(T.className+" - clearAdalCache","Start clearing adal cache event"),T.clearAdalCache(t)}),this.disableAuthUserPeopleBackfill||this.eventingService.unsafeOn(this.constants.events.user.profileUpdate,function(e,t){t&&t.displayName&&T.cachedUser&&T.cachedUser.profile?(T.cachedUser.profile.name=t.displayName,T.cachedUser.profile.given_name=t.givenName,T.cachedUser.profile.family_name=t.surname):T.authLogger.warn("Received profile update event but failed to update due to undefined values.")}),this.isDesktopApp&&this.eventingService.unsafeOn(this.constants.events.desktopApp.desktopOriginLogOut,function(e,t){T.logOut(T.constants.events.appState.reasons.userInitiatedDesktopOrigin)}),this.clientAuthenticationService.setAcquireTokenFunc(function(e){return T.getAuthTokensInternal([e],!0)}),this.getTokenTelemetrySampling=this.settingsService.valueFor(this.constants.settings.names.getTokenTelemetrySampling),this.initCriticalAppResourceLookUp()}return e.$inject=["authenticationLoggingService","settingsService","$q","constants","$window","$interval","$timeout","sxConfig","retryCollectionService","appStateService","orchestrationService","$injector","storageService","eventingService","resources","signoutHelperServiceFactory","utilityService","clientAuthenticationService","crossTabService","guestAccessSettingsService","errorRedirectService","$translate"],e.prototype.initCriticalAppResourceLookUp=function(){this.criticalAppResourceLookup={};for(var e=0,t=this.appResources;e<t.length;e++){s=t[e];this.criticalAppResourceLookup[s]=!0}var i=this.getClientId();if(this.criticalAppResourceLookup[i]=!0,this.authConstants.criticalAuthResources&&this.authConstants.criticalAuthResources.length>0)for(var n=0,r=this.authConstants.criticalAuthResources;n<r.length;n++){var s=r[n];this.criticalAppResourceLookup[s]=!0}},e.prototype.subscribeDesktopGetTokens=function(){var e=this;this.isDesktopApp&&null!=this.electronIpc&&this.electronIpc.on(this.constants.events.desktopApp.getAuthTokensFromWeb,function(t,i){e.getAuthTokens(e.appResources).then(function(t){e.electronIpc.send(e.constants.events.desktopApp.sendAuthTokensFromWeb,t)})})},e.prototype.startLoginTimer=function(){var e=this;this.loginDeferred&&(this.loginTimer=this.$timeout(function(){e.authenticationLoggingService.authErrorEvent(e.className+"startLoginTimer","Timeout waiting for login success or user profile on page load."),e.updateLoginTimer(!0,e.constants.authentication.adalUserLoginRequiredError,e.clientAuthenticationService.getClientId())},this.constants.authentication.adalLoginTimeout))},e.prototype.goOnline=function(e){var t=this,i=this.authenticationLoggingService.newScenario(e);i.cancelIfOffline=!0,!this.clientAuthenticationService.loginInProgress&&this.loginDeferred&&this.validateLoggedIn();var n=this.startTokenRetry([this.clientAuthenticationService.getClientId()]);return n.then(function(e){i.stop(),t.verifySiteToken("online"),t.startSiteTokenRefresh()},function(e){return i.fail(),t.$q.reject(e)}),n},e.prototype.startSiteTokenRefresh=function(){var e=this;this.cancelSiteTokenRefresh(),this.tokenRefreshIntervalPromise=this.$interval(function(){e.verifySiteToken("interval")},this.constants.timeInMiliseconds.twoMinutes,void 0,!1)},e.prototype.verifySiteToken=function(e){this.clientAuthenticationService.getCachedToken(this.appResource)||(this.authenticationLoggingService.event(this.constants.scenarios.auth.refreshTokens,{reason:e}),this.startTokenRetry())},Object.defineProperty(e.prototype,"appResource",{get:function(){return this.appResources[0]},enumerable:!0,configurable:!0}),e.prototype.cancelSiteTokenRefresh=function(){this.tokenRefreshIntervalPromise&&(this.$interval.cancel(this.tokenRefreshIntervalPromise),this.tokenRefreshIntervalPromise=null)},e.prototype.tryGetTokenExpiration=function(e){var t=this.clientAuthenticationService.tryGetTokenExpiration,i=e||this.appResource;if(angular.isFunction(t))return this.clientAuthenticationService.tryGetTokenExpiration(i)},e.prototype.getClientId=function(){return this.clientAuthenticationService.getClientId()},e.prototype.getUserRole=function(){return this.clientAuthenticationService.getConfiguredUserRole()},e.prototype.getUserTypeInTenant=function(){var e=this.clientAuthenticationService.getUserInfo();return 1===(e&&e.profile||{acct:1}).acct?teamspace.services.UserTypeInTenant.Guest:teamspace.services.UserTypeInTenant.Member},e.prototype.isAnonymous=function(){return this.getUserRole()===teamspace.services.UserRole.anonymous},e.prototype.isExternalUser=function(){if(this.useTokenClaim){var e=this.clientAuthenticationService.getUserInfo();return!!(e&&e.profile||{idp:void 0}).idp}return this.getUserRole()===teamspace.services.UserRole.guest},e.prototype.isMsa=function(){return this.clientAuthenticationService.isMsaAccount()},e.prototype.isMsInternalUser=function(){return this.settingsService.valueAsBoolean("isInternalUser")},e.prototype.goOffline=function(e){this.retryCollectionService.cancelAll(teamspace.services.RetryCollectionType.AdalAuth,e),this.skypeAuthenticationProvider.cancelOutstandingRequests(e),this.cancelSiteTokenRefresh()},e.prototype.shouldSendTelemetryForGetToken=function(){return this.getTokenTelemetrySampling?!(this.getTokenTelemetrySampling<=0)&&(1===this.getTokenTelemetrySampling||0===Math.floor(Math.random()*this.getTokenTelemetrySampling)):(this.authLogger.error("Get Token Telemetry Sampling is not defined."),!1)},e.prototype.startTokenRetry=function(e,t){var i=this;void 0===t&&(t=!1);var r=this.className+"startTokenRetry";e=e||this.appResources,this.authLogger.info("Start acquiring Adal tokens -- resources: "+e+".");var s=function(e){for(var s=[],a=0;a<e.length;a++)!function(a){var o=e[a];if(o)if(i.appStateService.isOnline){var c=i.shouldSendTelemetryForGetToken()?i.authenticationLoggingService.newScenario(i.constants.scenarios.auth.adalTokens.getAuthToken):new n.ScenarioImplementationStub;c.eventData.resource=o,c.eventData.newAcquireToken=i.settingsService.valueAsBoolean(i.constants.settings.names.enableTokenCache);var l=void 0;if(t||(l=i.clientAuthenticationService.getCachedToken(o)),l)i.authLogger.info("Return cached token for resource: "+o),s.push(i.$q.when(l)),c.stop();else{i.authLogger.debug("Cannot get cached token for resource "+o),c.eventData.tokenRenewalRequired=!0,t||l?(c.eventData.forceAcquireToken=!1,c.eventData.acquireTokenInBackground=!0):(c.eventData.forceAcquireToken=!0,c.eventData.acquireTokenInBackground=!1);var p={retryIntervals:i.constants.authentication.tokenRenewRetries,retryMaxTimeMs:i.constants.authentication.adalTokenRetryRenewTimeout,retryMaxTimeCallback:function(e){return e&&e.mark(i.constants.scenarios.auth.adalTokensRetry.markers.timeout),i.authenticationLoggingService.authErrorEvent(r,"Token retry operation taking longer than expected."),!!i.appStateService.isOnline||(i.authLogger.warn("App found to be offline canceling retry for resource:{0}",o),!1)},retryScenarioName:i.constants.scenarios.auth.adalTokensRetry.name},u=i.retryCollectionService.retry(teamspace.services.RetryCollectionType.AdalAuth,o,function(e){return i.clientAuthenticationService.acquireToken(o,t).then(function(e){return o===i.appResource&&(i.authLogger.info("forcing skype token renew after adal MT token renewal"),i.getSkypeTokensInternal(!0),i.settingsService.valueAsBoolean(i.constants.settings.names.emitEventOnTokenRefresh)&&i.eventingService.$emit(i.constants.events.appTokenRefresh.appTokenRefreshed)),c.stop(),e}).catch(function(e){var t=i.handleAuthError(o,e);if(c.fail(),t.type===i.constants.events.appState.reasons.renewalTimeout||t.type===i.constants.events.appState.reasons.receivedExpiredToken||t.type===i.constants.events.appState.reasons.backgroundTaskSpurious||t.type===i.constants.events.appState.reasons.receivedSameToken)return i.$q.reject(t.type);u.cancel(t.type)})},p);s.push(u.promise)}}else s.push(i.$q.reject("Due to current app state cannot start retry fetch of ADAL tokens"));else i.authenticationLoggingService.authErrorEvent(r,"Trying to get token for an invalid resource: {0} by {1}",o,(new Error).stack)}(a);return i.$q.all(s).then(function(t){return i.appStateService.notifyServiceUp(teamspace.services.AppService.AdalTokens,"token renewal success:"+e.join(",")),t})};return this.loginDeferred?this.loginDeferred.promise.then(function(){return s(e)}):s(e)},e.prototype.handleAuthLoginError=function(e,t){var i=this;return this.clientAuthenticationService.handleAuthError(e,t).catch(function(t){return i.handleAuthError(e,t),i.$q.reject(t)})},e.prototype.handleAuthError=function(e,t){var i=this.className+"handleAuthError";if(!this.appStateService.isOnline)return this.authLogger.warn("Not handling adal response due to current app state offline. No action can be taken at this time: error:"+t+", resource:"+e),{code:t,type:this.constants.events.appState.reasons.aborted};var n=this.clientAuthenticationService.getAuthError(t),r=this.isResourceCritical(e);switch(this.authenticationLoggingService.warn("Attempting to handle AAD error response: error:"+t+", error mapped to action:"+n.type+", resource:"+e+", isCritial:"+r),this.authenticationLoggingService.event(this.constants.scenarios.auth.aadError,{error:t,errorType:n.type,resource:e,isCritical:r}),n.type){case this.constants.events.appState.reasons.unknownAuthError:case this.constants.events.appState.reasons.tokenRevoked:(this.disableAdalAuthErrorHandlerv2||r)&&this.setTokenErrorState(teamspace.services.AppService.AdalLogin,n.type,e,t);break;case this.constants.events.appState.reasons.noAccessForResource:case this.constants.events.appState.reasons.resourceDisabled:case this.constants.events.appState.reasons.resourceRequiresConsent:r&&this.setTokenErrorState(teamspace.services.AppService.AdalLogin,this.constants.events.appState.reasons.unknownAuthError,e,t);break;case this.constants.events.appState.reasons.receivedSameToken:case this.constants.events.appState.reasons.receivedExpiredToken:(this.disableAdalAuthErrorHandlerv2||r)&&this.setTokenErrorState(teamspace.services.AppService.AdalTokens,n.type,e,t);break;case this.constants.events.appState.reasons.cancelled:case this.constants.events.appState.reasons.aborted:this.authLogger.warn("Token renewal cancelled for resource:"+e);break;case this.constants.events.appState.reasons.resourceRequiresMfa:r&&this.logOut(n.type);break;case this.constants.events.appState.reasons.missingUserAccountInTenant:case this.constants.events.appState.reasons.deviceNotCompliant:(this.disableAdalAuthErrorHandlerv2||r)&&this.logOut(n.type);break;case this.constants.events.appState.reasons.renewalTimeout:this.authenticationLoggingService.warn(i,"Timeout has occurred waiting for token renewal of resource:"+e+"."),this.eventingService.$emit(this.constants.events.http.networkSuspectedOffline,null),(this.disableAdalAuthErrorHandlerv2||r)&&this.setTokenErrorState(teamspace.services.AppService.AdalTokens,n.type,e,t);break;case this.constants.events.appState.reasons.devicePolicyUnsupported:if(this.authenticationLoggingService.warn(i,"Device Policy Unsupported."),this.disableAdalAuthErrorHandlerv2||r){this.setTokenErrorState(teamspace.services.AppService.AdalLogin,n.type,e,t);var s=new teamspace.services.ErrorParams;s.errorStep=this.constants.scenarios.steps.oops.login,s.errorMessage="Device Policy Unsupported",s.errorDescription="A conflicting device policy in their AAD configuration which is preventing the browsers from logging in",this.errorRedirectService.redirect(teamspace.services.ErrorRedirectReason.OopsPageRedirect,s)}}return n},e.prototype.isResourceCritical=function(e){return this.disableAdalAuthErrorHandlerv2?e===this.getClientId()||e===this.authConstants.resources[0]:!!this.criticalAppResourceLookup[e]},e.prototype.setTokenErrorState=function(e,t,i,n){this.authenticationLoggingService.authErrorEvent(this.className+"setTokenErrorState",'Bringing down auth services {0} due to {1}, resource "{2}"',teamspace.services.AppService[e],t,i),this.appStateService.notifyServiceDown(e,t,n)},e.prototype.decorateUser=function(e){e&&!angular.isDefined(e.userRole)&&(e.userRole=this.getUserRole())},e.prototype.getLoggedInUser=function(){var e=this.clientAuthenticationService.getUserInfo();return!e||this.cachedUser&&e===this.originalUser||(this.originalUser=e,this.cachedUser=angular.copy(e),this.authenticationLoggingService.event(this.constants.scenarios.auth.copiedUserProfile),this.disableAuthUserPeopleBackfill||this.backfillPeopleInformation()),this.decorateUser(this.cachedUser),this.cachedUser},e.prototype.switchTenant=function(e,t){var i=this,n=this.authenticationLoggingService.newScenario(this.constants.scenarios.auth.tenantSwitch);n.cancelIfOffline=!0;var r={tenantId:t.tenantId,guestUserId:t.userId,isRedeemed:t.isInvitationRedeemed,isSameTenant:void 0};this.getUserInformation().then(function(s){s&&s.profile?s.profile.tid&&s.profile.tid!==t.tenantId||!s.profile.oid?(i.authenticationLoggingService.event(i.constants.scenarios.auth.tenantSwitch,{tenant_id:t.tenantId}),i.appStateService.notifyServiceDown(teamspace.services.AppService.AdalReauth,i.constants.events.appState.reasons.tenantSwitch),i.clientAuthenticationService.switchTenant(e,t,n),r.isSameTenant=!1,n.stop((a={},a[i.constants.scenarioDataPropNames.data]=JSON.stringify(r),a))):(i.authenticationLoggingService.event(i.constants.scenarios.auth.appSwitchSameTenant,{tenant_id:t.tenantId}),r.isSameTenant=!0,n.cancel((o={},o[i.constants.scenarioDataPropNames.data]=JSON.stringify(r),o))):n.fail({error:"No user profile found to do a tenant switch"});var a,o}).catch(function(e){n.fail((t={},t[i.constants.scenarioDataPropNames.data]=JSON.stringify(r),t[i.constants.scenarioDataPropNames.error]=JSON.stringify(e),t));var t})},e.prototype.getAuthTokens=function(e){return this.getAuthTokensInternal(e)},e.prototype.getAuthTokensInternal=function(e,t){return void 0===t&&(t=!1),this.startTokenRetry(e,t).then(function(e){var t=[];return e.forEach(function(e){t.push(e)}),t.join(",")})},e.prototype.getAuthHeaders=function(e,t){var i=this;return this.getAuthTokens(t).then(function(t){return e=e||{},t.indexOf(",")>0?e[i.constants.headers.teamspaceAuth]=t:e[i.constants.headers.tokens.authorization]="Bearer "+t,e})},e.prototype.getSkypeTokens=function(e){return void 0===e&&(e=!1),this.disallowForceRefreshSkypeToken?this.getSkypeTokensInternal(!1):this.getSkypeTokensInternal(e)},e.prototype.getSkypeTokensInternal=function(e,t){var i=this;if(void 0===t&&(t=!0),!this.appStateService.isOnline)return this.$q.reject("Due to current app state cannot fetch Skype tokens");var n=function(e){if(e){var t=new SkypeX.Services.SkypeToken(e.skypeToken);return i.sxConfig.putNativeInfo(t,null),i.$q.resolve(e)}return i.$q.reject('Skype token is undefined in "getSkypeTokens".')};return t?this.skypeAuthenticationProvider.acquireToken(null,e).then(n):this.skypeAuthenticationProvider.acquireTokenWithoutTimeout(null,e).then(n)},e.prototype.getSkypeTokensWithoutTimeout=function(){return this.getSkypeTokensInternal(!1,!1)},e.prototype.signUpForTrial=function(){return this.skypeAuthenticationProvider.signUpForTrial()},e.prototype.getUserInformation=function(){var e,t=this,i=this.className+"getUserInformation",n=this.clientAuthenticationService.getClientId();return this.appStateService.isOnline?e=this.startTokenRetry([n]).catch(function(e){return t.authenticationLoggingService.authErrorEvent(i,"Unable to get fresh id token due to error getting token: {0}",e),t.$q.reject(e)}):(this.authLogger.warn("Unable to fetch updated user profile due to app state. Returning cached user"),e=this.$q.resolve(null)),e.then(function(){var e=t.getLoggedInUser();return e?(t.cachedUser.profile.upn||t.backfillPeopleInformation(),e):(t.authenticationLoggingService.authErrorEvent(i,"Null user profile found in cache. The profile was cleared and not refreshed"),t.$q.reject("Null user profile found"))})},e.prototype.clearAdalCache=function(e){this.authLogger.warn(this.className+"clearAdalCache","Clearing the adal cache for {0}.",e||"ALL"),this.clientAuthenticationService.clearCache(e)},e.prototype.clearSkypeCache=function(){this.authLogger.warn(this.className+"clearSkypeCache","Clearing the skype cache."),this.skypeAuthenticationProvider.clearCache()},e.prototype.getUserDetails=function(){return this.skypeAuthenticationProvider.getUserDetails()},e.prototype.logOut=function(e,t){var i=this,n=this.className+"logOut";this.$injector.get("layoutService").showLoadingScreen(this.resources.strings.auth_logout_message),this.authenticationLoggingService.authErrorEvent(n,"Logging the user out");var r=this.$timeout(function(){i.logoutNow(e,n,t)},this.appMaxLogOutTimer);this.disposeActionRegistration=this.orchestrationService.registerAction(this.constants.actions.logout.continueLogout,function(){return i.$timeout.cancel(r),i.logoutNow(e,n,t),i.$q.resolve()});var s=this.authenticationLoggingService.newScenario(this.constants.actions.logout.appLogout);this.orchestrationService.executeOrchestration(this.constants.plans.appLogout,s)},e.prototype.setLoginRequired=function(e){this.clientAuthenticationService.setLoginRequired(e)},e.prototype.checkLoginRequired=function(){return this.clientAuthenticationService.checkLoginRequired()},e.prototype.throwAwaySkypeTokenOnApiSwitch=function(){var e=this.settingsService.getApi(),t=this.storageService.get(this.constants.authentication.currentApiId);e&&e.id&&t!==e.id&&(this.storageService.remove(this.constants.authentication.skypeTokenKey),this.storageService.set(this.constants.authentication.currentApiId,e.id))},e.prototype.logoutNow=function(e,t,i){var n=this;this.disposeActionRegistration&&(this.disposeActionRegistration(),this.disposeActionRegistration=null),this.appStateService.notifyServiceDown(teamspace.services.AppService.AdalLogin,this.constants.events.appState.reasons.appLogout),this.goOffline(e);var r=this.signoutHelperServiceFactory(this.settingsService.getRootUri()),s=this.$injector.get("clientDatabase"),a=this.$injector.get("filesClientDatabase"),o=this.$injector.get("contactsDatabase"),c=this.$injector.get("teamsMembersDatabase"),l=this.$injector.get("priorityContactsDatabase"),p=this.$injector.get("buddyListEtagDatabase"),u=this.$injector.get("wopiAuthService"),h=this.$injector.get("googleDriveAuthenticationService"),d=[s?s.nukeDB(i):SkypeX.Services.SyncTasks.when(),a?a.nukeDB(i):SkypeX.Services.SyncTasks.when(),o?o.nukeDB(i):SkypeX.Services.SyncTasks.when(),c?c.nukeDB(i):SkypeX.Services.SyncTasks.when(),l?l.nukeDB(i):SkypeX.Services.SyncTasks.when(),p?p.nukeDB(i):SkypeX.Services.SyncTasks.when()];if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableExternalFileProviders)){var g=u?function(){return u.signOutFromAll()}:function(){return n.$q.resolve()},v=h?function(){return h.signOut()}:function(){return n.$q.resolve()},m=g().finally(function(){return v()});d.push(SkypeX.Services.SyncTasks.fromNgPromise(m))}SkypeX.Services.SyncTasks.whenAll(d).finally(function(){n.skypeAuthenticationProvider.clearCache(),r.handleWindow();var s=!!i;if(n.isDesktopApp){var a={reason:e,cacheClearOnly:s};n.eventingService.$emit(n.constants.events.desktopApp.logOut,a),n.$window.electronSafeIpc&&(a.name=n.constants.events.desktopApp.adalLogout,n.$window.electronSafeIpc.send(n.constants.events.desktopApp.telemetryEvent,a))}n.authenticationLoggingService.event("adal_logout",{reason:e}),s?(n.clearAdalCache(),n.authenticationLoggingService.authErrorEvent(t,"Reloading app after wipeout"),n.eventingService.$emit(n.constants.events.settings.reloadNoLoadingScreen)):n.clientAuthenticationService.logOut()})},e.prototype.backfillPeopleInformation=function(){var e=this;if(!this.getUpnPromise){var t=this.authenticationLoggingService.newScenario("auth_backfill_upn");t.appendEventData({oid:this.cachedUser&&this.cachedUser.profile?this.cachedUser.profile.oid:void 0}),t.cancelIfOffline=!0;var i=this.$injector.get("peopleService");i&&(this.getUpnPromise=i.getPeopleProfile(this.cachedUser.profile.email||this.cachedUser.profile.unique_name,"authenticationService",!0).then(function(n){var r=e.settingsService.valueAsBoolean(e.constants.settings.names.enablePreventUnknownUserBackfill);!(e.cachedUser&&e.cachedUser.profile&&n)||r&&i.isUnknownUser(n)?e.authenticationLoggingService.authErrorEvent(e.className+"backfillPeopleInformation","One of the expected user profiles are undefined after getPeopleProfile has run! Aborting backfill from peopleService:                 cachedUser:"+!!e.cachedUser+", mtUser:"+!!n+"."):(e.authLogger.info('Auth: Successfully backfilled the UPN for login user "{0}".',e.cachedUser.profile.oid),e.cachedUser.profile.upn||(e.cachedUser.profile.upn=n.userPrincipalName||e.cachedUser.profile.upn),e.disableAuthUserPeopleBackfill||(e.cachedUser.profile.name=n.displayName||e.cachedUser.profile.name,e.cachedUser.profile.family_name=n.surname||e.cachedUser.profile.family_name,e.cachedUser.profile.given_name=n.givenName||e.cachedUser.profile.given_name),t.stop())}).catch(function(i){e.authLogger.error("Auth: Unable to backfill the UPN for logged in user."),t.fail()}).finally(function(){e.getUpnPromise=void 0}))}},e.prototype.updateLoginTimer=function(e,t,i){this.loginDeferred&&(this.$timeout.cancel(this.loginTimer),e?this.loginDeferred.reject(t):this.loginDeferred.resolve(),this.loginDeferred=null),e&&this.handleAuthLoginError(i,t)},e.prototype.validateLoggedIn=function(){var e=this.getLoggedInUser();e?(this.authenticationLoggingService.populateUserInfo(e),this.authLogger.info("User profile refreshed bringing service up, isAuthenticated: {0}",e.isAuthenticated),this.isDesktopApp&&null!=this.electronIpc&&this.electronIpc.send(this.constants.events.desktopApp.userLoggedIn,e.profile),this.updateLoginTimer(),this.appStateService.notifyServiceUp(teamspace.services.AppService.AdalLogin,"login success")):this.updateLoginTimer(!0,this.constants.authentication.adalUserLoginRequiredError,this.clientAuthenticationService.getClientId())},e.prototype.subscribeForProviderEvents=function(){var e=this,t=this.className+"subscribeForProviderEvents";this.loginDeferred=this.$q.defer(),this.authLogger.info("Subscribing for initial login success/failure events."),this.clientAuthenticationService.loginSuccess.on(function(t){e.validateLoggedIn()}),this.clientAuthenticationService.loginFailure.on(function(i){e.authenticationLoggingService.authErrorEvent(t,"On route change adal login failure event received adal could not aquire a token for client ID:{0}.",e.clientAuthenticationService.getClientId()),e.appStateService.isOnline?e.authenticationLoggingService.authErrorEvent(t,"App is online the user may have logged out on another tab"):e.authenticationLoggingService.authErrorEvent(t,"This is due to app state offline"),e.updateLoginTimer(!0,i.error,e.clientAuthenticationService.getClientId())})},e.prototype.isTenantSwitch=function(e){var t=e.profile.altsecid,i=this.storageService.get(this.constants.authentication.personalUserId,!1).toString();'"'===i.charAt(0)&&(i=JSON.parse(i));var n=!1;if(angular.isDefined(i))if(angular.isDefined(e.profile.puid)&&i===e.profile.puid)n=!0;else if(angular.isDefined(t)){var r=t.lastIndexOf(":");i===t.substring(r+1)&&(n=!0)}return n&&this.authenticationLoggingService.event(this.constants.scenarios.auth.tenantSwitch,{tenant_id:e.profile.tid,altSec:t,previousPuid:i,puid:e.profile.puid}),n},e.prototype.validateNoUserChange=function(){var e=this;if(this.isAnonymous())return this.authLogger.info("Bypassing user change validation for anonymous user"),void this.storageService.clear();var t=this.className+"validateNoUserChange";this.getUserInformation().then(function(i){var n=e.$q.defer();if(e.eventingService.unsafeOn(e.constants.events.db.providerReady,function(){return n.resolve()}),i&&i.profile){var r=i.profile.oid,s=e.storageService.get(e.constants.authentication.latestOid,!1),a=function(t,i){n.promise.then(function(){return e.logOut(t,i)})};e.authLogger.info("Got latestUserId: {0}",s),angular.isDefined(r)||e.isMsa()||e.isExternalUser()||(e.authLogger.error("Current users has signed in with a tenant they have not redeemed"),a(e.constants.events.appState.reasons.signedInWithUnRedeemedTenant,void 0)),e.isUsingDisabledGuestAccessFeature()&&a(e.constants.events.appState.reasons.signedInWithGuestFeatureOff,void 0),s&&r!==s?(e.authenticationLoggingService.event(e.constants.scenarios.auth.userIdMismatch,{userId:r,previousUserId:s}),e.isTenantSwitch(i)?(e.authenticationLoggingService.info(t,"Logged in user performing tenant switch, new tenant: {0}",i.profile.tid),e.setOid(r),e.crossTabService.reloadAllButThisTab(e.constants.events.appState.reasons.authTenantSwap)):(e.authenticationLoggingService.event(e.constants.scenarios.auth.clearPreviousSession,{userId:s,message:"Logged in user is different than previous user, wiping storage for the previous user"}),a(e.constants.events.appState.reasons.userStorageMisMatch,s))):e.validateTenantChange(i).then(function(){e.authenticationLoggingService.event(e.constants.scenarios.auth.deepLinkTenantSwap,{tenant_id:i.profile.tid})}).catch(function(){e.updatePuidInStorage(i)?e.isMsa()&&!angular.isDefined(r)?e.setOid(e.constants.authentication.msaDefaultOid):e.setOid(r):a(e.constants.events.appState.reasons.badUserProfile,void 0)})}else e.authenticationLoggingService.authErrorEvent(t,"Missing user or user profile from getUserInformation")})},e.prototype.setOid=function(e){this.authenticationLoggingService.event(this.constants.scenarios.auth.oidIdSet,{userId:e}),this.storageService.set(this.constants.authentication.latestOid,e,!1)},e.prototype.isUsingDisabledGuestAccessFeature=function(){return!(!this.isExternalUser()||this.guestAccessSettingsService.isGuestAccessEnabled())&&(this.authLogger.info("User Role type guest not allowed. Disabled by settings"),!0)},e.prototype.validateTenantChange=function(e){var t=this.$window.location.search;if(t){var i=t.split("#")[0],n=this.utilityService.getQueryParameters(i);if(n){var r=n.tenantId;if(angular.isDefined(r)&&r!==e.profile.tid)return this.$injector.get("guestAccessService").promptToSwitchTenant(r)}}return this.$q.reject()},e.prototype.updatePuidInStorage=function(e){var t=!1;if(!this.$window.enableGuestAccessV3&&this.isDesktopApp)return!0;var i=this.useTokenClaim?!this.isExternalUser():this.getUserRole()===teamspace.services.UserRole.member,n=this.useTokenClaim?this.isExternalUser():this.getUserRole()===teamspace.services.UserRole.guest;if(i&&angular.isDefined(e.profile.puid))e.profile.puid.indexOf('"')>-1?this.authLogger.error("puid in token is wrapped in double quotes. This is not valid and needs to be fixed"):(this.storageService.set(this.constants.authentication.personalUserId,e.profile.puid,!1),t=!0);else if(n&&angular.isDefined(e.profile.altsecid)){var r=e.profile.altsecid,s=r.lastIndexOf(":"),a=r.substring(s+1);this.storageService.set(this.constants.authentication.personalUserId,a,!1),t=!0}else this.getClientId()===this.constants.webClientAppId.thirdParty&&(e.profile.puid=e.profile.unique_name,t=!0);return t?this.authenticationLoggingService.event(this.constants.scenarios.auth.puidSet,{tenant_id:e.profile.tid,puid:e.profile.puid}):this.authenticationLoggingService.event(this.constants.scenarios.auth.puidNotSet,{tenant_id:e.profile.tid,puid:e.profile.puid,altsec:e.profile.altsecid}),t},e.prototype.validateMsaSupport=function(){if(this.isMsa()&&!this.settingsService.valueAsBoolean(this.constants.settings.names.msaLoginAllowed)){this.authenticationLoggingService.authErrorEvent(this.className+" - msaSupportCheck","MSA login is not supported");var e=new teamspace.services.ErrorParams;e.errorStep=this.constants.scenarios.steps.oops.msaLogin,e.displayMessage=this.$translate.instant(this.resources.strings.oops_page_msa_login_disable_header_message),this.errorRedirectService.redirect(teamspace.services.ErrorRedirectReason.MsaLoginDisabled,e)}},e.prototype.registerForOrchestration=function(){var e,t,i=this;this.orchestrationService.registerAction(this.constants.actions.authentication.startup,function(){return e=window.performance.now(),i.startLoginTimer(),i.validateNoUserChange(),i.validateMsaSupport(),i.goOnline(i.constants.scenarios.appAuthenticated).finally(function(){window[i.constants.scenarios.alt.timings.serviceAuthDuration]=window.performance.now()-e})}),this.orchestrationService.registerAction(this.constants.actions.authentication.skypeAuth,function(){return t=window.performance.now(),i.getSkypeTokensWithoutTimeout().finally(function(){window[i.constants.scenarios.alt.timings.skypeAuthDuration]=window.performance.now()-t})}),this.orchestrationService.registerAction(this.constants.actions.authentication.online,function(){return i.goOnline(i.constants.scenarios.appAuthenticatedOnline)}),this.orchestrationService.registerAction(this.constants.actions.authentication.offline,function(){return i.goOffline("orchestration "+i.constants.actions.authentication.offline),null})},e}();t.AuthenticationServiceImplementation=r,angular.module("teamspace.authenticationService",["teamspace.config","teamspace.loggingService","teamspace.appState","teamspace.orchestrationService","teamspace.retryService","teamspace.retryCollectionService","skypeX.sxConfig","teamspace.authenticationLoggingService","teamspace.signoutHelperServiceFactory","teamspace.clientAuthenticationService"]).service("authenticationService",r),angular.module("teamspace.signoutHelperServiceFactory",["teamspace.storageService"]).factory("signoutHelperServiceFactory",["$window","storageService",function(e,t){return function(i){return new teamspace.services.authentication.SignOut(e,i,t)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s){this.$q=e,this.loggingService=t,this.brbV2AppDiagnosticDataProvider=i,this.brbV2DeviceDiagnosticDataProvider=n,this.brbV2MediaDevicesDiagnosticDataProvider=r,this.brbV2SessionDiagnosticDataProvider=s,this.logger=this.loggingService.newLogger("BrbV2DiagnosticDataProviderAggregator")}return e.$inject=["$q","loggingService","brbV2AppDiagnosticDataProvider","brbV2DeviceDiagnosticDataProvider","brbV2MediaDevicesDiagnosticDataProvider","brbV2SessionDiagnosticDataProvider"],e.prototype.getDiagnosticTags=function(){var e=this,t=[this.brbV2AppDiagnosticDataProvider.getDiagnosticTags(),this.brbV2DeviceDiagnosticDataProvider.getDiagnosticTags(),this.brbV2MediaDevicesDiagnosticDataProvider.getDiagnosticTags(),this.brbV2SessionDiagnosticDataProvider.getDiagnosticTags()];return this.$q.all(t).then(function(e){return _.flatten(e)}).catch(function(t){return e.logger.error("One or more getDiagnoticTags promisses failed"),e.$q.resolve([])})},e.prototype.getDiagnosticText=function(){var e=this,t=[this.brbV2AppDiagnosticDataProvider.getDiagnosticText(),this.brbV2DeviceDiagnosticDataProvider.getDiagnosticText(),this.brbV2MediaDevicesDiagnosticDataProvider.getDiagnosticText(),this.brbV2SessionDiagnosticDataProvider.getDiagnosticText()];return this.$q.all(t).then(function(e){return["<b>DIAGNOSTICS</b>"].concat(e).join("<br><br>")}).catch(function(t){return e.logger.error("One or more getDiagnosticText promisses failed"),e.$q.resolve("")})},e}();t.BrbV2DiagnosticDataProviderAggregator=n,angular.module("teamspace.brbV2DiagnosticDataProviderAggregator",["teamspace.deviceManagerService","teamspace.loggingService","teamspace.brbV2AppDiagnosticDataProvider","teamspace.brbV2DeviceDiagnosticDataProvider","teamspace.brbV2MediaDevicesDiagnosticDataProvider","teamspace.brbV2SessionDiagnosticDataProvider","teamspace.constants"]).service("brbV2DiagnosticDataProviderAggregator",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c){var l=this;this.$q=e,this.$window=t,this.platformDetectService=i,this.desktopUtilityService=n,this.hwaServiceProvider=r,this.settingsService=s,this.utilityService=a,this.constants=o,this.callingAgentsService=c,this.getMediastackVersion=this.utilityService.convertToSafeCachingGetter(function(){return l.$window.MediaStack.getVersion()},"N/A"),this.getMediastackApiVersion=this.utilityService.convertToSafeCachingGetter(function(){return l.$window.MediaStack.getApiVersion()},0)}return e.$inject=["$q","$window","platformDetectService","desktopUtilityService","hwaServiceProvider","settingsService","utilityService","constants","callingAgentsService"],e.prototype.getDiagnosticTags=function(){return this.$q.resolve([])},e.prototype.getDiagnosticText=function(){var e=this;return this.getHostBuild().then(function(t){return[e.getAppName(),e.getWebClientBuild(),t,e.getMediaBuild(),e.getTsCallingBuild()].join("<br>")})},e.prototype.getAppName=function(){var e;if(this.desktopUtilityService.isDesktopHwa())e="for HWA desktop";else if(this.desktopUtilityService.isSurfaceHub())e="for Surface Hub";else if(this.settingsService.valueAsBoolean(this.constants.settings.names.isDesktopApp)){var t=this.platformDetectService.getOS();switch(t){case this.constants.os.windows:e="for Windows";break;case this.constants.os.mac:e="for Mac";break;default:e="for other OS ("+t+")"}}else switch(this.platformDetectService.getBrowser()){case this.constants.browser.chrome:e="on Chrome";break;case this.constants.browser.edge:e="on Edge";break;default:e="on another browser"}return"<b>App</b>: Teams "+e},e.prototype.getWebClientBuild=function(){return"<b>WebClient build</b>: "+this.settingsService.getVersion().clientVersion},e.prototype.getHostBuild=function(){if(this.settingsService.valueAsBoolean(this.constants.settings.names.isDesktopApp)){return this.desktopUtilityService.getElectronClientVersion().then(function(e){return"<b>Desktop app build</b>: "+e}).catch(function(){return"<b>Desktop app build</b>: N/A"})}if(this.desktopUtilityService.isHwa()){var e=this.hwaServiceProvider.getAppInfo().appVersion;return this.$q.resolve("<b>Desktop app build</b>: "+e)}var t=this.platformDetectService.getBrowserVersion();return this.$q.resolve("<b>Browser build</b>: "+t)},e.prototype.getMediaBuild=function(){var e=[];if(this.$window.MediaStack){var t=this.getMediastackVersion(),i=this.getMediastackApiVersion();e.push("<b>Mediastack build</b>: "+t+" APIv"+i)}if(this.$window.SlimCore||this.$window.SlimCoreRT){var n=this.desktopUtilityService.getSlimCoreVersion(!0);e.push("<b>Slimcore build</b>: "+n)}return e.length||e.push("<b>No media build detected.</b>"),e.join("<br>")},e.prototype.getTsCallingBuild=function(){return"<b>Ts-calling build</b>: "+this.callingAgentsService.getTsCallingVersion()},e}();t.BrbV2AppDiagnosticDataProvider=n,angular.module("teamspace.brbV2AppDiagnosticDataProvider",["teamspace.platformDetectService","teamspace.desktopUtilityService","teamspace.hwaServiceProvider","teamspace.settingsService","teamspace.utilityService","teamspace.constants","teamspace.callingAgentsService"]).service("brbV2AppDiagnosticDataProvider",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r){this.$q=e,this.localizationService=t,this.desktopUtilityService=i,this.hwaServiceProvider=n,this.appConfig=r}return e.$inject=["$q","localizationService","desktopUtilityService","hwaServiceProvider","appConfig"],e.prototype.getDiagnosticTags=function(){return this.$q.resolve([])},e.prototype.getDiagnosticText=function(){var e=[this.getPlatformId(),this.getLanguage()];return this.$q.resolve(e.join("<br>"))},e.prototype.getLanguage=function(){var e=this.localizationService.getLocale(),t=this.localizationService.getLanguages().find(function(t){return t.code===e});return"<b>Language</b>: "+(t.name?t.name:"N/A")},e.prototype.getPlatformId=function(){var e=this.appConfig.environment.platformId;return this.desktopUtilityService.isHwa()&&(e=this.hwaServiceProvider.getAppInfo()?this.hwaServiceProvider.getAppInfo().platformId:"N/A"),"<b>Platform ID</b>: "+e},e}();t.BrbV2DeviceDiagnosticDataProvider=n,angular.module("teamspace.brbV2DeviceDiagnosticDataProvider",["teamspace.localizationService","teamspace.desktopUtilityService","teamspace.hwaServiceProvider","teamspace.config","teamspace.constants"]).service("brbV2DeviceDiagnosticDataProvider",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.$q=e,this.deviceManagerService=t}return e.$inject=["$q","deviceManagerService"],e.prototype.getDiagnosticTags=function(){return this.$q.resolve([])},e.prototype.getDiagnosticText=function(){var e,t="",i="",n="";try{var r=this.deviceManagerService.getSelectedDevices();t=r.microphone,i=r.speaker,n=r.camera}catch(e){}return e=[this.getMicrophonesList(t),this.getSpeakersList(i),this.getCamerasList(n)],this.$q.resolve(e.join("<br>"))},e.prototype.getMicrophonesList=function(e){var t;try{t=this.deviceManagerService.getMicrophones()}catch(e){}return"<b>Microphones</b>:<br>"+this.buildDeviceList(t,e)},e.prototype.getSpeakersList=function(e){var t;try{t=this.deviceManagerService.getSpeakers()}catch(e){}return"<b>Speakers</b>:<br>"+this.buildDeviceList(t,e)},e.prototype.getCamerasList=function(e){var t;try{t=this.deviceManagerService.getCameras()}catch(e){}return"<b>Cameras</b>:<br>"+this.buildDeviceList(t,e)},e.prototype.buildDeviceList=function(e,t){return e&&e.length?e.map(function(e){var i=e.id===t?" (selected)":"";return"&emsp;"+e.label+i}).join("<br>"):"&emsp;N/A"},e}();t.BrbV2MediaDevicesDiagnosticDataProvider=n,angular.module("teamspace.brbV2MediaDevicesDiagnosticDataProvider",["teamspace.deviceManagerService","teamspace.constants"]).service("brbV2MediaDevicesDiagnosticDataProvider",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c){this.$q=e,this.loggingService=t,this.authenticationService=i,this.telemetryProvider=n,this.callingService=r,this.identityService=s,this.broadcastPlaybackService=a,this.constants=o,this.callingDebugService=c}return e.$inject=["$q","loggingService","authenticationService","telemetryProvider","callingService","identityService","broadcastPlaybackService","constants","callingDebugService"],e.prototype.getDiagnosticTags=function(){var e=[];return this.identityService.isFreemiumTenant()&&e.push(this.constants.freemium.bugTag),this.$q.resolve(e)},e.prototype.getDiagnosticText=function(){var e=this;return this.getUserData().then(function(t){var i=[e.getTimestamp(),t,e.getDeviceId(),e.getSessionId()];i.push(e.getLastOrOngoingCallInfo());var n=e.getBroadcastPlaybackDiagnosticInfo();return n&&i.push(n),e.identityService.isFreemiumTenant()&&i.push(e.getFreemiumData()),i.join("<br>")})},e.prototype.getSessionId=function(){return"<b>Session ID</b>: "+this.loggingService.sessionId},e.prototype.getDeviceId=function(){return"<b>Device ID</b>: "+this.telemetryProvider.deviceId},e.prototype.getFreemiumData=function(){return"<b>Is Nutmix</b>: "+!!this.identityService.isFreemiumTenant()},e.prototype.getUserData=function(){return this.authenticationService.getUserInformation().then(function(e){return["<b>Userinfo ID</b>: "+e.profile.oid,"<b>User's email address</b>: "+(e.profile.email?e.profile.email:e.profile.upn)].join("<br>")}).catch(function(){return["<b>Userinfo ID</b>: N/A","<b>User's email address</b>: N/A"].join("<br>")})},e.prototype.getLastOrOngoingCallInfo=function(){var e=this.callingService.getActiveCall(),t=[];if(e){var i=e.callId,n=e.participantId,r=e.conversationId,s=e.meetingDetails&&e.meetingDetails.capabilities,a={callId:i,participantId:n,conversationId:r,isBroadcastMeeting:!!e.broadcastMeeting,broadcastMeetingRole:e.broadcastMeeting?e.broadcastMeeting.role:"",capabilities:s,conferenceId:e.meetingDetails&&e.meetingDetails.pstnDetails&&e.meetingDetails.pstnDetails.acpMcuInfo&&e.meetingDetails.pstnDetails.acpMcuInfo.settings&&e.meetingDetails.pstnDetails.acpMcuInfo.settings.participantPasscode};t=this.fillInCallInfoData(!0,a)}else{var o=this.callingDebugService.lastCallData;t=this.fillInCallInfoData(!1,o)}return t.length>0?t.join("<br>"):t.join()},e.prototype.fillInCallInfoData=function(e,t){var i=[],n=e?"Ongoing":"Last",r="<b>"+n+" Call ID</b>",s="<b>"+n+" Call's Participant ID</b>",a="<b>"+n+" Conversation ID</b>",o="<b>"+n+" call meeting capabilities</b>",c="<b>"+n+" Call Conference Id</b>";if(t&&t.callId){if(i=[r+": "+t.callId,s+": "+t.participantId,a+": "+t.conversationId],t.capabilities){var l=JSON.stringify(t.capabilities);i.push(o+": "+l)}if(t.conferenceId){var p=t.conferenceId.replace(/(?=(\d{3})+$)/g," ");i.push(c+": "+p)}t.isBroadcastMeeting&&(i.push("<b>Is Broadcast</b>: true"),i.push("<b>Broadcast role</b>: "+t.broadcastMeetingRole))}return i},e.prototype.getBroadcastPlaybackDiagnosticInfo=function(){var e=this.broadcastPlaybackService.getActiveBroadcastPlayback();if(!e)return null;if(e.type===teamspace.services.BroadcastPlaybackType.AMS){var t=e.attendeeMeeting&&e.attendeeMeeting.stream,i=e.attendeeMeeting&&e.attendeeMeeting.signalR,n=["<b>Meeting ID</b>: "+e.threadId,"<b>Has Wams url</b>: "+!(!t||!t.wamsStreamingUrl),"<b>Has SignalR url</b>: "+!(!i||!i.url)];if(i&&i.querystrings)for(var r in i.querystrings)n.push("<b>"+r+"</b>: "+i.querystrings[r]);return"<b>Broadcast Attendee</b><br><ul><li>"+n.join("</li><li>")+"</li></ul>"}if(e.type===teamspace.services.BroadcastPlaybackType.Stream){var s=e.modalityLinks.stream,n=["<b>Meeting ID</b>: "+e.threadId,"<b>User Role</b>: "+teamspace.services.BroadcastParticipantRole[e.userRole],"<b>Stream VideoId</b>: "+(s&&s.videoId)],a=this.broadcastPlaybackService.streamDiagnosticsData;if(a)for(var r in a)n.push("<b>"+r+"</b>: "+a[r]);return"<b>Broadcast Playback</b><br><ul><li>"+n.join("</li><li>")+"</li></ul>"}},e.prototype.getTimestamp=function(){var e=new Date;return"<b>BRB Timestamp</b>: "+this.convertNrToString(e.getUTCFullYear())+"/"+this.convertNrToString(e.getUTCMonth()+1)+"/"+this.convertNrToString(e.getUTCDate())+" "+this.convertNrToString(e.getUTCHours())+":"+this.convertNrToString(e.getUTCMinutes())+":"+this.convertNrToString(e.getUTCSeconds())+":"+this.convertNrToString(e.getUTCMilliseconds(),3)+" UTC ("+e.valueOf()+")"},e.prototype.convertNrToString=function(e,t){return void 0===t&&(t=2),e.toLocaleString("en-US",{minimumIntegerDigits:t,useGrouping:!1})},e}();t.BrbV2SessionDiagnosticDataProvider=n,angular.module("teamspace.brbV2SessionDiagnosticDataProvider",["teamspace.loggingService","teamspace.authenticationService","teamspace.telemetryProvider","teamspace.callingService","teamspace.constants","teamspace.identityService","teamspace.callingDebugService"]).service("brbV2SessionDiagnosticDataProvider",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t){var i=this;this.$q=t,this.getContentToUpload=function(){if(!i.getLogsCallback)return i.$q.resolve(null);var t={type:e.type,fileName:e.fileName,isBinary:!1,content:i.getLogsCallback()};return i.$q.resolve(t)}}return e.$inject=["$q"],Object.defineProperty(e.prototype,"type",{get:function(){return e.type},enumerable:!0,configurable:!0}),e.type="ampLog",e.fileName="ampLogs.txt",e}();t.BrbV2AmpLogProvider=n,angular.module("teamspace.brbV2AmpLogProvider",[]).service("brbV2AmpLogProvider",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h,d){this.$q=e,this.brbV2AmpLogProvider=t,this.brbV2HwaMediaStackEventsLogFileProvider=i,this.brbV2HwaMediaStackLogFileProvider=n,this.brbV2HwaSlimcoreLogFileProvider=r,this.brbV2HwaTeamsAppLogFileProvider=s,this.brbV2HwaTeamsHelperLogFileProvider=a,this.brbV2HwaTeamsTaskLogFileProvider=o,this.brbV2CallingLogProvider=c,this.brbV2KustoQueriesProvider=l,this.brbV2PerfInfoProvider=p,this.brbV2SyncLogProvider=u,this.brbV2WebLogProvider=h,this.constants=d}return e.$inject=["$q","brbV2AmpLogProvider","brbV2HwaMediaStackEventsLogFileProvider","brbV2HwaMediaStackLogFileProvider","brbV2HwaSlimcoreLogFileProvider","brbV2HwaTeamsAppLogFileProvider","brbV2HwaTeamsHelperLogFileProvider","brbV2HwaTeamsTaskLogFileProvider","brbV2CallingLogProvider","brbV2KustoQueriesProvider","brbV2PerfInfoProvider","brbV2SyncLogProvider","brbV2WebLogProvider","constants"],e.prototype.collectUploadContent=function(e,t,i,n){var r=this.$q.defer(),s=this.getUploadContentProviders(e,t).map(function(e){return e.getContentToUpload().then(function(e){if(e)return i(e)}).catch(function(t){n.error("Error collecting content to upload of type {0}: {1}",e.type,t)})});return this.$q.all(s).then(function(){r.resolve()}),r.promise},e.prototype.getUploadContentProviders=function(e,t){var i=[];switch(i.push(this.brbV2WebLogProvider),i.push(this.brbV2CallingLogProvider),i.push(this.brbV2AmpLogProvider),i.push(this.brbV2SyncLogProvider),e){case this.constants.feedback.categories.crash:i.push(this.brbV2PerfInfoProvider),i.push(this.brbV2KustoQueriesProvider)}return t&&(i.push(this.brbV2HwaMediaStackEventsLogFileProvider),i.push(this.brbV2HwaMediaStackLogFileProvider),i.push(this.brbV2HwaSlimcoreLogFileProvider),i.push(this.brbV2HwaTeamsAppLogFileProvider),i.push(this.brbV2HwaTeamsHelperLogFileProvider),i.push(this.brbV2HwaTeamsTaskLogFileProvider)),i},e}();t.BrbV2UploadContentCollector=n,angular.module("teamspace.brbV2UploadContentCollector",["teamspace.settingsService","teamspace.brbV2AmpLogProvider","teamspace.brbV2HwaMediaStackEventsLogFileProvider","teamspace.brbV2HwaMediaStackLogFileProvider","teamspace.brbV2HwaSlimcoreLogFileProvider","teamspace.brbV2HwaTeamsAppLogFileProvider","teamspace.brbV2HwaTeamsHelperLogFileProvider","teamspace.brbV2HwaTeamsTaskLogFileProvider","teamspace.brbV2CallingLogProvider","teamspace.brbV2KustoQueriesProvider","teamspace.brbV2PerfInfoProvider","teamspace.brbV2SyncLogProvider","teamspace.brbV2WebLogProvider"]).service("brbV2UploadContentCollector",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r){this.$q=e,this.diagnosticsActionService=t,this.settingsService=i,this.callingService=n,this.constants=r}return e.$inject=["$q","diagnosticsActionService","settingsService","callingService","constants"],Object.defineProperty(e.prototype,"type",{get:function(){return e.type},enumerable:!0,configurable:!0}),e.prototype.getContentToUpload=function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableCallingInfoTracking)&&this.callingService.getActiveCall()?this.diagnosticsActionService.getCallingLogs().then(function(t){return{type:e.type,fileName:e.fileName,isBinary:!1,content:t}}):this.$q.resolve(null)},e.type="callinglog",e.fileName="calling-debug.txt",e}();t.BrbV2CallingLogProvider=n,angular.module("teamspace.brbV2CallingLogProvider",["teamspace.settingsService","teamspace.callingService","teamspace.diagnosticsActionService","teamspace.constants"]).service("brbV2CallingLogProvider",n)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.$inject=["$q"],t.prototype.filterFile=function(e){return e.displayName.includes("MediaStackETW")&&!e.displayName.includes(".bak")},t.prototype.getLogFileType=function(){return t.fileType},t.prototype.getLogFileName=function(){return t.fileName},t.prototype.isBinary=function(){return t.isBinary},t.fileType="mediastack-events",t.fileName="MediaStackETW.etl",t.isBinary=!0,t}(i(12).BrbV2HwaLogFileProviderBase);t.BrbV2HwaMediaStackEventsLogFileProvider=r,angular.module("teamspace.brbV2HwaMediaStackEventsLogFileProvider",[]).service("brbV2HwaMediaStackEventsLogFileProvider",r)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.$inject=["$q"],t.prototype.filterFile=function(e){return e.displayName.includes("msrtc")&&!e.displayName.includes(".bak")},t.prototype.getLogFileType=function(){return t.fileType},t.prototype.getLogFileName=function(){return t.fileName},t.prototype.isBinary=function(){return t.isBinary},t.fileType="mediastack",t.fileName="MediaStack.blog",t.isBinary=!0,t}(i(12).BrbV2HwaLogFileProviderBase);t.BrbV2HwaMediaStackLogFileProvider=r,angular.module("teamspace.brbV2HwaMediaStackLogFileProvider",[]).service("brbV2HwaMediaStackLogFileProvider",r)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.$inject=["$q"],t.prototype.filterFile=function(e){return e.displayName.includes("SlimCore-0")},t.prototype.getLogFileType=function(){return t.fileType},t.prototype.getLogFileName=function(){return t.fileName},t.prototype.isBinary=function(){return t.isBinary},t.fileType="slimcore-rt",t.fileName="SlimcoreRT.blog",t.isBinary=!0,t}(i(12).BrbV2HwaLogFileProviderBase);t.BrbV2HwaSlimcoreLogFileProvider=r,angular.module("teamspace.brbV2HwaSlimcoreLogFileProvider",[]).service("brbV2HwaSlimcoreLogFileProvider",r)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.$inject=["$q"],t.prototype.filterFile=function(e){return e.name.includes("Teams.log")},t.prototype.getLogFileType=function(){return t.fileType},t.prototype.getLogFileName=function(){return t.fileName},t.prototype.isBinary=function(){return t.isBinary},t.fileType="teams-log",t.fileName="Teams.log",t.isBinary=!1,t}(i(12).BrbV2HwaLogFileProviderBase);t.BrbV2HwaTeamsAppLogFileProvider=r,angular.module("teamspace.brbV2HwaTeamsAppLogFileProvider",[]).service("brbV2HwaTeamsAppLogFileProvider",r)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.$inject=["$q"],t.prototype.filterFile=function(e){return e.name.includes("TeamsHelper.log")},t.prototype.getLogFileType=function(){return t.fileType},t.prototype.getLogFileName=function(){return t.fileName},t.prototype.isBinary=function(){return t.isBinary},t.fileType="teams-helper",t.fileName="TeamsHelper.log",t.isBinary=!1,t}(i(12).BrbV2HwaLogFileProviderBase);t.BrbV2HwaTeamsHelperLogFileProvider=r,angular.module("teamspace.brbV2HwaTeamsHelperLogFileProvider",[]).service("brbV2HwaTeamsHelperLogFileProvider",r)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.$inject=["$q"],t.prototype.filterFile=function(e){return e.displayName.includes("TeamsTask")},t.prototype.getLogFileType=function(){return t.fileType},t.prototype.getLogFileName=function(){return t.fileName},t.prototype.isBinary=function(){return t.isBinary},t.fileType="teams-task",t.fileName="TeamsTask.log",t.isBinary=!1,t}(i(12).BrbV2HwaLogFileProviderBase);t.BrbV2HwaTeamsTaskLogFileProvider=r,angular.module("teamspace.brbV2HwaTeamsTaskLogFileProvider",[]).service("brbV2HwaTeamsTaskLogFileProvider",r)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n){this.$q=e,this.settingsService=t,this.loggingService=i,this.constants=n}return e.$inject=["$q","settingsService","loggingService","constants"],Object.defineProperty(e.prototype,"type",{get:function(){return e.type},enumerable:!0,configurable:!0}),e.prototype.getContentToUpload=function(){var t=new Date,i=this.settingsService.valueFor(this.constants.settings.names.loggingConstants),n=new Date(t.getTime()-36e5).toISOString(),r=new Date(t.getTime()+9e5).toISOString(),s=this.loggingService.sessionId,a={startTime:(new Date).getTime()+36e5,database:i.database,tenantId:i.tenantId,queries:['http\n          | where Session_Id == "'+s+'"\n          | where EventInfo_Time > datetime('+n+") and EventInfo_Time < datetime("+r+")\n          | project EventInfo_Time, EventInfo_BaseType, status, resultcode, method, delta, hostName;",'scenario\n          | where Session_Id == "'+s+'" and step == "stop"\n          | where EventInfo_Time > datetime('+n+") and EventInfo_Time < datetime("+r+")\n          | summarize max = max(delta) by EventInfo_BaseType\n          | top 50 by max desc;",'scenario\n          | where Session_Id == "'+s+'"\n          | where EventInfo_Time > datetime('+n+") and EventInfo_Time < datetime("+r+')\n          | project EVS_Target = EventInfo_Sequence, scenario, EventInfo_BaseType, step, EventInfo_Time\n          | extend dummy = 1\n          | join kind=leftouter (\n            scenario\n                | where Session_Id == "'+s+'"\n                | where EventInfo_BaseType == "messaging_switch_channel"\n                | where EventInfo_Time > datetime('+n+") and EventInfo_Time < datetime("+r+')\n                | where ["step"] == "start"\n                | project EVS_Start = EventInfo_Sequence, scenario\n                | join (\n                    scenario\n                        | where ["step"] == "stop"\n                        | project EVS_Stop = EventInfo_Sequence, scenario\n                        | extend dummy = 1\n                ) on scenario\n        ) on dummy\n        | where EVS_Target >= EVS_Start and EVS_Target <= EVS_Stop\n        | project scenario, EventInfo_Time, EVS_Target, EventInfo_BaseType, step\n        | order by EVS_Target asc;']},o={type:e.type,fileName:e.fileName,isBinary:!1,content:JSON.stringify(a).replace(/(\\r\\n|\\r|\\n|\\t)/g,"").replace(/\s\s+/g," ")};return this.$q.resolve(o)},e.type="kusto",e.fileName="kusto.json",e}();t.BrbV2KustoQueriesProvider=n,angular.module("teamspace.brbV2KustoQueriesProvider",["teamspace.diagnosticMetricsCollector","teamspace.constants","teamspace.settingsService","teamspace.loggingService"]).service("brbV2KustoQueriesProvider",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n){this.$q=e,this.settingsService=t,this.constants=i,this.brbV2CollectCpuProfile=n}return e.$inject=["$q","settingsService","constants","brbV2CollectCpuProfile"],Object.defineProperty(e.prototype,"type",{get:function(){return e.type},enumerable:!0,configurable:!0}),e.prototype.getContentToUpload=function(){if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableCollectPerfWithBrb)){var t={type:e.type,fileName:e.fileName,isBinary:!1,content:JSON.stringify(this.brbV2CollectCpuProfile.getCpuProfile())};return this.$q.resolve(t)}return this.$q.resolve(null)},e.type="performance",e.fileName="perflog.txt",e}();t.BrbV2PerfInfoProvider=n,angular.module("teamspace.brbV2PerfInfoProvider",["teamspace.brbV2CollectCpuProfile"]).service("brbV2PerfInfoProvider",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.diagnosticsActionService=e}return e.$inject=["diagnosticsActionService"],Object.defineProperty(e.prototype,"type",{get:function(){return e.type},enumerable:!0,configurable:!0}),e.prototype.getContentToUpload=function(){return this.diagnosticsActionService.getSyncLogs().then(function(t){return{type:e.type,fileName:e.fileName,isBinary:!1,content:t}})},e.type="synclog",e.fileName="sync.txt",e}();t.BrbV2SyncLogProvider=n,angular.module("teamspace.brbV2SyncLogProvider",["teamspace.diagnosticsActionService"]).service("brbV2SyncLogProvider",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.$q=e,this.diagnosticsActionService=t}return e.$inject=["$q","diagnosticsActionService"],Object.defineProperty(e.prototype,"type",{get:function(){return e.type},enumerable:!0,configurable:!0}),e.prototype.getContentToUpload=function(){var t=this.diagnosticsActionService.getEventJsonString(),i={type:e.type,fileName:e.fileName,isBinary:!1,content:t};return this.$q.resolve(i)},e.type="weblog",e.fileName="weblog.txt",e}();t.BrbV2WebLogProvider=n,angular.module("teamspace.brbV2WebLogProvider",["teamspace.diagnosticsActionService"]).service("brbV2WebLogProvider",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i){this.$window=e,this.diagnosticMetricsCollector=t,this.constants=i,this.electronSafeIpc=this.$window.electronSafeIpc,this.perfMetrics=void 0}return e.$inject=["$window","diagnosticMetricsCollector","constants"],e.prototype.recordCpuProfile=function(e){return this.collectCpuProfile().then(function(){e.close("submit")})},e.prototype.collectCpuProfile=function(){var e=this;return this.diagnosticMetricsCollector.collectData().then(function(t){e.setCpuProfile(t),e.isCpuProfileDone=!0})},e.prototype.stopCpuProfiling=function(){if(this.electronSafeIpc){this.electronSafeIpc.send(this.constants.events.desktopApp.feedback.stopCPUProfiler);var e=this.diagnosticMetricsCollector.cancelCollectionTimer();this.setCpuProfile(e),this.isCpuProfileDone=!0}},e.prototype.stopAndDeleteCpuProfiling=function(){this.electronSafeIpc&&(this.electronSafeIpc.send(this.constants.events.desktopApp.feedback.stopCPUProfiler),this.diagnosticMetricsCollector.cancelCollectionTimer(),this.electronSafeIpc.send(this.constants.events.desktopApp.feedback.deleteCPUProfile),this.isCpuProfileDone=!1)},e.prototype.deleteCpuProfiling=function(){this.electronSafeIpc&&this.electronSafeIpc.send(this.constants.events.desktopApp.feedback.deleteCPUProfile)},e.prototype.getCpuProfile=function(){return this.perfMetrics},e.prototype.setCpuProfile=function(e){this.perfMetrics=e},e.prototype.getCpuProfileDone=function(){return this.isCpuProfileDone},e.prototype.clearPerfMetrics=function(){this.isCpuProfileDone=!1},e.prototype.clearFeedbackText=function(){this.feedbackText=""},e.prototype.setFeedbackText=function(e){this.feedbackText=e},e.prototype.getFeedbackText=function(){return this.feedbackText},e}();t.BrbV2CollectCpuProfile=n,angular.module("teamspace.brbV2CollectCpuProfile",["teamspace.diagnosticMetricsCollector"]).service("brbV2CollectCpuProfile",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(193),i(43),i(194),i(195),i(196),i(197),i(198),i(199),i(200)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n,r,s,a,o){var c=e.call(this)||this;return c.$window=t,c.constants=i,c.conversationsService=n,c.loggingService=r,c.callingSupportService=s,c.sxConfig=a,c.$injector=o,c.activeCalls={},c.endedCalls=[],c}return n(t,e),t.$inject=["$window","constants","conversationsService","loggingService","callingSupportService","sxConfig","$injector"],t.prototype.init=function(){var e=this,t=this.conversationsService.getAllConversations();this.addOrUpdateConversations(t),this.ensureConversationUpdatesListenerExists(),this.$window.requestIdleCallback(function(){e.isInitialized=!0})},t.prototype.getCallsByConversationId=function(e){return this.ensureConversationIsLoaded(e),this.getCallsForConversationId(e).map(this.sanitizeCallInfo)},t.prototype.getCallsCountByConversationId=function(e){return this.getCallsForConversationId(e).length},t.prototype.getCallByMessageId=function(e,t){return SkypeX.Services.ChatServiceUtils.isValidId(t)?this.getCallsByConversationId(e).filter(function(e){return e.messageId===t})[0]:(this.loggingService.warn("ActiveCallsService: Invalid message id provided "+t+"}"),null)},t.prototype.getLivenessPropertyName=function(e){return SkypeX.Services.ChatServiceUtils.ThreadProp_Liveness+":"+e},t.prototype.getCallByCallId=function(e,t){return this.getCallsByConversationId(e).filter(function(e){return e.callId===t})[0]},t.prototype.markCallAsEnded=function(e,t){this.getCallByCallId(e,t)&&(this.endedCalls.push(t),this.trigger(teamspace.services.ActiveCallsServiceEvents.Type_ActiveCallsChanged,e))},t.prototype.getActiveCallsForDebug=function(){return this.activeCalls},Object.defineProperty(t.prototype,"callingService",{get:function(){return this.callingServiceCache=this.callingServiceCache||this.$injector.get("callingService"),this.callingServiceCache},enumerable:!0,configurable:!0}),t.prototype.onConversationsUpdated=function(e){var t=this;if(e){var i=this.isInitialized?e:e.filter(function(e){return t.activeCalls[e.id]});this.addOrUpdateConversations(i)}},t.prototype.ensureConversationIsLoaded=function(e){if(!this.isInitialized&&!this.activeCalls[e]){var t=this.conversationsService.getConversation(e);t&&(this.ensureConversationUpdatesListenerExists(),this.updateConversationCallInfo(t),this.activeCalls[e]=this.activeCalls[e]||{callsMap:{},calls:[]})}},t.prototype.ensureConversationUpdatesListenerExists=function(){var e=this;this.conversationUpdatesListener||(this.conversationUpdatesListener=this.conversationsService.subscribe(function(t,i){return e.onConversationsUpdated(i)},teamspace.services.ConversationsServiceEvents.EventType_Batched))},t.prototype.isCallMarkedAsEnded=function(e){return this.endedCalls.indexOf(e)>=0},t.prototype.getCallsForConversationId=function(e){var t=this;return(this.activeCalls[e]?this.activeCalls[e].calls:[]).filter(function(e){return!t.isCallMarkedAsEnded(e.callId)})},t.prototype.sanitizeCallInfo=function(e){return{callId:e.callId,teamsCallId:e.teamsCallId,callUrl:e.callUrl,expiration:e.expiration,status:e.status,callInitiator:e.callInitiator,messageId:"global"===e.messageId?null:e.messageId,replyChainMessageId:e.replyChainMessageId,conversationId:e.conversationId}},t.prototype.addOrUpdateConversations=function(e){var t=this;e&&0!==e.length&&_.chunk(e,16).forEach(function(e,i){t.$window.requestIdleCallback(function(){e.forEach(function(e){t.updateConversationCallInfo(e)})})})},t.prototype.updateConversationCallInfo=function(e){var t=!1,i={};if(e.isUserMember(this.sxConfig.getCurrentSkypeMri()))for(var n in e.threadProperties)if(this.hasLivenessProperty(n)){var r=this.getMessageIdFromLivenessProperty(e,n);t=this.updateActiveCallsForConversation(r,e,n)||t,i[r]=!0}var s=this.removeEndedCalls(e.id,i);!t&&_.isEmpty(s.removedCalls)||this.trigger(teamspace.services.ActiveCallsServiceEvents.Type_ActiveCallsChanged,e.id,s.currentActiveCalls)},t.prototype.removeEndedCalls=function(e,t){var i=this;void 0===t&&(t={});var n=[],r=[];return _.forEach(this.getCallsForConversationId(e),function(s){var a=s.messageId;t[a]?n.push(s):(r.push(s),i.loggingService.info("Removing call property was not found or invalid: "+JSON.stringify(s)),i.removeCall(e,a))}),{currentActiveCalls:n,removedCalls:r}},t.prototype.hasLivenessProperty=function(e){return 0===e.indexOf(SkypeX.Services.ChatServiceUtils.ThreadProp_Liveness)},t.prototype.getMessageIdFromLivenessProperty=function(e,t){if(e.isGroupChat())return"global";if(e.isMeetingConversation())return"0";var i=t.substring(SkypeX.Services.ChatServiceUtils.ThreadProp_Liveness.length+1);return i||this.loggingService.error("Liveness property is empty"),i},t.prototype.updateActiveCallsForConversation=function(e,t,i){var n=this.activeCalls[t.id],r=n&&n.callsMap[e],s=r&&!this.isCallMarkedAsEnded(r.callId),a=this.getCallInfo(t.threadProperties[i],e,t.id),o=this.hasActiveCall(a),c=this.callingSupportService.shouldAllowCalling(t.id);return o&&!s&&c?(this.addCall(t.id,e,a),!0):!(o||!s)&&(this.loggingService.info("Removing call as property is removed or invalid: "+a),this.removeCall(t.id,e),!0)},t.prototype.addCall=function(e,t,i){this.activeCalls[e]=this.activeCalls[e]||{callsMap:{},calls:[]},this.activeCalls[e].callsMap[t]=i,this.activeCalls[e].calls=this.activeCalls[e].calls||[],this.activeCalls[e].calls.push(i),this.loggingService.info("Call was added: "+JSON.stringify(i))},t.prototype.removeCall=function(e,t){var i=this.conversationsService.getConversation(e),n=this.activeCalls[e],r=n.callsMap[t].callId,s=this.loggingService.findScenario(this.constants.scenarios.calling.endMeetup);if(s&&s.stop(),delete n.callsMap[t],this.endedCalls=this.endedCalls.filter(function(e){return e!==r}),this.activeCalls[e].calls=this.activeCalls[e].calls.filter(function(e){return e.messageId!==t}),this.loggingService.info("Call was removed. messageId: "+t+", conversationId: "+e),t&&i){var a=i.threadProperties[this.getLivenessPropertyName(t)];a&&this.loggingService.info("Call was removed - threadProp: "+a)}},t.prototype.getCallInfo=function(e,t,i){var n=null,r=this.parseCallProps(e);if(r){var s=this.callingService.getCallByCallId(r.conversationId,null,!0),a=s?s.teamsCallId:teamspace.services.TeamsCallService.getNextTeamsCallId();n={callId:r.conversationId,teamsCallId:a,callUrl:r.conversationUrl,expiration:r.expiration,status:r.status,callInitiator:r.groupCallInitiator,messageId:t,replyChainMessageId:r.meetingInfo?r.meetingInfo.replyChainMessageId:null,conversationId:i}}return n},t.prototype.parseCallProps=function(e){try{return JSON.parse(e)}catch(e){return this.loggingService.error("Couldn't parse callinfo ! "+e),null}},t.prototype.hasActiveCall=function(e){return!(!_.isObject(e)||!e.hasOwnProperty("expiration"))&&1e3*e.expiration>Date.now()},t}(SkypeX.Services.ObservableBase);t.ActiveCallsServiceImplementation=r,angular.module("teamspace.activeCallsService",["skypeX.sxConfig","teamspace.conversationsService","teamspace.loggingService","teamspace.constants","teamspace.callingSupportService"]).service("activeCallsService",r)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a){this.$q=e,this.constants=t,this.dataManagerService=i,this.loggingService=n,this.policiesService=r,this.settingsService=s,this.voiceSettingsStore=a,this.logger=this.loggingService.newLogger("CallerIDService");var o=new teamspace.services.DataManagerOptions(t.urls.calling.callerID.type,function(e){return e.id});o.isTransient=!0,this.callerIDDataManager=this.dataManagerService.registerManager(o)}return e.$inject=["$q","constants","dataManagerService","loggingService","policiesService","settingsService","voiceSettingsStore"],e.prototype.isBlockOutgoingCallerIDEnabled=function(){var e=this;return this.policiesService.waitForPolicySettingsFetch().then(function(){var t=e.policiesService.getPolicySettings();return t&&t.callingLineIdentityPolicy&&!!t.callingLineIdentityPolicy.enableUserOverride}).catch(function(t){return e.logger.error("[isBlockOutgoingCallerIDEnabled] Failed to retrieve CallingLineIdentityPolicy. Error: "+(t&&t.message||"unknown")),!1})},e.prototype.isOutgoingCallerIDBlocked=function(){var e=this,t=this.$q.defer();return this.isBlockOutgoingCallerIDEnabled().then(function(i){return i||t.resolve(!1),e.voiceSettingsStore.waitForSettingAndGetValue(SkypeX.Services.VoiceSettingsStorageKey.electedSettings).then(function(e){t.resolve(e&&!!e.blockOutgoingCallerId)})}).catch(function(i){e.logger.error("[isOutgoingCallerIDBlocked] Failed to retrieve CallingLineIdentityPolicy. Error: "+(i&&i.message||"unknown")),t.resolve(!1)}),t.promise},e.prototype.updateBlockOutgoingCallerID=function(e){var t=this,i={data:JSON.stringify({blockOutgoingCallerId:e})},n=this.loggingService.newScenario(this.constants.scenarios.calling.callerID.updateBlockOutgoingCallerID);n.cancelIfOffline=!0;var r={blockOutgoingCallerId:e},s={url:this.settingsService.valueFor(this.constants.settings.names.middleTierConstants).newEndpointAddress+this.constants.urls.calling.callerID.post,method:"POST",data:r};return this.callerIDDataManager.invoke(s).then(function(){t.logger.debug("[updateBlockOutgoingCallerID] Updated BlockOutgoingCallerID setting successfully."),n.stop(i);var r=t.voiceSettingsStore.getSettings(),s=_.cloneDeep(r);s.electedSettings||(s.electedSettings={}),s.electedSettings.blockOutgoingCallerId=e,t.voiceSettingsStore.updateSettingsLocally(s)},function(e){return t.logger.error("[updateBlockOutgoingCallerID] Failed to update BlockOutgoingCallerID setting. Error: "+(e&&e.message||"unknown")),i.error=JSON.stringify(e),n.fail(i),t.$q.reject(e)})},e}();t.CallerIDServiceImplementation=n,angular.module("teamspace.callerIdService",["skypeX.voiceSettingsStore","teamspace.constants","teamspace.dataManagerService","teamspace.loggingService","teamspace.policiesService","teamspace.settingsService"]).service("callerIdService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r){this.$q=e,this.constants=t,this.dataManagerService=i,this.exceptionUtilityService=n,this.loggingService=r,this.logger=this.loggingService.newLogger("CallBlockingService");var s=new teamspace.services.DataManagerOptions(t.urls.calling.callBlocking.type,function(e){return e.id});s.isTransient=!0,s.isResponseWrappedInValue=!1,this.callBlockingDataManager=this.dataManagerService.registerManager(s)}return e.$inject=["$q","constants","dataManagerService","exceptionUtilityService","loggingService"],e.prototype.getCurrentStatus=function(){var e=this,t={url:this.constants.urls.calling.callBlocking.endpoint,method:"GET"},i=this.loggingService.newScenario(this.constants.scenarios.calling.callBlocking.fetchCallBlocking);return i.cancelIfOffline=!0,this.callBlockingDataManager.invoke(t).then(function(t){return e.logger.debug("Current call blocking status is: {0}",t&&t.isAnonymousCallerBlocked),i.stop(),t&&t.isAnonymousCallerBlocked},function(t){return e.exceptionUtilityService.failScenarioSelectively(i,t),e.logger.error("Error while getting call blocking status: {0}",t),e.$q.reject(t)})},e.prototype.blockAnonymous=function(e){var t=this,i={data:JSON.stringify({blockAnonymous:!!e})},n=this.loggingService.newScenario(this.constants.scenarios.calling.callBlocking.updateCallBlocking);n.cancelIfOffline=!0;var r={blockAnonymousCaller:!!e},s={url:this.constants.urls.calling.callBlocking.endpoint,method:"POST",data:r};return this.callBlockingDataManager.invoke(s).then(function(){t.logger.debug("Updated blockAnonymous setting successfully to {0}.",!!e),n.stop(i)},function(r){return t.logger.error("Failed to update blockAnonymous setting to "+!!e+". Error: "+(r&&r.message||"unknown")),i.error=JSON.stringify(r),n.fail(i),t.$q.reject(r)})},e}();t.CallBlockingServiceImplementation=n,angular.module("teamspace.callBlockingService",["teamspace.constants","teamspace.dataManagerService","teamspace.loggingService","teamspace.settingsService"]).service("callBlockingService",n)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=teamspace.services.CallConsultationEvents,s=teamspace.services.CallConsultationState,a=function(e){function t(){var t=e.call(this)||this;return t.subjectCalls={},t.consultations={},t}return n(t,e),t.prototype.getCallConsultationInfo=function(e){return this.subjectCalls[e]||{consultationState:s.None}},t.prototype.isConsultCall=function(e){return!!this.consultations[e]},t.prototype.getSubjectCallForConsult=function(e){var t=this.consultations[e];return t?t.subjectCall:null},t.prototype.getConsulteeForConsult=function(e){var t=this.consultations[e];if(t&&t.subjectCall){var i=t.subjectCall.teamsCallId;return this.getCallConsultationInfo(i).consultee}return null},t.prototype.isSubjectCall=function(e){return!!this.subjectCalls[e]},t.prototype.prepareToConsult=function(e,t,i){this.subjectCalls[e.teamsCallId]={consultationState:s.None,consultee:t,context:i,subjectCall:e}},t.prototype.consultWithIM=function(e,t,i){this.extendContext(e.teamsCallId,i),this.subjectCalls[e.teamsCallId].consultConvId=t,this.setCallConsultationState(e.teamsCallId,s.ConsultingWithIM),this.setConsultContext(t,e)},t.prototype.consultWithAV=function(e,t,i){this.extendContext(e.teamsCallId,i),this.subjectCalls[e.teamsCallId].consultCall=t,this.setCallConsultationState(e.teamsCallId,s.ConsultingWithAV),this.setConsultContext(t.teamsCallId,e)},t.prototype.resetConsultationState=function(e){this.subjectCalls[e]&&(this.resetConsultContext(e),delete this.subjectCalls[e],this.trigger(r.StateChanged,teamspace.services.TeamsCallService.getTeamsCallIdAsString(e)))},t.prototype.extendContext=function(e,t){t&&_.extend(this.subjectCalls[e].context,t)},t.prototype.setCallConsultationState=function(e,t){this.subjectCalls[e].consultationState=t,this.trigger(r.StateChanged,teamspace.services.TeamsCallService.getTeamsCallIdAsString(e))},t.prototype.setConsultContext=function(e,t){this.resetConsultContext(t.teamsCallId),this.consultations[e]={subjectCall:t}},t.prototype.resetConsultContext=function(e){var t=this.subjectCalls[e],i=t.consultConvId,n=t.consultCall;i&&this.consultations[i]&&delete this.consultations[i],n&&this.consultations[n.teamsCallId]&&delete this.consultations[n.teamsCallId]},t}(SkypeX.Services.SXStoreBase);t.CallConsultationStore=a,angular.module("teamspace.callConsultationStore",[]).service("callConsultationStore",a)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.IM=0]="IM",e[e.AV=1]="AV"}(r||(r={}));var s=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d){var g=e.call(this)||this;return g.constants=i,g.loggingService=n,g.callTogglingService=r,g.callingNavigationService=s,g.callingService=a,g.callingTelemetryService=o,g.callingUserActionService=c,g.conversationsService=l,g.dialogService=p,g.settingsService=u,g.callTransferService=h,g.eventingService=d,g.logger=g.loggingService.newLogger("CallConsultationService"),g.store=t,g.eventingService.unsafeOn(g.constants.events.calling.incomingReplaceCall,function(e,t){var i=t.incomingCall,n=t.callToReplace;g.handleIncomingReplaceCall(i,n)}),g}return n(t,e),t.$inject=["callConsultationStore","constants","loggingService","callTogglingService","callingNavigationService","callingService","callingTelemetryService","callingUserActionService","conversationsService","dialogService","settingsService","callTransferService","eventingService"],t.prototype.openCallConsultationDialog=function(e,t,i){return 4!==e.state&&this.callTogglingService.toggleHold(e,t),this.loggingService.event(this.constants.scenarios.calling.callConsultation.openDialog,(n={},n[this.constants.counters.eventNames.callId]=e.callId,n[this.constants.counters.eventNames.context]=t,n)),this.dialogService.open(this.constants.dialogs.callConsultation,{call:e,darkMode:i});var n},t.prototype.startConsultation=function(e,t){var i=this;this.store.isSubjectCall(e.teamsCallId)&&this.stopConsultingWithFailure(e.teamsCallId,"New consult started");var n=this.isPstn(t),s=this.determineConsultationType(n),a=r[s];this.logger.log(a+" consultation started for call "+e.teamsCallId+", isPstn="+n);var o=this.callingTelemetryService.newCallingScenario(e,this.constants.scenarios.calling.startConsultation,(h={},h[this.constants.counters.eventNames.context]=this.constants.scenarios.calling.context.callConsultationService,h[this.constants.counters.eventNames.targetType]=t.type,h[this.constants.counters.eventNames.consultationType]=a,h)),c={dispose:this.eventingService.unsafeOn(this.constants.events.calling.consultCallCreated,function(t,n){return i.onConsultCallCreated(n,e)})},l=this.subscribeToSubjectCall(e);if(this.store.prepareToConsult(e,t,{scenario:o,eventingServiceSubscription:c,subjectCallSubscription:l}),this.updateCanTransfer(e),s===r.AV){var p={subjectTeamsCallId:e.teamsCallId};(n?this.callingUserActionService.startPstnCall({dialoutNumber:t.mri.substring(SkypeX.Services.ChatServiceUtils.PstnPrefix.length),consultationContext:p}):this.callingUserActionService.placeCall({conversationId:this.conversationsService.getChatConversationWith(t.mri).id,consultationContext:p})).catch(function(t){i.stopConsultingWithFailure(e.teamsCallId,"Start call failed",t)})}else{var u=this.conversationsService.getChatConversationWith(t.mri).id;this.store.consultWithIM(e,u),this.callingNavigationService.navigateToCallScreen(e)}var h},t.prototype.handleIncomingReplaceCall=function(e,t){var i=this;e&&t?(this.logger.info("Consultative call found: replacing callId {0} with {1}",t.callId,e.callId),this.callingService.leaveCall(t,this.constants.scenarios.calling.context.callConsultationService).then(function(){i.logger.info("leave call successful for callId {0}",t.callId),i.callingUserActionService.acceptCall(e.conversationId,e.messageId,!1,!1,e.callId)}).catch(function(e){i.logger.error("Could not leave call with callId {0}",t.callId)})):this.logger.error("Could not find a call to replace for incoming call id {0} and consultativeCallId {1}",e.callId,e.consultativeCallId)},t.prototype.onConsultCallCreated=function(e,t){var i=e.subjectTeamsCallId,n=e.consultCall;t.teamsCallId===i?this.onConsultCallStarted(n,t):this.logger.error("Received consultCallCreated event with different teams call id. expected="+t.teamsCallId+", but got="+i)},t.prototype.getConsultation=function(e){var t=this.getSubjectCall(e);return t?this.store.getCallConsultationInfo(t.teamsCallId):{consultationState:teamspace.services.CallConsultationState.None}},t.prototype.getSubjectCall=function(e){return this.store.getSubjectCallForConsult(e.teamsCallId)||(this.store.isSubjectCall(e.teamsCallId)?e:null)},t.prototype.updateCanTransfer=function(e){var t=this.getConsultation(e),i=t.subjectCall,n=t.consultCall,r=t.context;if(r){var s=this.canTransferInternal(i,n);r.canTransfer!==s&&(r.canTransfer=s,this.triggerCanTransferChanged(i.teamsCallId,s),n&&this.triggerCanTransferChanged(n.teamsCallId,s))}else this.logger.error("No context for which to update canTransfer")},t.prototype.triggerCanTransferChanged=function(e,t){this.trigger(teamspace.services.CallConsultationServiceEvents.CanTransferChanged,teamspace.services.TeamsCallService.getTeamsCallIdAsString(e),t)},t.prototype.canTransferInternal=function(e,t){var i=!0;return e?4!==e.state?i=!1:t&&(4!==t.state&&3!==t.state?i=!1:t.forwardingDestinationType===this.constants.forwardingDestinationType.voicemail&&(i=!1)):i=!1,i},t.prototype.canTransferConsultation=function(e){var t=this.getConsultation(e),i=t.subjectCall,n=t.consultCall;return this.canTransferInternal(i,n)},t.prototype.transferConsultation=function(e){var t=this.getConsultation(e),i=t.subjectCall,n=t.consultCall,r=t.consultee,s=t.context;this.canTransferInternal(i,n)&&(this.callTransferService.transferCall(i,r,n),s&&s.scenario&&s.scenario.mark("transfer_consultation"))},t.prototype.endConsultation=function(e){var t=this.store.getCallConsultationInfo(e).consultCall;t&&(teamspace.services.CallUtilities.isCallActive(t)?this.callingService.leaveCall(t,this.constants.scenarios.calling.context.callConsultationService):this.logger.error("endConsultation() should not be called when the consult call is no longer active")),this.stopConsulting(e,"User initiated")},t.prototype.stopConsultingWithFailure=function(e,t,i){this.logger.error("Consultation failed ("+t+") with terminated reason("+i+") for call "+e),this.stopConsulting(e,t,i,!0)},t.prototype.stopConsulting=function(e,t,i,n){if(this.store.isSubjectCall(e)){this.logger.log("Consultation ended ("+t+") with terminated reason("+i+") for call "+e);var r=this.store.getCallConsultationInfo(e).context,s=r.scenario,a=r.eventingServiceSubscription,o=r.subjectCallSubscription,c=r.consultCallSubscription;if(s){var l=(p={},p[this.constants.counters.eventNames.reason]=t,p[this.constants.counters.eventNames.terminatedReason]=i,p);n?s.fail(l):s.stop(l)}a&&a.dispose(),o&&o.dispose(),c&&c.dispose(),this.store.resetConsultationState(e);var p}else this.logger.error("Cannot stop consulting for a non-subject call. Stop reason="+t+"), terminated reason="+i+", teamsCallId="+e)},t.prototype.determineConsultationType=function(e){return!e&&!this.settingsService.valueAsBoolean(this.constants.settings.names.forceAVCallConsultation)?r.IM:r.AV},t.prototype.isPstn=function(e){return e&&e.mri&&e.mri.startsWith(SkypeX.Services.ChatServiceUtils.PstnPrefix)},t.prototype.subscribeToSubjectCall=function(e){var t=this,i=e.on("callStateChanged",function(){t.updateCanTransfer(e),7===e.state&&(i.dispose(),t.onSubjectCallDisconnected(e))});return i},t.prototype.onSubjectCallDisconnected=function(e){var t=this.store.getCallConsultationInfo(e.teamsCallId).consultCall;this.stopConsulting(e.teamsCallId,"Subject call ended",e.terminatedReason);var i=this.callingService.getActiveCall();t&&i&&t.teamsCallId===i.teamsCallId&&this.callingNavigationService.navigateToCallScreen(t)},t.prototype.subscribeToConsultCall=function(e){var t=this,i=e.changed(function(){t.updateCanTransfer(e),7===e.state&&(i.dispose(),t.onConsultCallDisconnected(e))});return i},t.prototype.onConsultCallStarted=function(e,t){var i=this.subscribeToConsultCall(e);this.store.consultWithAV(t,e,{consultCallSubscription:i})},t.prototype.onConsultCallDisconnected=function(e){var t=this.store.getSubjectCallForConsult(e.teamsCallId);t?this.stopConsulting(t.teamsCallId,"Consult call ended",e.terminatedReason):this.logger.error("Could not find subject call for disconnected consult call "+e.teamsCallId)},t}(SkypeX.Services.SXStoreBase);t.CallConsultationService=s,angular.module("teamspace.callConsultationService",["teamspace.callConsultationStore","teamspace.constants","teamspace.loggingService","teamspace.callTogglingService","teamspace.callingNavigationService","teamspace.callingService","teamspace.callingTelemetryService","teamspace.callingUserActionService","teamspace.conversationsService","teamspace.dialogService","teamspace.settingsService","teamspace.callTransferService","teamspace.eventingService"]).service("callConsultationService",s)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r,s=teamspace.services.CallTransferServiceEvents,a=teamspace.services.CallTransferState,o=teamspace.services.TeamsCallService;!function(e){e[e.Blind=0]="Blind",e[e.Safe=1]="Safe",e[e.Consultative=2]="Consultative"}(r||(r={}));var c=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m){var f=e.call(this)||this;return f.constants=t,f.$timeout=i,f.$translate=n,f.eventingService=r,f.loggingService=s,f.ariaLiveService=a,f.callingService=o,f.callingTelemetryService=c,f.callingNavigationService=l,f.callTogglingService=p,f.dialogService=u,f.notificationsService=h,f.peopleService=d,f.settingsService=g,f.sxConfig=v,f.resources=m,f.transferorCall=null,f.transferTargetCall=null,f.transferorSubscription=null,f.callsBeingTransferred={},f.logger=f.loggingService.newLogger("CallTransferService"),f.eventingService.unsafeOn(f.constants.events.calling.callTransferred,function(e,t){f.logger.log("call transfer requested and initiated"),f.reset(),f.transferorCall=t.transferorCall,f.transferTargetCall=t.targetCall,f.transferorSubscription=f.transferorCall.on("callStateChanged",function(){return f.resetIfDisconnected()})}),f}return n(t,e),t.$inject=["constants","$timeout","$translate","eventingService","loggingService","ariaLiveService","callingService","callingTelemetryService","callingNavigationService","callTogglingService","dialogService","notificationsService","peopleService","settingsService","sxConfig","resources"],t.prototype.resetIfDisconnected=function(){7===this.transferorCall.state&&this.reset()},t.prototype.reset=function(){this.transferorCall=null,this.transferTargetCall=null,this.transferorSubscription&&(this.transferorSubscription.dispose(),this.transferorSubscription=null)},t.prototype.getTransferorCall=function(){return this.transferorCall},t.prototype.getTransferTargetCall=function(){return this.transferTargetCall},t.prototype.getCallTransferInfo=function(e){return this.callsBeingTransferred[e]||{transferState:a.None,transferTarget:null}},t.prototype.isCallTransferring=function(e){return this.getCallTransferInfo(e).transferState===a.Transferring},t.prototype.openCallTransferDialog=function(e,t,i){return 4!==e.state&&this.callTogglingService.toggleHold(e,t),this.loggingService.event(this.constants.scenarios.calling.callTransfer.openDialog,(n={},n[this.constants.counters.eventNames.callId]=e.callId,n[this.constants.counters.eventNames.context]=t,n)),this.dialogService.open(this.constants.dialogs.callTransfer,{call:e,darkMode:i});var n},t.prototype.determineTransferType=function(e){var t=!1;return this.settingsService.valueAsBoolean(this.constants.settings.names.forceBlindTransfer)&&(t=!0,this.logger.log("Forcing the use of blind transfer")),e?r.Consultative:t?r.Blind:r.Safe},t.prototype.prepareForConsultativeTransfer=function(e,t){var i=this;4!==t.state&&this.callTogglingService.toggleHold(t,this.constants.scenarios.calling.context.callTransferService);var n=e.changed(function(){3===e.transferState?(n.dispose(),i.callingService.leaveCall(t,i.constants.scenarios.calling.context.callTransferService)):4!==e.transferState&&7!==e.state||n.dispose()})},t.prototype.transferCall=function(e,t,i){var n=this,s=this.determineTransferType(i);this.logger.log("Transferring call "+e.teamsCallId+" using "+r[s]+" transfer");var o=s===r.Consultative,c=s===r.Safe||o;o&&this.prepareForConsultativeTransfer(e,i),this.callsBeingTransferred[e.teamsCallId]={transferState:a.None,transferTarget:t},this.setCallTransferState(e.teamsCallId,a.Transferring);var l=this.callingTelemetryService.newCallingScenario(e,this.constants.scenarios.calling.transferCall,(p={},p[this.constants.counters.eventNames.context]=this.constants.scenarios.calling.context.callTransferService,p[this.constants.scenarios.calling.context.transferTargetType]=t.type,p[this.constants.scenarios.calling.context.transferType]=r[s],p),this.constants.timeInMiliseconds.minute);this.ariaLiveService.update(this.$translate.instant(this.resources.strings.calling_callTransfer_aria_start),!0),(o?e.callConsultativeTransfer(i):c?e.callSafeTransfer(t.mri):e.transferCall(t.mri)).then(function(t){n.logger.log("Transfer Completed"),c&&(n.setCallTransferState(e.teamsCallId,a.Succeeded),n.ariaLiveService.update(n.$translate.instant(n.resources.strings.calling_transfer_succeeded),!0)),l.stop(),n.callingService.leaveCall(e,n.constants.scenarios.calling.context.callTransferService)}).catch(function(i){n.logger.error("Transfer Failed: "+i),c&&n.notifyTransferFailed(e,t),n.setCallTransferState(e.teamsCallId,a.Failed),n.callsBeingTransferred[e.teamsCallId].failureSubscription=e.on("callStateChanged",function(){n.resetCallTransferState(e.teamsCallId)}),l.fail((r={},r[n.constants.counters.eventNames.terminatedReason]=i,r));var r}),c&&this.$timeout(function(){return n.callingNavigationService.navigateOnTransferringCall(e)},500);var p},t.prototype.setCallTransferState=function(e,t){this.callsBeingTransferred[e].transferState=t,this.trigger(s.CallTransferStateChanged,o.getTeamsCallIdAsString(e))},t.prototype.resetCallTransferState=function(e){var t=this.callsBeingTransferred[e];if(t){var i=t.failureNotification,n=t.failureSubscription;i&&i.cancel(),n&&n.dispose(),delete this.callsBeingTransferred[e],this.trigger(s.CallTransferStateChanged,o.getTeamsCallIdAsString(e))}},t.prototype.notifyTransferFailed=function(e,t){var i=this;this.getTransferee(e).then(function(n){i.createTransferFailedNotification(e,t.displayName,n.displayName)})},t.prototype.getTransferee=function(e){var t=this.sxConfig.getCurrentSkypeMri(),i=e.participants.filter(function(e){return e.id!==t})[0];return this.peopleService.getPeopleProfile(i.id,"callTransferService")},t.prototype.createTransferFailedNotification=function(e,t,i){var n,r=this,s=function(){};this.callsBeingTransferred[e.teamsCallId]&&(n=99999);var a={title:this.$translate.instant(this.resources.strings.notification_call_transfer_failure_title,{actor:t}),message:this.$translate.instant(this.resources.strings.notification_call_transfer_failure_message,{actor:i}),type:teamspace.services.NotificationType.callTransferFailed,icon:this.constants.icons.notification.callTransferFailed,timeout:n,onNotificationShown:s,dismissAction:{action:s},primaryAction:{action:function(){r.callsBeingTransferred[e.teamsCallId]&&(r.callsBeingTransferred[e.teamsCallId].failureNotification=null,r.callingNavigationService.navigateToCallScreen(e))}},trackingType:this.constants.telemetry.notification.type.callTransferFailed},o=this.notificationsService.createNotificationWithActions(a);this.callsBeingTransferred[e.teamsCallId]&&(this.callsBeingTransferred[e.teamsCallId].failureNotification=o)},t}(SkypeX.Services.ObservableBase);t.CallTransferService=c,angular.module("teamspace.callTransferService",["teamspace.constants","teamspace.eventingService","teamspace.loggingService","teamspace.ariaLiveService","teamspace.callingService","teamspace.callingTelemetryService","teamspace.callingNavigationService","teamspace.callTogglingService","teamspace.dialogService","teamspace.notificationsService","teamspace.peopleService","teamspace.settingsService"]).service("callTransferService",c)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=teamspace.services.CallEscalationServiceEvents,s=teamspace.services.CallEscalationState,a=teamspace.services.TeamsCallService,o=function(e){function t(t,i,n,r,s,a,o,c){var l=e.call(this)||this;return l.loggingService=t,l.eventingService=i,l.constants=n,l.callingTelemetryService=r,l.$timeout=s,l.$translate=a,l.resources=o,l.conversationsService=c,l.callsBeingEscalated={},l.logger=l.loggingService.newLogger("CallEscalationService"),l}return n(t,e),t.$inject=["loggingService","eventingService","constants","callingTelemetryService","$timeout","$translate","resources","conversationsService"],t.prototype.getCallEscalationInfo=function(e){return this.callsBeingEscalated[e]||{escalationState:s.None,user:null}},t.prototype.onCallEscalationSucceeded=function(e){this.logger.info("Call escalation succeeded, call.callId: "+e.callId);var t=this.loggingService.findScenarioByNameAndId(this.constants.scenarios.calling.escalateOneToOneCall,a.getTeamsCallIdAsString(e.teamsCallId))||this.loggingService.findScenarioByNameAndId(this.constants.scenarios.calling.escalateOneToOneCallToPstn,a.getTeamsCallIdAsString(e.teamsCallId));t?t.stop():this.callingTelemetryService.newCallingScenario(e,this.constants.scenarios.calling.detectCallEscalationOnReceiver).stop(),this.setCallEscalationState(e.teamsCallId,s.Succeeded),this.eventingService.$emit(this.constants.events.calling.callEscalated,e),this.setCallStateSubscription(e)},t.prototype.onCallEscalationFailed=function(e){this.logger.info("Call escalation failed, call.callId: "+e.callId),this.setCallEscalationState(e.teamsCallId,s.Failed),this.setCallStateSubscription(e)},t.prototype.onCallEscalating=function(e,t,i){var n=this;this.logger.info("Escalating call, call.callId: "+e.callId),this.callsBeingEscalated[e.teamsCallId]={escalationState:s.None,user:t},this.setCallEscalationState(e.teamsCallId,s.Escalating),this.$timeout(function(){e&&!e.threadId&&(n.handleCallEscalationError(i,n.constants.scenarios.calling.reasons.timeout,n.$translate.instant(n.resources.strings.chat_provisioningDefaultError),e),n.onCallEscalationFailed(e))},.5*this.constants.timeConversion.numSecondInMinute*this.constants.timeConversion.numMsInSecond)},t.prototype.handleCallEscalationError=function(e,t,i,n){if(e&&t&&i&&n){this.logger.warn("handleCallEscalationError: call.callId: "+n.callId+", scenarioError: "+t+", errorDisplayedToUser: "+i),e.eventData[this.constants.counters.eventNames.terminatedReason]=t,e.fail();var r={content:i,isError:!0};this.eventingService.$emit(this.constants.events.calling.callEscalationFailed,{callId:n.callId,message:r})}},t.prototype.handleCallEscalation=function(e,t,i){var n=this,r=t?this.constants.scenarios.calling.escalateOneToOneCallToPstn:this.constants.scenarios.calling.escalateOneToOneCall,s=this.constants.scenarios.steps.calling.callEscalation,a={},o=this.callingTelemetryService.newCallingScenario(i,r,{data:JSON.stringify(a)});o.cancelIfOffline=!0;var c=(i.participants||[]).map(function(e){return e.id});c.push(e.mri);var l=this.conversationsService.getChatConversationWith(c);if(l&&l.id){a.chatId=l.id,o.mark(s.getChatConversation,{data:JSON.stringify(a)});var p=this.conversationsService.getCallingConversation(l.id);p.alive(),p.getId().then(function(t){a.newThreadId=t,o.mark(s.getNewThreadId,{data:JSON.stringify(a)});var r={teamsCallId:i.teamsCallId,user:e,threadId:t,scenario:o,eventData:a};n.logger.log("handleCallEscalation: escalating call with call id: "+i.callId+", user: "+e.mri+", threadId: "+r.threadId),n.onCallEscalating(i,e,o),n.eventingService.$emit(n.constants.events.calling.escalateCall,r)}).catch(function(e){n.handleCallEscalationError(o,"Error aliving conversation",n.$translate.instant(n.resources.strings.chat_provisioningDefaultError),i)}).finally(function(){p.dispose()})}else this.handleCallEscalationError(o,"Error creating conversation",this.$translate.instant(this.resources.strings.chat_provisioningDefaultError),i)},t.prototype.setCallEscalationState=function(e,t){this.callsBeingEscalated[e]||(this.callsBeingEscalated[e]={escalationState:s.None,user:null}),this.callsBeingEscalated[e].escalationState=t,this.trigger(r.CallEscalationStateChanged,a.getTeamsCallIdAsString(e))},t.prototype.setCallStateSubscription=function(e){var t=this,i=e.on("callStateChanged",function(){t.logger.info("Deleting call from callsBeingEscalated, call.callId: "+e.callId+", call.state: "+e.state),t.setCallEscalationState(e.teamsCallId,s.None),delete t.callsBeingEscalated[e.teamsCallId],i.dispose()})},t}(SkypeX.Services.ObservableBase);t.CallEscalationService=o,angular.module("teamspace.callEscalationService",["teamspace.constants","teamspace.eventingService","teamspace.loggingService","teamspace.conversationsService"]).service("callEscalationService",o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.subscriptions=e,this.participantSubscriptions=new Map}return e.prototype.addParticipantSubscription=function(e,t){this.participantSubscriptions.set(e,t)},e.prototype.deleteParticipantSubscription=function(e){var t=this.participantSubscriptions.get(e);t&&(t.dispose(),this.participantSubscriptions.delete(e))},e.prototype.participantSubscriptionExists=function(e){return this.participantSubscriptions.has(e)},e.prototype.destroy=function(){this.participantSubscriptions.forEach(function(e){e.dispose()}),this.participantSubscriptions.clear(),this.subscriptions.forEach(function(e){e&&e.dispose()})},e}(),r=teamspace.services.SessionUtils,s=function(){function e(e,t,i,n,r,s,a,o){this.constants=e,this.loggingService=t,this.settingsService=i,this.callingAlertsService=n,this.callingService=r,this.callingParticipantService=s,this.utilityService=a,this.callingTelemetryService=o,this.initialized=!1,this.logger=this.loggingService.newLogger("SharingArbiterService"),this.isSharingArbiterEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePowerPointVsScreenSharingArbiter),this.callsWithContentSharing=new Set,this.callsWithScreenSharing=new Set,this.watchedCalls=new Map,this.checkCallSharing=this.checkCallSharing.bind(this)}return e.$inject=["constants","loggingService","settingsService","callingAlertsService","callingService","callingParticipantService","utilityService","callingTelemetryService"],e.prototype.init=function(){var e=this;!this.initialized&&this.isSharingArbiterEnabled&&(this.initialized=!0,this.callingService.subscribe(function(){return e.onCallsChanged()}),this.callingParticipantService.subscribe(function(t,i){return e.onParticipantAdded(i.teamsCallId,i.participant)},teamspace.services.CallingParticipantServiceEvents.Type_CallParticipantAdded),this.callingParticipantService.subscribe(function(t,i){return e.onParticipantRemoved(i.teamsCallId,i.participantId)},teamspace.services.CallingParticipantServiceEvents.Type_CallParticipantRemoved))},e.prototype.addScreenSharingIfNotExist=function(e,t){var i=this;if(!this.callsWithScreenSharing.has(e)){this.logger.info("Adding "+(t?"local":"remote")+" screen sharing, teamsCallId: "+e),this.callsWithScreenSharing.add(e);var n=this.callingService.getCallByTeamsCallId(e);n?n.contentSharingSessions.forEach(function(s){if(r.isOutgoingSession(s)){var a=i.callingTelemetryService.newCallingScenario(n,i.constants.scenarios.contentSharing.pptSharingScreenSharingTerminate,{type:"screen"});try{i.logger.info("There is local content sharing in progress, going to stop it"),s.stopContentSharing().then(function(){t||i.callingAlertsService.sharingStolen(e),a.stop()}).catch(function(e){var t=teamspace.services.CallingTelemetryService.getErrorMessage(e);i.logger.error("An error occured while stopping content sharing: "+t),a.fail({reason:t})})}catch(e){var o=teamspace.services.CallingTelemetryService.getErrorMessage(e);i.logger.error("An unexpected error occured while terminating the local content sharing upon a new screen sharing session: "+o),a.fail({reason:o})}}}):this.logger.warn("Call "+e+" not found")}},e.prototype.removeScreenSharing=function(e){this.callsWithScreenSharing.delete(e)&&this.logger.info("Removed screen sharing, teamsCallId: "+e)},e.prototype.addContentSharingIfNotExist=function(e){var t=this;if(!this.callsWithContentSharing.has(e)){this.logger.info("Adding content sharing, teamsCallId: "+e),this.callsWithContentSharing.add(e);var i=this.callingService.getCallByTeamsCallId(e);if(i){if(i.isScreenSharingOn){var n=this.callingTelemetryService.newCallingScenario(i,this.constants.scenarios.contentSharing.pptSharingScreenSharingTerminate,{type:"content"});try{this.logger.info("There is local screen sharing in progress, going to stop it"),i.shareDesktop(this.constants.scenarios.calling.context.sharingArbiter).then(function(){t.callingAlertsService.sharingStolen(e),n.stop()}).catch(function(e){var i="An error occured while attempting to stop active screensharing: "+teamspace.services.CallingTelemetryService.getErrorMessage(e);t.logger.error(i),n.fail({reason:i})})}catch(e){var r="An error occured while terminating the local screen sharing upon a new content sharing session: "+teamspace.services.CallingTelemetryService.getErrorMessage(e);this.logger.error(r),n.fail({reason:r})}}}else this.logger.warn("Call "+e+" not found")}},e.prototype.removeContentSharing=function(e){this.callsWithContentSharing.delete(e)&&this.logger.info("Removed content sharing, teamsCallId: "+e)},e.prototype.checkCallSharing=function(e){var t=!1,i=!1,n=!1,r=this.callingService.getCallByTeamsCallId(e);r&&(i=(t=r.isScreenSharingOn)||_.some(r.participants,function(e){return _.some(e.streams[1],function(e){return e.isAvailable})}),n=r.contentSharingSessions.length>0),i?this.addScreenSharingIfNotExist(e,t):this.removeScreenSharing(e),n?this.addContentSharingIfNotExist(e):this.removeContentSharing(e)},e.prototype.onCallsChanged=function(){var e=this,t=this.callingService.getAllCalls();t.filter(function(t){return!e.watchedCalls.has(t.teamsCallId)}).forEach(function(t){var i=t.on("contentSharingChanged",function(){e.checkCallSharing(t.teamsCallId)}),r=t.on("userActivityChanged",function(){e.checkCallSharing(t.teamsCallId)});e.watchedCalls.set(t.teamsCallId,new n([i,r]))});var i=t.map(function(e){return e.teamsCallId});_.difference(Array.from(this.callsWithScreenSharing.keys()),i).forEach(function(t){e.removeScreenSharing(t)}),_.difference(Array.from(this.callsWithContentSharing.keys()),i).forEach(function(t){e.removeContentSharing(t)}),_.difference(Array.from(this.watchedCalls.keys()),i).forEach(function(t){e.watchedCalls.get(t).destroy(),e.watchedCalls.delete(t)})},e.prototype.onParticipantAdded=function(e,t){var i=this,n=this.watchedCalls.get(e);if(n){if(n.participantSubscriptionExists(t.id))this.logger.log("Received onParticipantAdded on a call "+e+" for participant "+t.id+" we are already observing.");else{var r=t.changed(function(){i.utilityService.deferOnce(i.checkCallSharing,e)});n.addParticipantSubscription(t.id,r)}this.utilityService.deferOnce(this.checkCallSharing,e)}else this.logger.log("Received onParticipantAdded on a call "+e+" which is not being watched")},e.prototype.onParticipantRemoved=function(e,t){var i=this.watchedCalls.get(e);i?(i.deleteParticipantSubscription(t),this.checkCallSharing(e)):this.logger.log("Received onParticipantRemoved on a call "+e+" which is not being watched")},e}();t.SharingArbiterService=s,angular.module("teamspace.sharingArbiterService",["teamspace.constants","teamspace.loggingService","teamspace.settingsService","teamspace.callingAlertsService","teamspace.callingService","teamspace.callingParticipantService","teamspace.utilityService"]).service("sharingArbiterService",s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(202),i(203),i(204),i(205),i(206),i(207),i(208)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S){var y=this;this.loggingService=e,this.dataManagerService=t,this.eventingService=i,this.constants=n,this.$q=r,this.$translate=s,this.appStateService=a,this.settingsService=o,this.chatServiceClient=c,this.conversationsService=l,this.conversationsStore=p,this.channelConversationAdapterService=u,this.exceptionUtilityService=h,this.notifyAfterSyncService=d,this.teamService=g,this.tenantService=v,this.searchHistoryService=m,this.resources=f,this.coachmarkEngine=S,this.currentTeamAndChannel=new teamspace.services.TeamChannelTuple(null,null),this.teamTypeEnumMapping={},this.teamConversationSyncState={},this.latestChannelVersionNumber=5,this.logger=this.loggingService.newLogger("ChannelService"),this.maxChannelsAllowed=this.settingsService.valueFor(this.constants.settings.names.maxChannelsAllowed)||100,this.is200ChannelsEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.is200ChannelsAllowed);var C=new teamspace.services.DataManagerOptions(n.urls.teams.type,function(e){return e.objectId});C.getAllUrl=n.urls.teams.get,C.createUrl=n.urls.teams.create,C.deleteUrl=n.urls.teams.delete,C.updateUrl=n.urls.teams.update,C.isTransient=!0,C.isResponseWrappedInValue=!0,C.overwriteExistingOnCreate=!0,C.usePutInsteadOfPatchForUpdates=!1,this.teamsDataManager=this.dataManagerService.registerManager(C);var b=new teamspace.services.DataManagerOptions(n.urls.teams.channelStatus.type,function(e){return e.objectId});b.isResponseWrappedInValue=!0,this.channelStatusDataManager=this.dataManagerService.registerManager(b);var T=new teamspace.services.DataManagerOptions(n.urls.channels.type,function(e){return e.objectId});T.createUrl=n.urls.channels.create,T.updateUrl=n.urls.channels.update,T.deleteUrl=n.urls.channels.delete,T.isTransient=!0,T.usePutInsteadOfPatchForUpdates=!0,T.isResponseWrappedInValue=!0,this.channelDataManager=this.dataManagerService.registerManager(T);var I=new teamspace.services.DataManagerOptions(n.urls.upgradeThreadAndConversations.type,function(){return n.urls.upgradeThreadAndConversations.type});I.isTransient=!0,I.isResponseWrappedInValue=!0,this.upgradeThreadDataManager=this.dataManagerService.registerManager(I);var w=new teamspace.services.DataManagerOptions(n.urls.channels.additionalprovisioning.type,function(){return n.urls.channels.additionalprovisioning.type});w.isResponseWrappedInValue=!1,w.isTransient=!0,this.additionalChannelProvisioningDataManager=this.dataManagerService.registerManager(w);var k=new teamspace.services.DataManagerOptions(n.urls.teams.joinCode.type,function(){return n.urls.teams.joinCode.type});this.teamJoinCodeDataManager=this.dataManagerService.registerManager(k),this.settingsService.valueAsBoolean(this.constants.settings.names.enableAtMentionsRosterSync)&&this.conversationsStore.subscribe(function(e,t){return y.syncChannelUpdatesFromConversation(t)},SkypeX.Services.ConversationsStoreEvents.Type_ConversationUpdated),this.teamTypeEnumMapping[0]=this.constants.teamType.standard,this.teamTypeEnumMapping[2]=this.constants.teamType.class,this.teamTypeEnumMapping[3]=this.constants.teamType.plc,this.teamTypeEnumMapping[4]=this.constants.teamType.staff,this.logger=this.loggingService.newLogger("ChannelService")}return e.$inject=["loggingService","dataManagerService","eventingService","constants","$q","$translate","appStateService","settingsService","chatServiceClient","conversationsService","conversationsStore","channelConversationAdapterService","exceptionUtilityService","notifyAfterSyncService","teamService","tenantService","searchHistoryService","resources","coachmarkEngine"],Object.defineProperty(e.prototype,"isChannelEditV2Enabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableEditChannelV2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isChannelDeletionV2Enabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableChannelDeletionV2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPrivateChannelsInTeamDashboardEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enablePrivateChannelsInTeamDashboard)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceThreadLatestVersion",{get:function(){var e=9;return this.settingsService.valueAsBoolean(this.constants.settings.names.enableBackfillAutoFollow)&&(e=10),e},enumerable:!0,configurable:!0}),e.prototype.setCurrentTeamAndChannel=function(e,t){this.currentTeamAndChannel=new teamspace.services.TeamChannelTuple(e,t)},e.prototype.getCurrentTeamAndChannel=function(){return this.currentTeamAndChannel},e.prototype.getTeamByName=function(e){var t=this;return this.getTeams().then(function(i){if(i&&i.length>0)for(var n=0;n<i.length;n++)if(i[n].displayName===e)return i[n];return t.logger.error("Team with the specified name was not found"),t.$q.reject(teamspace.services.ErrorPayload.create(teamspace.middletier.ApiResponseErrorType.ResourceNotFound,"Team with the specified name was not found.",404))})},e.prototype.getTeamWithName=function(e){var t=[];return this.getTeams().then(function(i){if(i&&i.length>0)for(var n=0;n<i.length;n++)i[n].displayName.toLowerCase().indexOf(e.toLowerCase())>=0&&t.push(i[n]);return t})},e.prototype.getTeamById=function(e){var t=this.getTeamByObjectId(e);return t?this.$q.when(t):(this.logger.error("Team id {0} was not found",e),this.$q.reject())},e.prototype.getAllChannelsInTeam=function(e,t){var i=this;if(!e)return this.$q.reject("[getAllChannelsInTeam] teamId is null");var n=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.getAllChannels),r=(c={},c[this.constants.scenarioDataPropNames.teamId]=e,c),s={Channels:[{Type:"standard",State:["deleted"]},{Type:"private",State:["deleted"]}]};t&&s.Channels[1].State.push("active");var a={url:this.constants.urls.channels.getAllChannels.replace("{teamId}",encodeURIComponent(e)),method:"PUT",data:JSON.stringify(s)},o=new teamspace.services.DataManagerRequestOptions;return o.isResponseWrappedInValue=!1,this.teamsDataManager.invoke(a,o).then(function(t){var s=t&&t.length||0;return i.loggingService.info("[getAllChannelsInTeam] Successfully fetched all {1} channels for team {0}",e,s),n.stop(r),t}).catch(function(t){return i.loggingService.error("[getAllChannelsInTeam] Failed to get channels for team {0}. Error message: {1}",e,t.message),n.fail(r),i.$q.reject(t)});var c},e.prototype.getDeletedChannelsInTeam=function(e){var t=this;if(!e)return this.$q.reject("[getDeletedChannelsInTeam] teamId is null");var i=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.getAllDeletedChannelsInTeam),n=(a={},a[this.constants.scenarioDataPropNames.teamId]=e,a),r={url:this.constants.urls.channels.getAllDeleted.replace("{teamId}",encodeURIComponent(e)),method:"GET"},s=new teamspace.services.DataManagerRequestOptions;return s.isResponseWrappedInValue=!1,this.teamsDataManager.invoke(r,s).then(function(r){var s=r&&r.length||0;return t.loggingService.info("[getDeletedChannelsInTeam] Successfully fetched {1} channels for team {0}",e,s),i.stop(n),r}).catch(function(r){return t.loggingService.error("[getDeletedChannelsInTeam] Failed to get channels for team {0}",e),i.fail(n),t.$q.reject(r)});var a},e.prototype.getSoftDeletedChannels=function(e){var t=this,i=[];if(e&&e.length||0){var n=moment().utc().valueOf();_.forEach(e,function(e){e.deleteTime&&n-e.deleteTime<=t.constants.channelSoftDeleteTimeInMs&&i.push(e)})}return i},e.prototype.getChannelWithName=function(e){var t=[];return this.getTeams().then(function(i){if(i&&i.length>0)for(var n=0;n<i.length;n++)for(var r=0;r<i[n].channels.length;r++)i[n].channels[r].displayName.toLowerCase().indexOf(e.toLowerCase())>=0&&t.push(i[n].channels[r]);return t})},e.prototype.getChannelById=function(e){var t=this.getChannelByObjectId(e);return t?this.$q.when(t):(this.logger.error("Channel with id = {0} - not found.",e),this.$q.reject())},e.prototype.getGeneralChannelName=function(e){var t=this.getChannelByObjectId(e);if(t){if(t.isGeneral)return t.displayName;e=t.parentTeamId}var i=this.getTeamByObjectId(e);return i?i.generalChannel.displayName:(this.logger.error("General channel not available for the team {0}",e),this.constants.channels.defaultChannelName)},e.prototype.getChannelCountByDisplayName=function(e){var t=this.channelConversationAdapterService.getChannelNameToIdsMapper();if(t){var i=t[e.toLowerCase()];if(i&&i.length>1)return i.length}return 0},e.prototype.waitForThreadToSync=function(e,t){var i=this.conversationsService.getConversation(e);return i?(i.detailsVersion&&-1!=i.detailsVersion?this.$q.when():this.notifyAfterSyncService.waitForConversationDetailsSync(e).toNgPromise(this.$q)).then(function(){return i}):(this.logger.error("Channel with converstionId - {0} - not found.",e),this.$q.reject("Conversation do not exist"))},e.prototype.getChannelByObjectId=function(e){return this.channelConversationAdapterService.getChannelById(e)},e.prototype.getTeamByObjectId=function(e){return this.channelConversationAdapterService.getTeamById(e)},e.prototype.updateChannelStatusFromServer=function(e,t,i){var n=this;if(!e||!t||!t.length)return this.$q.when();var r=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.openChannelOverflow);return this.performTeamConversationsSyncRecur(e,t).then(function(){r.stop({caller:i})},function(e){return n.exceptionUtilityService.failScenarioSelectively(r,e,{caller:i},[]),n.$q.reject(e)})},e.prototype.performTeamConversationsSyncRecur=function(e,t,i,n){var r=this;void 0===i&&(i=this.$q.defer()),void 0===n&&(n=0);var s=this.teamConversationSyncState[e];return this.chatServiceClient.getTeamConversations(e,s).toNgPromise(this.$q).then(function(s){if(!s._metadata.syncState&&!s.conversations)return i.resolve();s._metadata.syncState&&(r.teamConversationSyncState[e]=SkypeX.Services.ChatServiceUtils.decodeSyncState(s._metadata.syncState));for(var a=0;s.conversations&&a<s.conversations.length;a++)!function(e){if(t.indexOf(s.conversations[e].id)<0)return"continue";var i=new SkypeX.Services.SkypeConversationLocal(s.conversations[e]),n=r.conversationsService.getConversation(i.id);if(!n)return r.logger.warn("Conversation {0} do not exist locally for bold unbold",i.id),"continue";if(i.lastMessage&&i.lastMessageId){var a=parseInt(i.lastMessageId);if(isNaN(a)||!a)return"continue";var o=n.lastMessageId;(!o||NaN==parseInt(o)||parseInt(o)<a)&&r.conversationsStore.patchConversation(n.id,function(e){e.lastMessage=i.lastMessage,e.threadProperties&&!e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]&&(e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]=SkypeX.Services.ChatServiceUtils.ThreadType_Topic)})}}(a);if(s._metadata.backwardLink){if(n>=10)return r.logger.error("Recieved more than 10 continuous backward link. Skipping"),void i.reject(teamspace.services.ErrorPayload.create("Recieved more than 10 continuous backward link. Skipping"));n++,r.performTeamConversationsSyncRecur(e,t,i,n)}else i.resolve()},function(e){r.logger.error("Error while fetching team child conversations {0}",e),i.reject(e)}),i.promise},e.prototype.upgradeThreads=function(){var e=this,t=[];return this.getTeams().then(function(i){for(var n=0;n<i.length;n++){var r=i[n];e.isVersionOutOfDate(r.threadVersion,e.spaceThreadLatestVersion)&&t.push(r.objectId);for(var s=0;r.channels&&s<r.channels.length;s++){var a=r.channels[s];a.isJoined&&!a.isGeneral&&(e.isVersionOutOfDate(a.threadVersion,e.latestChannelVersionNumber)&&t.push(a.objectId))}}if(!t.length)return e.logger.info("No threads found for upgrade"),e.$q.when();var o=[],c=e.constants.urls.upgradeThreadAndConversations.maxThreadsSize;if(t.length)for(e.logger.warn("Threads found for upgrade {0}",t.length);t.length>0;)o.push(e.upgradeThreadsInternal(t.splice(0,Math.min(c,t.length))));return e.$q.all(o).then(function(){return null})})},e.prototype.upgradeThreadsInternal=function(e){var t=this,i=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.threadUpgrade),n={url:this.constants.urls.upgradeThreadAndConversations.updateThreads,method:"PUT",data:e};return this.upgradeThreadDataManager.invoke(n).then(function(){i.stop()},function(e){return t.exceptionUtilityService.failScenarioSelectively(i,e),t.$q.reject(e)})},e.prototype.isVersionOutOfDate=function(e,t){if(!e)return!0;if(e=="v"+t.toString())return!1;var i=e.split("v");if(2!=i.length)return this.logger.error("Error while parsing version "+e),!1;var n=parseInt(i[1]);return isNaN(n)?(this.logger.error("Error while parsing version. Unexpected version no. "+e),!1):n<t},e.prototype.getTeams=function(e){return this.channelConversationAdapterService.getTeams()},e.prototype.stripInvalidEmailCharacters=function(e){if(!e)return e;var t=/[^a-z0-9_]/gi;return e.replace(t,"")},e.prototype.getTeamAccessType=function(e){return e===this.constants.teams.visibility.private?1:3},e.prototype.validateTeamName=function(e,t,i,n,r,s){var a=this;if(!e)return this.$q.reject("[validateTeamName] teamName is empty");var o={displayName:e,displayNamePrefix:t,displayNameSuffix:i,mailNicknamePrefix:n,mailNicknameSuffix:r,groupId:s},c={url:this.constants.urls.teams.validate,method:"POST",data:o};return this.teamsDataManager.invoke(c).then(function(e){return a.logger.debug("teamName is valid"),!e.resultCode&&e.mailNickname?e.mailNickname:a.$q.reject(e)})},e.prototype.createTeam=function(e){var t={teamName:e,teamType:0,description:"",visibility:this.constants.teams.visibility.private,validationRequired:!1};return this.createTeamWithDescription(t)},e.prototype.createTeamWithDescription=function(e){var t=this;if(!e){var i="[createTeam] Invalid params";return this.logger.error(i),this.$q.reject(i)}if(!this.appStateService.isOnline)return this.logger.error("[createTeam] App is not online"),this.$q.reject(teamspace.services.ErrorPayload.create(this.constants.errorCodes.networkOffline));var n=this.teamService.shouldEnableTenantWideTeam();return this.teamService.verifyGroupsAccess().then(function(){if(n&&e.isTenantWide)return t.canCreateTenantWide()}).then(function(){var i={alias:e.mailNickName,displayName:e.teamName,displayNamePrefix:e.displayNamePrefix,displayNameSuffix:e.displayNameSuffix,description:e.description?e.description:"",classification:e.classification,validationRequired:e.validationRequired,isTenantWide:n&&e.isTenantWide};if(2!==e.teamType){var r=t.getTeamAccessType(e.visibility);i.accessType=r}0!==e.teamType&&(i.teamType=t.teamTypeEnumMapping[e.teamType]);var s=new teamspace.services.DataManagerRequestOptions;return s.isResponseWrappedInValue=!0,s.httpConfigModifier=function(e){e.counter=t.constants.counters.groupCreate},t.loggingService.info("[createTeamWithDescription] Creating a new team..."),t.teamsDataManager.create(i,s).then(function(i){return e.classification&&(i.classification=e.classification),t.teamService.ensureTeamInLocalCache(i)}).then(function(i){return t.loggingService.info('[createTeamWithDescription] Successfully created team with ID "{0}".',i.objectId),t.teamService.getAndStampTeamSmtpAddress(i.objectId),i.objectId&&t.eventingService.$emit(t.constants.events.channels.newChannel,{channel:i.objectId,isTeam:!0}),e.teamType&&(i.teamType=e.teamType),i},function(e){return t.loggingService.error("[createTeamWithDescription] Failed to create team - {0} ",e),t.$q.reject(e)})})},e.prototype.editTeam=function(e){var t=this;if(!e){var i="[editTeamPayload] Invalid params";return this.logger.error(i),this.$q.reject(i)}if(!e.newTeamName)return this.logger.error("[editTeam] InvalidCommandParameter: Team Name is undefined."),this.$q.reject(teamspace.services.ErrorPayload.create(this.constants.errorCodes.editTeamEmptyTeamName));if(!this.appStateService.isOnline)return this.logger.error("[editTeam] App is not online"),this.$q.reject(teamspace.services.ErrorPayload.create(this.constants.errorCodes.networkOffline));var n=this.teamService.shouldEnableTenantWideTeam(),r=!1;return this.getTeamById(e.teamId).then(function(i){return(r=n&&void 0!==e.isTenantWide&&void 0!==i.isTenantWide&&e.isTenantWide!==i.isTenantWide)&&e.isTenantWide?t.canCreateTenantWide(i):i}).then(function(i){var n=e.displayNamePrefix?e.displayNamePrefix+e.newTeamName:e.newTeamName;e.displayNameSuffix&&(n+=e.displayNameSuffix);var s=n!==i.displayName,a=e.newDescription!==i.description,o=e.newClassification!==i.classification,c=e.newVisibility!==i.visibility;if(!(s||a||o||c||r))return t.logger.error("[editTeam] InvalidCommandParameter: Neither team name/description nor team data/access type is changed"),t.$q.reject(teamspace.services.ErrorPayload.create(t.constants.errorCodes.editTeamInvalidInput));var l=t.loggingService.newScenario(t.constants.scenarios.teamAndChannel.groupUpdate),p=(d={},d[t.constants.scenarioDataPropNames.teamId]=e.teamId,d[t.constants.scenarioDataPropNames.data]=JSON.stringify({teamId:e.teamId,isTeamNameChanged:s,isTeamDescriptionChanged:a,isTeamClassificationChanged:o,isTeamVisibilityChanged:c,isTenantWideChanged:r}),d),u={displayName:s?e.newTeamName:void 0,description:a?e.newDescription:void 0,classification:o?e.newClassification:void 0,accessType:c?t.getTeamAccessType(e.newVisibility):void 0,isTenantWide:r?e.isTenantWide:void 0,displayNamePrefix:e.displayNamePrefix,displayNameSuffix:e.displayNameSuffix,validationRequired:e.validationRequired},h=new teamspace.services.DataManagerRequestOptions;return h.isResponseWrappedInValue=!0,h.httpConfigModifier=function(t){t.url=t.url.replace("{teamId}",encodeURIComponent(e.teamId))},t.teamsDataManager.update(u,h).then(function(i){l.stop(p),t.logger.info("Team {0} updated successful",e.teamId);var r=t.conversationsService.getConversation(e.teamId);return r?(t.conversationsStore.patchConversation(r.id,function(t){t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceThreadTopic]=n,t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicDescription]=e.newDescription,o&&(t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Classification]=e.newClassification),c&&(t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Visibility]=e.newVisibility)}),t.searchHistoryService.updateSearchHistory(e.teamId,e.newTeamName,"team"),i):(t.logger.warn("Conversation with id {0} do not exist after team update ",e.teamId),i)},function(e){return p[t.constants.scenarioDataPropNames.error]=JSON.stringify(e),t.exceptionUtilityService.failScenarioSelectively(l,e,p),t.logger.error("Error occured while updating team {0}",e),t.$q.reject(e)});var d})},e.prototype.restoreChannel=function(e){var t=this;if(!e)return this.logger.error("[restore channel] Invalid channel object id"),this.$q.reject("Invalid channel object id");var i={url:this.constants.urls.channels.restore.replace("{channelId}",encodeURIComponent(e)),method:"PUT"},n=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.restoreChannel);return this.channelDataManager.invoke(i).then(function(){return n.stop()}).catch(function(i){return t.logger.error('Restore of channel "'+e+'" failed.'),n.fail(),t.$q.reject(i)})},e.prototype.setDefaultChannel=function(e,t){var i=this,n=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.setDefaultChannel);if(!e)return this.logger.error("[set default channel] Invalid channel object id: '"+e+"'"),n.fail(),this.$q.reject("[set default channel] Invalid channel object id: '"+e+"'");if("boolean"!=typeof t)return this.logger.error("[set default channel] isFavDefault is not Boolean, but is of type "+typeof t),n.fail(),this.$q.reject("[set default channel] isFavDefault is not Boolean, but is of type "+typeof t);var r={url:this.constants.urls.teams.setDefaultChannel.replace("{channelThreadId}",e),method:t?"PUT":"DELETE"};return this.channelDataManager.invoke(r).then(function(e){return n.stop(),e}).catch(function(r){var s=i.getChannelByObjectId(e),a=s&&s.displayName,o={notificationData:{title:a?i.$translate.instant(i.resources.strings.update_fav_default_failure,{channelDisplayName:a}):i.$translate.instant(i.resources.strings.update_fav_default_failure_no_channel_object),timeout:!0,iconName:"icons-call-alert"}};return i.logger.error("Error trying to set channel (id: '"+e+"') isFavDefault property to '"+t+"'. Status: "+r.status+". Message: "+r._message),r.response.errorCode===i.constants.errorCodes.maxFavDefaultChannelLimitExceeded?n.incomplete():n.fail(),i.eventingService.$emit(i.constants.events.notifications.createNotification,o),i.$q.reject("Error trying to set channel (id: '"+e+"') isFavDefault property to '"+t+"'. Status: "+r.status+". Message: "+r._message)})},Object.defineProperty(e.prototype,"favDefaultChannelsLimit",{get:function(){return this.settingsService.valueFor(this.constants.settings.names.favDefaultChannelsLimit)},enumerable:!0,configurable:!0}),e.prototype.createChannel=function(e,t,i,n,r){var s=this;if(void 0===i&&(i=""),void 0===n&&(n=!1),void 0===r&&(r=teamspace.services.ChannelType.Regular),!t)return this.logger.error("[create channel] Invalid team object"),this.$q.reject("Invalid team");if(r===teamspace.services.ChannelType.Regular){var a=t.channels&&t.channels.length||0;if(this.is200ChannelsEnabled){var o=this.conversationsService.getConversation(t.objectId);a=o&&o.getTopicMinis().length||0}if(a>=this.maxChannelsAllowed)return this.logger.error("[create channel] max channel limit exceeded for team."),this.$q.reject(teamspace.services.ErrorPayload.create(this.constants.errorCodes.maxChannelLimitExceeded))}var c=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.channelAdd),l=(h={},h[this.constants.scenarioDataPropNames.teamId]=t.objectId,h),p={displayName:e,description:i,groupId:t.siteInfo&&t.siteInfo.groupId};r!==teamspace.services.ChannelType.Regular&&(p.channelType=teamspace.services.ChannelType[r].toLowerCase());var u=new teamspace.services.DataManagerRequestOptions;return u.isResponseWrappedInValue=!0,u.anchorMailbox=t.smtpAddress,u.httpConfigModifier=function(e){e.url=e.url.replace("{teamId}",encodeURIComponent(t.objectId))},this.channelDataManager.create(p,u).then(function(e){var i=e;return i.parentTeamId=t.objectId,s.coachmarkEngine.markCreateChannelAsSeen(),(r===teamspace.services.ChannelType.Regular?s.addChannelTopicToParentConversation(e,t):s.ensureSpecialChannelInLocalCache(i)).then(function(){var t=s.channelConversationAdapterService.getChannelById(e.objectId);return t?(i=t,t):(s.logger.error('"'+e.objectId+'" channel is not found in cache after client lie.'),e)},function(t){return s.logger.error('Error while updating "'+e.objectId+'" channel into cache.'),e}).finally(function(){l[s.constants.scenarioDataPropNames.threadId]=e.objectId,c.stop(l),c=null,s.eventingService.$emit(s.constants.events.channels.newChannel,{channel:i.objectId}),r===teamspace.services.ChannelType.Regular&&s.eventingService.$emit(s.constants.events.personalization.toggleFavoriteSettingForChannel,{channel:i,isFavorite:!0}),s.onNewlyCreatedChannel(i,t,n)})},function(e){return l[s.constants.scenarioDataPropNames.error]=JSON.stringify(e),s.exceptionUtilityService.failScenarioSelectively(c,e,l),c=null,s.logger.error("Error while updating channel : {0}",e),s.$q.reject(e)});var h},e.prototype.ensureSpecialChannelInLocalCache=function(e){var t=this,i=e.objectId;return this.conversationsService.getConversation(i)?this.$q.when():(this.logger.warn('[ensureSpecialChannelInLocalCache] Channel "'+i+"\" hasn't been sync'ed by long poll yet after being created."),this.conversationsStore.addOrUpdateConversation(this.createConversationLieForSpecialChannel(e)).then(function(){return t.channelConversationAdapterService.getChannelById(i)||t.logger.error('[ensureSpecialChannelInLocalCache] Linked channel "'+i+'" is not found in local cache.'),t.$q.when()}).catch(function(e){return t.logger.error('[ensureSpecialChannelInLocalCache] Failed to update localdb for linked channel "'+i+'".'),t.$q.when()}))},e.prototype.onNewlyCreatedChannel=function(e,t,i){var n=this;if(void 0===i&&(i=!1),e&&e.displayName&&t.siteInfo&&t.siteInfo.groupId&&t.siteInfo.siteUrl){var r={displayName:e.displayName,sharepointSiteUrl:t.siteInfo.siteUrl,groupId:t.siteInfo.groupId,notebookId:t.siteInfo.notebookId},s={url:this.constants.urls.channels.additionalprovisioning.additionalprovisioning.replace("{teamId}",encodeURIComponent(t.objectId)).replace("{channelId}",encodeURIComponent(e.objectId)),method:"PUT",data:JSON.stringify(r)};this.additionalChannelProvisioningDataManager.invoke(s).then(function(){n.logger.debug('Additional channel provisioning for "'+e.objectId+'" completed successfully.')},function(t){n.logger.error('Additional channel provisioning for "'+e.objectId+'" failed.')})}e&&e.objectId&&i&&this.setDefaultChannel(e.objectId,!0)},e.prototype.getTeamJoinCode=function(e){var t=this;if(!e)return this.$q.reject("[getTeamJoinCode] Invalid teamThreadId");var i={url:this.constants.urls.teams.joinCode.get.replace("{teamThreadId}",e),method:"GET",cache:!1},n=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.getTeamJoinCode),r=(s={},s[this.constants.scenarioDataPropNames.threadId]=e,s);return this.loggingService.info("[getTeamJoinCode] Getting team join code. TeamThreadId: {0}.",e),this.teamJoinCodeDataManager.invoke(i).then(function(i){return t.loggingService.info("[getTeamJoinCode] Successfully obtained team join code. TeamThreadId: {0}.",e),n.stop(r),i}).catch(function(i){var s=(i||{}).code;return r[t.constants.scenarioDataPropNames.error]=s,t.loggingService.error("[getTeamJoinCode] Failed to get team join code. TeamThreadId: {0}. ErrorCode: {1}.",e,s),n.fail(r),t.$q.reject(s)});var s},e.prototype.createTeamJoinCode=function(e){var t=this;if(!e)return this.$q.reject("[createTeamJoinCode] Invalid teamThreadId");var i={url:this.constants.urls.teams.joinCode.put.replace("{teamThreadId}",e),method:"PUT",cache:!1},n=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.createTeamJoinCode),r=(s={},s[this.constants.scenarioDataPropNames.threadId]=e,s);return this.loggingService.info("[createTeamJoinCode] Creating team join code. TeamThreadId: {0}.",e),this.teamJoinCodeDataManager.invoke(i).then(function(i){return t.loggingService.info("[createTeamJoinCode] Successfully created team join code. TeamThreadId: {0}.",e),n.stop(r),i}).catch(function(i){var s=(i||{}).code;return r[t.constants.scenarioDataPropNames.error]=s,t.loggingService.error("[createTeamJoinCode] Failed to create team join code. TeamThreadId: {0}. ErrorCode: {1}.",e,s),n.fail(r),t.$q.reject(s)});var s},e.prototype.deleteTeamJoinCode=function(e){var t=this;if(!e)return this.$q.reject("[deleteTeamJoinCode] Invalid teamThreadId");var i={url:this.constants.urls.teams.joinCode.delete.replace("{teamThreadId}",e),method:"DELETE",cache:!1},n=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.deleteTeamJoinCode),r=(s={},s[this.constants.scenarioDataPropNames.threadId]=e,s);return this.loggingService.info("[deleteTeamJoinCode] Deleting team join code. TeamThreadId: {0}.",e),this.teamJoinCodeDataManager.invoke(i).then(function(i){return t.loggingService.info("[deleteTeamJoinCode] Successfully deleted team join code. TeamThreadId: {0}.",e),n.stop(r),i}).catch(function(i){var s=(i||{}).code;return r[t.constants.scenarioDataPropNames.error]=s,t.loggingService.error("[deleteTeamJoinCode] Failed to delete team join code. TeamThreadId: {0}. ErrorCode: {1}.",e,s),n.fail(r),t.$q.reject(s)});var s},e.prototype.archiveOrUnarchiveTeam=function(e){var t=this;if(!e){var i="[archiveTeamPayload] Invalid params";return this.logger.error(i),this.$q.reject(i)}return e.teamId?this.getTeamById(e.teamId).then(function(i){if(!(e.isArchived!==i.isArchived))return t.logger.error("[archiveTeam] InvalidCommandParameter: ArchivalLevel of the team is not changed"),t.$q.reject(teamspace.services.ErrorPayload.create(t.constants.errorCodes.editTeamInvalidInput));var n=t.loggingService.newScenario(t.constants.scenarios.teamAndChannel.groupUpdate),r=(o={},o[t.constants.scenarioDataPropNames.teamId]=e.teamId,o[t.constants.scenarioDataPropNames.data]=JSON.stringify({teamId:e.teamId}),o),s=e.isArchived?t.constants.urls.teams.archive.replace("{teamId}",encodeURIComponent(e.teamId)):t.constants.urls.teams.unarchive.replace("{teamId}",encodeURIComponent(e.teamId));e.isArchived&&e.isSharepointEnabled&&(s=s.contains("?")?s.concat("&setMembersReadOnly=true"):s.concat("?setMembersReadOnly=true"));var a={url:s,method:"POST"};return t.teamsDataManager.invoke(a).then(function(i){return n.stop(r),t.logger.info("Team {0} updated successfully",e.teamId),t.createConversationLieForArchivedTeam(e),i}).catch(function(e){return r[t.constants.scenarioDataPropNames.error]=JSON.stringify(e),t.exceptionUtilityService.failScenarioSelectively(n,e,r),t.logger.error("Error occured while archiving/unarchiving team {0}",e),t.$q.reject(e)});var o}):(this.logger.error("[editTeam] InvalidCommandParameter: Team Id is undefined."),this.$q.reject(teamspace.services.ErrorPayload.create(this.constants.errorCodes.editTeamInvalidInput)))},e.prototype.createConversationLieForSpecialChannel=function(e){var t=this.getThreadPropertiesForSpecialChannelLie(e);return this.teamService.createConversationLieForTeam(e.objectId,t)},e.prototype.createConversationLieForArchivedTeam=function(e){var t=this.conversationsService.getConversation(e.teamId);{if(t)return this.conversationsStore.patchConversation(t.id,function(t){t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ArchivalLevel]=e.isArchived?SkypeX.Services.ChatServiceUtils.ThreadArchivalLevel_Space:SkypeX.Services.ChatServiceUtils.ThreadArchivalLevel_None});this.logger.error("Conversation with id {0} does not exist after team update ",e.teamId)}},e.prototype.getThreadPropertiesForSpecialChannelLie=function(e){var t={};return t[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceThreadTopic]=e.displayName,t[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType]=SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType_Standard,t[SkypeX.Services.ChatServiceUtils.ThreadProp_ParentSpaces]=this.generateSpaceTypesProperty(e),e.channelType&&e.channelType.toLowerCase()===teamspace.services.ChannelType[teamspace.services.ChannelType.Private].toLowerCase()&&(t[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceTypes]=teamspace.services.ChannelType.Private),t[SkypeX.Services.ChatServiceUtils.ThreadProp_LastJoinAt]=new Date(moment.utc().toISOString()).getTime(),t},e.prototype.generateSpaceTypesProperty=function(e){var t={linkedSpaceInfoItems:[{spaceThreadId:e.parentTeamId}]};return JSON.stringify(t)},e.prototype.deleteChannelInternal=function(e,t){var i=this,n=new teamspace.services.DataManagerRequestOptions;n.anchorMailbox=t.smtpAddress,n.httpConfigModifier=function(n){(i.isChannelDeletionV2Enabled||e.channelType===teamspace.services.ChannelType.Private)&&(n.url=i.constants.urls.channels.deletev2),n.url=n.url.replace("{teamId}",t.objectId),n.url=n.url.replace("{channelId}",e.objectId),n.counter=i.constants.counters.deleteChannel};var r=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.channelDelete),s=(a={},a[this.constants.scenarioDataPropNames.teamId]=t.objectId,a[this.constants.scenarioDataPropNames.threadId]=e.objectId,a[this.constants.scenarioDataPropNames.data]=JSON.stringify({teamId:t.objectId,channelId:e.objectId}),a);return this.channelDataManager.delete(e,n).then(function(t){return i.searchHistoryService.removeTeamOrChannelFromSearchHistory(e.objectId),e.channelType===teamspace.services.ChannelType.Private&&i.conversationsService.markThreadAsDeletedAndRemoveFromStore(e.objectId,!0),i.updateChannelTopicFromParentConversationForDelete(e).finally(function(){r.stop(s)})},function(t){return s[i.constants.scenarioDataPropNames.error]=JSON.stringify(t),i.exceptionUtilityService.failScenarioSelectively(r,t,s),i.logger.error("Cannnot delete channel {0} : {1}",e.objectId,t),i.$q.reject(t)});var a},e.prototype.updateChannelTopicForEdit=function(e,t,i){var n=this,r=e.objectId,s=this.conversationsService.getConversation(r);if(s){if(this.conversationsStore.patchConversation(s.id,function(s){var a=e.channelType===teamspace.services.ChannelType.Private?SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceThreadTopic:SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName;s.threadProperties[a]=t,s.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicDescription]=i,n.searchHistoryService.updateSearchHistory(r,t,"channel")}),e.channelType!==teamspace.services.ChannelType.Private){var a=this.conversationsService.getConversation(e.parentTeamId);if(!a)return;this.conversationsStore.patchConversation(a.id,function(i){var r=i.getTopicMinis(),s=r.filter(function(t){return t.id===e.objectId});if(!s||!s.length)return n.$q.when();s[0].name=t,i.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Topics]=JSON.stringify(r)})}}else this.logger.warn("Conversation with id {0} do not exist after channel update ",r)},e.prototype.updateChannelTopicFromParentConversationForDelete=function(e){var t=this,i=this.conversationsService.getConversation(e.parentTeamId);if(!i)return this.$q.when();var n=i.getTopicMinis().filter(function(t){return t.id===e.objectId});return n&&n.length?this.conversationsStore.patchConversation(i.id,function(t){var i=t.getTopicMinis();i.filter(function(t){return t.id===e.objectId})[0].isdeleted=!0,t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Topics]=JSON.stringify(i)}).then(function(){var i=t.loggingService.newScenario(t.constants.scenarios.sync.markThreadAsDead);return i.eventData={data:JSON.stringify({source:"channelService::updateChannelTopicFromParentConversationForDelete",id:e.objectId})},i.stop(),t.conversationsService.markThreadAsDeletedAndRemoveFromStore(e.objectId,!0)}):this.$q.when()},e.prototype.addChannelTopicToParentConversation=function(e,t){var i=this.conversationsService.getConversation(t.objectId);if(!i)return this.$q.when();var n=i.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Topics],r=n?JSON.parse(n):[],s=r.filter(function(t){return t.id===e.objectId});if(s&&s.length)return this.$q.when();this.logger.warn("ChannelService: Adding channel to the parent conversation as long poll hasn't come");var a={};return a.id=e.objectId,a.name=e.displayName,r.push(a),this.conversationsStore.patchConversation(i.id,function(e){e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Topics]=JSON.stringify(r)})},e.prototype.deleteTeam=function(e){var t=this;return this.getTeamById(e).then(function(i){var n=new teamspace.services.DataManagerRequestOptions;n.httpConfigModifier=function(i){i.url=i.url.replace("{teamId}",e),i.counter=t.constants.counters.groupDelete};var r=t.loggingService.newScenario(t.constants.scenarios.teamAndChannel.groupDelete),s=(a={},a[t.constants.scenarioDataPropNames.teamId]=i.objectId,a);return t.loggingService.info('[deleteTeam] Deleting team "{0}"...',e),t.searchHistoryService.removeTeamOrChannelFromSearchHistory(e),t.teamsDataManager.delete(i,n).then(function(i){t.loggingService.info('[deleteTeam] Successfully deleted team "{0}".',e);var n=t.loggingService.newScenario(t.constants.scenarios.sync.markThreadAsDead);return n.eventData={data:JSON.stringify({source:"channelService::deleteTeam",id:e})},t.conversationsService.markThreadAsDeletedAndRemoveFromStore(e,!0),n.stop(),r.stop(s),i},function(i){return t.loggingService.error('[deleteTeam] Failed to delete team "{0}".',e),s[t.constants.scenarioDataPropNames.error]=JSON.stringify(i),t.exceptionUtilityService.failScenarioSelectively(r,i,s),t.logger.error("Cannot delete team {0} : {1}",e,i),t.$q.reject(i)});var a},function(i){t.logger.error("Failed to find team "+e)})},e.prototype.deleteChannelById=function(e){var t=this.getParentTeamAndChannelByChannelId(e);return t?this.deleteChannelInternal(t.channel,t.team).then(function(e){return t.team}):(this.logger.error("Couldn't find the team and channel object for {0}",e),this.$q.reject("Couldn't find the team and channel object"))},e.prototype.editChannelV2=function(e,t,i,n){var r=this,s=this.getParentTeamAndChannelByChannelId(i);if(!s)return this.logger.error("Couldn't find the team and channel object for {0}",i),this.$q.reject("Couldn't find the team and channel object");var a=s.channel.displayName,o=n!==s.channel.isFavDefault?this.setDefaultChannel(i,n).catch(function(e){}):this.$q.resolve(),c=this.$q.resolve();if(e!==a||t!==s.channel.description){var l=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.channelEdit),p=(v={},v[this.constants.scenarioDataPropNames.teamId]=s.team.objectId,v[this.constants.scenarioDataPropNames.threadId]=s.channel.objectId,v[this.constants.scenarioDataPropNames.data]=JSON.stringify({isChannelNameChanged:e!==a,isChannelDescriptionChanged:t!==s.channel.description,isFavDefaultChanged:n!==s.channel.isFavDefault}),v),u=new teamspace.services.DataManagerRequestOptions;u.anchorMailbox=s.team.objectId;var h=this.constants.urls.channels.updatev2.replace("{teamId}",encodeURIComponent(s.team.objectId)).replace("{channelId}",encodeURIComponent(s.channel.objectId)),d={description:t!==s.channel.description?t:void 0};s.channel.displayName!=e&&(d.displayName=e);var g={url:h,method:"PATCH",data:d};c=this.channelDataManager.invoke(g,u).then(function(i){return l.stop(p),r.updateChannelTopicForEdit(s.channel,e,t),i}).catch(function(e){return p[r.constants.scenarioDataPropNames.error]=JSON.stringify(e),r.exceptionUtilityService.failScenarioSelectively(l,e,p),s.channel.displayName=a,r.logger.error('[editChannel] Failed to edit "'+s.channel.objectId+'" channel. Error: "'+e.message+'"'),r.$q.reject(e)})}return this.$q.all({favDefaultPromise:o,updatePromise:c});var v},e.prototype.editChannel=function(e,t,i,n){var r=this,s=this.getParentTeamAndChannelByChannelId(i);if(!s)return this.logger.error("Couldn't find the team and channel object for {0}",i),this.$q.reject("Couldn't find the team and channel object");if(this.isChannelEditV2Enabled||s.channel.channelType===teamspace.services.ChannelType.Private)return this.editChannelV2(e,t,i,n);var a=s.channel.displayName,o=n!==s.channel.isFavDefault?this.setDefaultChannel(i,n).catch(function(e){}):this.$q.resolve(),c=this.$q.resolve();if(e!==a||t!==s.channel.description){var l=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.channelEdit),p=(v={},v[this.constants.scenarioDataPropNames.teamId]=s.team.objectId,v[this.constants.scenarioDataPropNames.threadId]=s.channel.objectId,v[this.constants.scenarioDataPropNames.data]=JSON.stringify({isChannelNameChanged:e!==a,isChannelDescriptionChanged:t!==s.channel.description,isFavDefaultChanged:n!==s.channel.isFavDefault}),v),u=new teamspace.services.DataManagerRequestOptions;u.anchorMailbox=s.team.objectId,u.httpConfigModifier=function(e){e.url=e.url.replace("{teamId}",encodeURIComponent(s.team.objectId))};var h=s.channel.folderRelativeUrl?s.channel.folderRelativeUrl.substring(s.channel.folderRelativeUrl.indexOf(this.constants.files.strings.provisionedFolder)):"",d=s.team.siteInfo.siteUrl||"",g={description:t!==s.channel.description?t:void 0,channelId:s.channel.objectId,objectId:s.channel.objectId,SpoFolderRelativeUrl:h,SpoSiteUrl:d};s.channel.displayName!=e&&(g.displayName=e,g.isNameUpdated=!0),c=this.channelDataManager.update(g,u).then(function(i){return l.stop(p),r.updateChannelTopicForEdit(s.channel,e,t),i}).catch(function(e){return p[r.constants.scenarioDataPropNames.error]=JSON.stringify(e),r.exceptionUtilityService.failScenarioSelectively(l,e,p),s.channel.displayName=a,r.logger.error('[editChannel] Failed to edit "'+s.channel.objectId+'" channel. Error: "'+e.message+'"'),r.$q.reject(e)})}return this.$q.all({favDefaultPromise:o,updatePromise:c});var v},e.prototype.isForbiddenChannelName=function(e){return!e||e.toLowerCase()===this.constants.channels.defaultChannelName.toLowerCase()},e.prototype.isValidDisplayName=function(e,t){return!e.match(t)},e.prototype.resolveTeamAndChannel=function(e){var t=this;return angular.isString(e)?this.getTeams().then(function(i){var n=t.getParentTeamAndChannelByChannelId(e);return n||t.$q.reject("Couldn't find team and channel for the channel")}):(this.logger.error("Empty threadId"),this.$q.reject("Empty threadId"))},e.prototype.getParentTeamAndChannelByChannelId=function(e,t){void 0===t&&(t=!1);var i=this.getChannelByObjectId(e);if(!i)return t&&this.logger.error("Cannot find channel object for "+e),null;var n=this.getTeamByObjectId(i.parentTeamId);return n?new teamspace.services.TeamChannelTuple(n,i):(t&&this.logger.error("Cannot find team object for "+i.parentTeamId),null)},e.prototype.canCreateTenantWide=function(e){var t=this;return this.tenantService.canCreateTenantWide().then(function(i){return i?e:(t.logger.error("[canCreateTenantWide] Cannot create org wide team because tenant has greater than max number of members allowed"),t.$q.reject(teamspace.services.ErrorPayload.create(t.constants.errorCodes.canCreateTenantWideExceededMaxMemberLimitError)))},function(e){var i=(e||{}).status;return t.loggingService.error("[canCreateTenantWide] Cannot create org wide team, error status - {0} ",i),i===t.constants.responseCode.forbidden?t.$q.reject(teamspace.services.ErrorPayload.create(t.constants.errorCodes.canCreateTenantWideAuthenticationError)):t.$q.reject(teamspace.services.ErrorPayload.create(t.constants.errorCodes.canCreateTenantWideGenericError))})},e.prototype.syncChannelUpdatesFromConversation=function(e){var t=e.oldConversation,i=e.newConversation;if(t&&i){var n=void 0,r=void 0,s=!1;if(t.threadProperties&&(n=t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName]),i.threadProperties&&(r=i.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName],s=i.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_IsDeleted]&&"false"!==i.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_IsDeleted].toLowerCase()),r){var a=void 0,o=this.getParentTeamAndChannelByChannelId(i.id);if(o&&(a=o.team.objectId),n)n!==r?this.raiseUpdatedChannelNameEvent(a,n,r):s&&i.id&&this.eventingService.$emit(this.constants.events.channels.deletedChannel,i.id);else{var c={teamId:a,channelId:i.id,channelName:r};this.eventingService.$emit(this.constants.events.channels.syncNewChannel,c)}}}},e.prototype.raiseUpdatedChannelNameEvent=function(e,t,i){var n={teamId:e,oldChannelName:t,newChannelName:i};this.eventingService.$emit(this.constants.events.channels.updatedChannelName,n)},e}();t.ChannelServiceImplementation=n,angular.module("teamspace.channelService",["teamspace.constants","teamspace.config","teamspace.loggingService","teamspace.dataManagerService","teamspace.utilityService","teamspace.authenticationService","teamspace.eventingService","teamspace.settingsService","teamspace.conversationsService","skypeX.chatServiceClient","teamspace.exceptionUtilityService","teamspace.teamService","teamspace.tenantService","teamspace.searchHistoryService","teamspace.coachmarkEngine"]).service("channelService",n)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=SkypeX.Services.ChatServiceUtils,s=SkypeX.Services.ConversationsStoreEvents,a=SkypeX.Services.ObservableBase,o=function(e){function t(t,i,n,r){var s=e.call(this)||this;return s.constants=t,s.settingsService=i,s.conversationsStore=n,s.sxConfig=r,s.cache={},s}return n(t,e),t.$inject=["constants","settingsService","conversationsStore","sxConfig"],Object.defineProperty(t.prototype,"teams",{get:function(){return this.cache},enumerable:!0,configurable:!0}),t.prototype._startedTrackingKeyForType=function(e,t){this.hasSubscribers()||this.start()},t.prototype._stoppedTrackingKeyForType=function(e,t){this.hasSubscribers()||this.stop()},t.prototype.adaptConversation=function(e){var t,i=this.sxConfig.getCurrentSkypeMri(),n=e.totalUserCount();this.settingsService.valueAsBoolean(this.constants.settings.names.enableLargeTeams)||(n=_.filter(e.members,function(e){return e.id===i&&(t=e),!SkypeX.Services.ChatServiceUtils.isBotMri(e.id,!1)}).length);var s=e.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_Favorite];return{id:e.id,version:e.version,displayName:e.teamName(),description:e.threadProperties[r.ThreadProp_TopicDescription],memberCount:n,pictureETag:e.threadProperties[r.ThreadProp_PictureETag],accessType:r.mapAccessType(e.threadProperties[r.ThreadProp_Visibility]),teamSiteInformation:{groupId:e.threadProperties[r.ThreadProp_GroupId]},adminView:t&&t.role===this.constants.RoleConstants.Admin,isFavorite:!/false/i.test(s),userRole:t&&r.mapUserRole(t.role),isArchived:e.isTeamArchived()}},t.prototype.onConversationUpdate=function(e){this.updateCache(this.conversationsStore.dangerousGetConversationMutable(e))&&this.trigger(a.Type_All)},t.prototype.start=function(){var e=this;_.map(this.conversationsStore.dangerousGetAllConversationsMutable(),this.updateCache.bind(this)),this.trigger(a.Type_All),this.conversationsStoreSubscription=this.conversationsStore.subscribe(function(t){return e.onConversationUpdate(t)},s.Type_Conversation)},t.prototype.stop=function(){this.conversationsStore.unsubscribe(this.conversationsStoreSubscription),this.conversationsStoreSubscription=null,this.cache={}},t.prototype.updateCache=function(e){return!(!e||!e.isTeam())&&(e.isUserMember(this.sxConfig.getCurrentSkypeMri())?this.cache[e.id]=_.merge(this.cache[e.id]||{},this.adaptConversation(e)):this.cache[e.id]&&delete this.cache[e.id],!0)},t}(a);t.TeamManagementService=o,angular.module("teamspace.teamManagementService",["skypeX.conversationsStore","skypeX.sxConfig"]).service("teamManagementService",o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S,y,C){var b=this;this.$q=e,this.$qNoApply=t,this.$state=i,this.authenticationService=n,this.channelMembershipPropertiesService=r,this.channelService=s,this.chatServiceClient=a,this.constants=o,this.conversationsService=c,this.conversationsStore=l,this.dataManagerService=p,this.eventingService=u,this.exceptionUtilityService=h,this.freemiumUtilities=d,this.identityService=g,this.loggingService=v,this.peopleService=m,this.settingsService=f,this.sxConfig=S,this.teamMembershipPropertiesService=y,this.utilityService=C,this.rolesMap={};var T=new teamspace.services.DataManagerOptions(o.urls.transientData.type,function(e){return e.toString()});T.isTransient=!0,T.isResponseWrappedInValue=!1,this.transientDataManager=this.dataManagerService.registerManager(T),this.addMemberBatchSize=this.settingsService.valueFor(this.constants.settings.names.maxAddTeamMembersBatch)||this.constants.teams.settings.maxAddTeamMembersBatch,this.allowBotsInChannel=this.settingsService.valueAsBoolean(this.constants.settings.names.allowBotsInChannel),this.enableMuteStudentSetting=this.settingsService.valueAsBoolean(this.constants.settings.names.enableMuteStudentSetting),this.logger=this.loggingService.newLogger("TeamMembershipService"),this.addTeamUsersSemaphore=this.utilityService.createSemaphore(this.constants.teams.settings.maxAddTeamMembersParallelCalls),this.addChannelUsersSemaphore=this.utilityService.createSemaphore(this.constants.teams.settings.maxAddTeamMembersParallelCalls),this.curUserRole=this.identityService.isGuestUserType()?this.constants.RoleConstants.Guest:this.constants.RoleConstants.User,this.eventingService.unsafeOn(this.constants.events.channels.joinChannel,function(e,t){t.promise=b.joinChannel(t.channelId)}),this.rolesMap=(I={},I[this.constants.RoleConstants.Admin]=1,I[this.constants.RoleConstants.User]=0,I[this.constants.RoleConstants.Guest]=2,I),this.atMentionsRosterSyncEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enableAtMentionsRosterSync),this.atMentionsRosterSyncEnabled&&(this.conversationsUpdateToken=this.conversationsStore.subscribe(function(e,t){return b.syncTeamMemberUpdatesFromConversation(t)},SkypeX.Services.ConversationsStoreEvents.Type_ConversationUpdated)),this.eventingService.unsafeOn(this.constants.events.settings.updated,function(){var e=b.settingsService.valueAsBoolean(b.constants.settings.names.enableAtMentionsRosterSync);b.atMentionsRosterSyncEnabled?!e&&b.conversationsUpdateToken&&(b.conversationsStore.unsubscribe(b.conversationsUpdateToken),b.conversationsUpdateToken=null):e&&!b.conversationsUpdateToken&&(b.conversationsUpdateToken=b.conversationsStore.subscribe(function(e,t){return b.syncTeamMemberUpdatesFromConversation(t)},SkypeX.Services.ConversationsStoreEvents.Type_ConversationUpdated)),b.atMentionsRosterSyncEnabled=e});var I}return e.$inject=["$q","$qNoApply","$state","authenticationService","channelMembershipPropertiesService","channelService","chatServiceClient","constants","conversationsService","conversationsStore","dataManagerService","eventingService","exceptionUtilityService","freemiumUtilities","identityService","loggingService","peopleService","settingsService","sxConfig","teamMembershipPropertiesService","utilityService"],Object.defineProperty(e.prototype,"enableLargeTeams",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableLargeTeams)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"syncFrequencyInHours",{get:function(){return this.settingsService.valueFor(this.constants.settings.names.syncFrequencyInHours)},enumerable:!0,configurable:!0}),e.prototype.getTeamMembers=function(e,t,i,n){var r=this;if(void 0===t&&(t=!0),void 0===i&&(i=!1),this.enableLargeTeams)return this.loggingService.warn("TeamMembershipService: getTeamMembers from store/MT is deprecated as large teams is enabled."),this.$q.resolve([]);if(!e)return this.loggingService.error("TeamMembershipService: getTeamMembers - Passed in Team object is Null"),this.$q.reject("Passed Team Object is invalid");var s=this.conversationsService.getConversation(e);if(!s||!s.members)return this.loggingService.warn("PeopleService: getTeamMembers - Falling back to MT since there are no members on TeamObject"),this.getTeamMembersFromMT(e).then(function(s){var a=_.reduce(s,function(e,t){return e[t.mri]={role:t.role||r.constants.RoleConstants.User,isReader:t.isReader},e},{}),o=_.keys(a);return t&&(o=_.filter(o,function(e){return!r.isInterceptorBotMri(e)})),r.$q.all([r.addRemoveOrUpdateMembersInConversationObject(e,teamspace.services.TeamMemberAction.Add,s).catch(angular.noop),r.getResolvedPeopleProfiles(o,a,e,i,n).catch(angular.noop)]).then(function(){return s})});var a=this.filterAndGetMemberMris(s.members,t),o=this.mapMemberRoles(s.members);return this.getResolvedPeopleProfiles(a,o,e,i,n)},e.prototype.getTeamMembersFromCS=function(e,t,i,n,r,s){var a=this;return void 0===t&&(t=null),void 0===i&&(i=100),e?this.chatServiceClient.getTeamMembers(e,t,i,n,r,s).toNgPromise(this.$q).catch(function(e){return a.loggingService.error("TeamMembershipService: getTeamMembersFromCS - chatService returned error : "+JSON.stringify(e)),a.$q.reject("[getTeamMembersFromCS] chatService returned error : "+JSON.stringify(e))}):(this.loggingService.error("TeamMembershipService: getTeamMembersFromCS - Passed in Team object is Null"),this.$q.reject("Passed Team Object is invalid"))},e.prototype.getTeamMembersFromCsAndResolveProfiles=function(e,t,i,n,r,s){var a=this;if(void 0===t&&(t=null),void 0===i&&(i=100),!e)return this.loggingService.error("TeamMembershipService: getTeamMembersFromCsAndResolveProfiles - Passed in Team object is Null"),this.$q.reject("Passed Team Object is invalid");var o={};return this.chatServiceClient.getTeamMembers(e,t,i,n,r,s).toNgPromise(this.$q).then(function(t){var i=t.members;return o.nextLink=t.nextLink,o.totalMemberCount=t.totalMemberCount,a.getResolvedPeopleProfiles(a.filterAndGetMemberMris(i,!0),a.mapMemberRoles(i),e,!1,null)}).then(function(e){return o.members=e,o}).catch(function(e){return a.loggingService.error("TeamMembershipService: getTeamMembersFromCsAndResolveProfiles: "+JSON.stringify(e)),a.$q.reject(e)})},e.prototype.getResolvedPeopleProfiles=function(e,t,i,n,r){var s=this;return(n?this.peopleService.getAllPeopleProfile(e,"team-membership-service"):this.peopleService.getAllShortPeopleProfile(e,"team-membership-service",!1,r)).then(function(e){var n=e||[];return n.forEach(function(e){t&&t[e.mri]?(e.role=t[e.mri].role,e.isReader=t[e.mri].isReader):(e.role=s.constants.RoleConstants.User,s.logger.warn('[getTeamMembers] The role of "'+e.objectId+'" member is not found in Chat Service thread for "'+i+'" team.'))}),n},function(e){return s.loggingService.error("TeamMembershipService: getTeamMembers - failed getting the data from people service"),s.$q.reject(e)})},e.prototype.filterAndGetMemberMris=function(e,t){var i=this;return _.map(e,function(e){return e.id}).filter(function(e){return(SkypeX.Services.ChatServiceUtils.isUserMri(e)||SkypeX.Services.ChatServiceUtils.isBotMri(e,!1))&&!(t&&i.isInterceptorBotMri(e))})},e.prototype.mapMemberRoles=function(e){var t=this;return _.reduce(e,function(e,i){return e[i.id]={role:i.role||t.constants.RoleConstants.User,isReader:i.isReader},e},{})},e.prototype.getTeamMembersFromMT=function(e){var t=this,i=new teamspace.services.DataManagerRequestOptions;return i.anchorMailbox=e,i.httpConfigModifier=function(i){i.url=i.url.replace("{teamId}",encodeURIComponent(e)),i.headers[t.constants.headers.cache]=!0,i.counter=t.constants.counters.peopleGetTeamMembersMT},this.getTeamMembersDataManager().getAll(i)},e.prototype.updateTeamOwner=function(e,t,i){var n=this;return(i?this.isTeamOwnershipAvailable(e):this.isLastOwnerOfTeam(t.userPrincipalName,e)).then(function(){var r=t.role,s=i?n.constants.RoleConstants.Admin:n.constants.RoleConstants.User,a=n.loggingService.newScenario(n.constants.scenarios.teamAndChannel.editMemberPermission),o=(h={},h[n.constants.scenarioDataPropNames.teamId]=e,h[n.constants.scenarioDataPropNames.data]=JSON.stringify({memberMri:t.mri,oldRole:r,newRole:s}),h);t.userPrincipalName||(t.userPrincipalName=t.email),t.role=s,t.isOwner=i;var c=n.channelService.getTeamByObjectId(e),l=new teamspace.services.DataManagerRequestOptions;l.isResponseWrappedInValue=!1;var p={};p.updateType=i?teamspace.middletier.TeamMembershipUpdateType[teamspace.middletier.TeamMembershipUpdateType.Promoted]:teamspace.middletier.TeamMembershipUpdateType[teamspace.middletier.TeamMembershipUpdateType.Demoted],p.userPrincipalName=t.email||t.userPrincipalName,p.userMri=t.mri,p.groupId=c&&c.siteInfo&&c.siteInfo.groupId;var u={url:n.constants.urls.members.update.replace("{teamId}",encodeURIComponent(e)),method:"PUT",data:p,counter:n.constants.counters.channelUpdateUser};return n.addRemoveOrUpdateMembersInConversationObject(e,teamspace.services.TeamMemberAction.Update,[t]).finally(function(){return n.getTeamMembersDataManager().invoke(u,l).then(function(){a.stop(o)},function(i){return o[n.constants.scenarioDataPropNames.error]=JSON.stringify(i),n.exceptionUtilityService.failScenarioSelectively(a,i,o),t.role=r,t.isOwner=r===n.constants.RoleConstants.Admin,n.addRemoveOrUpdateMembersInConversationObject(e,teamspace.services.TeamMemberAction.Update,[t]).finally(function(){return n.$q.reject(i)})})});var h})},e.prototype.updateChannelOwner=function(e,t,i){var n=this;if(!e)return this.$q.reject("[updateChannelOwner] null channelId passed");var r=this.channelService.getChannelByObjectId(e);return r?(i?this.isChannelOwnershipAvailable(e):this.isLastOwnerOfChannel(t.userPrincipalName,e)).then(function(){var s=t.role,a=i?n.constants.RoleConstants.Admin:n.constants.RoleConstants.User,o=n.loggingService.newScenario(n.constants.scenarios.teamAndChannel.editMemberPermission),c=(h={},h[n.constants.scenarioDataPropNames.threadId]=e,h[n.constants.scenarioDataPropNames.data]=JSON.stringify({memberMri:t.mri,oldRole:s,newRole:a}),h);t.role=a,t.isOwner=i;var l=new teamspace.services.DataManagerRequestOptions;l.isResponseWrappedInValue=!1;var p={mri:t.mri,role:a},u={url:n.constants.urls.members.channel.update.replace("{teamId}",encodeURIComponent(r.parentTeamId)).replace("{channelId}",encodeURIComponent(e)).replace("{userId}",encodeURIComponent(t.mri)),method:"PATCH",data:p,counter:n.constants.counters.channelUpdateUser};return n.addRemoveOrUpdateMembersInConversationObject(e,teamspace.services.TeamMemberAction.Update,[t]).finally(function(){return n.transientDataManager.invoke(u,l).then(function(){o.stop(c)},function(i){return c[n.constants.scenarioDataPropNames.error]=JSON.stringify(i),n.exceptionUtilityService.failScenarioSelectively(o,i,c),t.role=s,t.isOwner=s===n.constants.RoleConstants.Admin,n.addRemoveOrUpdateMembersInConversationObject(e,teamspace.services.TeamMemberAction.Update,[t]).finally(function(){return n.$q.reject(i)})})});var h}):this.$q.reject("[updateChannelOwner] cant resolve the channel")},e.prototype.addTeamUsers=function(e,t,i){var n=this;if(!e||!t)return this.$q.reject(teamspace.services.ErrorPayload.create(this.constants.errorCodes.invalidTeamOrUser));if(!t.length)return this.$q.when({addedMembers:[],errors:[]});var r=this.conversationsService.getConversation(e.objectId),s=e.siteInfo&&e.siteInfo.groupId?e.siteInfo.groupId:r&&r.groupId?r.groupId:void 0;if(!s)return this.logger.error('[addTeamUsers] Unable to add members to team "{0}". Reason: no groupId is found.',e.objectId),this.$q.reject(teamspace.services.ErrorPayload.create("GetUserUnifiedGroupsFailed"));i||(i=this.convertUsersToUserCompact(t));var a=this.getMemberOwnerCounts(i);return this.isTeamOwnershipAvailable(e.objectId,a.ownerCount).then(function(){return n.isTeamMembershipAvailable(e.objectId,a.memberCount)}).then(function(){return n.addMemberInternal(e.objectId,t,i,"[addTeamUsers]",n.addTeamUsersSemaphore,n.addTeamUsersInternal(e,s,i),function(t){return n.addRemoveOrUpdateMembersInConversationObject(e.objectId,teamspace.services.TeamMemberAction.Add,t)})})},e.prototype.addChannelUsers=function(e,t,i,n){var r=this;if(!e||!t||!i)return this.$q.reject(teamspace.services.ErrorPayload.create(this.constants.errorCodes.invalidTeamOrUser));if(!i.length)return this.$q.when({addedMembers:[],errors:[]});n=this.convertUsersToUserCompact(i);var s=this.getMemberOwnerCounts(n);return this.checkForChannelLimits(t,s.ownerCount,s.memberCount).then(function(){return r.addMemberInternal(t,i,n,"[addChannelUsers]",r.addChannelUsersSemaphore,r.addChannelUsersInternal(e,t,n),function(e){return r.addRemoveOrUpdateMembersInConversationObject(t,teamspace.services.TeamMemberAction.Add,e)})})},e.prototype.isMemberOfTeam=function(e,t){return this.chatServiceClient.getMemberPropertiesIfInTeam(t,e).toNgPromise(this.$q).then(function(){return!0}).catch(function(e){if(404===e.statusCode)return!1;throw e})},e.prototype.addMemberInternal=function(e,t,i,n,r,s,a){var o=this,c=new Map,l=[];_.each(t,function(e){c.set(e.mri,e),l.push(e.mri)});var p=[],u=[],h=_.chunk(i,this.addMemberBatchSize),d=_.map(h,function(e){return r.acquireSemaphore().then(function(){return s}).then(function(e){u=_.concat(u,e.updatedUsers)}).catch(function(e){return p.push(e)}).finally(function(){return r.releaseSemaphore()})});return this.$q.all(d).then(function(){var t=o.settingsService.valueAsBoolean(o.constants.settings.names.enableAddMemberV2);if(p.length>=d.length)return o.logger.error('"'+n+'" Unable to add users into "'+e+'" team.'),o.$q.reject(p[0]);var i=[],r=[],s=[];return _.each(u,function(a){var l=c.get(a.value.mri);if(l)if(2!==a.resultCode&&"Error"!==a.resultCode)if(t&&"UserAlreadyExistsInTeam"===a.errorType)s.push(l);else{switch(a.value.role){case o.constants.RoleConstants.Admin:l.role=o.constants.RoleConstants.Admin,l.isOwner=!0;break;case o.constants.RoleConstants.Guest:l.role=o.constants.RoleConstants.Guest,l.isOwner=!1;break;default:l.role=o.constants.RoleConstants.User,l.isOwner=!1}i.push(l)}else o.logger.error(n+'" Unable to add "'+l.objectId+'" into "'+e+'" team. Error code: '+a.errorType+"."),r.push({user:l,error:teamspace.services.ErrorPayload.create(a.errorType)});else o.logger.warn(n+'" Unable to find user with mri of "'+SkypeX.Services.ChatServiceUtils.scrubMri(a.value.mri)+'".')}),a(i).catch(angular.noop).then(function(){return{addedMembers:i,errors:r,existingMembers:s}})})},e.prototype.checkForChannelLimits=function(e,t,i){var n=this;return this.isChannelOwnershipAvailable(e,t).then(function(){return n.isChannelMembershipAvailable(e,i)})},e.prototype.getMemberOwnerCounts=function(e){var t={memberCount:0,ownerCount:0};if(!e||!e.length)return t;for(var i=0;i<e.length;i++)1===e[i].role?t.ownerCount++:t.memberCount++;return t},e.prototype.convertUsersToUserCompact=function(e){var t=this;if(e){if(!e.length)return[];var i=[];return e.forEach(function(e){i.push({mri:e.mri,role:t.rolesMap[e.role]||0})}),i}},e.prototype.addTeamUsersInternal=function(t,i,n){var r=this,s=n.length<=e.addMemberMoreLimit?this.constants.scenarios.teamAndChannel.addMembers5:this.constants.scenarios.teamAndChannel.addMembersMore,a=this.loggingService.newScenario(s),o=(h={},h[this.constants.scenarioDataPropNames.teamId]=t.objectId,h[this.constants.scenarioDataPropNames.data]=JSON.stringify({usersCount:n.length}),h),c={users:n};i&&(c.groupId=i);var l=new teamspace.services.DataManagerRequestOptions;l.isResponseWrappedInValue=!0;var p=this.constants.urls.members.addRoledMultiple.replace("{teamMri}",encodeURIComponent(t.objectId)),u={url:p+=this.allowBotsInChannel?"?allowBotsInChannel=true":"",method:"PUT",data:c};return this.getTeamMembersDataManager().invoke(u,l).then(function(e){return a.stop(o),e},function(e){return o[r.constants.scenarioDataPropNames.error]=JSON.stringify(e),r.exceptionUtilityService.failScenarioSelectively(a,e,o),r.$q.reject(e)});var h},e.prototype.addChannelUsersInternal=function(t,i,n){var r=this,s=n.length<=e.addMemberMoreLimit?this.constants.scenarios.teamAndChannel.addMembers5:this.constants.scenarios.teamAndChannel.addMembersMore,a=this.loggingService.newScenario(s),o=(p={},p[this.constants.scenarioDataPropNames.teamId]=t,p[this.constants.scenarioDataPropNames.threadId]=i,p[this.constants.scenarioDataPropNames.data]=JSON.stringify({usersCount:n.length,targetType:"channel"}),p),c=new teamspace.services.DataManagerRequestOptions;c.isResponseWrappedInValue=!0;var l={url:this.constants.urls.members.channel.addRoledMultiple.replace("{teamId}",encodeURIComponent(t)).replace("{channelId}",encodeURIComponent(i)),method:"PUT",data:{value:n}};return this.getTeamMembersDataManager().invoke(l,c).then(function(e){return a.stop(o),e}).catch(function(e){return o[r.constants.scenarioDataPropNames.error]=JSON.stringify(e),r.exceptionUtilityService.failScenarioSelectively(a,e,o),r.$q.reject(e)});var p},e.prototype.verifyWhitelistedUsers=function(e,t){var i=this;return e&&t?t.length?this.authenticationService.getUserInformation().then(function(n){var r=_.reduce(t,function(e,t){return e[t.mri]=t,e},{}),s=_.keys(r),a={url:i.constants.urls.members.verify.whitelist.replace("{tenantId}",encodeURIComponent(n.profile.tid)),method:"POST",data:s},o=i.loggingService.newScenario(i.constants.scenarios.teamAndChannel.verifyWhitelistedUsers),c=(l={},l[i.constants.scenarioDataPropNames.teamId]=e.objectId,l[i.constants.scenarioDataPropNames.data]=JSON.stringify({userMRIsCount:s.length}),l);return i.getTeamMembersDataManager().invoke(a).then(function(t){var n=[],s=[];return _.each(t.users,function(t){var a=r[t.value.userMri];a&&(2!==t.resultCode?t.value.isWhitelisted?n.push(a):s.push({user:a,error:teamspace.services.ErrorPayload.create("UserNotFoundInWhitelist")}):(i.logger.error('[verifyWhitelistedUsers] Unable to verify whitelist status for user "'+a.objectId+'" against "'+e.objectId+'" team. Error code: '+t.errorType+"."),s.push({user:a,error:teamspace.services.ErrorPayload.create(t.errorType)})))}),o.stop(c),{whitelistedUsers:n,errors:s}},function(t){return i.logger.error('[verifyWhitelistedUsers] Failed to verify whitelist statuses for users against "'+e.objectId+'" team.'),c[i.constants.scenarioDataPropNames.error]=JSON.stringify(t),i.exceptionUtilityService.failScenarioSelectively(o,t,c),i.$q.reject(t)}).finally(function(){o=null});var l}):this.$q.when({whitelistedUsers:[],errors:[]}):this.$q.reject(teamspace.services.ErrorPayload.create(this.constants.errorCodes.invalidTeamOrUser))},e.prototype.removeTeamUser=function(e,t,i,n,r){var s=this;return void 0===r&&(r=this.constants.scenarios.teamAndChannel.removeMember),e&&(t||i)?this.channelService.getTeamById(e).then(function(a){return s.removeUserInternal(a,e,t,i,n,r)},function(e){return s.$q.reject(e)}):(this.logger.error("[removeTeamUser] Invalid team or user. Team: {0}",e),this.$q.reject(teamspace.services.ErrorPayload.create(this.constants.errorCodes.invalidTeamOrUser)))},e.prototype.removeChannelUser=function(e,t,i,n,r){var s=this;if(void 0===r&&(r=this.constants.scenarios.teamAndChannel.removeMember),!e||!t||!i&&!n)return this.$q.reject(teamspace.services.ErrorPayload.create(this.constants.errorCodes.invalidTeamOrUser));var a={url:this.constants.urls.members.channel.update.replace("{teamId}",encodeURIComponent(e)).replace("{channelId}",encodeURIComponent(t)).replace("{userId}",encodeURIComponent(n)),method:"DELETE"};return this.transientDataManager.invoke(a).then(function(){n==s.sxConfig.getCurrentSkypeMri()&&s.conversationsService.markThreadAsDeletedAndRemoveFromStore(t)}).catch(function(e){return s.logger.error("[removeUserInternal] Failed to leave the channel in MT. {0}",e),s.$q.reject(e)})},e.prototype.removeUserInternal=function(e,t,i,n,r,s){var a=this;return void 0===s&&(s=this.constants.scenarios.teamAndChannel.removeMember),this.verifyNotLastMember(e).then(function(){return a.demoteUserIfOwner(e,n)}).then(function(o){a.enableLargeTeams&&!o&&r&&(o={role:r});var c=a.loggingService.newScenario(s),l=(m={},m[a.constants.scenarioDataPropNames.teamId]=e.objectId,m[a.constants.scenarioDataPropNames.data]=JSON.stringify({memberMri:n}),m),p=new teamspace.services.DataManagerRequestOptions;p.isResponseWrappedInValue=!1,p.anchorMailbox=e.smtpAddress;var u=teamspace.middletier.TeamMembershipUpdateType[teamspace.middletier.TeamMembershipUpdateType.Left],h=a.teamMembershipPropertiesService.isAdmin(e.objectId);a.enableLargeTeams&&n===a.sxConfig.getCurrentSkypeMri()&&h&&(u=teamspace.middletier.TeamMembershipUpdateType[teamspace.middletier.TeamMembershipUpdateType.DemotedAndLeft]);var d={};d.teamMri=t,d.updateType=u,d.userPrincipalName=i,d.teamSmtpAddress=e.smtpAddress,d.userMri=n,e.siteInfo&&e.siteInfo.groupId&&(d.groupId=e.siteInfo.groupId);var g=a.constants.urls.members.update.replace("{teamId}",encodeURIComponent(t)),v={url:g+=a.allowBotsInChannel?"?allowBotsInChannel=true":"",method:"PUT",data:d,counter:a.constants.counters.channelDeleteUser};return a.getTeamMembersDataManager().invoke(v,p).then(function(){c.stop(l),a.logger.info("[removeUserInternal] MT call to remove user succeeded.");var i=o?[o]:null;return a.addRemoveOrUpdateMembersInConversationObject(e.objectId,teamspace.services.TeamMemberAction.Remove,i).catch(angular.noop).then(function(){if(a.$state.current.name===a.constants.states.appDiscover&&e.visibility===a.constants.teams.visibility.public&&0===e.teamType&&a.eventingService.$emit(a.constants.events.teams.removeMemberFromTeam),n==a.sxConfig.getCurrentSkypeMri()){var i=a.loggingService.newScenario(a.constants.scenarios.sync.markThreadAsDead);i.eventData={data:JSON.stringify({source:"teamMembershipService",id:t})},a.conversationsService.markThreadAsDeletedAndRemoveFromStore(t),i.stop()}})}).catch(function(e){return a.logger.error("[removeUserInternal] Failed to leave the team in MT. {0}",e),l[a.constants.scenarioDataPropNames.error]=JSON.stringify(e),a.exceptionUtilityService.failScenarioSelectively(c,e,l),a.$q.reject(e)});var m})},e.prototype.verifyNotLastMember=function(e){var t=this;return e?this.enableLargeTeams?1===this.teamMembershipPropertiesService.getTotalUserCount(e.objectId)?this.$q.reject(teamspace.services.ErrorPayload.create("OperationDeniedAsMemberIsLastMemberInTeam")):this.$q.resolve():this.getTeamMembers(e.objectId).then(function(e){if(1===e.length)return t.$q.reject(teamspace.services.ErrorPayload.create("OperationDeniedAsMemberIsLastMemberInTeam"))}):this.$q.reject("[teamMembershipService] Null source passed to verifyNotLastMember")},e.prototype.demoteUserIfOwner=function(e,t){var i=this;return this.enableLargeTeams?this.$q.resolve(null):e&&t?this.getTeamMembers(e.objectId).then(function(n){var r=_.find(n,function(e){return e.mri===t});return r&&(r.isOwner||r.role===i.constants.RoleConstants.Admin)?i.updateTeamOwner(e.objectId,r,!1).then(function(){return r}):r}):this.$q.reject("[teamMembershipService] Cant demote, null source or userMri passed")},e.prototype.joinChannel=function(e,t,i){var n,r=this;t&&(n=Math.ceil(Date.now()/1e3+teamspace.services.TeamMembershipExpirationDurationInSecond));var s=this.channelService.getChannelByObjectId(e);if(s&&s.isGeneral){o="caller attempted to join the general channel:"+s.objectId;return this.logger.warn(o),this.$q.reject(o)}if(s&&s.channelType===teamspace.services.ChannelType.Private){o="caller attempted to join private channel:"+s.objectId;return this.logger.warn(o),this.$q.reject(o)}var a=this.conversationsService.getConversation(e);if(a&&a.isChat()){o="caller attempted to join chat:"+a.id;return this.logger.warn(o),this.$q.reject(o)}if(SkypeX.Services.SkypeConversationLocal.isLie(e)){var o="caller attempted to join a lie:"+s.objectId;return this.logger.warn(o),this.$q.reject(o)}var c=(p={},p[this.constants.scenarioDataPropNames.data]=JSON.stringify({trigger:i,isTempJoin:t}),p),l=this.loggingService.newScenario(t?this.constants.scenarios.teamAndChannel.joinConversationWithExpiration:this.constants.scenarios.teamAndChannel.joinConversation);return this.chatServiceClient.addMemberToThread(e,this.sxConfig.getCurrentSkypeMri(),this.curUserRole,n,null,s.isFollowed).toNgPromise(this.$q).then(function(){l.stop(c)},function(t){var n=JSON.stringify(t);c[r.constants.scenarioDataPropNames.error]=n,r.loggingService.error("Couldn't Join the conversation "+e+" Trigger: "+i+" Error: "+JSON.stringify(t)),r.exceptionUtilityService.failScenarioSelectively(l,t,c,[])});var p},e.prototype.leaveChannel=function(e){return this.chatServiceClient.removeMemberFromThread(e,this.sxConfig.getCurrentSkypeMri()).toNgPromise(this.$q)},e.prototype.reconcileMyTeamMemberships=function(){var e=this,t=this.sxConfig.getCurrentSkypeMri();return this.channelService.getTeams().then(function(i){return _.filter(i,function(i){return e.isTemporarilyJoined(i,t)})}).then(function(i){var n=e.loggingService.newScenario(e.constants.scenarios.teamAndChannel.reconcileMyTeamMemberships),r={myMri:t};if(!i.length)return e.logger.log('[reconcileMyTeamMemberships] All memberships of currently logged-in user with MRI "'+t+'" are good.'),void n.cancel({data:JSON.stringify(r)});var s=_.map(i,function(t){var i=e.conversationsService.getConversation(t.objectId);return{threadId:t.objectId,groupId:i.groupId}});r.requestedTeams=s;var a={url:e.constants.urls.members.reconcilePermanentJoinMembership,method:"POST",data:s};return e.transientDataManager.invoke(a).then(function(){e.logger.log('[reconcileMyTeamMemberships] All memberships of currently logged-in user with MRI "'+t+'" are reconciled.'),n.stop({data:JSON.stringify(r)})}).catch(function(i){return r.error=i,e.logger.error('[reconcileMyTeamMemberships] Failed to reconcile memberships of currently logged-in user with MRI "'+SkypeX.Services.ChatServiceUtils.scrubMri(t)+'".'),n.fail({data:JSON.stringify(r)}),e.$q.reject(i)})})},e.prototype.syncMembersFromAAD=function(e){var t=this;return void 0===e&&(e=!1),this.channelService.getTeams().then(function(i){if(!(e||i&&0!=i.length))return t.$q.when();var n=Date.now(),r=i.filter(function(e){var i=!(!e.siteInfo||!e.siteInfo.groupId);if(i){var r=t.conversationsStore.getConversation(e.objectId),s=r&&r.threadProperties&&r.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastSyncTime],a=s&&parseInt(s);i=!a||_.isNaN(a)||n-a>t.constants.timeInMiliseconds.hour*t.syncFrequencyInHours,t.logger.debug("Sync status for conversation {0}. Last sync time {1}. Current time {2}. Will sync {3}",e.objectId,a,n,i)}return i}).map(function(e){return{threadId:e.objectId,groupId:e.siteInfo&&e.siteInfo.groupId,role:t.teamMembershipPropertiesService.isAdmin(e.objectId)?t.constants.RoleConstants.Admin.toLowerCase():void 0}});if(!r.length&&!e)return t.$q.when();var s=t.loggingService.newScenario(t.constants.scenarios.teamAndChannel.syncMembersFromAAD),a=new teamspace.services.DataManagerRequestOptions;a.isResponseWrappedInValue=!1;var o=r,c={url:t.constants.urls.members.syncFromAAD.update,method:"PUT",data:o};return t.transientDataManager.invoke(c,a).then(function(){s.stop()},function(e){return t.exceptionUtilityService.failScenarioSelectively(s,e,null,[]),t.$q.reject(e)})})},e.prototype.inviteUserToTeam=function(e,t,i,n){var r=this;if(void 0===n&&(n="guest"),!e||!i){this.logger.error("[inviteUserToTeam] Undefined email or team");s=teamspace.services.ErrorPayload.create("InvalidCommandParameter","Undefined input parameter.");return this.$qNoApply.reject(s)}if(!validator.isEmail(e)){this.logger.error("[inviteUserToTeam] Invalid email address");var s=teamspace.services.ErrorPayload.create("InvalidCommandParameter","Email address is invalid.");return this.$qNoApply.reject(s)}return this.isTeamMembershipAvailable(i.objectId,1).then(function(){return r.freemiumUtilities.getCanInviteMembers()}).then(function(s){var a={emailAddress:e,displayName:t,userType:n},o={url:(s?r.constants.urls.user.inviteUserToTeam.put:r.constants.urls.user.inviteGuest.put).replace("{teamId}",i.objectId).replace("{groupId}",i.siteInfo.groupId),method:"PUT",data:a},c=new teamspace.services.DataManagerRequestOptions,l=s?r.constants.scenarios.people.inviteToTeamAndTenant:r.constants.scenarios.people.inviteGuest,p=r.loggingService.newScenario(l);p.cancelIfOffline=!0;var u={tenantId:i.siteInfo.groupId,teamId:i.objectId,userMRI:null};return r.transientDataManager.invoke(o,c).then(function(t){var n=t.value;u.userMRI=n.mri;var a={invitedMember:n};switch(2!==t.resultCode&&"Error"!==t.resultCode?(r.logger.debug('[inviteUserToTeam] Successfully invited user into team with objectId: "{0}" and groupId: "{1}" with tenantInvite set to: {2}',i.objectId,i.siteInfo.groupId,s),p.stop((o={},o[r.constants.scenarioDataPropNames.data]=JSON.stringify(u),o))):(a.partialError=teamspace.services.ErrorPayload.create(t.errorType),r.logger.error("[inviteUserToTeam] Invitation partially failed with error {0}",t.errorType),p.fail((c={},c[r.constants.scenarioDataPropNames.data]=JSON.stringify(u),c[r.constants.scenarioDataPropNames.error]=JSON.stringify(t.errorType),c))),n.accountEnabled||(n.accountEnabled=!0),n.displayName||(n.displayName=n.email.substr(0,n.email.indexOf("@"))),n.userPrincipalName||(n.userPrincipalName=e),n.isOwner=!1,n.role){case r.constants.RoleConstants.Admin:n.userType=r.constants.userTypes.member,n.isOwner=!0;break;case r.constants.RoleConstants.Guest:n.userType=r.constants.userTypes.guest;break;default:n.role=r.constants.RoleConstants.User,n.userType=r.constants.userTypes.member}return 2!==t.resultCode&&"Error"!==t.resultCode?r.addRemoveOrUpdateMembersInConversationObject(i.objectId,teamspace.services.TeamMemberAction.Add,[n]).catch(angular.noop).then(function(){return a}):a;var o,c},function(e){return r.logger.error("[inviteUserToTeam] Failed to invite user. Error: {0}",e&&e.message||"unknown"),e&&e.response&&e.response.errorCode===r.constants.freemium.errorCodes.noAvailableLicenses?p.incomplete({message:"tenant out of available licenses: "+e.statusCode}):p.fail((t={},t[r.constants.scenarioDataPropNames.data]=JSON.stringify(u),t[r.constants.scenarioDataPropNames.error]=JSON.stringify(e),t)),r.$qNoApply.reject(e);var t})})},e.prototype.isLastOwnerOfTeam=function(e,t){return t?this.enableLargeTeams?this.teamMembershipPropertiesService.isAdmin(t)&&1===this.teamMembershipPropertiesService.getAdminCount(t)?this.$q.reject(teamspace.services.ErrorPayload.create("OperationDeniedAsMemberIsLastAdminInTeam")):this.$q.resolve():this.getIsLastOwnerFromMembers(t,e):this.$q.reject("Null team passed to isLastOwnerOfTeam")},e.prototype.isLastOwnerOfChannel=function(e,t){return t&&e?this.enableLargeTeams?this.channelMembershipPropertiesService.isAdmin(t)&&1===this.channelMembershipPropertiesService.getAdminCount(t)?this.$q.reject(teamspace.services.ErrorPayload.create("OperationDeniedAsMemberIsLastAdminInTeam")):this.$q.resolve():this.getIsLastOwnerFromMembers(t,e):this.$q.reject("Null channel or user passed to isLastOwnerOfChannel")},e.prototype.getIsLastOwnerFromMembers=function(e,t){var i=this;return this.getTeamMembers(e).then(function(e){if(!_.some(e,function(e){return(e.role==i.constants.RoleConstants.Admin||e.isOwner)&&e.userPrincipalName!==t}))return i.$q.reject(teamspace.services.ErrorPayload.create("OperationDeniedAsMemberIsLastAdminInTeam"))})},e.prototype.isTemporarilyJoined=function(e,t){var i=this.conversationsService.getConversation(e.objectId);return _.some(i.members,function(e){return e.id===t&&e.memberExpirationTime&&e.memberExpirationTime<SkypeX.Services.SkypeConversationLocal.MaxTimeStamp})},e.prototype.getTeamMembersDataManager=function(){if(!this.teamMembersDataManager){var e=new teamspace.services.DataManagerOptions(this.constants.urls.members.type,function(e){return e.userPrincipalName});e.getUrl=this.constants.urls.members.get,e.getAllUrl=this.constants.urls.members.getAll,e.updateUrl=this.constants.urls.members.update,e.usePutInsteadOfPatchForUpdates=!0,e.isTransient=!0,this.teamMembersDataManager=this.dataManagerService.registerManager(e)}return this.teamMembersDataManager},e.prototype.isTeamOwnershipAvailable=function(e,t){return void 0===t&&(t=0),this.enableLargeTeams?this.teamMembershipPropertiesService.getAdminCount(e)+t>this.constants.teams.settings.maxTeamOwners?this.$q.reject(teamspace.services.ErrorPayload.create("MaximumTeamOwnersLimitReached")):this.$q.resolve():this.getIsOwnershipAvailableFromMembers(e,t)},e.prototype.isChannelOwnershipAvailable=function(e,t){return void 0===t&&(t=0),this.enableLargeTeams?this.channelMembershipPropertiesService.getAdminCount(e)+t>this.constants.teams.settings.maxTeamOwners?this.$q.reject(teamspace.services.ErrorPayload.create("MaximumTeamOwnersLimitReached")):this.$q.resolve():this.getIsOwnershipAvailableFromMembers(e,t)},e.prototype.getIsOwnershipAvailableFromMembers=function(e,t){var i=this;return void 0===t&&(t=0),this.getTeamMembers(e).then(function(e){if(_.filter(e,function(e){return e.role===i.constants.RoleConstants.Admin||e.isOwner}).length+t>i.constants.teams.settings.maxTeamOwners)return i.$q.reject(teamspace.services.ErrorPayload.create("MaximumTeamOwnersLimitReached"))})},e.prototype.isChannelMembershipAvailable=function(e,t){void 0===t&&(t=0);var i=this.settingsService.valueFor(this.constants.settings.names.maxTeamSize);return this.enableLargeTeams?this.channelMembershipPropertiesService.getTotalUserCount(e,!1)+t>i?this.$q.reject(teamspace.services.ErrorPayload.create("MaximumTeamOwnersLimitReached")):this.$q.resolve():this.getIsMembershipAvailableFromMembers(e,t)},e.prototype.isTeamMembershipAvailable=function(e,t){void 0===t&&(t=0);var i=this.settingsService.valueFor(this.constants.settings.names.maxTeamSize);return this.enableLargeTeams?this.teamMembershipPropertiesService.getTotalUserCount(e,!1)+t>i?this.$q.reject(teamspace.services.ErrorPayload.create("MaximumTeamOwnersLimitReached")):this.$q.resolve():this.getIsMembershipAvailableFromMembers(e,t)},e.prototype.getIsMembershipAvailableFromMembers=function(e,t){var i=this;void 0===t&&(t=0);var n=this.settingsService.valueFor(this.constants.settings.names.maxTeamSize);return this.getTeamMembers(e).then(function(e){if(e.length+t>n)return i.$q.reject(teamspace.services.ErrorPayload.create("MaximumTeamMembersLimitReached"))})},e.prototype.addRemoveOrUpdateMembersInConversationObject=function(e,t,i){var n=this,r=this.conversationsService.getConversation(e);if(!r)return this.logger.warn("[addRemoveOrUpdateMembersInConversationObject] Conversation object and/or members are not found in the conversation adapter."),this.$q.when();var s={action:t,members:i,teamId:e},a=this.conversationsStore.patchConversation(r.id,function(e){switch(e.members||n.enableLargeTeams||(e.members=[]),t){case teamspace.services.TeamMemberAction.Add:n.addMembersInConversationObject(e,i);break;case teamspace.services.TeamMemberAction.Update:n.updateMembersInConversationObject(e,i);break;case teamspace.services.TeamMemberAction.Remove:n.removeMembersFromConversationObject(e,i);break;default:return n.logger.warn('[addRemoveOrUpdateMembersInConversationObject] Team member action of "'+t+'" is not supported.'),n.$q.reject()}});return this.atMentionsRosterSyncEnabled?a:a.finally(function(){n.eventingService.$emit(n.constants.events.teamMembers.teamMemberCacheRoleChange,s)})},e.prototype.addMembersInConversationObject=function(e,t){var i=this;if(this.enableLargeTeams){var n=e.rosterSummary;if(!n||!n.roleCounts)return;return _.each(t,function(e){switch(e.role){case i.constants.RoleConstants.Admin:n.roleCounts.Admin++;break;case i.constants.RoleConstants.Guest:n.roleCounts.Guest++;break;default:n.roleCounts.User++}n.memberCount++}),void(e.rosterVersion=e.rosterVersion+1)}var r={};_.each(e.members,function(e){r[e.id]=!0}),_.each(t,function(t){r[t.mri]||e.members.push({id:t.mri,role:t.role||i.constants.RoleConstants.User,isReader:!1})})},e.prototype.updateMembersInConversationObject=function(e,t){var i=this;if(this.enableLargeTeams){var n=e.rosterSummary;if(!n||!n.roleCounts)return;return _.each(t,function(e){e.role===i.constants.RoleConstants.Admin?(n.roleCounts.Admin++,n.roleCounts.User--):e.role===i.constants.RoleConstants.User&&(n.roleCounts.Admin--,n.roleCounts.User++)}),void(e.rosterVersion=e.rosterVersion+1)}var r={};_.each(t,function(e){r[e.mri]=e}),_.each(e.members,function(e){var t=r[e.id];t&&(e.role=t.role,e.isReader=t.isReader)})},e.prototype.removeMembersFromConversationObject=function(e,t){var i=this;if(this.enableLargeTeams){var n=e.rosterSummary;if(!n||!n.roleCounts)return;if(!t||!t.length)return;return _.each(t,function(e){switch(e.role){case i.constants.RoleConstants.Admin:n.roleCounts.Admin--;break;case i.constants.RoleConstants.Guest:n.roleCounts.Guest--;break;default:n.roleCounts.User--}n.memberCount--}),void(e.rosterVersion=e.rosterVersion+1)}var r={};_.each(t,function(e){r[e.mri]=e});for(var s=e.members.length;s--;){var a=e.members[s];r[a.id]&&e.members.splice(s,1)}},e.prototype.getChannelsRoster=function(e){if(!e||!e.length){var t={channels:[]};return this.$q.when(t)}var i=new teamspace.services.DataManagerRequestOptions;i.isResponseWrappedInValue=!0;var n={channels:e},r={url:this.constants.urls.members.channelsRoster.post,method:"POST",data:n};return this.transientDataManager.invoke(r,i)},e.prototype.isInterceptorBotMri=function(e){return this.constants.outgoingWebhooks.interceptorBotMris.some(function(t){return t===e})},e.prototype.syncTeamMemberUpdatesFromConversation=function(e){var t=this;if(!this.enableLargeTeams){var i=e.oldConversation,n=e.newConversation;if(i&&n){var r=i.members,s=n.members,a=[],o=[],c=[],l=i.teamId,p=n.teamId,u=this.channelService.getCurrentTeamAndChannel(),h=void 0;if(u&&u.team&&(h=u.team.objectId),h&&l&&p&&h===l&&l===p&&(i.isTeam()&&n.isTeam()||i.isLinkedChannel()&&n.isLinkedChannel())&&r&&s){for(var d={},g=0;g<s.length;g++)d[(f=s[g]).id]=f;for(var v={},g=0;g<r.length;g++)v[(S=r[g]).id]=S;for(var m in d)if(d.hasOwnProperty(m)){f=d[m];void 0===(S=v[m])?a.push(f.id):S.role&&f.role&&S.role!==f.role&&c.push(f.id)}for(var m in v)if(v.hasOwnProperty(m)){var f=d[m],S=v[m];void 0===f&&o.push(S.id)}var y=[];y=y.concat(a,o,c),this.peopleService.getAllShortPeopleProfile(y,"team-membership-service").then(function(e){var i=[],n=[],r=[];e.forEach(function(e){a.some(function(t){return t===e.mri})?i.push(e):o.some(function(t){return t===e.mri})?n.push(e):c.some(function(t){return t===e.mri})&&r.push(e)}),i.length>0&&t.raiseTeamMemberCacheRoleChangeEvent(p,teamspace.services.TeamMemberAction.Add,i),n.length>0&&t.raiseTeamMemberCacheRoleChangeEvent(p,teamspace.services.TeamMemberAction.Remove,n),r.length>0&&t.raiseTeamMemberCacheRoleChangeEvent(p,teamspace.services.TeamMemberAction.Update,r)})}}}},e.prototype.raiseTeamMemberCacheRoleChangeEvent=function(e,t,i){var n={action:t,members:i,teamId:e};this.eventingService.$emit(this.constants.events.teamMembers.teamMemberCacheRoleChange,n)},e.addMemberMoreLimit=5,e}();t.TeamMembershipServiceImplementation=n,angular.module("teamspace.teamMembershipService",["teamspace.peopleService","teamspace.exceptionUtilityService","teamspace.utilityService","teamspace.identityService","teamspace.freemiumUtilities","teamspace.teamMembershipPropertiesService"]).service("teamMembershipService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S,y){var C=this;this.$q=e,this.$timeout=t,this.channelConversationAdapterService=i,this.constants=n,this.conversationsService=r,this.conversationsStore=s,this.dataManagerService=a,this.eventingService=o,this.exceptionUtilityService=c,this.settingsService=l,this.localizationService=p,this.loggingService=u,this.blobUrlCacheService=h,this.usersGroupsSettingsService=d,this.groupSpecificSettingsService=g,this.userResourcesSettingsStore=v,this.identityService=m,this.scopedPeopleSearchService=f,this.skypeModelFactory=S,this.sxConfig=y,this.cachedModernGroups=[],this.teamNameProperties=null,this.logger=this.loggingService.newLogger("TeamService");var b=new teamspace.services.DataManagerOptions(n.urls.teams.getAndStampSmtpAddress.type,function(e){return e});b.isResponseWrappedInValue=!1,b.isTransient=!0,this.getAndStampTeamSmtpAddressDataManager=this.dataManagerService.registerManager(b);var T=new teamspace.services.DataManagerOptions(n.urls.teams.transient.type,function(e){return e.objectId});T.isResponseWrappedInValue=!1,T.isTransient=!0,this.transientDataManager=this.dataManagerService.registerManager(T);var I=new teamspace.services.DataManagerOptions(n.urls.teams.settings.type,function(e){return e.avatar});I.isResponseWrappedInValue=!1,I.isTransient=!0,this.personalizationSettingsDataManager=this.dataManagerService.registerManager(I),this.settingsService.valueAsBoolean(this.constants.settings.names.enableAtMentionsRosterSync)&&this.conversationsStore.subscribe(function(e,t){return C.syncTeamUpdatesFromConversation(t)},SkypeX.Services.ConversationsStoreEvents.Type_ConversationUpdated),this.isTeamPictureV2Enabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTeamPictureV2);var w=new teamspace.services.DataManagerOptions(this.constants.urls.teams.officeGroup.type,function(e){return""});w.isResponseWrappedInValue=!1,w.isTransient=!0,this.officeGroupDataManager=this.dataManagerService.registerManager(w)}return e.$inject=["$q","$timeout","channelConversationAdapterService","constants","conversationsService","conversationsStore","dataManagerService","eventingService","exceptionUtilityService","settingsService","localizationService","loggingService","blobUrlCacheService","usersGroupsSettingsService","groupSpecificSettingsService","userResourcesSettingsStore","identityService","scopedPeopleSearchService","skypeModelFactory","sxConfig"],e.prototype.isTeamProfilePictureV2Enabled=function(){return this.isTeamPictureV2Enabled},e.prototype.reconcileTeam=function(e){var t=this,i=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.reconcileTeam),n=e.teamStatus.exchangeTeamCreationStatus,r=e.teamStatus.exchangeTeamCreationErrorCode;e.teamStatus.exchangeTeamCreationStatus=0,e.teamStatus.exchangeTeamCreationErrorCode=0;var s={url:this.constants.urls.teams.transient.reconcileTeam.replace("{teamId}",e.objectId),method:"POST",counter:this.constants.counters.teamReconcile};return this.transientDataManager.invoke(s).then(function(){i.stop()},function(s){return e.teamStatus.exchangeTeamCreationStatus=n,e.teamStatus.exchangeTeamCreationErrorCode=r,t.exceptionUtilityService.failScenarioSelectively(i,s),t.$q.reject(s)})},e.prototype.getAndStampTeamSmtpAddress=function(e){var t={url:this.constants.urls.teams.getAndStampSmtpAddress.putTeamSmtpAddress.replace("{teamThreadId}",e),method:"PUT",counter:this.constants.counters.teamReconcile};return this.getAndStampTeamSmtpAddressDataManager.invoke(t)},e.prototype.getPersonalizationSettings=function(e){var t=this,i={url:this.constants.urls.teams.settings.get.replace("{teamId}",e),method:"GET"};return this.personalizationSettingsDataManager.invoke(i).then(function(e){return e},function(e){return t.logger.error("failed when getting team personalization: {0}",e),t.$q.reject(e)})},e.prototype.setPersonalizationSettings=function(e,t){var i=this,n={url:this.constants.urls.teams.settings.patch.replace("{teamId}",e),method:"PATCH",data:t},r=this.logger.service.newScenario(this.constants.scenarios.teamAndChannel.personalizeTeam);return this.personalizationSettingsDataManager.invoke(n).then(function(e){return r.stop(),e},function(e){return r.fail({errorInfo:e}),i.logger.error("failed when setting team personalization: {0}",e),i.$q.reject(e)})},e.prototype.verifyGroupsAccess=function(){var e=this;return this.getMyGroupsSettings().then(function(t){if(!t||!t.isUserAllowedToCreateTeam)return e.logger.error("[verify user settings] user is not authorized"),e.$q.reject(teamspace.services.ErrorPayload.create(e.constants.errorCodes.userNotPartOfSGToCreateTeam))},function(){return e.logger.error("[verify user settings] user is not authorized"),e.$q.reject(teamspace.services.ErrorPayload.create(e.constants.errorCodes.userNotPartOfSGToCreateTeam))})},e.prototype.getMyGroupsSettings=function(){return this.usersGroupsSettingsService.getMyGroupsSettings()},e.prototype.getGroupSpecificSettings=function(e){return this.groupSpecificSettingsService.getGroupSpecificSettings(e)},e.prototype.getModernGroups=function(e){var t=this;if(this.identityService.isGuestUserType())return this.$q.reject(null);var i,n=this.$q.defer();switch(e){case 0:i=this.constants.teamType.standard;break;case 1:i=this.constants.teamType.edu;break;case 3:i=this.constants.teamType.plc;break;default:i=null}var r={url:this.constants.urls.teams.transient.getModernGroups.replace("{teamType}",i),method:"GET",counter:this.constants.counters.getModernGroups},s=this.sxConfig.getCurrentSkypeMri(),a=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.getModernGroups),o={loggedInUserMRI:s};return this.transientDataManager.invoke(r).then(function(e){a.stop({data:JSON.stringify(o)}),t.cachedModernGroups=e,n.resolve(t.cachedModernGroups)},function(e){o.error=e,t.exceptionUtilityService.failScenarioSelectively(a,e,{data:JSON.stringify(o)}),t.logger.error('[getModernGroups] Unable to get the private Mordern Groups of current logged-in user "'+SkypeX.Services.ChatServiceUtils.scrubMri(s)+'".'),n.reject(e)}),this.$timeout(function(){return n.notify(t.cachedModernGroups)}),n.promise},e.prototype.migrateModernGroup=function(e,t){var i=this;if(!e||!e.groupId)return this.$q.reject(teamspace.services.ErrorPayload.create("InvalidCommandParameter","Invalid group"));var n={description:e.description||"",displayName:e.displayName,smtpAddress:e.smtpAddress,teamType:t},r={url:this.constants.urls.teams.transient.migrateModernGroup.replace("{groupId}",e.groupId),method:"PUT",data:n,counter:this.constants.counters.migrateModernGroup},s=new teamspace.services.DataManagerRequestOptions;s.isResponseWrappedInValue=!0;var a=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.migrateModernGroup),o={loggedInUserMri:this.sxConfig.getCurrentSkypeMri(),groupId:e.groupId};return this.transientDataManager.invoke(r,s).then(function(e){return i.ensureTeamInLocalCache(e)}).then(function(e){return e.objectId&&i.eventingService.$emit(i.constants.events.channels.newChannel,{channel:e.objectId,isTeam:!0,isMigration:!0}),a.stop({data:JSON.stringify(o)}),e}).catch(function(t){return o.error=t,i.exceptionUtilityService.failScenarioSelectively(a,t,{data:JSON.stringify(o)}),i.logger.error('[migrateModernGroup] Unable to migrate the Mordern Group with groupId "'+e.groupId+'" to Microsoft Teams.'),i.$q.reject(t)})},e.prototype.isValidDisplayName=function(e){return!!e&&(!!this.settingsService.valueAsBoolean(this.constants.settings.names.allowSpCharsOnTeamName)||!e.match(this.constants.teams.invalidDisplayNameRegEx))},e.prototype.getTeamPicture=function(e,t,i,n){var r=this;if(!e)return this.logger.error("Invalid groupId passed to getTeamPicture"),this.$q.reject(teamspace.services.ErrorPayload.create("InvalidCommandParameter"));i||this.logger.error("displayName not present for the team with groupId:{0}",e);var s=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.getTeamPicture),a=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTeamPictureCachingInNgHttp),o={scrubbedUrl:this.settingsService.valueFor(this.constants.settings.names.middleTierConstants).newEndpointAddressImg+this.constants.urls.teams.picture.get,url:this.settingsService.valueFor(this.constants.settings.names.middleTierConstants).newEndpointAddressImg+this.constants.urls.teams.picture.get.replace("{teamGroupId}",e).replace("{etag}",t).replace("{displayName}",i),method:"GET",cache:a},c=new teamspace.services.DataManagerRequestOptions;return c.isResponseWrappedInValue=!0,c.skipApply=!!n,c.responseType=this.constants.http.responseType.string,this.transientDataManager.invoke(o,c).then(function(e){return s.stop((t={},t[r.constants.scenarioDataPropNames.data]=JSON.stringify({imageSize:e.length}),t)),r.constants.pictureLoad.mimeJpeg+e;var t},function(e){return r.logger.error("failed when getting team picture:{0}",e),s.fail((t={},t[r.constants.scenarioDataPropNames.error]=e,t)),r.constants.pictureLoad.mimeJpeg+r.constants.pictureLoad.defaultGroupImageSvg;var t})},e.prototype.getTeamInitialsPicture=function(e){var t=this;if(!e)return this.logger.error("A displayName is needed to generate the team initials picture"),this.$q.reject();var i=new teamspace.services.DataManagerRequestOptions;i.isResponseWrappedInValue=!0,i.responseType=this.constants.http.responseType.string;var n={scrubbedUrl:this.constants.urls.teams.picture.getDefaultPicture,url:this.constants.urls.teams.picture.getDefaultPicture.replace("{displayName}",e),method:"GET"};return this.transientDataManager.invoke(n,i).then(function(e){return t.constants.pictureLoad.mimeJpeg+e},function(e){return t.logger.error("failed when getting team initials picture:{0}",e),t.constants.pictureLoad.mimeJpeg+t.constants.pictureLoad.defaultImageSvg})},e.prototype.uploadTeamPicture=function(e,t,i){var n=this,r=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.updatePicture),s=new teamspace.services.DataManagerRequestOptions;s.isResponseWrappedInValue=!0;var a={url:this.settingsService.valueFor(this.constants.settings.names.middleTierConstants).newEndpointAddressImg+this.constants.urls.teams.picture.update.replace("{teamGroupId}",e).replace("{teamThreadId}",t),method:"POST",data:i};return this.transientDataManager.invoke(a,s).then(function(t){n.logger.debug("picture uploaded successfully"),r.stop(),n.blobUrlCacheService.invalidateBlobImageUrl(e)},function(e){return r.fail({errorInfo:e}),n.logger.error("failed to upload team image:{0}",e),n.$q.reject(e)})},e.prototype.ensureTeamInLocalCache=function(e){var t=this,i=e.objectId;if(this.conversationsService.getConversation(i))return this.$q.resolve(e);this.logger.warn('[ensureTeamInLocalCache] Team "'+i+"\" hasn't been sync'ed by long poll yet after being created.");var n=this.createThreadPropertiesForTeamLie(e);return this.conversationsStore.addOrUpdateConversation(this.createConversationLieForTeam(e.objectId,n)).then(function(){var n=t.channelConversationAdapterService.getTeamById(i);return n||(t.logger.error('[ensureTeamInLocalCache] Team "'+i+'" is not found in local cache.'),n=e),n},function(n){return t.logger.error('[ensureTeamInLocalCache] Failed to update localdb for team "'+i+'".'),e})},e.prototype.getTeamDataClassificationSettings=function(){var e=this;return this.getMyGroupsSettings().then(function(t){return t&&t.classificationSettings&&t.classificationSettings[0]?t.classificationSettings:e.$q.reject(teamspace.services.ErrorPayload.create("ResourceNotFound"))})},e.prototype.getUsageGuidelineUrl=function(){var e=this;return this.getMyGroupsSettings().then(function(t){return t&&t.usageGuidelineUrl?t.usageGuidelineUrl:e.$q.reject(teamspace.services.ErrorPayload.create("ResourceNotFound"))})},e.prototype.isTeamEligibleForRenewal=function(e){return e&&e.teamStatus&&e.teamStatus.groupRenewalStatus&&e.teamStatus.groupRenewalStatus.isEligibleForRenewal},e.prototype.getTeamExpiryDate=function(e){var t=e&&e.teamStatus&&e.teamStatus.groupRenewalStatus&&e.teamStatus.groupRenewalStatus.groupExpiryTime;return t?this.localizationService.getDate(t,"shortDate"):null},e.prototype.isTeamNameValidateRequired=function(){return this.getMyGroupsSettings().then(function(e){return e&&!!e.isNameValidationRequired})},e.prototype.isTeamNamePrefixSuffixRequired=function(){return this.getMyGroupsSettings().then(function(e){return e&&!!e.isNamePrefixSuffixRequired})},e.prototype.updateTeamNameProperties=function(e,t,i,n){var r=this;this.getTeamNameProperties().then(function(s){s&&(r.teamNameProperties.displayNamePrefix=e,r.teamNameProperties.displayNameSuffix=t,r.teamNameProperties.mailNicknamePrefix=i,r.teamNameProperties.mailNicknameSuffix=n)})},e.prototype.getTeamNameProperties=function(){var e=this;if(this.onGoingGetTeamNamePropPromise)return this.onGoingGetTeamNamePropPromise;if(this.teamNameProperties)return this.$q.resolve(this.teamNameProperties);var t={url:this.constants.urls.teams.namingProperties,method:"GET"},i=new teamspace.services.DataManagerRequestOptions;return i.isResponseWrappedInValue=!0,this.onGoingGetTeamNamePropPromise=this.transientDataManager.invoke(t,i).then(function(t){return t&&t.code===e.constants.errorCodes.missingPrefixSuffixInTeamName?(e.teamNameProperties={},e.teamNameProperties.displayNamePrefix=t.displayNamePrefix,e.teamNameProperties.displayNameSuffix=t.displayNameSuffix,e.teamNameProperties.mailNicknamePrefix=t.mailNicknamePrefix,e.teamNameProperties.mailNicknameSuffix=t.mailNicknameSuffix,e.$timeout(function(){e.teamNameProperties=null},e.constants.timeInMiliseconds.hour,!1),e.teamNameProperties):(e.logger.error("[getTeamNameProperties] team naming properties was not returned by MT."),null)}).catch(function(){return e.logger.error("[getTeamNameProperties] get team naming properties failed.")}).finally(function(){return e.onGoingGetTeamNamePropPromise=null}),this.onGoingGetTeamNamePropPromise},e.prototype.renewTeam=function(e){var t=this;if(e){var i=e.siteInfo&&e.siteInfo.groupId;if(i){var n=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.renewTeam),r={url:this.constants.urls.teams.renew.replace("{groupId}",i),method:"POST"};return this.transientDataManager.invoke(r).then(function(e){return n.stop(),e.groupExpiryTime},function(i){return n.fail({team:e.objectId}),t.$q.reject(i)})}this.logger.error("[renewTeam] groupId cannot be found for team : "+e.objectId)}else this.logger.error("[renewTeam] invalid team object")},e.prototype.canCreateOrMigrateTeams=function(){return this.getCreateOrMigrateTeamsPermissions().then(function(e){return e.canCreateTeam||!!e.canMigrateTeam}).catch(function(){return!1})},e.prototype.getCreateOrMigrateTeamsPermissions=function(e){var t=this;void 0===e&&(e=!1);var i={canCreateTeam:!1};return this.identityService.isGuestUserType()?this.$q.resolve(i):this.verifyGroupsAccess().then(function(){return i.canCreateTeam=!0,e?t.checkIfCanMigrate(i):i}).catch(function(e){return t.settingsService.valueAsBoolean(t.constants.settings.names.enableGroupMigrationWorkaround)&&e&&e.code===t.constants.errorCodes.userNotPartOfSGToCreateTeam?t.checkIfCanMigrate(i):i})},e.prototype.getOfficeGroup=function(e){var t=this;if(!e)return this.logger.error("[getOfficeGroup]  Unable to get the group info, officeGroupId missing."),this.$q.reject();var i={url:this.constants.urls.teams.officeGroup.get.replace("{officeGroupId}",e),method:"GET",counter:this.constants.urls.teams.officeGroup.type},n=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.getOfficeGroup),r={officeGroupId:e};return this.officeGroupDataManager.invoke(i).then(function(e){return n.stop({data:JSON.stringify(r)}),e}).catch(function(i){return r.error=i,t.exceptionUtilityService.failScenarioSelectively(n,i,{data:JSON.stringify(r)}),t.logger.error('[getOfficeGroup] Unable to get the group info for group: "'+e+'".'),t.$q.reject(i)})},e.prototype.shouldEnableTenantWideTeam=function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableTenantWideTeams)||(this.identityService.isFreemiumTenant()?this.settingsService.valueAsBoolean(this.constants.settings.names.enableTenantWideTeamForFreemium):this.settingsService.valueAsBoolean(this.constants.settings.names.enableTenantWideTeamForNonFreemium))},e.prototype.checkIfCanMigrate=function(e){var t=this;return void 0===e&&(e={}),this.userResourcesSettingsStore.waitForSettingAndGetValue(SkypeX.Services.UserResourcesStorageKey.licenseType).then(function(i){return e.licenseType=i,i===t.constants.licenseType.teacher||i===t.constants.licenseType.student?e:t.scopedPeopleSearchService.isScopedPeopleSearchEnabled()?e:t.getModernGroups().then(function(t){return t&&t.length&&(e.canMigrateTeam=!0,e.modernGroups=t),e}).catch(function(){return e})})},e.prototype.createThreadPropertiesForTeamLie=function(e){var t={};t[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceThreadTopic]=e.displayName,t[SkypeX.Services.ChatServiceUtils.ThreadProp_Classification]=e.classification,t[SkypeX.Services.ChatServiceUtils.ThreadProp_Visibility]=e.visibility||this.constants.teams.settings.defaultTeamVisiblity;var i=e.teamType?String(e.teamType).toLowerCase():SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType_Standard;return t[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType]=i,e.siteInfo&&e.siteInfo.groupId?t[SkypeX.Services.ChatServiceUtils.ThreadProp_GroupId]=e.siteInfo.groupId:this.logger.warn("[createConversationLieForTeam] Group ID was expected in newly created team object, but is not present."),t[SkypeX.Services.ChatServiceUtils.ThreadProp_LastJoinAt]=new Date(moment.utc().toISOString()).getTime(),t},e.prototype.createConversationLieForTeam=function(e,t){if(!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLargeTeams)){var i=[{id:this.sxConfig.getCurrentSkypeMri(),role:this.constants.RoleConstants.Admin}];return this.skypeModelFactory.createTeamConversationLie(e,t,i)}var n=(s={},s[SkypeX.Services.ChatServiceUtils.MemberProp_Role]=this.constants.RoleConstants.Admin,s),r={memberCount:1,botCount:0,readerCount:0,roleCounts:{admin:1,guest:0,user:0}};return this.skypeModelFactory.createTeamConversationLie(e,t,null,n,r);var s},e.prototype.syncTeamUpdatesFromConversation=function(e){var t=e.oldConversation,i=e.newConversation;if(t&&i){var n=void 0,r=void 0;t.threadProperties&&(n=t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceThreadTopic]),i.threadProperties&&(r=i.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceThreadTopic]),n&&r&&t.teamId===i.teamId&&n!==r&&this.raiseUpdatedTeamNameEvent(i.teamId,n,r)}},e.prototype.raiseUpdatedTeamNameEvent=function(e,t,i){var n={teamId:e,oldTeamName:t,newTeamName:i};this.eventingService.$emit(this.constants.events.channels.updatedTeamName,n)},e}();t.TeamServiceImplementation=n,angular.module("teamspace.teamService",["skypeX.conversationsStore","teamspace.blobUrlCacheService","teamspace.channelConversationAdapterService","teamspace.constants","teamspace.conversationsService","teamspace.dataManagerService","teamspace.extensionConfigurationService","teamspace.exceptionUtilityService","teamspace.loggingService","teamspace.usersGroupsSettingsService","teamspace.groupSpecificSettingsService","teamspace.scopedPeopleSearchService"]).service("teamService",n)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m){var f=e.call(this)||this;return f.identityService=t,f.conversationsService=i,f.constants=n,f.eventingService=r,f.sxConfig=s,f.$q=a,f.loggingService=o,f.$translate=c,f.resources=l,f.settingsService=p,f.myUserPreferencesStore=u,f.teamTemplatingActions=h,f.utilityService=d,f.routeUtilityService=g,f.offlineActionService=v,f.activeCallsService=m,f.teamsArray=[],f.teamById={},f.channelById={},f.conversationPostSyncSteps={},f.debouncePostSyncOperation=_.debounce(function(){return f.executePostSyncOperations()},2e3,{maxWait:5*f.constants.timeInMiliseconds.second}),f.logger=f.loggingService.newLogger("conversationToChannel"),f.generalLocalizedName=f.$translate.instant(f.resources.strings.channel_general),f.conversationsService.subscribe(function(e,t){return f.addOrUpdateConversations(t)},teamspace.services.ConversationsServiceEvents.EventType_Batched),f.myUserPreferencesStore.subscribe(function(e,t){return f.updateTeamsOrder(t)},f.constants.MyUserPreferencesStore.Type_UserPreference),f.channelByNamePopulator=new teamspace.services.ChannelByNamePopulator,f.boldLogic2=f.settingsService.valueAsBoolean(f.constants.settings.names.boldLogic2),f.enableGeneralChannelRestrictions=f.settingsService.valueAsBoolean(f.constants.settings.names.enableGeneralChannelRestrictions),f.enablePrivateChannels=f.settingsService.valueAsBoolean(f.constants.settings.names.enableNiji),f.enableInactiveTeamLogs=f.settingsService.valueAsBoolean(f.constants.settings.names.enableInactiveTeamLogs),f.enableTeamChannelMembershipService=f.settingsService.valueAsBoolean(f.constants.settings.names.enableTeamChannelMembershipService),f.settingsService.valueAsBoolean(n.settings.names.enableMessageSendFailureIndicator)&&f.offlineActionService.subscribe(function(e){return f.updateHasFailedMessages(e)},SkypeX.Services.OfflineActionServiceEvents.Type_ConversationHasFiledMessageUpdated),f.activeCallsService.subscribe(f.updateActiveCalls.bind(f),teamspace.services.ActiveCallsServiceEvents.Type_ActiveCallsChanged),f}return n(t,e),t.$inject=["identityService","conversationsService","constants","eventingService","sxConfig","$q","loggingService","$translate","resources","settingsService","myUserPreferencesStore","teamTemplatingActions","utilityService","routeUtilityService","offlineActionService","activeCallsService"],Object.defineProperty(t.prototype,"isLargeTeamsEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableLargeTeams)},enumerable:!0,configurable:!0}),t.prototype.updateHasFailedMessages=function(e){var t=this.channelById[e];t&&(t.hasFailedMessages=this.offlineActionService.hasFailedMessages(t.objectId));var i=this.teamById[e];i&&(i.hasFailedMessages=this.offlineActionService.hasFailedMessages(i.objectId))},t.prototype.updateActiveCalls=function(e,t){var i=this.getChannelById(e);i&&(i.activeCallsCount=t?t.length:this.activeCallsService.getCallsCountByConversationId(e))},t.prototype.getTeams=function(){var e=this;return this.conversationsService.waitForConversationsSynced().then(function(){return e.teamsArray})},t.prototype.getTeamById=function(e){return this.teamById[e]},t.prototype.getChannelById=function(e){return this.channelById[e]},t.prototype.getChannelNameToIdsMapper=function(){return this.channelByNamePopulator.getChannelIdsByName()},t.prototype.addOrUpdateConversations=function(e){var t=this;if(e&&e.length){this.logger.debug("Adding conversations to left rail. Got {0} conversations",e.length);var i=[],n={},r=this.sxConfig.getCurrentSkypeMri();angular.forEach(e,function(e){t.conversationsService.isTeam(e)?(t.addOrUpdateTeam(e),n[e.teamId]=e):(t.conversationsService.isChannel(e)&&!t.conversationsService.isLinkedChannel(e)||t.enablePrivateChannels&&t.conversationsService.isLinkedChannel(e))&&i.push(e)}),Object.keys(n).length&&this.updateTeamsOrder();for(var s=0;s<i.length;s++){var a=i[s];if(this.conversationsService.isLinkedChannel(a)?this.addOrUpdatePrivateChannel(a):this.addOrUpdateChannel(a),!n[a.teamId]){var o=(this.boldLogic2?a.isRead():a.isReadForUser(r))?0:1;a.isFavorite()&&o&&(n[a.teamId]=a)}}var c=Object.keys(n);c.length&&this.eventingService.$emit(this.constants.events.channels.updatedTeam,c),(i.length||c.length)&&this.trigger(this.constants.ChannelConversationAdapterService.Type_ChannelConversationsChanged,null,_.union(i,c.map(function(e){return n[e]}))),this.debouncePostSyncOperation()}else this.logger.debug("No conversations were passed as an argument in batched update. Skipping")},t.prototype.addOrUpdateTeam=function(e){this.logger.debug("Adding team conversation {0}",e.id);var t=this.teamById[e.id],i=!1;if(t||((t=new teamspace.services.TeamLocal).objectId=e.id,t.isDeleted=e.isDeleted(),this.teamById[e.id]=t,this.teamsArray.push(t),i=!0),this.conversationsService.isActiveTeamOrChannel(e))this.populateMainProperties(e,t),this.populateTeamSettingsProperties(e,t),this.populateTeamSiteInfoProperties(e,t),this.populateTeamStatusProperties(e,t),this.populateTeamType(e,t),this.populateTeamLicenseTypeProperties(e,t),this.populateTeamChannels(e,t),this.populateTeamTemplatingProperties(e,t),this.enableTeamChannelMembershipService||this.populateRosterProperties(e,t),i&&this.eventingService.$emit(this.constants.events.channels.addedTeam,e.id);else{if(this.enableInactiveTeamLogs){var n=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastJoinAt],r=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastLeaveAt];this.logger.info("Inactive team id:"+t.objectId+",lastJoin: "+n+",lastLeave: "+r+",dead: "+e.isThreadDead()+",deleted: "+e.isDeleted())}this.removeTeam(e,t)}},t.prototype.addOrUpdatePrivateChannel=function(e){this.logger.debug("Adding private channel conversation {0}",e.id);var t=this.channelById[e.id],i=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceThreadTopic],n=null;if(t&&(n=t.displayName),!t){var r=this.parsePrivateChannelParent(e),s=this.teamById[r];if(!s)return;(t=new teamspace.services.ChannelLocal(null,function(e){return s.unreadChannelsChanged(e)},function(e){return s.activityCountChanged(e)},function(e){return s.importanceChanged(e)})).objectId=e.id,t.displayName=i,t.parentTeamId=r,s.addToPrivateChannels(t),this.channelById[t.objectId]=t,this.channelByNamePopulator.mapIdstoChannelName(t,n)}if(!this.conversationsService.isActiveTeamOrChannel(e))return this.logger.debug("Recieved delete notification for channel "+i+" id:"+t.objectId),void this.removePrivateChannel(t);this.setPrivateChannelProperties(e,t),this.setCommonChannelProperties(e,t)},t.prototype.removeTeam=function(e,t){var i=this.teamsArray.indexOf(t);if(-1!=i){var n=[e];this.teamsArray.splice(i,1),delete this.teamById[t.objectId],this.trigger(this.constants.ChannelConversationAdapterService.Type_ChannelConversationsChanged,this.constants.events.channels.deletedTeam,n),this.eventingService.$emit(this.constants.events.channels.deletedTeam,t.objectId);for(var r=0;r<t.channels.length;r++)delete this.channelById[t.channels[r].objectId]}},t.prototype.removePrivateChannel=function(e){if(e){var t=e.parentTeamId,i=e.objectId,n=this.teamById[t];n&&n.removeFromPrivateChannels(e)&&(this.eventingService.$emit(this.constants.events.channels.deletedChannel,i),this.channelByNamePopulator.removeChannelIdFromMapping(e.displayName,i)),this.channelById[i]&&delete this.channelById[i]}},t.prototype.populateMainProperties=function(e,t){var i=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceThreadTopic];t.displayName=i,t.objectId=e.id;var n=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Picture];n&&(t.thumbnailUri=n+this.constants.amsImageTemplate.thumbnail);var r=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_PictureETag];r&&(t.pictureETag=r);var s=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicDescription];t.description=s,t.isFollowed="true"===e.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_Followed]||"True"===e.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_Followed],t.isFavorite="false"!=e.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_Favorite]&&"False"!=e.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_Favorite],t.isCollapsed=e.isCollapsed(),this.isLargeTeamsEnabled||(t.members=e.members,t.peopleCount=this.calculatePeopleCount(t.members)),t.smtpAddress=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TeamSmtpAddress],t.threadVersion=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceThreadVersion],t.threadVersionOnConversation=e.threadVersion,t.conversationVersion=e.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_Version],t.classification=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Classification],t.visibility=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Visibility]||this.constants.teams.settings.defaultTeamVisiblity,t.guestUsersCategory=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_GuestUsers],t.dynamicMembership=this.utilityService.convertStringToBoolean(e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_DynamicMembership]),t.isMaxMemberLimitExceeded=this.utilityService.convertStringToBoolean(e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_MemberLimitExceeded]);var a=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastJoinAt];t.lastJoinAt=a||t.lastJoinAt,t.createdAt=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_CreatedAt],t.isArchived=e.isTeamArchived()},t.prototype.populateTeamSettingsProperties=function(e,t){var i=this.sxConfig.getCurrentSkypeMri();if(!this.enableTeamChannelMembershipService)if(!this.isLargeTeamsEnabled&&e.members){var n=e.members.filter(function(e){return e.id===i});n.length>0&&(t.adminView=n[0].role===this.constants.RoleConstants.Admin,t.userRole=n[0].role,t.muteView=n[0].isReader)}else if(this.isLargeTeamsEnabled&&e.memberProperties){var r=e.memberProperties[SkypeX.Services.ChatServiceUtils.MemberProp_Role];t.userRole!==r&&this.eventingService.$emit(this.constants.events.teamMembers.teamMemberCacheRoleChange,{action:teamspace.services.TeamMemberAction.Update,teamId:e.id}),t.adminView=r===this.constants.RoleConstants.Admin,t.userRole=r,t.muteView=e.memberProperties[SkypeX.Services.ChatServiceUtils.MemberProp_Reader]}t.isCreator=this.isCreator(i,e);var s=e.threadProperties;if(s&&s[SkypeX.Services.ChatServiceUtils.ThreadProp_TeamAdminSettings]){var a=JSON.parse(s[SkypeX.Services.ChatServiceUtils.ThreadProp_TeamAdminSettings]);if(a.userSettings){var o=this.identityService.isGuestUserType();this.setMemberSettings(a.userSettings,t),this.setGuestSettings(a.guestSettings,t),this.setClassSettingsIfApplicable(a.classSettings,t),t.teamUserSettings.teamMention=!!angular.isDefined(a.userSettings.teamMention)&&a.userSettings.teamMention,t.teamUserSettings.channelMention=!!angular.isDefined(a.userSettings.channelMention)&&a.userSettings.channelMention,t.teamUserSettings.giphyEnabled=!angular.isDefined(a.userSettings.giphyEnabled)||a.userSettings.giphyEnabled,t.teamUserSettings.stickersEnabled=!angular.isDefined(a.userSettings.stickersEnabled)||a.userSettings.stickersEnabled,t.teamUserSettings.customMemesEnabled=!angular.isDefined(a.userSettings.customMemesEnabled)||a.userSettings.customMemesEnabled,t.teamUserSettings.teamMemesEnabled=!!angular.isDefined(a.userSettings.teamMemesEnabled)&&a.userSettings.teamMemesEnabled,t.teamUserSettings.giphyRating=angular.isDefined(a.userSettings.giphyRating)?a.userSettings.giphyRating:1,t.teamUserSettings.adminDeleteEnabled=!angular.isDefined(a.userSettings.adminDeleteEnabled)||a.userSettings.adminDeleteEnabled,t.teamUserSettings.deleteEnabled=!angular.isDefined(a.userSettings.deleteEnabled)||a.userSettings.deleteEnabled,t.teamUserSettings.editEnabled=!angular.isDefined(a.userSettings.editEnabled)||a.userSettings.editEnabled,t.teamUserSettings.messageThreading=!angular.isDefined(a.userSettings.messageThreading)||a.userSettings.messageThreading,this.enableGeneralChannelRestrictions&&(t.teamUserSettings.generalChannelSetting=angular.isDefined(a.userSettings.generalChannelSetting)?a.userSettings.generalChannelSetting:teamspace.components.GeneralChannelSettings.AnyonePost),o?(t.teamSettings=new teamspace.services.TeamSettingsLocal,_.merge(t.teamSettings,t.teamUserSettings,t.teamGuestSettings)):t.teamSettings=t.teamUserSettings;var c=this.routeUtilityService.getRootRouteParams();if(this.hasKeyedSubscribers(this.constants.events.teams.updatedTeamAdminSettings)&&c&&c.threadId){var l=this.conversationsService.getTeamFromConversation(c.threadId);l&&l.id===t.objectId&&this.trigger(this.constants.ChannelConversationAdapterService.Type_ChannelConversationsChanged,this.constants.events.teams.updatedTeamAdminSettings,t.objectId)}}}},t.prototype.setMemberSettings=function(e,t){t.teamUserSettings.createTab=e.createTab,t.teamUserSettings.updateTopic=e.updateTopic,t.teamUserSettings.createTopic=e.createTopic,t.teamUserSettings.deleteTopic=e.deleteTopic,t.teamUserSettings.createPrivateSpace=e.createPrivateSpace,t.teamUserSettings.deleteTab=e.deleteTab,t.teamUserSettings.createIntegration=e.createIntegration,t.teamUserSettings.updateIntegration=e.updateIntegration,t.teamUserSettings.deleteIntegration=e.deleteIntegration,t.teamUserSettings.installApp=!angular.isDefined(e.installApp)||e.installApp,t.teamUserSettings.uninstallApp=!angular.isDefined(e.uninstallApp)||e.uninstallApp},t.prototype.setGuestSettings=function(e,t){t.teamGuestSettings.updateTopic=!(!e||!angular.isDefined(e.updateTopic))&&e.updateTopic,t.teamGuestSettings.createTopic=!(!e||!angular.isDefined(e.createTopic))&&e.createTopic,t.teamGuestSettings.deleteTopic=!(!e||!angular.isDefined(e.deleteTopic))&&e.deleteTopic,t.teamGuestSettings.createPrivateSpace=!1,t.teamGuestSettings.createTab=!1,t.teamGuestSettings.deleteTab=!1,t.teamGuestSettings.createIntegration=!1,t.teamGuestSettings.updateIntegration=!1,t.teamGuestSettings.deleteIntegration=!1,t.teamGuestSettings.installApp=!1,t.teamGuestSettings.uninstallApp=!1},t.prototype.setClassSettingsIfApplicable=function(e,t){2===t.teamType&&(t.classSettings={guardianAssignmentEmail:!(!e||!angular.isDefined(e.guardianAssignmentEmail))&&e.guardianAssignmentEmail})},t.prototype.populateTeamType=function(e,t){var i=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceTypes]||[],n=i&&2==(2&i);t.isTenantWide=!!n},t.prototype.populateTeamSiteInfoProperties=function(e,t){var i={};i.groupId=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_GroupId]||void 0,i.siteUrl=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SiteUrl]||void 0,i.notebookId=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_NotebookId]||void 0,i.isOneNoteProvisioned=void 0===i.notebookId,t.siteInfo=i},t.prototype.calculatePeopleCount=function(e){return e&&e.length?_.filter(e,function(e){return!SkypeX.Services.ChatServiceUtils.isBotMri(e.id,!1)}).length:0},t.prototype.populateTeamStatusProperties=function(e,t){var i=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TeamStatus]||null;t.teamStatus=i?JSON.parse(i):null},t.prototype.populateTeamLicenseTypeProperties=function(e,t){switch((e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType]||SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType_Standard).toLowerCase()){case SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType_Standard.toLowerCase():t.teamType=0;break;case SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType_Edu.toLowerCase():t.teamType=1;break;case SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType_Class.toLowerCase():t.teamType=2;break;case SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType_Plc.toLowerCase():t.teamType=3;break;case SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceType_Staff.toLowerCase():t.teamType=4;break;default:t.teamType=0}},t.prototype.populateTeamChannels=function(e,t){var i=this,n={};if(angular.forEach(t.channels,function(e){n[e.objectId]=e}),n[e.id])delete n[e.id];else{var r=new teamspace.services.ChannelLocal(null,function(e){return t.unreadChannelsChanged(e)},function(e){return t.activityCountChanged(e)},function(e){return t.importanceChanged(e)});r.objectId=e.id,r.displayName=this.generalLocalizedName,r.parentTeamId=e.id,r.membersContainerId=r.parentTeamId,r.settingsContainerId=r.parentTeamId,r.activityCount=0,r.isGeneral=!0,r.isFavorite=!0,r.isFollowed=t.isFollowed,r.isJoined=!0,r.activeCallsCount=this.activeCallsService.getCallsCountByConversationId(e.id),t.addToChannels(r),t.generalChannel=r,this.channelById[r.objectId]=r}this.addOrUpdateChannel(e);var s=e.getTopicMinis();angular.forEach(s,function(r){if(r)if(r.isdeleted)i.logger.debug("Topic {0} is deleted. So not adding it to left rail",r.id);else{var s=r.name;s===i.constants.channels.defaultChannelName&&(s=i.$translate.instant(i.resources.strings.teams_old_genreal_format,{general:s}));var a=null,o=i.channelById[r.id];if(o&&(a=o.displayName),n[r.id])return delete n[r.id],void(s!==a&&(o.displayName=s,o.createdAt=r.createdat,i.channelByNamePopulator.mapIdstoChannelName(o,a)));var c=new teamspace.services.ChannelLocal(null,function(e){return t.unreadChannelsChanged(e)},function(e){return t.activityCountChanged(e)},function(e){return t.importanceChanged(e)});c.objectId=r.id,c.displayName=s,c.parentTeamId=t.objectId,c.activityCount=0,c.hasFailedMessages=i.offlineActionService.hasFailedMessages(c.objectId),c.createdAt=r.createdat,c.activeCallsCount=i.activeCallsService.getCallsCountByConversationId(e.id),t.addToChannels(c),i.channelById[c.objectId]=c,c.displayName==i.constants.channels.defaultChannelName&&(c.isGeneral=!0,c.isFavorite=!0,c.isFollowed=!1,c.isJoined=!0,t.generalChannel=c,i.logger.warn("Team {0} still has the general channel ",r.id)),i.channelByNamePopulator.mapIdstoChannelName(c,a),i.eventingService.$emit(i.constants.events.channels.addedChannel,c.objectId)}});for(var a in n){var o=n[a];t.removeFromChannels(o)&&(this.logger.log("Recieved delete notification for channel "+o.displayName+" id:"+a),this.eventingService.$emit(this.constants.events.channels.deletedChannel,a),this.channelByNamePopulator.removeChannelIdFromMapping(o.displayName,a)),this.channelById[a]&&delete this.channelById[a]}},t.prototype.populateTeamTemplatingProperties=function(e,t){if(e&&t&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableCloneTeam)){var i=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_CreatingFromTemplate];t.creatingFromTemplate=i&&"boolean"==typeof i?!!i:!(!i||"string"!=typeof i)&&"true"===i.toLowerCase(),t.creatingFromTemplate&&this.teamTemplatingActions.verifyJob({teamId:t.objectId})}},t.prototype.populateRosterProperties=function(e,t){this.isLargeTeamsEnabled&&e.rosterVersion!==t.rosterVersion&&(t.rosterVersion=e.rosterVersion,t.rosterSummary=new teamspace.services.RosterSummaryLocal(e.rosterSummary))},t.prototype.addOrUpdateChannel=function(e){this.logger.debug("Adding channel conversation {0}",e.id);var t=this.channelById[e.id];if(t){var i=!1,n=t.displayName;this.setCommonChannelProperties(e,t),t.isGeneral||(this.setRegularChannelProperties(e,t),i=this.setChannelFavoriteProperties(e,t)),this.channelByNamePopulator.mapIdstoChannelName(t,n),i&&this.eventingService.$emit(this.constants.events.channels.updatedChannel)}},t.prototype.setRegularChannelProperties=function(e,t){t.description=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicDescription],t.parentTeamId=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceId]||t.parentTeamId,t.settingsContainerId=t.parentTeamId,t.membersContainerId=t.parentTeamId,t.threadVersion=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicThreadVersion],t.threadVersionOnConversation=e.threadVersion,t.isArchived=e.isChannelArchived()},t.prototype.setChannelFavoriteProperties=function(e,t){var i=this.sxConfig.getCurrentSkypeMri(),n=void 0!=t.isFavorite&&!!t.isFavorite!=!!e.isFavorite();t.isFavorite=e.isFavorite(),t.hasMemberExpiration=!1;var r=e.getMemberExpiration(i);r&&r<SkypeX.Services.SkypeConversationLocal.MaxTimeStamp&&(t.hasMemberExpiration=!0,t.expirationTime=r);var s=e.isUserMember(i);if(t.isJoined=s&&(!t.hasMemberExpiration||t.expirationTime>Date.now()),(this.isLargeTeamsEnabled||e.members&&e.members.length)&&e.detailsVersion===e.threadVersion){var a=s&&!t.hasMemberExpiration;if(!t.isFavorite&&a){var o=teamspace.services.ConversationPostSyncFavoriteOperationStep.getKey(t.objectId);this.conversationPostSyncSteps[o]||(this.loggingService.event(this.constants.telemetry.channel.postsync,{markAsFavorite:!0,threadId:t.objectId}),this.conversationPostSyncSteps[o]=new teamspace.services.ConversationPostSyncFavoriteOperationStep(this.loggingService,this.conversationsService,this.eventingService,this,this.$q,this.constants,t.objectId,{requirePermanentJoinedState:this.isLargeTeamsEnabled}))}}return n},t.prototype.setPrivateChannelProperties=function(e,t){t.displayName=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceThreadTopic],t.description=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicDescription],t.threadVersion=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicThreadVersion];var i=e.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_Favorite];t.isFavorite=_.isNil(i)||!/false/i.test(i),t.threadVersionOnConversation=e.threadVersion,t.membersContainerId=t.objectId,t.settingsContainerId=t.objectId;var n=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceTypes],r=n?parseInt(n):0,s=this.parsePrivateChannelParent(e);t.parentTeamId=s,this.addPrivateChannelToParent(t),this.generateChannelType(t,r)},t.prototype.parsePrivateChannelParent=function(e){var t,i=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ParentSpaces];try{var n=JSON.parse(i),r=n&&n.linkedSpaceInfoItems;r&&r.length&&(t=r[0].spaceThreadId)}finally{return t}},t.prototype.addPrivateChannelToParent=function(e){var t=this.teamById[e.parentTeamId];!t||t.privateChannels.findIndex(function(t){return t.objectId===e.objectId})>=0||t.addToPrivateChannels(e)},t.prototype.generateChannelType=function(e,t){e&&(e.channelType=1==(1&t)?teamspace.services.ChannelType.Private:teamspace.services.ChannelType.Regular)},t.prototype.setCommonChannelProperties=function(e,t){var i=this.sxConfig.getCurrentSkypeMri();t.isFollowed=e.isFollowed(),t.folderRelativeUrl=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_FolderRelativeUrl]||null,t.documentLibraryId=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_DocumentLibraryId]||null,t.defaultSectionId=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ChannelDefaultSectionId]||null;var n=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_NotesSectionInfo]||null;t.defaultNotesSection=n?JSON.parse(n):null,t.lastActivity=e&&e.lastMessageTimeUtc||null;var r=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_FavDefault]||"false";t.isFavDefault=/^true$/i.test(r),t.activityCount=0,t.lastSeen=e.getConsumptionHorizonTimestamp().toString(),t.unreadCount=(this.boldLogic2?e.isRead():e.isReadForUser(i))?0:1,t.isHighImportance=e.isHighImportance(),t.activeCallsCount=this.activeCallsService.getCallsCountByConversationId(e.id),this.isLargeTeamsEnabled&&e.memberProperties&&(t.userRole=e.memberProperties[SkypeX.Services.ChatServiceUtils.MemberProp_Role]),t.hasFailedMessages=this.offlineActionService.hasFailedMessages(t.objectId);var s=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastJoinAt];t.lastJoinAt=s||t.lastJoinAt;var a=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_CreatedAt];t.createdAt=a||t.createdAt,t.isCreator=this.isCreator(i,e)},t.prototype.isCreator=function(e,t){var i=t.creator(),n=i?i.split(";"):[];return e===(n&&n.length>=1?n[0]:null)},t.prototype.updateTeamsOrder=function(e){if(!(e&&e.indexOf(SkypeX.Services.MyUserPreferenceStorageKey.TeamsOrder)<0)){var t=this.myUserPreferencesStore.getUserPreferences().teamsOrder;if(t&&angular.isArray(t)&&t.length)for(var i=0;i<t.length;i++){var n=this.teamById[t[i].teamId];n&&n.order!==t[i].order&&(this.logger.info("Changing team order id: {0} from {1} to {2}",n.objectId,n.order,t[i].order),n.order=t[i].order)}}},t.prototype.executePostSyncOperations=function(){var e=Object.keys(this.conversationPostSyncSteps);e&&e.length&&this.executePostSyncOperationsInternal(e)},t.prototype.executePostSyncOperationsInternal=function(e){var t=this;if(e&&e.length){var i=e.shift(),n=this.conversationPostSyncSteps[i];delete this.conversationPostSyncSteps[i],n.execute().finally(function(){t.executePostSyncOperationsInternal(e)})}},t}(SkypeX.Services.ObservableBase);t.ChannelConversationAdapterServiceImplementation=r,angular.module("teamspace.channelConversationAdapterService",["teamspace.identityService","teamspace.teamTemplatingActions"]).service("channelConversationAdapterService",r)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o){this.$q=e,this.$translate=t,this.channelService=i,this.constants=n,this.exceptionUtilityService=r,this.loggingService=s,this.resources=a,this.teamService=o}return e.$inject=["$q","$translate","channelService","constants","exceptionUtilityService","loggingService","resources","teamService"],e.prototype.getTeamNamePolicyIfRequired=function(){var e=this,t={isNameValidationRequired:!1,teamNamePolicy:null};return this.teamService.isTeamNameValidateRequired().then(function(i){return i?(t.isNameValidationRequired=!0,e.teamService.isTeamNamePrefixSuffixRequired().then(function(i){return i?e.teamService.getTeamNameProperties().then(function(e){return t.teamNamePolicy=e,t}):t})):t})},e.prototype.validateTeamName=function(e,t,i,n,r,s){var a=this,o=this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.teamNamValidation),c={};return this.channelService.validateTeamName(e,t,i,n,r,s).then(function(e){return o.stop(),e}).catch(function(e){c[a.constants.scenarioDataPropNames.error]=JSON.stringify(e),o.fail(c);var t=a.generateValidationErrorTuple(e);return a.$q.reject(t)})},e.prototype.generateValidationErrorTuple=function(e){var t={error:e,errorCode:null,formattedErrorString:null},i=this.constants.teams.validateTeamNameTarget.unknown,n=e&&e.code||i;t.errorCode=n;var r=e&&e.target||i;switch(r=r.toLowerCase()){case this.constants.teams.validateTeamNameTarget.displayName:switch(n){case this.constants.errorCodes.missingPrefixSuffixInTeamName:t.formattedErrorString=this.$translate.instant(this.resources.strings.error_message_MissingPrefixSuffix),this.teamService.updateTeamNameProperties(e.displayNamePrefix,e.displayNameSuffix,e.mailNicknamePrefix,e.mailNicknameSuffix);break;case this.constants.errorCodes.teamNameContainsBlockedWord:e.blockedWord?t.formattedErrorString=this.$translate.instant(this.resources.strings.error_message_Org_Blocked_Words,{blockedWord:e.blockedWord}):t.formattedErrorString=this.$translate.instant(this.resources.strings.error_message_Blocked_Words);break;default:t.formattedErrorString=this.exceptionUtilityService.getFormattedErrorMessage(e,this.$translate.instant(this.resources.strings.createTeam_defaultError))}break;case this.constants.teams.validateTeamNameTarget.mailNickName:switch(n){case this.constants.errorCodes.teamNameContainsBlockedWord:e.blockedWord?t.formattedErrorString=this.$translate.instant(this.resources.strings.error_message_Org_Blocked_Words,{blockedWord:e.blockedWord}):t.formattedErrorString=this.$translate.instant(this.resources.strings.error_message_Blocked_Words);break;default:t.formattedErrorString=this.$translate.instant(this.resources.strings.error_message_MissingPrefixSuffix)}break;default:t.formattedErrorString=this.exceptionUtilityService.getFormattedErrorMessage(e,this.$translate.instant(this.resources.strings.createTeam_defaultError))}return t},e}();t.TeamNameValidationHelperService=n,angular.module("teamspace.teamNameValidationHelperService",["teamspace.constants","teamspace.channelService","teamspace.exceptionUtilityService","teamspace.loggingService","teamspace.teamService"]).service("teamNameValidationHelperService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c){var l=this;this.analyticsService=e,this.channelService=t,this.constants=i,this.eventingService=n,this.loggingService=r,this.settingsService=s,this.$state=a,this.utilityService=o,this.$window=c,this.teamsWithNewBadge=[],this.channelsWithNewBadge=[],this.newTeamsAndChannelsBadgeSettings=this.settingsService.valueFor(this.constants.settings.names.newTeamsAndChannelsBadge),_.isString(this.newTeamsAndChannelsBadgeSettings)&&(this.newTeamsAndChannelsBadgeSettings=JSON.parse(this.newTeamsAndChannelsBadgeSettings)),this.listenForSettingUpdates(),(this.enableNewTeamsAndChannelsBadge||this.enableNewBadgeOnlyOnChannels||this.shouldSendTelemetry)&&this.$window.requestIdleCallback(function(){l.channelService.getTeams().then(function(e){l.initializeAndApplyBadges(e),l.listenForTeamAndChannelUpdates()})})}return e.$inject=["analyticsService","channelService","constants","eventingService","loggingService","settingsService","$state","utilityService","$window"],Object.defineProperty(e.prototype,"enableNewTeamsAndChannelsBadge",{get:function(){if(this.enableNewBadgeOnlyOnChannels)return!1;var e=this.newTeamsAndChannelsBadgeSettings;return!!e&&(e.newBadges||e.newBadgesAndToast)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"teamAndChannelNewBadgeDurationInHours",{get:function(){return this.newTeamsAndChannelsBadgeSettings?this.newTeamsAndChannelsBadgeSettings.teamAndChannelNewBadgeDurationInHours:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldSendTelemetry",{get:function(){return!!this.newTeamsAndChannelsBadgeSettings&&this.newTeamsAndChannelsBadgeSettings.collectData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableNewBadgeOnlyOnChannels",{get:function(){return!!this.newTeamsAndChannelsBadgeSettings&&this.newTeamsAndChannelsBadgeSettings.newBadgesOnlyOnChannels},enumerable:!0,configurable:!0}),e.prototype.showNewTeamBadge=function(e,t){return void 0===t&&(t=!1),!this.enableNewBadgeOnlyOnChannels&&(!(!t&&!this.enableNewTeamsAndChannelsBadge)&&!(e.isCreator||!this.isTeamNew(e)||this.hasTeamBeenSeen(e)))},e.prototype.showNewChannelBadge=function(e,t,i){return void 0===i&&(i=!1),!!(i||this.enableNewTeamsAndChannelsBadge||this.enableNewBadgeOnlyOnChannels)&&(!this.isTeamNew(e)&&!(t.isCreator||!this.isChannelNew(t)||this.hasChannelBeenSeen(t)))},e.prototype.removeNewBadge=function(e,t){e.showNewBadge=!1,t.showNewBadge&&!t.isFavorite&&e.nonFavoriteChannelsWithNewBadge&&e.nonFavoriteChannelsWithNewBadge--,t.showNewBadge=!1},e.prototype.initializeAndApplyBadges=function(e){this.applyNewBadgeOnInitialization(e),this.sendNewBadgeTelemetry()},e.prototype.applyNewBadgeOnInitialization=function(e){for(var t=this.settingsService.valueAsBoolean(this.constants.settings.names.enableNiji),i=0;i<e.length;++i){var n=e[i],r=n.getChannels(t),s=this.showNewTeamBadge(n);this.enableNewTeamsAndChannelsBadge&&(n.showNewBadge=s),s&&this.teamsWithNewBadge.push(n),this.applyBadgesOnChannels(n,r,!0)}},e.prototype.applyBadgesOnChannels=function(e,t,i){var n=this;_.forEach(t,function(t){var r=n.showNewChannelBadge(e,t);(n.enableNewBadgeOnlyOnChannels||n.enableNewTeamsAndChannelsBadge)&&(r&&!t.isFavorite&&e.nonFavoriteChannelsWithNewBadge++,t.showNewBadge=r),r&&i&&n.channelsWithNewBadge.push(t)})},e.prototype.listenForTeamAndChannelUpdates=function(){this.unsubscribeTeamAdditions&&this.unsubscribeTeamAdditions(),this.unsubscribeTeamAdditions=this.listenForTeamAdditions(),this.unsubscribeChannelAdditions&&this.unsubscribeChannelAdditions(),this.unsubscribeChannelAdditions=this.listenForChannelAdditions(),this.unsubscribeChannelFavoriting&&this.unsubscribeChannelFavoriting(),this.unsubscribeChannelFavoriting=this.listenForChannelFavoriting()},e.prototype.listenForTeamAdditions=function(){var e=this;return this.eventingService.unsafeOn(this.constants.events.channels.addedTeam,function(t,i){var n=e.channelService.getTeamByObjectId(i);n.showNewBadge=e.showNewTeamBadge(n)})},e.prototype.listenForChannelAdditions=function(){var e=this;return this.eventingService.unsafeOn(this.constants.events.channels.addedChannel,function(t,i){var n=e.channelService.getChannelByObjectId(i),r=n?e.channelService.getTeamByObjectId(n.parentTeamId):null;r&&e.applyBadgesOnChannels(r,[n],!1)})},e.prototype.listenForChannelFavoriting=function(){var e=this;return this.eventingService.unsafeOn(this.constants.events.channels.updatedChannel,function(t,i){var n=e.channelService.getChannelByObjectId(i),r=n?e.channelService.getTeamByObjectId(n.parentTeamId):null;r&&n.showNewBadge&&(n.isFavorite?r.nonFavoriteChannelsWithNewBadge--:r.nonFavoriteChannelsWithNewBadge++)})},e.prototype.listenForSettingUpdates=function(){var e=this;this.eventingService.unsafeOn(this.constants.events.settings.updated,function(){e.loggingService.info("[teamchannelNewBadgeService] settings update");var t=e.enableNewBadgeOnlyOnChannels,i=e.enableNewTeamsAndChannelsBadge;e.newTeamsAndChannelsBadgeSettings=e.settingsService.valueFor(e.constants.settings.names.newTeamsAndChannelsBadge),e.enableNewTeamsAndChannelsBadge||(e.loggingService.info("[teamchannelNewBadgeService] New badging on teams is not enabled"),e.unsubscribeTeamAdditions&&e.unsubscribeTeamAdditions()),e.enableNewTeamsAndChannelsBadge||e.enableNewBadgeOnlyOnChannels||(e.loggingService.info("[teamchannelNewBadgeService] New badging on channels is not enabled"),e.unsubscribeChannelFavoriting&&e.unsubscribeChannelFavoriting(),e.unsubscribeChannelAdditions&&e.unsubscribeChannelAdditions()),!e.enableNewBadgeOnlyOnChannels&&!e.enableNewTeamsAndChannelsBadge||t||i||(e.loggingService.info("[teamchannelNewBadgeService] new badging on teams/channels is enabled"),e.listenForTeamAndChannelUpdates())})},e.prototype.sendNewBadgeTelemetry=function(){var e=this;this.shouldSendTelemetry&&_.defer(function(){var t={panel:{type:teamspace.PanelType[teamspace.PanelType.teamList],region:teamspace.PanelRegion[teamspace.PanelRegion.left],launchMethod:teamspace.components.LaunchMethod[teamspace.components.LaunchMethod.direct],previousUri:void 0,previousUriParams:void 0,uri:e.$state.current.name,uriParams:e.loggingService.hashUriParamsPII(e.$state.params),viewId:e.utilityService.generateUUID()},dataBag:{newTeams:e.teamsWithNewBadge.length,newChannels:e.channelsWithNewBadge.length}};e.analyticsService.sendPanelView(t)})},e.prototype.isTeamNew=function(e){var t=Number.MAX_VALUE;return e.lastJoinAt?t=this.timeDiffFromCurrentInHours(e.lastJoinAt):e.createdAt&&(t=this.timeDiffFromCurrentInHours(e.createdAt)),t<this.teamAndChannelNewBadgeDurationInHours},e.prototype.isChannelNew=function(e){var t=Number.MAX_VALUE;return e.createdAt&&(t=this.timeDiffFromCurrentInHours(e.createdAt)),t<this.teamAndChannelNewBadgeDurationInHours},e.prototype.hasTeamBeenSeen=function(e){var t=this;return _.some(e.channels,function(e){return t.hasChannelBeenSeen(e)})},e.prototype.hasChannelBeenSeen=function(e){return!!e.lastSeen&&parseInt(e.lastSeen)>0},e.prototype.timeDiffFromCurrentInHours=function(e){var t=!1,i=Date.now()/1e3-parseInt(e);return i<0&&(i+=30),i>=0&&(t=!0),(i=t?i:(Date.now()-parseInt(e))/1e3)/3600},e}();t.TeamChannelNewBadgeService=n,angular.module("teamspace.teamChannelNewBadgeService",["teamspace.channelService","teamspace.constants","teamspace.analyticsService","teamspace.eventingService","teamspace.loggingService","teamspace.settingsService","teamspace.utilityService"]).service("teamChannelNewBadgeService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(210),r=i(211),s=i(212),a=i(213),o=i(76),c=i(214),l=i(215),p=i(216),u=i(77),h=i(217);i(222),i(223),i(224),i(225),i(226),i(227),i(228),i(78),i(229),angular.module("skypeX.chatSyncService",["skypeX.chatServiceClient","skypeX.conversationsStore","skypeX.longPollSubscription","skypeX.notificationsStore","skypeX.messageStore","skypeX.replyChainStore","skypeX.persistenceService","skypeX.myUserPreferencesStore","skypeX.chatSyncPriorityService","skypeX.teamsDataService","skypeX.syncEndpointService","skypeX.syncLongPollService","skypeX.syncTelemetryService","teams.models","teamspace.chatListService","teamspace.resourceManager","teamspace.htmlSanitizer","skypeX.syncStateService","teamspace.messageSanitizingService"]).service("chatSyncService",n.ChatSyncService).factory("syncScheduler",["$injector",function(e){return e.instantiate(u.SyncSchedulerService,{forceStrategy:h.BasicSyncStrategy})}]),angular.module("skypeX.skypeModelFactory",["skypeX.sxConfig","teamspace.constants","teamspace.settingsService","teamspace.sfbInteropService","teamspace.utilityService"]).service("skypeModelFactory",l.SkypeModelFactory),angular.module("skypeX.conversationsStore",["skypeX.sxConfig","skypeX.clientDatabase","skypeX.chatServiceClient","skypeX.teamsObjectsAdapter","skypeX.syncStateService","skypeX.skypeModelFactory","teamspace.loggingService","teamspace.settingsService","teamspace.utilityService","teamspace.messageSanitizingService"]).service("skypeConversationsStore",c.SkypeConversationsStore).factory("conversationsStore",["$injector",function(e){return e.get("skypeConversationsStore")}]).run(["constants","settingsService",function(e,t){SkypeX.Services.EnableSkypeMessageLocalNewAssignment=t.valueAsBoolean(e.settings.names.enableSkypeMessageLocalNewAssignment),SkypeX.Services.enableFastObjectClones=t.valueAsBoolean(e.settings.names.enableFastObjectClones)}]),angular.module("skypeX.chatServiceClient",["teamspace.appState","teamspace.authenticationService","teamspace.config","teamspace.constants","teamspace.geoRoutingService","teamspace.loggingService","teamspace.messagingUtilities","teamspace.qNoApply","teamspace.settingsService","skypeX.sxConfig"]).service("realChatServiceClient",o.RealChatServiceClient).service("mockChatServiceClient",r.MockChatServiceClient).factory("chatServiceClient",["$injector","settingsService",function(e,t){var i=t.valueAsBoolean("useMockChatService");return e.get(i?"mockChatServiceClient":"realChatServiceClient")}]),angular.module("skypeX.chatServiceV2Client",["teamspace.appState","teamspace.authenticationService","teamspace.config","teamspace.constants","teamspace.geoRoutingService","teamspace.loggingService","teamspace.messagingUtilities","teamspace.qNoApply","teamspace.settingsService","skypeX.sxConfig"]).service("chatServiceV2Client",p.ChatServiceV2ClientImplementation),angular.module("skypeX.longPollSubscription",["skypeX.chatServiceClient","skypeX.endpointService"]).service("oldLongPollService",s.OldLongPollService).service("longPollServiceV1",a.LongPollServiceV1).factory("longPollService",["$injector","constants","settingsService",function(e,t,i){var n=i.valueAsBoolean(t.settings.names.enableNewLongpollService);return e.get(n?"longPollServiceV1":"oldLongPollService")}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(30),r=i(74),s=i(75),a=i(31),o=SkypeX.Services.ChatServiceUtils,c=teamspace.services.MessagingUtilities,l=SkypeX.Services.SkypeMessageSource;t.ExtendMessageHistoryCount=20,t.CheckRetentionPruningIntervalSeconds=600,t.SettingForcePruneIntervalSeconds="retentionForcePruneIntervalSeconds",t.DefaultForcePruneIntervalSeconds=86400,t.RetentionForcePruneTimestampKey="retentionForcePruneTimestamp";var p=function(){function e(e,t,i){this.constants=e,this.syncScheduler=t,this.eventingService=i,this.conversationTargets=[]}return e.$inject=["constants","syncScheduler","eventingService"],e.prototype.initialize=function(){var e=this;this.syncScheduler.subscribe(function(){return e.updateTargets()}),this.updateTargets()},e.prototype.updateTargets=function(){var e=this;this.conversationTargets=_.chain(this.syncScheduler.scheduledResources).map(function(t){return e.getConversationIdForResource(t)}).filter(function(e){return!!e}).uniq().value(),this.eventingService.$emit(this.constants.events.syncService.syncTargetsUpdated,this.conversationTargets)},e.prototype.getConversationIdForResource=function(e){var t=null;if(t=n.MessageSyncJob.getConversationId(e),t=t||a.ThreadDetailsSyncJob.getConversationId(e)){var i=t.indexOf(";messageid");i>-1&&(t=t.substr(0,i))}return t},e}(),u=function(){function e(e,t,i,n,r,s,a,o,c,l,u,h,d,g,v){var m=this;this.$injector=e,this.$interval=t,this.$q=i,this.clientDatabase=n,this.constants=r,this.conversationsStore=s,this.eventingService=a,this.loggingService=o,this.settingsService=c,this.messageStore=l,this.replyChainStore=u,this.myUserPreferencesStore=h,this.orchestrationService=d,this.syncLongPollService=g,this.syncScheduler=v,this.didStartup=!1,this.initialConversationListSyncStart=SkypeX.Services.SyncTasks.Defer(),this.initialConversationListSyncComplete=SkypeX.Services.SyncTasks.Defer(),this.initialSyncComplete=SkypeX.Services.SyncTasks.Defer(),this.relatedMessageSyncs={},this.logger=this.loggingService.newLogger("ChatSyncService"),this.allowLeave=this.settingsService.valueAsBoolean(this.constants.settings.names.enableLeaveChat),this.syncTargets=e.instantiate(p),this.throttledSyncPoke=_.throttle(function(){m.didStartup&&m.syncScheduler.start(!0)},this.settingsService.valueFor("chatSyncThrottledPoke")||9e4,{trailing:!1})}return e.$inject=["$injector","$interval","$q","clientDatabase","constants","conversationsStore","eventingService","loggingService","settingsService","messageStore","replyChainStore","myUserPreferencesStore","orchestrationService","syncLongPollService","syncScheduler"],Object.defineProperty(e.prototype,"newTeamsStoreEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.useChatSvcAggStartup)},enumerable:!0,configurable:!0}),e.prototype.startup=function(){var e=this;return this.didStartup?SkypeX.Services.SyncTasks.Resolved():(this.syncTargets.initialize(),this.eventingService.unsafeOn(this.constants.events.syncService.conversationListSyncStart,_.once(function(){return e.initialConversationListSyncStart.resolve(void 0)})),this.eventingService.unsafeOn(this.constants.events.syncService.conversationListSyncComplete,_.once(function(){return e.initialConversationListSyncComplete.resolve(void 0)})),this.eventingService.unsafeOn(this.constants.events.syncService.backgroundSyncComplete,_.once(function(){return e.initialSyncComplete.resolve(void 0)})),this.syncLongPollService.subscribe(function(t,i){return e.onLongPollMessages(i)},SkypeX.Services.SyncLongPollService.EventType_MessageUpdates),this.syncLongPollService.subscribe(function(t,i){return e.onLongPollConversations(i)},SkypeX.Services.SyncLongPollService.EventType_ConversationUpdates),this.syncLongPollService.subscribe(function(t,i){return e.onLongPollThreads(i)},SkypeX.Services.SyncLongPollService.EventType_ThreadUpdates),this.syncLongPollService.subscribe(function(){return e.onLongpollSubscriptionEvent()},SkypeX.Services.SyncLongPollService.EventType_Subscription),this.syncLongPollService.subscribe(function(){return e.onLongPollResyncEvent()},SkypeX.Services.SyncLongPollService.EventType_Resync),this.syncLongPollService.subscribe(function(t,i){return e.myUserPreferencesStore.handleUserPreferenceDeltaUpdates(i)},SkypeX.Services.SyncLongPollService.EventType_CustomUserProperties),this.syncLongPollService.subscribe(function(t,i){return e.onLongPollThreadPropertyUpdates(i)},SkypeX.Services.SyncLongPollService.EventType_ThreadPropertyUpdate),this.orchestrationService.registerAction(this.constants.actions.chatSync.offline,function(){return e.disableSync("orchestration offline"),e.$q.when()}),this.orchestrationService.registerAction(this.constants.actions.chatSync.online,function(){return e.enableSync("orchestration online"),e.$q.when()}),this.syncLongPollService.startup(),this.settingsService.valueAsBoolean("enableReplyChainApi")&&this.replyChainStore.startup(),this.settingsService.valueAsBoolean(r.SettingEnableTailPruning)&&this.$interval(function(){return e.forceRetentionPrune()},1e3*t.CheckRetentionPruningIntervalSeconds,void 0,!1),this.enableSync("startup"),this.didStartup=!0,SkypeX.Services.SyncTasks.Resolved())},e.prototype.waitForInitialConversationListSyncStart=function(){return this.initialConversationListSyncStart.promise().toNgPromise(this.$q)},e.prototype.waitForInitialConversationListSync=function(){return this.initialConversationListSyncComplete.promise().toNgPromise(this.$q)},e.prototype.disableSync=function(e){this.syncEnabled&&(this.logger.info("Disabled: {0}",e),this.syncEnabled=!1,this.syncLongPollService.stopLongPollTimer(),this.syncScheduler.pause())},e.prototype.enableSync=function(e){this.syncEnabled?this.logger.info("Enablement ignored - already enabled: {0}",e):(this.logger.info("Enabled: {0}",e),this.syncEnabled=!0,this.syncScheduler.start())},e.prototype.onLongPollThreadPropertyUpdates=function(e){this.conversationsStore.patchConversation(e.id,function(t){t.threadProperties=t.threadProperties||{},_.assign(t.threadProperties,e.properties);var i=parseInt(e.version),n=parseInt(e.oldVersion);t.detailsVersion&&t.detailsVersion===n&&(t.detailsVersion=i)})},e.prototype.onLongPollConversations=function(e){var t=this,i=_.remove(e,function(e){return!t.conversationsStore.isSupported(e.id)});if(i.length>0&&this.logger.info(i.length+" unnsupported conversations filtered out. "+e.length+" conversations to process."),0!==e.length){var n=_.map(e,function(e){var i=t.conversationsStore.createConversationLocalFromConversation(e);return t.conversationsStore.applyConversationUpdate(i)});if(this.conversationsStore.updateConversations(n),this.newTeamsStoreEnabled){var r=!1;if(_.forEach(e,function(e){if(null===t.conversationsStore.getConversation(e.id))return r=!0,!1}),r){this.logger.info("Scheduling teams start up sync job from long poll conversation update.");var a=this.$injector.instantiate(s.TeamsStartupSyncJob,{config:{}});this.syncScheduler.schedule(a,0)}}}},e.prototype.onLongPollMessages=function(e){var t=this,i=_.remove(e,function(e){return!t.conversationsStore.isSupported(SkypeX.Services.SkypeMessageLocal.getConversationId(e))});if(i.length>0&&this.logger.info(i.length+" unnsupported conversation messages filtered out. "+e.length+" messages to process."),0!==e.length){var n=_.map(e,function(e){return SkypeX.Services.SkypeMessageLocal.getConversationId(e)+";"+e.id+"@"+e.version}).join(",");this.logger.info("LongPollMessages: {0}",n);var r=_.groupBy(e,function(e){var i=SkypeX.Services.SkypeMessageLocal.getConversationId(e),n=t.conversationsStore.dangerousGetConversationMutable(i);if(!n)return"unknown";var r=t.conversationsStore.isCSAReplyChainApiSupported(i),s=n.areMessagesSynced(),a=r?"replychainstore":"messagestore";return a+=s?"_persisted":"_unpersisted"});this.messageStore.handleSyncedMessages(r.messagestore_persisted,l.LongPoll,!0),this.messageStore.handleSyncedMessages(r.messagestore_unpersisted,l.LongPoll,!1),this.replyChainStore.handleSyncedMessages(r.replychainstore_persisted,{syncSource:l.LongPoll},!0),this.replyChainStore.handleSyncedMessages(r.replychainstore_unpersisted,{syncSource:l.LongPoll},!1)}},e.prototype.onLongPollThreads=function(e){var t=this;if(_.forEach(e,function(e){return t.conversationsStore.applyThreadUpdate(e)}),this.newTeamsStoreEnabled){var i=!1;if(_.forEach(e,function(e){if(null===t.conversationsStore.getConversation(e.id))return i=!0,!1}),i){this.logger.info("Scheduling teams start up sync job from long poll thread update.");var n=this.$injector.instantiate(s.TeamsStartupSyncJob,{config:{}});this.syncScheduler.schedule(n,0)}}},e.prototype.onLongpollSubscriptionEvent=function(){this.doCatchUpSync("longpoll endpoint and subscription established")},e.prototype.onLongPollResyncEvent=function(){this.doCatchUpSync('Longpoll(CNS) response has "previous" link or "resync" link')},e.prototype.doCatchUpSync=function(e){this.syncEnabled?this.settingsService.valueAsBoolean("disableChatSyncOnLongPollStateChange")||(this.logger.info(e+" - Forcing sync poke..."),this.throttledSyncPoke()):this.enableSync(e),this.myUserPreferencesStore.syncUserPreferencesFromServer()},e.prototype.getSyncStatusClass=function(e,t){var i=!1;switch(t){case SkypeX.Services.SyncStatusResource.Thread:i=this.conversationsStore.needsThreadSync(e);break;case SkypeX.Services.SyncStatusResource.Messages:i=this.conversationsStore.needsMessageSync(e)}return i?"queued":"complete"},e.prototype.getCurrentSyncTargets=function(){return this.syncTargets.conversationTargets},e.prototype.isCurrentlySyncing=function(){return this.syncScheduler.scheduledResources.length>0},e.prototype.isCurrentlySyncingTargetOrItsReplyChains=function(e){var t="messages/"+e;return!!_.find(this.syncScheduler.scheduledResources,function(e){return e.indexOf(t)>-1})},e.prototype.isSyncDisabled=function(){return!this.syncEnabled},e.prototype.extendMessageHistoryStartTime=function(e){var i=this.conversationsStore.getConversationSyncState(e);return!(!i||this.isCurrentlySyncingTargetOrItsReplyChains(e)||i.isSyncedToStartOfTime)&&(this.syncScheduler.activeStrategy.loadMoreMessages?this.syncScheduler.activeStrategy.loadMoreMessages(e):(this.syncScheduler.schedule(new n.MessageSyncJob(this.$injector,this.conversationsStore,this.eventingService,this.constants,e,{minimumUniqueReplyChains:t.ExtendMessageHistoryCount,extendStartTime:!0}),0),!0))},e.prototype.syncRelatedMessages=function(e,t,i){var r=this;if(void 0===i&&(i=SkypeX.Services.MessageViewType.ReplyChains),o.containsParentMessageId(e)||c.isClientLie(t))this.logger.error("syncRelatedMessages unfulfillable call: conversationId: {0} replyChainId: {1}",e,t);else{var s=e+"-"+t;if(this.relatedMessageSyncs[s])return;this.syncScheduler.schedule(new n.RelatedMessagesSyncJob(this.$injector,this.conversationsStore,this.eventingService,this.constants,e,t,i),0).promise.then(function(){r.relatedMessageSyncs[s]=Date.now()})}},e.prototype.startConversationListSync=function(){this.throttledSyncPoke()},e.prototype.forceSyncConversation=function(e,t){return void 0===t&&(t=!1),this.$q.when()},e.prototype.pokePreviewingDownload=function(e){this.forceSyncConversation(e,!0)},e.prototype.schedulePersistencePruning=function(e){var t="boolean"==typeof e?{force:e}:e,i=this.$injector.instantiate(r.PersistencePruningJob,{config:t});return this.syncScheduler.schedule(i,1).promise},e.prototype.forceRetentionPrune=function(){var e=this,i=function(){return e.clientDatabase.provider.put(e.clientDatabase.schema.stores.internaldata.name,{id:t.RetentionForcePruneTimestampKey,value:(new Date).toISOString()})};this.clientDatabase.provider.get(this.clientDatabase.schema.stores.internaldata.name,t.RetentionForcePruneTimestampKey).then(function(n){var r=n&&n.value&&Date.parse(n.value);r||i();var s=e.settingsService.valueFor(t.SettingForcePruneIntervalSeconds)||t.DefaultForcePruneIntervalSeconds;(!r||Date.now()>r+1e3*s)&&e.schedulePersistencePruning(!0).then(function(){return i()})})},e.prototype.waitForAllInitialSync=function(){return this.initialSyncComplete.promise().toNgPromise(this.$q)},e}();t.ChatSyncService=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s){this.$timeout=t,this.$q=i,this.sxConfig=s,this.subscriptionId=-1,this.maxPageSizeForConversations=r.valueFor(n.settings.names.maxPageSizeForConversations)||100,this.maxPageSizeForConvMessages=r.valueFor(n.settings.names.maxPageSizeForConvMessages)||100,this.maxPageSizeForTeamConversations=r.valueFor(n.settings.names.maxPageSizeForTeamConversations)||100}return e.$inject=["$injector","$timeout","$q","constants","settingsService","sxConfig"],e.prototype._getAuthHeaders=function(e){return void 0===e&&(e=!1),this.$q.when(SkypeX.Services.MockChatServiceClientData.TestAuthHeaders)},e.prototype.getMyProperties=function(){return SkypeX.Services.SyncTasks.when(SkypeX.Services.MockChatServiceClientData.TestPropertiesData)},e.prototype.setMyProperty=function(e,t){return SkypeX.Services.SyncTasks.when()},e.prototype.setMyDogfoodState=function(e){return SkypeX.Services.SyncTasks.when()},e.prototype.createEndpoint=function(e,t){return SkypeX.Services.SyncTasks.when(SkypeX.Services.MockChatServiceClientData.TestEndpointData)},e.prototype.publishEndpointPresence=function(e){return SkypeX.Services.SyncTasks.when()},e.prototype.getMyPresence=function(){return SkypeX.Services.SyncTasks.when(SkypeX.Services.MockChatServiceClientData.TestPresenceData)},e.prototype.setMyPresenceStatus=function(e){return SkypeX.Services.SyncTasks.when()},e.prototype.createLongPollSubscriptionId=function(e){return this.subscriptionId++,SkypeX.Services.SyncTasks.when(this.subscriptionId.toString())},e.prototype.updateLongPollInterestedResources=function(e,t){return SkypeX.Services.SyncTasks.when()},e.prototype.deleteLongPollSubscription=function(e){return SkypeX.Services.SyncTasks.when()},e.prototype.pollSubscription=function(e,t){var i=SkypeX.Services.SyncTasks.Defer();return this.$timeout(function(){return i.resolve(void 0)},27e3,!1),i.promise()},e.prototype.postActiveEndpoint=function(e,t){return SkypeX.Services.SyncTasks.when()},e.prototype.getMyConversations=function(e,t,i,n){return void 0===e&&(e="All"),void 0===t&&(t=1),void 0===i&&(i=null),void 0===n&&(n=this.maxPageSizeForConversations),SkypeX.Services.SyncTasks.when(SkypeX.Services.MockChatServiceClientData.TestConversationsFetchResponse)},e.prototype.getTeamConversations=function(e,t,i){return void 0===i&&(i=this.maxPageSizeForTeamConversations),SkypeX.Services.SyncTasks.when(SkypeX.Services.MockChatServiceClientData.TestConversationsFetchResponse)},e.prototype.setConversationProperty=function(e,t,i,n,r){return SkypeX.Services.SyncTasks.when()},e.prototype.getConversationConsumptionHorizons=function(e){return SkypeX.Services.SyncTasks.when(SkypeX.Services.MockChatServiceClientData.TestConsumptionHorizonsFetchResponse)},e.prototype.setConversationConsumptionHorizon=function(e,t,i){return void 0===i&&(i=!1),SkypeX.Services.SyncTasks.when()},e.prototype.setConversationAlerts=function(e,t){return SkypeX.Services.SyncTasks.when()},e.prototype.getConversationMessages=function(e,t){void 0===t&&(t={});var i=angular.copy(SkypeX.Services.MockChatServiceClientData.TestMessagesFetchResponse);return i.messages.forEach(function(t){t.conversationLink=t.conversationLink.replace("<convId>",e)}),SkypeX.Services.SyncTasks.when(i)},e.prototype.getConversationMessage=function(e,t){var i=angular.copy(SkypeX.Services.MockChatServiceClientData.TestMessagesFetchResponse).messages.filter(function(e){return e.conversationLink.indexOf("messageid")<0})[0];return i.id=t,SkypeX.Services.SyncTasks.when(i)},e.prototype.postMessageToConversation=function(e,t,i,n){var r=SkypeX.Services.SyncTasks.Defer(),s=Date.now();return this.$timeout(function(){return r.resolve({id:s.toString(),originalarrivaltime:s})},50,!1),r.promise()},e.prototype.deleteMessage=function(e,t){return SkypeX.Services.SyncTasks.when()},e.prototype.editMessage=function(e,t,i){return SkypeX.Services.SyncTasks.when()},e.prototype.setMessageProperty=function(e,t,i,n,r){return void 0===r&&(r=!1),SkypeX.Services.SyncTasks.when()},e.prototype.createThread=function(e,t,i){return void 0===i&&(i={}),SkypeX.Services.SyncTasks.when({})},e.prototype.getThread=function(e){var t=angular.copy(SkypeX.Services.MockChatServiceClientData.TestThread),i=this.sxConfig.getCurrentSkypeMri();return t.members[0].id=i,t.members[0].userlink+=i,SkypeX.Services.SyncTasks.when(t)},e.prototype.getThreads=function(e){var t=this;return SkypeX.Services.SyncTasks.whenAll(_.map(e,function(e){return t.getThread(e)}))},e.prototype.setThreadProperty=function(e,t,i,n){return SkypeX.Services.SyncTasks.when()},e.prototype.addMemberToThread=function(e,t,i,n,r,s){return void 0===i&&(i="Admin"),SkypeX.Services.SyncTasks.when()},e.prototype.addMembersToThread=function(e,t,i){return SkypeX.Services.SyncTasks.when({})},e.prototype.removeMemberFromThread=function(e,t){return SkypeX.Services.SyncTasks.when()},e.prototype.postInvoke=function(e){return SkypeX.Services.SyncTasks.when({})},e.prototype.setMemberMuted=function(e,t,i){return SkypeX.Services.SyncTasks.when()},e.prototype.setMembersMuted=function(e,t,i){return this.$q.resolve(SkypeX.Services.MuteAllResult.Success)},e.prototype.getTeamMembers=function(e,t,i,n,r,s){return void 0===t&&(t=null),void 0===i&&(i=100),SkypeX.Services.SyncTasks.when({})},e.prototype.getMembersPropertiesIfInTeam=function(e,t,i){return SkypeX.Services.SyncTasks.when([])},e.prototype.getMemberPropertiesIfInTeam=function(e,t,i){return SkypeX.Services.SyncTasks.when({})},e}();t.MockChatServiceClient=n},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n,r,s,a,o,c,l,p){var u=e.call(this)||this;return u.chatServiceClient=t,u.constants=i,u.loggingService=n,u.endpointService=r,u.eventingService=s,u.utilityService=a,u.$q=o,u.$qNoApply=c,u.$timeout=l,u.settingsService=p,u.currentSubscriptionPromises={},u.logger=u.loggingService.newLogger("LongPollService"),u}return n(t,e),t.$inject=["chatServiceClient","constants","loggingService","endpointService","eventingService","utilityService","$q","$qNoApply","$timeout","settingsService"],t.prototype.createNewSubscription=function(e,t,i,n,r){var s=this;if(void 0===r&&(r=!1),n=n||_.noop,this.settingsService.valueAsBoolean("disableLongPoll"))return this.logger.warn("Long poll is disabled by setting"),n(!0),null;var a=r?this.$qNoApply:this.$q,o=function(e){s.createNewSubscription(e,t,i,n)},c=(this.currentSubscriptionPromises[t]||a.when(null)).then(function(e){return e?s.stopSubscription(e,t):a.when()}).then(function(){s.logger.info("Creating a new subscription for {0}.",t);var r=new SkypeX.Services.LongPollSubscription(a,s.$timeout,s.chatServiceClient,s.constants,s.loggingService,s.endpointService,s.eventingService,s.settingsService,s.utilityService,e,i,o,n,t);return r.init(),s.eventingService.$emit(s.constants.events.longpoll.newSubscriptionCreated+t,{longpoll:r}),r});return this.currentSubscriptionPromises[t]=c,c},t.prototype.stopSubscription=function(e,t){var i=this,n=e.getSubscriptionId();return e.killCurrentSubscription(!0).then(function(){i.logger.info("Killed the current subscription for {0} - subscriptionId: {1}",t,n)},function(e){var r="The current subscription could not be killed or properly cleaned up - "+JSON.stringify(e);i.logger.warn("{0} Requestor: {1}, Subscription Id: {2}",r,t,n)})},t}(SkypeX.Services.ObservableBase);t.OldLongPollService=r},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n,r,s,a,o,c,l){var p=e.call(this)||this;return p.$q=t,p.$timeout=i,p.chatServiceClient=n,p.constants=r,p.endpointService=s,p.eventingService=a,p.loggingService=o,p.settingsService=c,p.utilityService=l,p.endpointId=null,p.subscriptionId=null,p.subscriptionCreationInFlight=!1,p.subscriptionErrorCount=0,p.longPollInFlight=!1,p.longPollMaxDuration=6e4,p.longPollErrorCount=0,p.defaultDelayOnError=2,p.maxWaitTime=120,p.logger=p.loggingService.newLogger("Longpoll Service"),p.queryLongPollBound=p.queryLongPoll.bind(p),p.createSubscriptionBound=p.createSubscription.bind(p),p.subscriptionCreationDeferred=p.$q.defer(),p.endpointService.subscribe(p.onEndpointUpdate.bind(p),p.endpointService.Type_Endpoint),p.eventingService.unsafeOn(p.constants.events.settings.updated,function(){p.endpointId&&p.subscriptionId&&!p.isSyncEndpointServiceEnabled&&p.messageTypes&&!p.messageTypes.includes(SkypeX.Services.ChatServiceUtils.syncResources[0])&&p.updateInterestedResources(p.messageTypes)}),p}return n(t,e),t.$inject=["$q","$timeout","chatServiceClient","constants","endpointService","eventingService","loggingService","settingsService","utilityService"],Object.defineProperty(t.prototype,"isSyncEndpointServiceEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableSyncEndpointService)},enumerable:!0,configurable:!0}),t.prototype.updateInterestedResources=function(e){var t=this;if(!e||!e.length)return this.$q.reject(teamspace.services.ErrorPayload.create("InvalidCommandParameter","No interested resource is given."));if(this.setMessageTypes(e),!this.endpointService.isConnected()){this.logger.warn("Failed to update interested resources. Chat Service end point is disconnected.");var i=teamspace.services.ErrorPayload.create("ResourceNotFound","Chat Service end point is disconnected.");return this.$q.reject(i)}var n=this.loggingService.newScenario(this.constants.scenarios.longpollUpdateInterestedResources),r={data:JSON.stringify({interestedResourcesCount:e.length,subscriptionId:this.subscriptionId})};return this.logger.debug("Updating interested resources for subscription: {0}",this.subscriptionId),this.subscriptionCreationDeferred.promise.then(function(){return t.chatServiceClient.updateLongPollInterestedResources(t.subscriptionId,t.messageTypes).toNgPromise(t.$q).then(function(){t.logger.debug("Successfully updated interested resources for subscription: {0}",t.subscriptionId),n.stop(r)},function(e){return t.logger.error("Failed to update interested resources for subscription: {0}",t.subscriptionId),r.error=e,n.fail(r),t.$q.reject(e)})})},t.prototype.onEndpointUpdate=function(e,t){if(t){var i=!1;if(t.subscriptions&&t.subscriptions.length>0){var n=_.find(t.subscriptions,function(e){return e&&e.channelType&&"httplongpoll"===e.channelType.toLowerCase()});n&&(i=!0,this.subscriptionId=n.id&&n.id.toString(),this.logger.info("Subscription exists for endpoint - Subscription Id: {0}",this.subscriptionId))}i?(this.longPollInFlight||this.queryLongPoll(),this.trigger(this.constants.NewLongPollService.EventType_Subscription)):(this.endpointId=t.id,this.cleanup(),this.createSubscription())}else this.cleanup()},t.prototype.setMessageTypes=function(e){var t=_.isEmpty(e)?[SkypeX.Services.ChatServiceUtils.presenceResource]:e;this.messageTypes=this.isSyncEndpointServiceEnabled?t:SkypeX.Services.ChatServiceUtils.syncResources.concat(t)},t.prototype.abortLongPollRequest=function(){this.longPollRequestDeferred&&(this.logger.info("Aborting current longPoll request - Subscription Id:{0}",this.subscriptionId),this.utilityService.abortHttpRequest(this.longPollRequestDeferred))},t.prototype.cleanup=function(){this.subscriptionId&&(this.subscriptionId=null,this.abortLongPollRequest(),this.subscriptionCreationDeferred=this.$q.defer())},t.prototype.createSubscription=function(){var e=this;if(this.subscriptionCreationInFlight)return this.logger.warn("Subscription is already getting created"),this.$q.when();this.subscriptionCreationInFlight=!0,this.subscriptionScenario=this.subscriptionScenario||this.loggingService.newScenario(this.constants.scenarios.longpollSubscription),this.setMessageTypes();var t=this.chatServiceClient.createLongPollSubscriptionId(this.messageTypes).toNgPromise(this.$q);return this.utilityService.getPromiseWithTimeout(t,this.constants.promise.defaultTimeout,this.$q).then(function(t){if(!t)return e.logger.error("subscription not returned in the network call"),e.subscriptionScenario.fail({endpointId:e.endpointId}),void(e.subscriptionScenario=null);e.subscriptionId=t,e.subscriptionCreationInFlight=!1,e.subscriptionErrorCount=0,e.subscriptionCreationDeferred.resolve(),e.subscriptionScenario.stop({endpointId:e.endpointId}),e.subscriptionScenario=null,e.trigger(e.constants.NewLongPollService.EventType_Subscription),e.logger.info("Subscription created - Subscription Id: {0}",t),e.queryLongPoll()}).catch(function(t){if(e.subscriptionCreationInFlight=!1,!e.endpointService.isConnected())return e.logger.warn("Endpoint/network got disconnected during subscription creation"),e.subscriptionScenario.cancel({endpointId:e.endpointId}),e.subscriptionScenario=null,e.$q.reject(t);var i=JSON.stringify(t);e.logger.error(i),e.subscriptionErrorCount++,e.subscriptionErrorCount>2?(e.subscriptionScenario.fail({endpointId:e.endpointId,errorInfo:i}),e.subscriptionScenario=null):e.subscriptionScenario.mark("subscription_creation_retry",{endpointId:e.endpointId,errorInfo:i});var n=Math.min(e.maxWaitTime,Math.pow(e.defaultDelayOnError,e.subscriptionErrorCount)),r=t&&Number(t.statusCode);-1==r||r>=400&&r<500?(e.logger.info("Subscription creation retry: Reconnecting to endpoint"),e.$timeout(function(){return e.endpointService.reconnectToEndpoint()},1e3*n,!1)):(e.logger.info("Subscription creation retry"),e.$timeout(e.createSubscriptionBound,1e3*n,!1))})},t.prototype.queryLongPoll=function(){var e=this;if(this.endpointService.shouldQueryLongPoll())if(this.longPollInFlight)this.logger.warn("long poll is already active");else if(this.endpointService.isConnected()){if(!this.subscriptionId)return this.logger.warn("subscription not yet created. Creating subscription..."),void this.createSubscription();this.longPollInFlight=!0,this.longPollRequestDeferred=this.$q.defer();var t=this.chatServiceClient.pollSubscription(this.subscriptionId,this.longPollRequestDeferred.promise).toNgPromise(this.$q).then(function(t){e.longPollInFlight=!1,e.longPollRequestDeferred=null,e.longPollErrorCount=0,e.triggerLongPollUpdate(t),e.queryLongPollBound()}).catch(function(t){if(e.longPollInFlight=!1,e.longPollRequestDeferred=null,e.endpointService.isConnected()){var i=JSON.stringify(t);e.logger.error(i);var n=t&&Number(t.statusCode);if(-1==n||n>=400&&n<500)e.reconnectToEndpointWithDelay(n);else{e.longPollErrorCount++;var r=Math.min(e.maxWaitTime,Math.pow(e.defaultDelayOnError,e.longPollErrorCount));e.$timeout(e.queryLongPollBound,1e3*r,!1)}e.trigger(e.constants.NewLongPollService.EventType_Longpoll_Killed,null,{error:t})}else e.logger.warn("Endpoint/network got disconnected")});this.utilityService.getPromiseWithTimeout(t,this.longPollMaxDuration,this.$q).catch(function(t){t&&t.message===e.constants.promise.timedOutMessage&&(e.logger.debug("LongPoll pending for {0} seconds; aborting it",e.longPollMaxDuration/1e3),e.abortLongPollRequest())})}else this.logger.warn("Endpoint got disconnected");else this.logger.info("Machine is locked, skip longpoll")},t.prototype.reconnectToEndpointWithDelay=function(e){var t=this,i=0;if(404===e){var n=this.settingsService.valueFor(this.constants.settings.names.maxEndpointReconnectWaitTimeInSecs)||15;i=_.random(0,n,!1)}this.$timeout(function(){return t.endpointService.reconnectToEndpoint()},1e3*i,!1)},t.prototype.triggerLongPollUpdate=function(e){if(e&&e.length){var t={presence:[],sync:[],consumptionhorizon:[]};_.forEach(e,function(e){if(e&&e.resourceType)if(e.resourceType===SkypeX.Services.ChatServiceUtils.SkypeEventMessage_ResourceType_UserPresence||e.resourceType===SkypeX.Services.ChatServiceUtils.SkypeEventMessage_ResourceType_EndpointPresence)t.presence.push(e);else if(t.sync.push(e),e.resourceType===SkypeX.Services.ChatServiceUtils.SkypeEventMessage_ResourceType_NewMessage){var i=e.resource;i&&i.messagetype&&i.messagetype===SkypeX.Services.ChatServiceUtils.MessageType_MemberConsumptionHorizonUpdate&&t.consumptionhorizon.push(i)}}),_.isEmpty(t.presence)||this.trigger(this.constants.NewLongPollService.EventType_Longpoll_Presence,null,t.presence),_.isEmpty(t.consumptionhorizon)||this.trigger(this.constants.NewLongPollService.EventType_Longpoll_ConsumptionHorizon,null,t.consumptionhorizon),this.settingsService.valueAsBoolean(this.constants.settings.names.enableSyncEndpointService)&&!this.settingsService.valueAsBoolean(this.constants.settings.names.runningscenariotests)||this.trigger(this.constants.NewLongPollService.EventType_Longpoll_Sync,null,t.sync)}else this.trigger(this.constants.NewLongPollService.EventType_Longpoll_Sync,null,[])},t}(SkypeX.Services.ObservableBase);t.LongPollServiceV1=r},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=teamspace.services.SyncStateStorageTarget,s=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m){var f=e.call(this)||this;f.$injector=t,f.$q=i,f.clientDatabase=n,f.constants=r,f.chatServiceClient=s,f.loggingService=a,f.messageSanitizingService=o,f.settingsService=c,f.skypeModelFactory=l,f.storageService=p,f.syncStateService=u,f.teamsObjectsAdapter=h,f.userResourcesSettingsStore=d,f.eventingService=g,f.appStateService=v,f.sxConfig=m,f._enableConversationCloning=!0,f._enableFrozenObjects=!1,f._conversationMap={},f.hasConversationsPromise=SkypeX.Services.SyncTasks.Defer(),f._conversationClones={},f._conversationsByTeam={},f._isCSAReplyChainSupported={},f.users={},f.enableSfBGateway=!1;return f._enableConversationCloning=!f.settingsService.valueAsBoolean(f.constants.settings.names.disableConversationCloning),f._enableFrozenObjects=!f._enableConversationCloning&&f.settingsService.valueAsBoolean("enableFrozenObjects"),f.eventingService.unsafeOn(f.constants.events.settings.updated,function(){f._enableConversationCloning=!f.settingsService.valueAsBoolean(f.constants.settings.names.disableConversationCloning)}),f.logger=f.loggingService.newLogger("ConversationsStore"),f.triggerLogger=function(e){return f.logger.error("trigger error: {0}",e)},f.useChatTopicForRoster=f.settingsService.valueAsBoolean("enableChatTopicRoster"),f.atMentionsRosterSyncEnabled=f.settingsService.valueAsBoolean(f.constants.settings.names.enableAtMentionsRosterSync),f.allowLeave=f.settingsService.valueAsBoolean(f.constants.settings.names.enableLeaveChat),f.evictFromDBThresholdInDays=f.settingsService.valueFor(f.constants.settings.names.evictFromDBThresholdInDays),f.replyChainSyncEnabled=f.settingsService.valueAsBoolean("enableReplyChainApi"),f.replyChainSyncEnabledFavorites=f.settingsService.valueAsBoolean("enableReplyChainApiFavorites"),f.replyChainSyncEnabledGeneral=f.settingsService.valueAsBoolean("enableReplyChainApiGeneral"),f.botsAllowedAsChatUsers=_.keys(f.settingsService.valueFor(f.constants.settings.names.botsAllowedForMedia)),f.useSyncStateService=f.settingsService.valueAsBoolean("useSyncStateService"),f.enableSfBGateway=f.settingsService.valueAsBoolean(f.constants.settings.names.enableSfBGateway),f}return n(t,e),t.$inject=["$injector","$q","clientDatabase","constants","chatServiceClient","loggingService","messageSanitizingService","settingsService","skypeModelFactory","storageService","syncStateService","teamsObjectsAdapter","userResourcesSettingsStore","eventingService","appStateService","sxConfig"],Object.defineProperty(t.prototype,"isLargeTeamsEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableLargeTeams)},enumerable:!0,configurable:!0}),t.prototype.loadFromPersistence=function(){return this.clientDatabase.provider.getAll(this.clientDatabase.schema.stores.conversations.name).then(function(e){return e.map(function(e){return new SkypeX.Services.SkypeConversationLocal(e)})})},t.prototype.isRosterStateInSync=function(e){if(!e.isChannelConversation()||!e.isUserMember())return!0;if(this.isLargeTeamsEnabled){if(!e.members&&e.rosterVersion&&e.memberProperties&&e.memberProperties[SkypeX.Services.ChatServiceUtils.MemberProp_Role]&&(!e.isSpaceConversation()||e.isSpaceConversation()&&e.rosterSummary&&e.rosterSummary.memberCount))return!0}else if(!e.isSpaceConversation()||e.isSpaceConversation()&&e.members)return!0;return!1},t.prototype.summarizeRoster=function(e){if(!this.isLargeTeamsEnabled)return e;var t={},i={memberCount:0,botCount:0,readerCount:0,roleCounts:{Admin:0,Guest:0,User:0}};if(e.members&&e.members.length)for(var n=0;n<e.members.length;n++){var r=e.members[n];if(r.id===this.curUserMri&&(t[SkypeX.Services.ChatServiceUtils.MemberProp_Reader]=r.isReader,t[SkypeX.Services.ChatServiceUtils.MemberProp_ExpirationTime]=r.memberExpirationTime,t[SkypeX.Services.ChatServiceUtils.MemberProp_Role]=r.role,!e.isTeam()))break;e.isTeam()&&(i.memberCount+=1,SkypeX.Services.ChatServiceUtils.isBotMri(r.id)?(i.botCount+=1,i.roleCounts.User+=1):r.role===this.constants.RoleConstants.Admin?i.roleCounts.Admin+=1:r.role===this.constants.RoleConstants.User?i.roleCounts.User+=1:r.role===this.constants.RoleConstants.Guest&&(i.roleCounts.Guest+=1),r.isReader&&(i.readerCount+=1))}return e.memberProperties=t,e.isTeam()&&(e.rosterSummary=i),e.rosterVersion=e.threadVersion,e.members=null,e},t.prototype.getFuncToSetRosterStateInConv=function(e){var t=this,i=new Map;if(this.isLargeTeamsEnabled){for(var n=0;n<e.length;n++){i.set(e[n],function(e){return t.summarizeRoster(e)})}return this.$q.resolve(i)}var r=this.loggingService.newScenario(this.constants.events.startup.conversationStoreFetchThreads),s=_.chunk(e,10),a=_.map(s,function(e){return t.chatServiceClient.getThreads(e).toNgPromise(t.$q).then(function(e){return e}).catch(function(e){return t.logger.error("getThreads to chatservice failed "+JSON.stringify(e)),[]})});return this.$q.all(a).then(function(e){for(var t=_.flatten(e),n=0;n<t.length;n++)!function(e){i.set(t[e].id,function(i){return i.members=t[e].members,i.rosterSummary=null,i})}(n);return i}).finally(function(){return r.stop({threadCounts:e&&e.length||0})})},t.prototype.ensureRosterStateInSyncOnLoad=function(e){var t=this;this.logger.info("[ensureRosterStateInSyncOnLoad] Large Teams is "+this.isLargeTeamsEnabled);var i=this.loggingService.newScenario(this.constants.events.startup.ensureRosterStateInSyncOnLoad),n=_.partition(e,function(e){return!t.isRosterStateInSync(e)}),r=n[0],s=n[1],a=_.map(r,function(e){return e.id}),o={convToBePersisted:[],convNotToBePersisted:e};if(!a||!a.length)return i.stop(),SkypeX.Services.SyncTasks.Resolved(o);var c=this.getFuncToSetRosterStateInConv(a).then(function(e){if(!e.size)return i.stop(),o;var t=_.map(r,function(t){return e.has(t.id)&&(t=e.get(t.id)(t)),t});return i.stop(),{convToBePersisted:t,convNotToBePersisted:s}});return SkypeX.Services.SyncTasks.fromNgPromise(c)},t.prototype.ensureRosterStateInSync=function(){var e=this;this.logger.info("[ensureRosterStateInSync] Large Teams is "+this.isLargeTeamsEnabled);var t=this.loggingService.newScenario(this.constants.events.startup.ensureRosterStateInSync),i=_.filter(this.dangerousGetAllConversationsMutable(),function(t){return!e.isRosterStateInSync(t)}),n=_.map(i,function(e){return e.id});return n&&n.length?this.getFuncToSetRosterStateInConv(n).then(function(n){if(!n.size)return t.stop(),!0;var r=_.map(i,function(t){if(n.has(t.id))return e.patchConversation(t.id,n.get(t.id))});return e.$q.all(r).then(function(){return!0}).catch(function(){return!1}).finally(function(){return t.stop()})}):(t.stop(),this.$q.resolve(!0))},t.prototype.startup=function(){var e=this;this.mruChannelsService=this.$injector.get("mruChannelsService"),this.curUserMri=this.sxConfig.getCurrentSkypeMri();var t,i=this.loggingService.newScenario("store_start_conversations");return this.loadFromPersistence().then(function(t){return e.ensureRosterStateInSyncOnLoad(t)}).then(function(i){if(t=i&&i.convToBePersisted.concat(i.convNotToBePersisted),i.convToBePersisted&&i.convToBePersisted.length)return e.updateConversations(i.convToBePersisted,!0)}).then(function(){i.mark("conversation_fetch_complete"),e.enableSfBGateway||(t=_.filter(t,function(e){return!e.isSfB()}));var n=[];_.forEach(t,function(i){e.migratePersistedSyncStatesToService(i),e.loadSyncState(i,t),i.messagesStale&&!i.isUserMember()&&n.push(i.id),e.resetSessionSyncStates(i)}),n.length>0&&e.loggingService.newScenario("messagestalereset").stop({count:n.length});var r=e.addSpaceIdToChannels(t);e.updateConversations(t,!1),r>0&&e.loggingService.newScenario("channelswithnospaceid").stop({count:r}),e.logger.info("Conversation store started with {0} conversations",t&&t.length),i.stop(),e.hasConversationsPromise.resolve(void 0),e.appStateService.setStartupState(teamspace.services.StartupState.LocalThreadDataFetched)},function(e){i.fail({error:e})})},t.prototype.addOrUpdateConversation=function(e,t){return void 0===t&&(t=!0),this.updateConversations([e],t)},t.prototype.createChatConversationLie=function(e,t){return this.skypeModelFactory.createChatConversationLie(e,t)},t.prototype.createReplyChainConversationLie=function(e,t){return this.skypeModelFactory.createReplyChainConversationLie(e,t)},t.prototype.createTeamConversationLie=function(e,t,i){return this.skypeModelFactory.createTeamConversationLie(e,t,i)},t.prototype.getConversationCount=function(){return _.filter(_.keys(this._conversationMap),function(e){return!SkypeX.Services.ChatServiceUtils.isReplyChain(e)}).length},t.prototype.getConversationsSummary=function(){return SkypeX.Services.getConversationsSummary(this.dangerousGetAllConversationsMutable())},t.prototype.isPersisted=function(e,t){var i=!0,n=t?_.find(t,function(t){return t.id===e}):this.dangerousGetConversationMutable(e);if(n){n&&n.isReplyChain()&&(n=t?_.find(t,function(e){return e.id===n.parentConversationId}):this.dangerousGetConversationMutable(n.parentConversationId));var r=this.replyChainSyncEnabled&&this.replyChainSyncEnabledFavorites;return this.replyChainSyncEnabled&&(r?SkypeX.Services.SkypeConversationLocal.isUnfavoriteChannel(n)&&(i=!1):i=!this.isCSAReplyChainApiSupported(n)),this.settingsService.valueAsBoolean("disableChannelPersistence")&&n&&n.isChannelConversation()&&(i=!1),i}},t.prototype.isPersistencePrunable=function(e){var t=!!this.syncStateService.getSyncState(e)&&this.syncStateService.getSyncState(e).isPersisted,i=this.isPersisted(e),n=this.isPrunableBasedOnMRU(e);return t&&(!i||n)},t.prototype.isPrunableBasedOnMRU=function(e){if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableMruChannels)){var t=this.dangerousGetConversationMutable(e);if(this.settingsService.valueAsBoolean(this.constants.settings.names.pruneConversationsAggressively)&&t&&t.isChannelConversation()&&!t.isMarkedForEviction()&&!this.mruChannelsService.contains(t.id))return!0;if(t&&t.isMarkedForEviction()&&Date.now()-t.mruEvictedTime>this.evictFromDBThresholdInDays*this.constants.timeInMiliseconds.day)return!0}return!1},t.prototype.isSynced=function(e,t){void 0===t&&(t=SkypeX.Services.SyncStatusResource.Messages),t=t instanceof Array?t:[t];var i=this.dangerousGetConversationMutable(e),n=this.getConversationSyncState(e);return!(!i||!n)&&_.every(t,function(e){switch(e){case SkypeX.Services.SyncStatusResource.Messages:return!!n.maxMessageVersion||!!n.messageHistoryStartTime;case SkypeX.Services.SyncStatusResource.Thread:return i.detailsVersion>0}})},t.prototype.isSupported=function(e){return!!(!teamspace.services.SfBInteropUtilsService.isSfBGatewayConversation(e)||this.enableSfBGateway&&teamspace.services.SfBInteropUtilsService.isSfbEligible(this.userResourcesSettingsStore))&&!(teamspace.services.SfBInteropUtilsService.isFederationConversation(e)&&!this.settingsService.valueAsBoolean(this.constants.settings.names.enableFederatedChat))},t.prototype.isCSAReplyChainApiSupported=function(e){var t=this.replyChainSyncEnabled&&this.replyChainSyncEnabledFavorites,i=!1,n="string"==typeof e?this.dangerousGetConversationMutable(e):e;if(this.replyChainSyncEnabled&&n){if(n.isReplyChain()&&!(n=this.dangerousGetConversationMutable(n.parentConversationId)))return!1;if(n.id in this._isCSAReplyChainSupported)return this._isCSAReplyChainSupported[n.id];var r=this.getConversationSyncState(n.id);SkypeX.Services.SkypeConversationLocal.isUnfavoriteChannel(n)?i=!0:t&&n.isChannelConversation()?i=!0:r.maxMessageVersion&&(i=!0),n.replyChainIndexFailure&&(i=!1),n.isTeam()&&!this.replyChainSyncEnabledGeneral&&(i=!1),!r.maxMessageVersion&&r.syncState&&(i=!1),this._isCSAReplyChainSupported[n.id]=i}return i},t.prototype.removeConversation=function(e){var t="string"==typeof e?e:e.id;this._removeConversationFromMap(t),this.clientDatabase.provider.remove(this.clientDatabase.schema.stores.conversations.name,t),this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_Conversation,t),this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_List,null,[]),this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_Remove,t)},t.prototype.resolveLie=function(e,t){t.localClientId=e.id,this._addOrUpdateConversations([t],!0),this._removeConversationFromMap(e.id),this.clientDatabase.provider.remove(this.clientDatabase.schema.stores.conversations.name,e.id);var i={lie:e,real:t};this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_Resolve,e.id,i)},t.prototype.needsMessageSync=function(e){if(!this.userHasAccess(e))return!1;var t=this.dangerousGetConversationMutable(e);return this.getConversationSyncState(e).messagesStale&&!t.isVirtual()},t.prototype.needsThreadSync=function(e){if(!this.userHasAccess(e))return!1;var t=this.dangerousGetConversationMutable(e);return t.isThread()&&!t.isPrivateFeed()&&t.detailsVersion<t.threadVersion&&!t.isVirtual()&&!t.isDeleted()},t.prototype.userHasAccess=function(e){var t=this.dangerousGetConversationMutable(e),i=t;return t&&t.teamId&&t.teamId!==t.id&&(i=this.dangerousGetConversationMutable(t.teamId)),i&&(t.isChat()&&this.allowLeave||i.isUserMember())},t.prototype.setLocalConsumptionHorizon=function(e,t,i,n){void 0===n&&(n=!1);var r,s,a=null;n?(r=SkypeX.Services.ChatServiceUtils.ConversationProp_ConsumptionHorizonBookmark,s=this.constants.scenarios.consumptionHorizonBookmarkClientOnly):(r=SkypeX.Services.ChatServiceUtils.ConversationProp_ConsumptionHorizon,s=this.constants.scenarios.consumptionHorizonClientOnly);var o=this.loggingService.newScenario(s);if(this.getConversation(e))a=SkypeX.Services.SkypeConversationLocal.buildConsumptionHorizon(t,i),this.patchConversation(e,function(e){return e.properties[r]=a}),o.stop();else{var c="Conversation not found";this.logger.error("Error occurred while updating consumption horizon for thread {0} locally on client: {1}",e,c),o.fail({error:c})}return a},t.prototype.setFakeConsumptionHorizon=function(e,t){this.getConversation(e)&&(this.patchConversation(e,function(e){return e.saveCurrentConsumptionHorizon(t)}),this.setLocalConsumptionHorizon(e,this.constants.FakeConsumptionHorizonValue,t))},t.prototype.revertFakeConsumptionHorizon=function(e,t){if(!t)return!1;var i=this.dangerousGetConversationMutable(e);if(!i)return!1;var n=!1,r=i.getConsumptionHorizonOriginalArrivalTime(),s=i.getSavedConsumptionHorizon(),a=t.clientmessageid&&1===s.keys.length&&_.head(s.keys)===t.clientmessageid,o=!!s.consumptionHorizon&&s.keys.indexOf(t.clientmessageid)<0;if(a){if(r!==this.constants.FakeConsumptionHorizonValue&&r>t.originalArrivalTimeUtc)this.loggingService.event("RevertFakeConsumptionHorizon_Self_Rollback",(p={},p[this.constants.scenarioDataPropNames.data]=JSON.stringify({conversationid:i.id,beforeArrivalTime:r,afterArrivalTime:t.originalArrivalTimeUtc}),p));else{var c=this.setLocalConsumptionHorizon(e,t.originalArrivalTimeUtc,t.idUnion);this.trigger(SkypeX.Services.ConversationsStoreEvents.Type_ConsumptionHorizon,i.id,c),n=!0}n=!0}else if(o){var l=SkypeX.Services.SkypeConversationLocal.getConsumptionHorizonParts(s.consumptionHorizon);r!==this.constants.FakeConsumptionHorizonValue&&r>l.originalArrivalTime?this.loggingService.event("RevertFakeConsumptionHorizon_Saved_Rollback",(u={},u[this.constants.scenarioDataPropNames.data]=JSON.stringify({conversationid:i.id,beforeArrivalTime:r,afterArrivalTime:l.originalArrivalTime}),u)):(this.setLocalConsumptionHorizon(e,l.originalArrivalTime,l.clientMessageId),n=!0)}return n?this.patchConversation(i.id,function(e){return e.clearMessageFromSavedConsumptionHorizon(t,!0)}):i.shouldClearMessageFromSavedConsumptionHorizon(t)&&this.patchConversation(i.id,function(e){return e.clearMessageFromSavedConsumptionHorizon(t,!1)}),n;var p,u},t.prototype.keepChannelReadForMessage=function(e,t){var i=this.getConversation(e);i&&i.isRead()&&i.isChannelConversation()&&i.getConsumptionHorizonOriginalArrivalTime()<=t.originalArrivalTimeUtc&&this.setLocalConsumptionHorizon(i.id,t.originalArrivalTimeUtc,t.idUnion)},t.prototype.patchConversation=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!0);var r=this.dangerousGetConversationMutableInternal(e,this._enableFrozenObjects),s=this._enableConversationCloning&&this.getConversationInternal(e);if(!r)return this.$q.reject("conversation not found");var a;n&&(a=this.dangerousGetConversationMutableInternal(e,!this._enableFrozenObjects)),t(r),s&&t(s);var o=this._addOrUpdateConversations([r],i,!1,a&&[a]);return this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_List,null,[r]),o},t.prototype.updateConversations=function(e,t){void 0===t&&(t=!0);var i=this._addOrUpdateConversations(e,t);return this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_List,null,e),i},t.prototype._addOrUpdateConversations=function(e,t,i,n){var r=this;void 0===i&&(i=!0),void 0===n&&(n=[]);for(var s={},a=0;a<e.length;a++)this._addOrUpdateConversationHelper(e[a],s,i,n[a]);var o=_.filter(s,function(e){return!r._conversationMap[e.id]}),c=_.filter(e.concat(o),function(e){return r._isPersistable(e)});return t&&c.length?this.clientDatabase.provider.put(this.clientDatabase.schema.stores.conversations.name,c).toNgPromise(this.$q):this.$q.when()},t.prototype._addOrUpdateConversationHelper=function(e,t,i,n){var r=this;if(void 0===i&&(i=!0),!_.isNil(e)){var s=this._conversationMap[e.id];n&&(s=n);var a,o;if(s){var c=s.getConsumptionHorizon(),l=s.getConsumptionHorizonOriginalArrivalTime();a=s.isFavorite(),o=e.isFavorite();var p=e.getConsumptionHorizonOriginalArrivalTime();l!==this.constants.FakeConsumptionHorizonValue&&l>p&&(this.loggingService.event("UpdateConversations_Rollback_Last_Read",(S={},S[this.constants.scenarioDataPropNames.data]=JSON.stringify({conversationid:e.id,beforeArrivalTime:l,afterArrivalTime:p,beforeVersion:s.version,afterVersion:e.version}),S)),e.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_ConsumptionHorizon]=c)}this._addConversationToMap(e,i,s),e.teamId!==e.id&&delete this._conversationsByTeam[e.id],s&&a!==o&&this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_FavoriteChanged,e.id,{oldVal:a,newVal:o});var u=this._conversationsByTeam[e.teamId],h=null;if(u){var d=_.head(_.remove(u,function(t){return t.id===e.id}));h=d&&d.isChat()&&d.topicName(),u.push(e),this._conversationsByTeam[e.teamId]=u}else this._conversationsByTeam[e.teamId]=[e];if(u||e.isChat()){if(e.isChat()&&(s||e.isLie())&&e.topicName()!==h){var g=e.topicName(),v=g?h?"changed":"set":"removed",m=g?g.length:0,f=h?h.length:0;this.logger.info("Chat topic has been "+v+". New topic length is "+m+". Old topic length is "+f),this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_TopicChanged,e.id,e.topicName())}}else this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_TopicChanged,e.id,e.topicName());this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_Conversation,e.id),e.isTeam()&&e.getFakeTopics().forEach(function(e){r._conversationMap[e.id]||(t[e.id]=e,r._addOrUpdateConversationHelper(e,t))});var S}},t.prototype.getConversation=function(e){return this.getConversationInternal(e)},t.prototype.getConversationInternal=function(e){if(!this._enableConversationCloning)return this.dangerousGetConversationMutableInternal(e,!1);var t=this._conversationClones[e];if(null===t){var i=this._conversationMap[e];i&&(t=i.clone(),this._conversationClones[e]=t)}return t||null},t.prototype.createConversationLocalFromConversation=function(e){var t=SkypeX.Services.SkypeConversationLocal.fromConversation(e);return this.clearSyncState(t.id),t},t.prototype.createConversationLocalFromThread=function(e){var t=SkypeX.Services.SkypeConversationLocal.fromThread(e);return this.clearSyncState(t.id),t},t.prototype.markSyncStateMessagesStale=function(e,t){var i=this.syncStateService.getSyncState(e)||new SkypeX.Services.Sync.TeamsObjectSyncState(e);i.messagesStale=t,this.syncStateService.addUpdateSyncState([i],r.Memory)},t.prototype.markMessagesStale=function(e,t){this.patchConversation(e,function(e){return e.messagesStale=t}),this.markSyncStateMessagesStale(e,t)},t.prototype.markThreadAsDead=function(e){this.patchConversation(e,function(e){return e.markThreadAsDead()}),this.markSyncStateMessagesStale(e,!1)},t.prototype.markThreadAsDeletedAndRemoveFromStore=function(e,t){var i=this;return this.patchConversation(e,function(e){t&&(e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_IsDeleted]="true"),e.markThreadAsDead()}).then(function(){i.markSyncStateMessagesStale(e,!1),i.removeConversation(e)})},t.prototype.clearSyncState=function(e){var t=this.syncStateService.getSyncState(e)||new SkypeX.Services.Sync.TeamsObjectSyncState(e);t.syncState="",t.messageHistoryStartTime=null,t.isSyncedToStartOfTime=!1,t.messagesStale=!0,t.continuationToken=void 0,t.maxMessageVersion=void 0,t.lastSyncTime=void 0,t.clientCacheClearedAt=void 0,this.syncStateService.addUpdateSyncState([t],r.Memory)},t.prototype.clearAndPatchSyncState=function(e,t,i){var n=this.patchConversation(e,function(e){SkypeX.Services.SkypeConversationLocal.clearSyncState(e)},t,i);return this.clearSyncState(e),n},t.prototype.getConversationSyncState=function(e){var t=this.dangerousGetConversationMutable(e);if(t){if(this.useSyncStateService)return(i=this.syncStateService.getSyncState(e))||(i=new SkypeX.Services.Sync.TeamsObjectSyncState(e),this.syncStateService.addUpdateSyncState([i],r.Memory)),i;var i=new SkypeX.Services.Sync.TeamsObjectSyncState(e);return i.syncState=t.syncState,i.messageHistoryStartTime=t.messageHistoryStartTime,i.messagesStale=t.messagesStale,i.isSyncedToStartOfTime=t.isSyncedToStartOfTime,i.lastSyncTime=t.lastSyncTime,i.continuationToken=t.continuationToken,i.maxMessageVersion=t.maxMessageVersion,i.conversationVersion=t.version,i.clientCacheClearedAt=t.clientCacheClearedAt,i}},t.prototype.dangerousGetConversationMutable=function(e){return this.dangerousGetConversationMutableInternal(e,!1)},t.prototype.dangerousGetConversationMutableInternal=function(e,t){return t?this._conversationMap[e]&&this._conversationMap[e].clone():this._conversationMap[e]},t.prototype.isConversationAvailable=function(e){return!!this._conversationMap[e]},t.prototype.isConversationChat=function(e){var t=this.dangerousGetConversationMutable(e);return!!t&&t.isChat()},t.prototype.isConversationGroupChat=function(e){var t=this.dangerousGetConversationMutable(e);return!!t&&t.isGroupChat()},t.prototype.getConversationMapSize=function(){return Object.keys(this._conversationMap).length},t.prototype.getConversationClonesSize=function(){return Object.keys(this._conversationClones).length},t.prototype.dangerousGetConversationsMutable=function(e){void 0===e&&(e=!1);var t=_.filter(_.values(this._conversationMap),function(e){return e.type!==SkypeX.Services.ChatServiceUtils.ConversationType_Team});return e?t:_.filter(t,function(e){return!e.isReplyChain()})},t.prototype.dangerousGetAllConversationsMutable=function(e){void 0===e&&(e=!1);var t=_.values(this._conversationMap);return e?t:_.filter(t,function(e){return!e.isReplyChain()})},t.prototype.dangerousGetAllConversations=function(){for(var e=this.dangerousGetAllConversationsMutable(),t=0;t<e.length;++t)e[t]=this.getConversation(e[t].id);return e},t.prototype.applyConversationUpdate=function(e){e.lastMessage=_.isEmpty(e.lastMessage)?null:e.lastMessage,e.lastMessage&&(e.lastMessage=this.messageSanitizingService.sanitizeMessage(e.lastMessage));var t;if(this.isConversationPresent(e.id)){if(t=this.dangerousGetConversationMutableInternal(e.id,this._enableFrozenObjects),this.logger.debug("conversation exists with id: {0}",t.id),!t.version||t.version<e.version){this.logger.debug("newConversation.version is newer than existing conversation.version");var i=t.getConsumptionHorizon(),n=t.getConsumptionHorizonOriginalArrivalTime();t.properties=e.properties;var r=t.getConsumptionHorizonOriginalArrivalTime();if(n!==this.constants.FakeConsumptionHorizonValue&&n>r&&(this.loggingService.event("ConvUpdate_Rollback_Last_Read",(a={},a[this.constants.scenarioDataPropNames.data]=JSON.stringify({conversationid:t.id,beforeArrivalTime:n,afterArrivalTime:r,beforeVersion:t.version,afterVersion:e.version}),a)),t.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_ConsumptionHorizon]=i),e.memberProperties&&(t.memberProperties=e.memberProperties),t.version=e.version,t.clientUpdateTime=(new Date).toISOString(),e.lastMessage&&(t.lastMessage=e.lastMessage),e.threadProperties){0===t.detailsVersion&&(t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName]=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName]),e.threadProperties.version&&(t.threadVersion=Number(e.threadProperties.version));var s=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_RosterVersion];s&&(t.rosterVersion=Number(s)),SkypeX.Services.ChatServiceUtils.ThreadPropsInConversationView.forEach(function(i){e.threadProperties[i]?t.threadProperties[i]=e.threadProperties[i]:delete t.threadProperties[i]})}this._enableFrozenObjects&&(t.freeze(),this._conversationMap[t.id]=t)}}else this.logger.debug("creating new SkypeConversationLocal, id: {0}",e.id),t=this.createConversationLocalFromConversation(e);return this.updateConversationTypeAndProps(t),this.useChatTopicForRoster&&this.updateConversationMembersForChat(t,e),t;var a},t.prototype.applyThreadUpdate=function(e){var t;if(this.isConversationPresent(e.id)){var i=void 0,n=void 0;if(!(t=this.dangerousGetConversationMutableInternal(e.id,!0)).detailsVersion||t.detailsVersion<e.version){t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastJoinAt]&&(i=t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastJoinAt]),t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastLeaveAt]&&(n=t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastLeaveAt]);var r=void 0;if(t.isChat()&&!t.isThreadDead()&&!t.topicName()&&_.isEmpty(e.members)&&(r={id:t.id,oldMembers:!!t.members,numOldMembers:_.size(t.members),oldDetailsVersion:t.detailsVersion,oldThreadVersion:t.threadVersion,newMembers:!!e.members,numNewMembers:_.size(e.members),newDetailsVersion:e.version,newThreadVersion:e.version,wasUserMember:t.isUserMember}),t.members=e.members?e.members.slice():void 0,t.rosterVersion=e.rosterVersion,t.rosterSummary=e.rosterSummary,t.threadVersion=e.version,t.detailsVersion=e.version,t.threadProperties=e.properties,n&&(t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastLeaveAt]=n),i&&(t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastJoinAt]=i),this.settingsService.valueAsBoolean(this.constants.settings.names.enableRemoveBotFromChatMembers)&&t.isChat()&&t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ExtensionDefinitionContainer]){var s=SkypeX.Services.ChatServiceUtils.partitionBotsFromChatMembers(t.members,this.botsAllowedAsChatUsers),a=s.members,o=s.botMembers;t.members=a,t.botMembers=o}_.isEmpty(r)||this.loggingService.event("MembersSetToEmptyArray_1",{data:JSON.stringify(_.extend(r,{isUserMember:t.isUserMember()}))})}}else t=this.createConversationLocalFromThread(e);return this.updateConversationTypeAndProps(t),this.addOrUpdateConversation(t),t},t.prototype.getConversationListSyncStateFromLocalStorage=function(){return this.storageService.get(this.constants.storageNames.conversationListSyncToken,!0)},t.prototype.hasConversations=function(){var e=this;return this.hasConversationsPromise.promise().then(function(){return!_.isEmpty(e._conversationMap)})},t.prototype.getConversationListSyncState=function(){var e=this;return _.isUndefined(this.conversationListSyncState)?this.clientDatabase.provider.get(this.clientDatabase.schema.stores.internaldata.name,"priv_convlist_syncstate").then(function(t){var i=t?t.value:null;return e.conversationListSyncState=i,i}):SkypeX.Services.SyncTasks.Resolved(this.conversationListSyncState)},t.prototype.ensureLastMessage=function(e){var t=this,i={};_.forEach(e,function(e){var n=t.dangerousGetConversationMutable(e.conversationId);if(n){var r=!e.messagetype||0!==e.messagetype.indexOf(SkypeX.Services.ChatServiceUtils.ThreadActivityMessageTypePrefix)&&e.messagetype!==SkypeX.Services.ChatServiceUtils.MessageType_Call,s=!n.lastMessage||e.originalArrivalTimeUtc>=n.lastMessageTimeUtc||e.id===n.lastMessageId&&(e.editTime!==SkypeX.Services.SkypeMessageLocal.getEditTime(n.lastMessage)||e.deleteTime!==SkypeX.Services.SkypeMessageLocal.getDeleteTime(n.lastMessage));r&&s&&t.patchConversation(e.conversationId,function(t){i[e.conversationId]||(i[e.conversationId]=t),t.lastMessage=e,e.isHighImportance&&(t.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_LastImportantImTime]=e.originalarrivaltime)})}}),_.each(i,function(e){e&&e.lastMessage&&!e.lastMessage.isSanitized&&(e.lastMessage=t.messageSanitizingService.sanitizeMessage(e.lastMessage))})},t.prototype.isConversationPresent=function(e){return void 0!==this.dangerousGetConversationMutable(e)},t.prototype.loadSyncState=function(e,t){var i=this.syncStateService.getSyncState(e.id);if(i&&this.isPersisted(e.id,t)){e.syncState=i.syncState,e.messageHistoryStartTime=i.messageHistoryStartTime,e.isSyncedToStartOfTime=i.isSyncedToStartOfTime,e.lastSyncTime=i.lastSyncTime,e.continuationToken=i.continuationToken,e.clientCacheClearedAt=i.clientCacheClearedAt;var n=i.messagesStale||e.messagesStale;(!i.conversationVersion||e.version>i.conversationVersion)&&(n=!0),e.messagesStale=n,e.replyChainIndexFailure=void 0}else SkypeX.Services.SkypeConversationLocal.clearSyncState(e)},t.prototype.addSpaceIdToChannels=function(e){var t=0,i=_.filter(e,function(e){return e.isTeam()}),n=new Map;return _.forEach(e,function(e){return n.set(e.id,e)}),_.forEach(i,function(e){var i=e.getTopicMinis();_.forEach(i,function(i){if(!i.isdeleted){var r=n.get(i.id);r&&(r.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceId]||(++t,r.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceId]=e.id),r.teamId=r.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceId])}})}),t},t.prototype.migratePersistedSyncStatesToService=function(e){var t=e.persistedMessageSyncState;if(t){var i=this.syncStateService.getSyncState(e.id);i&&t.lastSyncTime>i.lastSyncTime||(i=i||new SkypeX.Services.Sync.TeamsObjectSyncState(e.id),_.assign(i,t),i.conversationVersion=e.version,this.syncStateService.addUpdateSyncState([i])),delete e.persistedMessageSyncState}},t.prototype.resetSessionSyncStates=function(e){SkypeX.Services.SkypeConversationLocal.clearSessionSyncState(e),this.syncStateService.setFailed(e.id,!1)},t.prototype.saveConversationListSyncState=function(e){return this.conversationListSyncState=e,this.storageService.set(this.constants.storageNames.conversationListSyncToken,e,!0),this.clientDatabase.provider.put(this.clientDatabase.schema.stores.internaldata.name,{id:"priv_convlist_syncstate",value:e})},t.prototype.updateConversationTypeAndProps=function(e){e.threadProperties?(e.type=SkypeX.Services.ChatServiceUtils.mapConversationType(e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]),e.teamId=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceId]?e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_SpaceId]:e.id):e.type=SkypeX.Services.ChatServiceUtils.ConversationType_Conversation},t.prototype.updateConversationMembersForChat=function(e,t){if(e.isChat()&&!e.members&&t.threadProperties&&t.threadProperties.topic){var i=SkypeX.Services.ChatRoster.getMembersFromTopic(t.threadProperties.topic);if(i)if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableRemoveBotFromChatMembers)&&t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ExtensionDefinitionContainer]){var n=SkypeX.Services.ChatServiceUtils.partitionBotsFromChatMembers(i,this.botsAllowedAsChatUsers),r=n.members,s=n.botMembers;e.members=r,e.botMembers=s}else e.members=i}},t.prototype._addConversationToMap=function(e,t,i){if(void 0===t&&(t=!0),this.atMentionsRosterSyncEnabled){var n={oldConversation:i,newConversation:e};this.triggerWithLogging(this.triggerLogger,SkypeX.Services.ConversationsStoreEvents.Type_ConversationUpdated,null,n)}this._enableFrozenObjects&&e.freeze(),this._conversationMap[e.id]=e,t&&this._enableConversationCloning&&(this._conversationClones[e.id]=null)},t.prototype._removeConversationFromMap=function(e){delete this._conversationMap[e],this._enableConversationCloning&&delete this._conversationClones[e]},t.prototype._isPersistable=function(e){return!!this.enableSfBGateway||!e.isSfB()},t.prototype.addUsers=function(e){var t=this;e.forEach(function(e){return t.users[e.mri]=e})},t.prototype.addOrUpdateChats=function(e,t){var i=this,n=[],r={emptyMembers:[],containingFalsyMembers:[]},s={emptyMembers:[],containingFalsyMembers:[]};return _.forEach(e,function(e){var a=e.chatSubType===Teams.Models.ChatSubType.Meeting||e.title&&e.title.indexOf(":")<0;a||i.checkForMalformedMembers(e,r);var o;try{o=i.teamsObjectsAdapter.convertChatToSkypeConversationLocal(e,t),a||i.checkForMalformedMembers(o,s),n.push(o)}catch(t){i.logger.error("Bad conversion of "+e.id+": "+t),i.loggingService.event("teams_object_adapter_failure",{data:e.id})}}),(r.emptyMembers.length||r.containingFalsyMembers.length||s.emptyMembers.length||s.containingFalsyMembers.length)&&this.loggingService.event("startup_chats_malformed_members",{data:JSON.stringify({numChatsWithEmptyMembers:r.emptyMembers.length,convertedNumChatsWithEmptyMembers:s.emptyMembers.length,numChatsContainingFalsyMembers:r.containingFalsyMembers.length,convertedNumChatsContainingFalsyMembers:s.containingFalsyMembers.length,emptyMembers:r.emptyMembers,convertedEmptyMembers:s.emptyMembers,containsFalsyMembers:r.containingFalsyMembers,convertedContainsFalsyMembers:s.containingFalsyMembers})}),this._addConversationsToStore(n)},t.prototype.checkForMalformedMembers=function(e,t){if(e.members)if(0===e.members.length)t.emptyMembers.push({id:e.id,numMembers:0,numFalsyMembers:0});else{var i=_.size(_.filter(e.members,function(e){return!e}));i&&t.containingFalsyMembers.push({id:e.id,numMembers:e.members.length,numFalsyMembers:i})}},t.prototype.addOrUpdateTeams=function(e,t){var i=this,n=[];return _.forEach(e,function(e){var r=_.filter(_.map(_.filter(e.channels,function(e){return!e.isGeneral}),function(e){var n;try{n=i.teamsObjectsAdapter.convertChannelToSkypeConversationLocal(e,t)}catch(t){i.logger.error("Bad conversion of "+e.id+": "+t),i.loggingService.event("teams_object_adapter_failure",{data:e.id})}return n})),s=i.dangerousGetConversationMutable(e.id),a=s&&s.getTopicMinis()||[],o=_.map(_.filter(r,function(e){return!e.isLinkedChannel()}),function(e){return{id:e.id,name:e.topicName(),picture:null,createdat:e.createdAt(),isdeleted:e.isDeleted()}}),c=_.map(r,function(e){return e.id});_.forEach(e.availableChannels,function(e){c.includes(e.id)||o.push({id:e.id,name:e.displayName,picture:null,createdat:new Date(e.creationTime).getTime()+"",isdeleted:e.isDeleted})});var l,p=_.keyBy(a.concat(o),function(e){return e.id}),u=JSON.stringify(_.orderBy(_.values(p),["id"],["asc"]));try{(l=i.teamsObjectsAdapter.convertTeamToSkypeConversationLocal(e,t)).threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Topics]=u,(n=n.concat(r)).push(l)}catch(t){i.logger.error("Bad conversion of "+e.id+": "+t),i.loggingService.event("teams_object_adapter_failure",{data:e.id})}}),this._addConversationsToStore(n)},t.prototype.addOrUpdateChannels=function(e,t){var i=this,n=[];return _.forEach(e,function(e){var r;try{r=i.teamsObjectsAdapter.convertChannelToSkypeConversationLocal(e,t),n.push(r)}catch(t){i.logger.error("Bad conversion of "+e.id+": "+t),i.loggingService.event("teams_object_adapter_failure",{data:e.id})}}),this._addConversationsToStore(n)},t.prototype.addOrUpdatePrivateFeeds=function(e){var t=this,i=[];return _.forEach(e,function(e){try{var n=t.teamsObjectsAdapter.convertPrivateFeedToSkypeConversationLocal(e);i.push(n)}catch(i){t.logger.error("Bad conversion of "+e.id+": "+i),t.loggingService.event("teams_object_adapter_failure",{data:e.id})}}),this._addConversationsToStore(i)},t.prototype._addConversationsToStore=function(e){var t=this,i=_.map(e,function(e){var i,n=t.getConversation(e.id);n&&n.isChat()&&!n.isThreadDead()&&!n.topicName()&&_.isEmpty(e.members)&&(i={id:n.id,oldMembers:!!n.members,numOldMembers:_.size(n.members),oldDetailsVersion:n.detailsVersion,oldThreadVersion:n.threadVersion,newMembers:!!e.members,numNewMembers:_.size(e.members),newDetailsVersion:e.detailsVersion,newThreadVersion:e.threadVersion,wasUserMember:n.isUserMember});var r=t.applyConversationUpdate(e);return e.threadProperties&&(r.threadProperties=e.threadProperties),r.members=e.members,_.isEmpty(i)||t.loggingService.event("MembersSetToEmptyArray_2",{data:JSON.stringify(_.extend(i,{isUserMember:r.isUserMember()}))}),r.detailsVersion=e.detailsVersion,r.threadVersion=e.threadVersion,t.markMessagesStale(r.id,!0),r});return this.updateConversations(i)},t}(SkypeX.Services.SXStoreBase);t.SkypeConversationsStore=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=SkypeX.Services.SkypeMessageDB,r=SkypeX.Services.SkypeMessageLocal,s=function(){function e(e,t,i,n,r,s){this.$injector=e,this.sfbInteropUtilsService=t,this.utilityService=i,this.settingsService=n,this.constants=r,this.sxConfig=s,this.enableSfBGateway=!1,this.enableSfBGateway=this.settingsService.valueAsBoolean(this.constants.settings.names.enableSfBGateway)}return e.$inject=["$injector","sfbInteropUtilsService","utilityService","settingsService","constants","sxConfig"],e.prototype.createChatConversationLie=function(e,t){var i=this,n=SkypeX.Services.ChatServiceUtils.ConversationType_Chat,r=SkypeX.Services.ChatServiceUtils.MriNamespace_SkypeSpacesThread+SkypeX.Services.SkypeConversationLocal.LiePrefix+this.utilityService.generateUUID(),s=e.some(function(e){return i.sfbInteropUtilsService.isSfB(e.id)}),a=t&&"true"===t[SkypeX.Services.ChatServiceUtils.ThreadProp_IsFederated];return s?r=this.enableSfBGateway?teamspace.services.SfBInteropUtilsService.asSfBGatewayConversationLie(r):teamspace.services.SfBInteropUtilsService.asSfBConversationLie(r):a&&(r=teamspace.services.SfBInteropUtilsService.asFederationConversationLie(r)),this.createConversationLie(r,n,{members:e,isSyncedToStartOfTime:!0},t)},e.prototype.createReplyChainConversationLie=function(e,t){var i=SkypeX.Services.ChatServiceUtils.ConversationType_ReplyChain,n=this.conversationsStore.dangerousGetConversationMutable(e),r=n&&n.type;return this.createConversationLie(t,i,{messagesStale:!0,parentConversationId:e,parentConversationType:r})},e.prototype.createTeamConversationLie=function(e,t,i,n,r){return void 0===n&&(n=null),void 0===r&&(r=null),t=t||{},t[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]=SkypeX.Services.ChatServiceUtils.ThreadType_Team,this.createConversationLie(e,SkypeX.Services.ChatServiceUtils.ConversationType_Team,{threadProperties:t,members:i,memberProperties:n,rosterSummary:r})},e.prototype.createLocalMessage=function(e,t,i){var n=this;void 0===i&&(i=!1);var s=new r(e,t);return s.idUnion=s.clientmessageid?s.clientmessageid:s.id,s.conversationId=s.getConversationIdFromConversationLink(),s.parentMessageId=s.getParentMessageIdFromConversationLink(),s.createdTime=s.originalArrivalTimeUtc,s.creator=_.last(s.from.split("/")),s.isFromMe=this.sxConfig.getCurrentSkypeMri()===s.creator,teamspace.services.SfBInteropUtilsService.isGatewayConversation(s.conversationId)&&s.messagetype===SkypeX.Services.ChatServiceUtils.MessageType_Text&&teamspace.services.SfBInteropUtilsService.processInteropMessageContent(s,this.utilityService),s.notificationLevel=SkypeX.Services.eNotificationLevel.Simple,s.parentMessageId&&s.parentMessageId!==s.id||(s.parentMessageId=s.id,s.replyChainLatestDeliveryTime=s.originalArrivalTimeUtc),s.properties&&(s.userHasStarred=this.isMessageStarred(s),s.properties[this.constants.skypeMessagePropertyName.importance]=this.getStandardizedImportanceLevel(s),s.userHasStarred&&_.remove(s.properties[SkypeX.Services.ChatServiceUtils.MessageProperty_Emotions],function(e){return e.key===n.constants.emotions.star})),i&&(s._skypeMessage=e),s},Object.defineProperty(e.prototype,"conversationsStore",{get:function(){return this._conversationsStore=this._conversationsStore||this.$injector.get("conversationsStore")},enumerable:!0,configurable:!0}),e.prototype.createConversationLie=function(e,t,i,n){void 0===i&&(i={}),void 0===n&&(n={});var r=new SkypeX.Services.SkypeConversationLocal;return _.assign(r,_.defaults(i,{id:e,type:t,messages:null,properties:{},targetLink:null,version:0,threadVersion:0,lastMessage:null,threadProperties:n,members:null,memberProperties:null,rosterSummary:null,teamId:null,lastMessageTimeUtc:0,messagesStale:!1,messageHistoryStartTime:null,syncState:"",detailsVersion:-1,messagesSyncAfterUtc:0,messagesSyncFailureCount:0,conversationSyncFailureCount:0})),r},e.prototype.createFakeRootMessage=function(e,t){var i={};i.id=t,i.version=t,i.originalarrivaltime=new Date(parseInt(t)).toISOString(),i.conversationLink="local/"+e,i.from="",i.properties={},i.properties[SkypeX.Services.ChatServiceUtils.MessageProperty_DeleteTime]=parseInt(t,10),i.properties[SkypeX.Services.ChatServiceUtils.MessageProperty_SystemDelete]="true",i.properties.messagetype=SkypeX.Services.ChatServiceUtils.MessageType_Text;var r=this.createLocalMessage(i,void 0,!0);return new n(r)},e.prototype.getStandardizedImportanceLevel=function(e){var t=e.properties&&e.properties[this.constants.skypeMessagePropertyName.importance];if(!_.isUndefined(t))return teamspace.components.ImportanceLevels[t.toString().toUpperCase()]||teamspace.components.ImportanceLevels.NORMAL},e.prototype.isMessageStarred=function(e){if(e&&e.properties){var t=e.properties[SkypeX.Services.ChatServiceUtils.MessageProperty_Emotions],i=_.find(t,{key:this.constants.emotions.star}),n=i&&i.users;return!!_.some(n,{mri:this.sxConfig.getCurrentSkypeMri()})}return!1},e}();t.SkypeModelFactory=s},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(76),s=SkypeX.Services.SyncTasks,a=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d){var g=e.call(this,t,i,n,r,s,a,o,c,l,p,u,h,d)||this;return g.appConfig=t,g.$injector=i,g.$http=n,g.$q=r,g.$qNoApply=s,g.authenticationService=a,g.loggingService=o,g.constants=c,g.appStateService=l,g.geoRoutingService=p,g.messagingUtilities=u,g.settingsService=h,g.sxConfig=d,g.urlHostFinderRegex=/(http[s]?:\/\/)?[^\/]*\//i,g.logger=g.loggingService.newLogger("chatServiceV2Client"),g}return n(t,e),t.$inject=["appConfig","$injector","$http","$q","$qNoApply","authenticationService","loggingService","constants","appStateService","geoRoutingService","messagingUtilities","settingsService","sxConfig"],t.prototype.createSyncEndpoint=function(e,t){var i="v2/users/ME/endpoints/"+t,n={callType:this.constants.urls.endpoint.type,timeout:this.settingsService.valueFor("httpTimeoutMillisPutEndpoint"),retryAfterAuthRefresh:!1};return this.performApiPutDetailed(i,n,e).then(function(e){return e.object})},t.prototype.pollSyncSubscription=function(e,t){if(!e){var i="invalid longpoll url: "+e;return this.logger.error(i),s.Rejected({error:i})}var n={callType:this.constants.urls.longPollSubscription.type,timeout:t,responseType:this.constants.http.responseType.json};if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableQueryParamsInHeaderForCNS)){var r=e.split("?");n.url=r[0],r[1]&&(n.headers={"x-ms-query-params":r[1]})}else n.url=e;return this.performApiGet("",n)},t.prototype.postActiveEndpoint=function(e){var t={callType:this.constants.urls.postActiveEndpoint.type,timeout:this.settingsService.valueFor("httpTimeoutMillisPostActiveEndpoint")},i=e.replace(this.urlHostFinderRegex,"");if(!i){var n="invalid active url: "+e;return this.logger.error(n),s.Rejected({error:n})}return this.performApiPost(i,t,{timeout:135})},t.prototype._getAuthHeaders=function(e){var t=this;return void 0===e&&(e=!1),this.authenticationService.getSkypeTokens(e).then(function(e){var i=e&&e.skypeToken,n={};return n[t.constants.headers.tokens.authentication]=t.constants.headers.skypeTokenPrefix+i,n.ClientInfo=t.getClientInfoHeader(),n.BehaviorOverride="redirectAs404",n})},t}(r.RealChatServiceClient);t.ChatServiceV2ClientImplementation=a},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(218),s=i(77),a=i(30),o=i(74),c=i(31),l=i(220),p=i(221),u=SkypeX.Services.SyncTasks,h=SkypeX.Services.ChatServiceUtils,d=SkypeX.Services.SkypeMessageLocal,g=SkypeX.Services.MessageViewType,v=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h){var d=e.call(this,t,i,n,r,s,a,o,c,l,p,u,h)||this;return d.authenticationService=t.get("authenticationService"),d.syncStateService=t.get("syncStateService"),d.usePrefetchedStartupData=d.startupApiEnabled,d.persistPeopleData=d.settingsService.valueAsBoolean(r.settings.names.persistPeopleProfilesFromStartup),d.logger=d.loggingService.newLogger("BasicSyncStrategy"),d.enablePersistencePruning=d.settingsService.valueAsBoolean(d.constants.settings.names.enablePersistencePruning),d}return n(t,e),t.$inject=["$injector","$timeout","chatSyncPriorityService","constants","conversationsStore","eventingService","loggingService","scheduler","settingsService","syncLongPollService","utilityService","syncTelemetryService"],Object.defineProperty(t.prototype,"startupApiEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.useChatSvcAggStartup)},enumerable:!0,configurable:!0}),t.prototype.loadMoreMessages=function(e){if(!this.conversationsStore.dangerousGetConversationMutable(e))return this.logger.warn("Conversation not found in store. Not loading more messages for {0}",e),!1;if(this.conversationsStore.isCSAReplyChainApiSupported(e)){var t=this.createTeamsReplyChainSyncJob({conversationId:e,pageSize:20,extendStartTime:!0});this.schedule(t,0)}else this.schedule(new a.MessageSyncJob(this.$injector,this.conversationsStore,this.eventingService,this.constants,e,{minimumUniqueReplyChains:20,extendStartTime:!0}),0);return!0},t.prototype.syncImpl=function(){var e=this;return this.syncConversationList().then(function(){return e.syncStaleResources()})},t.prototype.syncStaleResources=function(){var e=this,t=[],i=_.filter(this.conversationsStore.dangerousGetAllConversationsMutable(!1),function(t){return e.conversationsStore.isSupported(t.id)}),n=_.partition(i,function(t){return e.chatSyncPriorityService.isActiveConversation(t.id)}),r=n[0],s=n[1],a=_.chain(r).map(function(t){return e.getSyncJobs(t.id)}).flatten().filter(_.identity).value();a.length>0&&t.push(this.schedule(a,0));var o=_.filter(s,function(t){return e.conversationsStore.needsThreadSync(t.id)&&e.chatMissingMembersAndIsRecent(t)}).map(function(e){return e.id}),c=_.chunk(o,l.BatchedThreadDetailsSyncJob.MaxBatchSize),p=_.map(c,function(t){return new l.BatchedThreadDetailsSyncJob(e.conversationsStore,e.eventingService,e.constants,t)});p.length>0&&t.push(this.schedule(p,1));var h=_.remove(s,function(e){return e.isPrivateFeed()}),d=_.map(h,function(t){return e.getMessageSyncJob(t.id)}).filter(_.identity);if(d.length>0&&t.push(this.schedule(d,1)),!this.settingsService.valueAsBoolean("noBackgroundSync")){var g=void 0;g=this.settingsService.valueAsBoolean(this.constants.settings.names.enableMruChannels)?_.map(this.chatSyncPriorityService.getPrioritizedConversationsToRetain(s,!1),function(e){return e.id}):_.chain(s).filter(function(t){return t.isUserMember()&&(t.isFavorite()||t.isTeam()||t.isChat()&&t.lastMessageTimeUtc>Date.now()-2*e.constants.timeInMiliseconds.week)}).sortBy(function(e){return!e.isRead()}).map(function(e){return e.id}).value();var v=_.keyBy(o),m=_.chain(g).filter(function(t){return e.conversationsStore.needsThreadSync(t)&&!v[t]}).chunk(l.BatchedThreadDetailsSyncJob.MaxBatchSize).map(function(t){return new l.BatchedThreadDetailsSyncJob(e.conversationsStore,e.eventingService,e.constants,t)}).value();m.length>0&&t.push(this.schedule(m,1));var f=_.chain(g).map(function(t){return e.getMessageSyncJob(t)}).filter(_.identity).value();f.length>0&&t.push(this.schedule(f,1))}return u.whenAll(t).then(function(){})},t.prototype.syncConversationList=function(){var e=this;if(this.eventingService.$emit(this.constants.events.syncService.conversationListSyncStart),this.startupApiEnabled&&!this.authenticationService.isAnonymous()){var t=this.schedule(this.createTeamsStartupSyncJob({usePrefetchedStartupData:!!this.usePrefetchedStartupData,persistPeopleData:!!this.persistPeopleData}),0);return this.usePrefetchedStartupData=!1,t.then(function(){return e.eventingService.$emit(e.constants.events.syncService.conversationListSyncComplete)})}return this.schedule(new p.ConversationListSyncJob(this.eventingService,this.constants,this.settingsService),0).then(function(){return e.eventingService.$emit(e.constants.events.syncService.conversationListSyncComplete)})},t.prototype.getMessageSyncJob=function(t){if(!this.conversationsStore.needsMessageSync(t))return null;var i=this.conversationsStore.isCSAReplyChainApiSupported(t);if(i){var n=this.conversationsStore.getConversationSyncState(t);if(n&&n.maxMessageVersion)return new a.MessageSyncJob(this.$injector,this.conversationsStore,this.eventingService,this.constants,t,{forceSyncInterval:n.maxMessageVersion});if(n&&n.messageHistoryStartTime&&n.syncState)return new a.MessageSyncJob(this.$injector,this.conversationsStore,this.eventingService,this.constants,t,{})}return i?this.getReplyChainSyncJob(t):e.prototype.getMessageSyncJob.call(this,t)},t.prototype.getReplyChainSyncJob=function(e){if(!this.conversationsStore.needsMessageSync(e))return null;var t=this.conversationsStore.dangerousGetConversationMutable(e),i=this.conversationsStore.getConversationSyncState(e);if(!t||!i)return this.logger.warn("Conversation not found in store. Skipping scheduling reply chain sync for {0}",e),null;var n=t.isChat()?r.MinimumUniqueReplyChainsForChat:r.MinimumUniqueReplyChainsForChannel;return!i.continuationToken&&(n=r.MinimumUniqueReplyChainsForFirstCall),this.createTeamsReplyChainSyncJob({conversationId:e,pageSize:n})},t.prototype.chatMissingMembersAndIsRecent=function(e){var t;if(e&&e.isChat()){var i=e&&!e.members;if(i){var n=e.isRead()?this.constants.p2p.chatListRecencyMs.read:this.constants.p2p.chatListRecencyMs.unread,r=e.lastMessageTimeUtc&&e.lastMessageTimeUtc>Date.now()-n;t=i&&r}}return!!t},t.prototype.getSyncJobs=function(e){var t=[],i=this.getMessageSyncJob(e);return i&&t.push(i),this.conversationsStore.needsThreadSync(e)&&t.push(new c.ThreadDetailsSyncJob(this.conversationsStore,this.eventingService,this.constants,e)),t},t.prototype.syncConversation=function(e,t){var i=this;void 0===t&&(t=1);var n=e instanceof Array?e:[e];_.forEach(n,function(e){i.getSyncJobs(e).forEach(function(e){return i.schedule(e,t)})})},t.prototype.syncReplyChain=function(e,t,i){void 0===i&&(i=SkypeX.Services.MessageViewType.ReplyChains),this.schedule(new a.RelatedMessagesSyncJob(this.$injector,this.conversationsStore,this.eventingService,this.constants,e,t,i))},t.prototype.getThreadIdAndMessageId=function(e){var t=h.parseActivityId(e);return t.isValid?{threadId:t.topicId,messageId:t.itemId}:{threadId:e,messageId:null}},t.prototype.onActiveConversation=function(e){var t=this.getThreadIdAndMessageId(e);this.syncConversation(t.threadId,0),t.messageId&&this.syncReplyChain(t.threadId,t.messageId,g.ReplyChains)},t.prototype.onLongPollMessage=function(e){var t=this;_.forEach(e,function(e){var i=d.getConversationId(e),n=t.conversationsStore.dangerousGetConversationMutable(i),r=t.conversationsStore.getConversationSyncState(i);if(n&&r){var s=d.getParentMessageId(e)||e.id,a=h.formatActivityId(i,s);r.messageHistoryStartTime&&!t.syncStateService.isReplyChainSynced(n,a)&&t.syncReplyChain(i,s,g.ReplyChains)}else t.sync()})},t.prototype.onAppStateChange=function(e){this.enablePersistencePruning&&e.newState===teamspace.services.ApplicationState.Inactive&&this.schedule(this.$injector.instantiate(o.PersistencePruningJob,{config:{}}),1)},t}(r.BaseSyncStrategy);t.BasicSyncStrategy=v,s.registerSyncStrategy(v)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(30),r=i(219),s=i(75),a=i(31),o=SkypeX.Services.ChatServiceUtils,c=SkypeX.Services.SyncTasks,l=SkypeX.Services.SyncLongPollService;t.FullMessageWindowConversations=[o.StarredItemsConversationId],t.ReducedMessageWindowConversations=[o.NotificationsConversationId,o.CallLogConversationId],t.MinimumUniqueReplyChainsForChat=50,t.MinimumUniqueReplyChainsForChannel=20,t.MinimumUniqueReplyChainsForFirstCall=5;var p=function(){function e(e,t,i,n,r,s,o,c,l,p,u,h){var d=this;this.$injector=e,this.$timeout=t,this.chatSyncPriorityService=i,this.constants=n,this.conversationsStore=r,this.eventingService=s,this.loggingService=o,this.scheduler=c,this.settingsService=l,this.syncLongPollService=p,this.utilityService=u,this.syncTelemetryService=h,this.unregisterAppStateChangedEvent=_.noop,this.unregisterSetActiveConversation=_.noop,this.isActiveConversation=function(e){return d.chatSyncPriorityService.isActiveConversation(e.conversation.id)},this.isChatNeedingRoster=function(e){return d.chatSyncPriorityService.isPrioritizedConversationForDetails(e.conversation.id)&&e.syncJob instanceof a.ThreadDetailsSyncJob},this.isFavorite=function(e){return e.conversation.isFavorite()},this.isFavoriteAndUnread=function(e){return e.conversation.isFavorite()&&!e.conversation.isRead()},this.isPrivateFeed=function(e){return e.conversation.isPrivateFeed()},this.isRecentChat=function(e){return e.conversation.isChat()&&e.conversation.lastMessageTimeUtc>Date.now()-2*n.timeInMiliseconds.week},this.isTeamRoster=function(e){return e.conversation.isTeam()&&e.syncJob instanceof a.ThreadDetailsSyncJob}}return e.$inject=["$injector","$timeout","chatSyncPriorityService","constants","conversationsStore","eventingService","loggingService","scheduler","settingsService","syncLongPollService","utilityService","syncTelemetryService"],e.prototype.start=function(e){this.registerListeners(),this.sync(e)},e.prototype.stop=function(){this.unregisterListeners(),this.cancelNextSync&&this.cancelNextSync(),this.syncTelemetryService.stopSyncConversationsScenario("Stopped",SkypeX.Services.Sync.StopReason.CANCELLED)},e.prototype.sync=function(e){var t=this;if(this.syncPromise)e&&this.syncPromise.then(function(){return t.sync()});else{this.syncTelemetryService.startSyncConversationsScenario();var i=this.getSyncTimeout(),n=this.syncImpl().finally(function(){i.cancel(),t.logSyncComplete()});this.syncPromise=c.race([n,i.promise]).finally(function(){t.scheduleNextSync(),t.syncPromise=null})}},e.prototype.getMessageSyncJob=function(e){if(!this.conversationsStore.needsMessageSync(e))return null;var i={},r=this.getReducedSyncWindowInterval();return t.ReducedMessageWindowConversations.indexOf(e)>-1?i.forceSyncInterval=Date.now()-this.constants.syncPrivateFeedForXNumberofDays*this.constants.timeInMiliseconds.day:t.FullMessageWindowConversations.indexOf(e)>-1?i.forceSyncInterval=1:r?i.forceSyncInterval=Date.now()-r:(i.minimumSyncIntervalMs=Date.now()-2*this.constants.timeInMiliseconds.week,i.minimumUniqueReplyChains=this.conversationsStore.dangerousGetConversationMutable(e).isChat()?t.MinimumUniqueReplyChainsForChat:t.MinimumUniqueReplyChainsForChannel),new n.MessageSyncJob(this.$injector,this.conversationsStore,this.eventingService,this.constants,e,i)},e.prototype.getReducedSyncWindowInterval=function(){var e;if(this.settingsService.valueAsBoolean("reduceMessageSyncWindow")){var t=this.settingsService.valueFor("reduceMessageSyncWindowMins"),i=parseInt(t);i&&i>0&&(e=this.constants.timeInMiliseconds.minute*i)}return e},e.prototype.logSyncComplete=function(){return this.loggingService.log("Sync Complete"),this.syncTelemetryService.stopSyncStartupScenario(),this.syncTelemetryService.stopSyncConversationsScenario(),this.eventingService.$emit(this.constants.events.syncService.backgroundSyncComplete),c.Resolved()},e.prototype.schedule=function(e,t){var i=this;if(void 0===t&&(t=1),e instanceof Array){var n=_.map(_.filter(e),function(e){return i.scheduler.schedule(e,t).promise});return c.whenAll(n)}return this.scheduler.schedule(e,t).promise},e.prototype.onActiveConversation=function(e){},e.prototype.onLongPollMessage=function(e){},e.prototype.onAppStateChange=function(e){},e.prototype.createTeamsReplyChainSyncJob=function(e){return this.$injector.instantiate(r.TeamsReplyChainSyncJob,{config:e})},e.prototype.createTeamsStartupSyncJob=function(e){return this.$injector.instantiate(s.TeamsStartupSyncJob,{config:e})},e.prototype.registerListeners=function(){var e=this;this.unregisterListeners(),this.unregisterSetActiveConversation=this.eventingService.unsafeOn(this.constants.events.syncService.setActiveConversation,function(t,i){return e.onActiveConversation(i)}),this.tokenSyncLongPoll=this.syncLongPollService.subscribe(function(t,i){return e.onLongPollMessage(i)},l.EventType_MessageUpdates),this.unregisterAppStateChangedEvent=this.eventingService.unsafeOn(this.constants.events.appState.changed,function(t,i){return e.onAppStateChange(i)})},e.prototype.unregisterListeners=function(){this.unregisterSetActiveConversation(),this.syncLongPollService.unsubscribe(this.tokenSyncLongPoll),this.unregisterAppStateChangedEvent()},e.prototype.scheduleNextSync=function(){var e=this;this.cancelNextSync&&this.cancelNextSync();var t=this.utilityService.jitter(this.getSyncIntervalMs(),this.getSyncIntervalJitterPercentage()),i=this.$timeout(function(){return e.sync()},t,!1);this.cancelNextSync=function(){e.$timeout.cancel(i),e.cancelNextSync=null}},e.prototype.getTimeout=function(e,t){var i=c.Defer(),n=setTimeout(function(){return i.reject(t)},e);return{promise:i.promise(),cancel:function(){return clearTimeout(n)}}},e.prototype.getSyncTimeout=function(){var e=this,t=this.getTimeout(this.getSyncIntervalMs(),"SyncLoopTimeout");return t.promise.fail(function(){var t="SyncLoopTimeout - waited "+e.getSyncIntervalMs()+" seconds";e.syncTelemetryService.stopSyncConversationsScenario(t,SkypeX.Services.Sync.StopReason.FAILED)}),t},e.prototype.getSyncIntervalMs=function(){return 1e3*this.settingsService.valueFor("syncIntervalSeconds")},e.prototype.getSyncIntervalJitterPercentage=function(){return this.settingsService.valueFor("syncIntervalJitterPercentage")||.15},e}();t.BaseSyncStrategy=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(30),r=SkypeX.Services.SyncTasks,s=SkypeX.Services.SkypeMessageSource,a=SkypeX.Services.ChatServiceUtils,o=teamspace.services.SyncStateStorageTarget;t.TeamsReplyChainResourceTag="messages";var c=function(){function e(e,t,i,n,r,s){this.$injector=e,this.constants=t,this.conversationsStore=i,this.eventingService=n,this.teamsObjectsAdapter=r,this.config=s}return e.$inject=["$injector","constants","conversationsStore","eventingService","teamsObjectsAdapter","config"],e.prototype.execute=function(e){var t,i=this,a=e.conversationsStore.dangerousGetConversationMutable(this.config.conversationId),c=e.conversationsStore.getConversationSyncState(this.config.conversationId);if(!a||!c)return r.Rejected("Unknown conversation "+this.config.conversationId);this.config.extendStartTime&&c.continuationToken&&(t=c.continuationToken);var l=c.maxMessageVersion&&!t?e.replyChainStore.getHeadViewReplyChainsCount(a.id):SkypeX.Services.SyncTasks.Resolved(0);l.fail(function(t){return e.logger.error("Unable to fetch skip count")});var p=performance.now(),u=a.getTeamId();return l.then(function(l){return e.teamsDataService.getReplyChains(u,i.config.conversationId,i.config.pageSize,t,l).then(function(n){var r=n.replyChains,o=_.flatten(_.map(r,function(e){return e.messages})),l=_.map(o,i.teamsObjectsAdapter.convertMessageToSkypeMessage),u=_.maxBy(o,function(e){return e.version}),h=u&&u.version||1,d=n.creatorProfiles,g=r&&r.length;i.eventStatus({successful:!0,replyChains:g,delta:performance.now()-p,withSyncState:!!t}),e.logger.info("Retrieved reply chains info: {0} reply chains in {1} ms for container id {2} up to {3}",g,performance.now()-p,i.config.conversationId,h);var v=e.conversationsStore.isPersisted(i.config.conversationId),m=e.replyChainStore.handleSyncedMessages(l,{syncSource:s.CSAReplyChain},v,d),f=Math.max(c.maxMessageVersion||1,h),S={syncState:null,messagesStale:!1,isSyncedToStartOfTime:!n.continuationToken,continuationToken:n.continuationToken,lastSyncTime:Date.now(),isFailed:void 0,maxMessageVersion:f,messageHistoryStartTime:f,conversationVersion:a.version};i.saveSyncState(S,h,n,m,e,v)}).fail(function(s){if(i.eventStatus({successful:!1,delta:performance.now()-p,withSyncState:!!t}),e.logger.error("Unable to fetch reply chain data: {0}",s.statusCode),404===s.statusCode||403===s.statusCode){e.logger.warn("ReplyChainAPI not supported for conversation {0} - falling back to chat service sync",i.config.conversationId),e.conversationsStore.patchConversation(i.config.conversationId,function(e){e.replyChainIndexFailure=Date.now()}),e.conversationsStore._isCSAReplyChainSupported&&delete e.conversationsStore._isCSAReplyChainSupported[i.config.conversationId];var a={minimumUniqueReplyChains:i.config.pageSize,extendStartTime:i.config.extendStartTime},c=new n.MessageSyncJob(i.$injector,i.conversationsStore,i.eventingService,i.constants,i.config.conversationId,a);return e.pushFront(c),r.Rejected("replyChainApiUnsupported")}var l=e.syncStateService.getSyncState(i.config.conversationId)||new SkypeX.Services.Sync.TeamsObjectSyncState(i.config.conversationId);l.errorCode=s.statusCode||s.errorCode,e.syncStateService.addUpdateSyncState([l],o.Memory)})})},e.prototype.isValid=function(){var e=this.conversationsStore.dangerousGetConversationMutable(this.config.conversationId),t=this.conversationsStore.getConversationSyncState(this.config.conversationId);return!(!(e&&e.isChannelConversation()&&t)||t.isSyncedToStartOfTime)&&(!!e.getTeamId()&&(!!t.messagesStale||!!this.config.extendStartTime))},e.prototype.resourceTags=function(){return[t.TeamsReplyChainResourceTag+"/"+this.config.conversationId]},e.prototype.abort=function(){},e.prototype.eventStatus=function(e){var t={conversationId:this.config.conversationId,jobType:SkypeX.Services.Sync.SyncJobType.REPLYCHAINS,successful:e.successful,delta:e.delta,withSyncState:e.withSyncState};e.replyChains&&(t.replyChains=e.replyChains),this.eventingService.$emit(this.constants.events.syncService.syncStatus,t)},e.prototype.saveSyncState=function(e,t,i,n,r,s){var c=this;r.conversationsStore.patchConversation(this.config.conversationId,function(n){n.syncState=e.syncState,n.messageHistoryStartTime=e.messageHistoryStartTime,n.messagesStale=e.messagesStale,n.isSyncedToStartOfTime=e.isSyncedToStartOfTime,n.lastSyncTime=e.lastSyncTime,n.continuationToken=e.continuationToken,n.maxMessageVersion=Math.max(n.maxMessageVersion||1,t),n.messageHistoryStartTime=n.maxMessageVersion,_.forEach(i.replyChains,function(e){var t=a.formatActivityId(e.containerId,e.id);n.replyChainSyncMap[t]={messagesStale:!1,syncState:"",syncStartTime:1,replyChainId:e.id}})},!0,!1),_.forEach(i.replyChains,function(e){var t=a.formatActivityId(e.containerId,e.id);r.syncStateService.updateReplyChainSyncState(c.config.conversationId,t,{messagesStale:!1,syncState:"",syncStartTime:1,replyChainId:e.id})});var l=r.syncStateService.getSyncState(this.config.conversationId)||new SkypeX.Services.Sync.TeamsObjectSyncState(this.config.conversationId),p=r.conversationsStore.dangerousGetConversationMutable(this.config.conversationId);l.syncState=e.syncState,l.messageHistoryStartTime=e.messageHistoryStartTime,l.messagesStale=e.messagesStale,l.isSyncedToStartOfTime=e.isSyncedToStartOfTime,l.lastSyncTime=e.lastSyncTime,l.continuationToken=e.continuationToken,l.maxMessageVersion=Math.max(p.maxMessageVersion||1,t),l.messageHistoryStartTime=p.maxMessageVersion,l.errorCode=null,r.syncStateService.addUpdateSyncState([l],o.Memory),s&&n.then(function(){var t=r.syncStateService.getSyncState(c.config.conversationId)||new SkypeX.Services.Sync.TeamsObjectSyncState(c.config.conversationId);t.isFailed?r.logger.info("Reply chain sync state not updated due to previous write failure {0}",c.config.conversationId):(_.assign(t,e),r.syncStateService.addUpdateSyncState([t],o.Persistence))}).fail(function(e){r.logger.warn("Unable to write reply chains for conversation {1} error: {2}",c.config.conversationId,e);var t=r.syncStateService.getSyncState(c.config.conversationId)||new SkypeX.Services.Sync.TeamsObjectSyncState(c.config.conversationId);t.isFailed=!0,r.syncStateService.addUpdateSyncState([t],o.Persistence)})},e}();t.TeamsReplyChainSyncJob=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(31),r=function(){function e(t,i,n,r){if(this.conversationsStore=t,this.eventingService=i,this.constants=n,this.conversationIds=r,r.length>e.MaxBatchSize)throw r.length+" conversationIds exceeds max batch size of "+e.MaxBatchSize}return e.prototype.execute=function(e){var t=this,i=performance.now();return e.chatServiceClient.getThreads(this.conversationIds).then(function(n){var r=_.partition(n,function(e){return e.version>0}),s=r[0],a=r[1];if(s.forEach(function(t){return e.conversationsStore.applyThreadUpdate(t)}),!_.isEmpty(a)){var o=e.loggingService.newScenario(t.constants.scenarios.sync.markThreadAsDead);o.eventData={data:JSON.stringify({source:"BatchedThreadDetailsSyncJob",ids:_.map(a,function(e){return e.id})})},a.forEach(function(t){e.conversationsStore.markThreadAsDead(t.id)}),o.stop()}var c=performance.now()-i;t.eventingService.$emit(t.constants.events.syncService.syncStatus,{jobType:SkypeX.Services.Sync.SyncJobType.BATCHEDDETAILS,conversationId:void 0,delta:c,threads:n.length,successful:!0})}).fail(function(r){var s=performance.now()-i;t.eventingService.$emit(t.constants.events.syncService.syncStatus,{jobType:SkypeX.Services.Sync.SyncJobType.BATCHEDDETAILS,conversationId:void 0,delta:s,threads:t.conversationIds.length,successful:!1}),r.message&&r.message.indexOf("ServiceProxy_MessageTooBig")>-1?(e.logger.warn("chatService unable to process {0} threads, scheduling ThreadDetailsSyncJobs",t.conversationIds.length),_.map(t.conversationIds,function(e){return new n.ThreadDetailsSyncJob(t.conversationsStore,t.eventingService,t.constants,e)}).forEach(function(t){return e.pushFront(t)})):e.logger.error("chatService unable to fulfill request: {0}",t.conversationIds.join(","))})},e.prototype.isValid=function(){var e=this;return!!_.find(this.conversationIds,function(t){var i=e.conversationsStore.dangerousGetConversationMutable(t);return i&&i.threadVersion>i.detailsVersion})},e.prototype.resourceTags=function(){return _.map(this.conversationIds,function(e){return"thread/"+e})},e.prototype.abort=function(){},e.MaxBatchSize=10,e}();t.BatchedThreadDetailsSyncJob=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=SkypeX.Services.ChatServiceUtils,r=function(){function e(e,t,i){this.eventingService=e,this.constants=t,this.settingsService=i}return e.prototype.execute=function(t){var i=this,r=performance.now();return t.conversationsStore.getConversationListSyncState().then(function(s){return t.chatServiceClient.getMyConversations("Passport|Skype|Lync|Thread|NotificationStream",1,s).then(function(a){var o=!!a._metadata.backwardLink,c=n.decodeSyncState(a._metadata.syncState),l=_.map(a.conversations,function(e){var i=t.conversationsStore.createConversationLocalFromConversation(e),n=t.conversationsStore.applyConversationUpdate(i);return t.conversationsStore.markMessagesStale(n.id,!0),n});t.conversationsStore.updateConversations(l).then(function(){return t.conversationsStore.saveConversationListSyncState(c)});var p=performance.now()-r;i.eventingService.$emit(i.constants.events.syncService.syncStatus,{jobType:SkypeX.Services.Sync.SyncJobType.CONVERSATIONLIST,conversationId:void 0,delta:p,withSyncState:!!s,successful:!0}),o&&t.pushFront(new e(i.eventingService,i.constants,i.settingsService))}).fail(function(n){var a=performance.now()-r;if(i.eventingService.$emit(i.constants.events.syncService.syncStatus,{jobType:SkypeX.Services.Sync.SyncJobType.CONVERSATIONLIST,conversationId:void 0,delta:a,withSyncState:!!s,successful:!1}),e.isInvalidSyncTokenResponse(n))return i.settingsService.valueAsBoolean(i.constants.settings.names.disablePerfTableLogging)||t.loggingService.newCounter("invalidsynctoken").stop(),t.logger.warn("Conversation list has invalid sync token - clearing it. {0} {1}",n,s),t.conversationsStore.saveConversationListSyncState(null),void t.pushFront(new e(i.eventingService,i.constants,i.settingsService));t.logger.warn("Error syncing conversation list: {0} ",n);var o=t.settingsService.valueFor("conversationListRetryTimeMs")||5e3;setTimeout(function(){return t.schedule(new e(i.eventingService,i.constants,i.settingsService))},o)})})},e.prototype.isValid=function(){return!0},e.prototype.resourceTags=function(){return["conversationList"]},e.prototype.abort=function(){},e.isInvalidSyncTokenResponse=function(e){return e&&400==e.statusCode&&e.errorCode==n.ErrorCode_InvalidToken},e}();t.ConversationListSyncJob=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.$q=e,this._appVersion=null,this._userMriDeferred=this.$q.defer()}return e.$inject=["$q"],e.prototype.getProcessorType=function(){return"x86"},e.prototype.isLocal=function(){return"Local"===this._environment},e.prototype.getAppVersion=function(){return this._appVersion},e.prototype.getPlatformId=function(){return 0},e.prototype.putNativeInfo=function(e,t){this._skypeId=e.getSkypeId(),this._skypeToken=e.rawToken,this._msaRefreshToken=t,this._userMriDeferred.resolve(this.getCurrentSkypeMri()),SkypeX.Services.ChatServiceUtils.SkypeSpacesUserMriTag!==SkypeX.Services.ChatServiceUtils.DodCloudUserMriTag&&this._skypeId.startsWith(SkypeX.Services.ChatServiceUtils.DodCloudUserMriTag)?SkypeX.Services.ChatServiceUtils.SkypeSpacesUserMriTag=SkypeX.Services.ChatServiceUtils.DodCloudUserMriTag:SkypeX.Services.ChatServiceUtils.SkypeSpacesUserMriTag!==SkypeX.Services.ChatServiceUtils.GccHighCloudUserMriTag&&this._skypeId.startsWith(SkypeX.Services.ChatServiceUtils.GccHighCloudUserMriTag)&&(SkypeX.Services.ChatServiceUtils.SkypeSpacesUserMriTag=SkypeX.Services.ChatServiceUtils.GccHighCloudUserMriTag)},e.prototype.waitForUserMri=function(){return this._userMriDeferred.promise},e.prototype.getCurrentSkypeId=function(){return this._skypeId},e.prototype.getCurrentSkypeMri=function(){return"8:"+this.getCurrentSkypeId()},e}();t.SXConfig=n,angular.module("skypeX.sxConfig",[]).service("sxConfig",n)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S,y){var C=e.call(this)||this;return C.constants=t,C.htmlSanitizer=i,C.$translate=n,C.resources=r,C.$sce=s,C.navigationService=a,C.messageStore=o,C.loggingService=c,C.peopleService=l,C.chatSyncService=p,C.channelService=u,C.utilityService=h,C.$rootScope=d,C.$q=g,C.messageService=v,C.conversationsService=m,C.eventingService=f,C.settingsService=S,C.botCardFactory=y,C.logger=null,C.deletedCache=[],C.bookmarkedCache={savedMessages:{},lastModified:Date.now()},C.logger=C.loggingService.newLogger("Starred"),C}return n(t,e),t.$inject=["constants","htmlSanitizer","$translate","resources","$sce","navigationService","messageStore","loggingService","peopleService","chatSyncService","channelService","utilityService","$rootScope","$q","messageService","conversationsService","eventingService","settingsService","botCardFactory"],Object.defineProperty(t.prototype,"navCtx",{get:function(){return"starred-items-store"},enumerable:!0,configurable:!0}),t.prototype.startup=function(){var e=this;this.messageStore.subscribe(function(){e.trigger(e.constants.starredItemStore.typeStarredItems)},SkypeX.Services.MessageStoreConstants.EventType_Batched,SkypeX.Services.ChatServiceUtils.StarredItemsConversationId),this.eventingService.unsafeOn(this.constants.events.appBar.savedClicked,function(t,i){e.navigateToDefaultStarredItem()})},t.prototype.starMessage=function(e){var t=this;return this.messageService.starMessage(e.conversationId,e.id).then(function(){t.removeFromDeletedCache(e.id);var i=t.loggingService.newScenario(t.constants.scenarios.starMessage);return(e.imdisplayname?t.$q.when(e.imdisplayname):t.peopleService.getPeopleProfile(e.creator,"starred-items-store").then(function(e){return e.displayName},function(e){return null})).then(function(n){var r=null,s=!1,a=e.creator;if(e.creatorProfile&&e.creatorProfile.type===t.constants.atMentions.type.webhook&&(n=e.creatorProfile.displayName,r=e.creatorProfile.imageUri,e.creatorProfile.mri&&(a=e.creatorProfile.mri)),e.creatorProfile&&e.creatorProfile.type===t.constants.connectors.type){var o=e.creatorProfile;if(n=o.displayName,r=o.avatarUrl,e.creatorProfile.mri&&(a=e.creatorProfile.mri),e.isEmailMessage&&teamspace.services.MessagingUtilities.isUnresolvedEmailUser(n,e.creatorProfile)){s=!0;var c=e.emailDetails&&e.emailDetails.from&&e.emailDetails.from.smtp;n=teamspace.services.MessagingUtilities.getDisplayNameFromEmailIdString(c)||n}}n=n?_.truncate(n,{length:100}):t.$translate.instant(t.resources.strings.messages_noAuthor);var l=e.content;if(e.messagetype===SkypeX.Services.ChatServiceUtils.MessageType_MediaCard){var p=e.renderContentNative;l=t.botCardFactory.createCardPreview(p)||t.$translate.instant(t.resources.strings.messages_noMessageBody)}var u={messageId:e.id,message:e,conversationId:SkypeX.Services.ChatServiceUtils.StarredItemsConversationId,replyChainId:null,fileAttachments:e.attachments,mentions:null,isHtml:e.messagetype==SkypeX.Services.ChatServiceUtils.MessageType_HTML,imdisplayname:n,messageBody:l||"",content:null,inlineImages:[],properties:{starred:JSON.stringify({"@type":"http://schema.skype.com/StarredMessage",mri:a,imdisplayname:n,messageId:e.id,parentMessageId:e.parentMessageId,threadId:e.conversationId,imageUri:r,isUnresolvedEmailUser:s,originalComposeTime:e.composetime,creatorType:e.creatorProfile&&e.creatorProfile.type})}};return u.content=u.messageBody,t.addToBookmarkedCache(u),i.stop({conversationId:e.conversationId,objectId:e.id}),t.messageService.createMessage(u)},function(n){return i.fail({conversationId:e.conversationId,objectId:e.id}),t.messageService.unstarMessage(e.conversationId,e.id).catch(function(i){t.addToDeletedCache(e.id),t.removeFromBookmarkedCache(e.id),t.trigger(t.constants.starredItemStore.typeStarredItems),t.logger.warn("Failed to unstar {0} after star failed with {1}",e.id,i)}),t.$q.reject(n)})})},t.prototype.unstarItemById=function(e,t){var i=this;return this.removeFromBookmarkedCache(e),this.getStarredItems().then(function(n){var r=_.find(n,function(i){return i.messageId===e&&i.conversationId===t});if(r)return i.unstarItem(r)})},t.prototype.unstarItem=function(e){var t=this;return this.addToDeletedCache(e.message.id),this.removeFromBookmarkedCache(e.messageId),"-1"===e.message.id?this.messageService.getMessage(e.conversationId,e.messageId).then(function(i){return e.message=i,t.processUnstarItem(e)}):this.processUnstarItem(e)},t.prototype.processUnstarItem=function(e){var t=this,i=this.loggingService.newScenario(this.constants.scenarios.unstarMessage),n={conversationId:e.conversationId,objectId:e.messageId},r=this.conversationsService.getConversation(e.conversationId);if(!r)return i.fail(n),this.$q.reject();var s=r.isUserMember(),a=this.settingsService.valueAsBoolean(this.constants.settings.names.enableBookmarkGroupChatDeletion);return this.messageService.markStarredMessageAsDeleted(e.message.conversationId,e.message.id).then(function(){if(!a||s)return t.messageService.unstarMessage(e.conversationId,e.messageId).then(function(){n.isUserStillInConversation=!0,t.bookmarkScenarioTime(e.message.createdTime),i.stop(n)}).catch(function(r){return i.fail(n),t.logger.warn("Failed to unstar {0} after unstar failed with {1}",e.messageId,r),t.$q.reject(r)});n.isUserStillInConversation=!1,t.bookmarkScenarioTime(e.message.createdTime),i.stop(n)}).catch(function(r){return i.fail(n),t.messageService.starMessage(e.conversationId,e.messageId).catch(function(i){t.logger.warn("Failed to re-star {0} after unstar failed with {1}",e.messageId,i)}),t.$q.reject(r)})},t.prototype.bookmarkScenarioTime=function(e){var t=((new Date).getTime()-e)/this.constants.timeInMiliseconds.day;this.eventingService.$emit(this.constants.events.messages.messageUnsaved,t)},t.prototype.getStarredItems=function(){var e=this;return this.chatSyncService.waitForInitialConversationListSync().then(function(){return e.messageStore.getMessagesForConversationAndReplyChainDeliveryTimeRange(SkypeX.Services.ChatServiceUtils.StarredItemsConversationId,0,Number.MAX_VALUE)}).then(function(t){return e.hydrateStarredItems(t)}).then(function(e){return _.orderBy(_.uniqBy(e,"messageId"),"message.originalarrivaltime","desc")})},t.prototype.hydrateStarredItems=function(e){var t=this,i={},n=[],r=[];return(e=this.appendBookmarkedCacheMessages(e)).forEach(function(e){var n=e.properties?e.properties.starred:null;if(angular.isString(n))try{n=JSON.parse(n)}catch(e){}if(n&&!angular.isString(n)){if("http://schema.skype.com/StarredMessage"===n["@type"]){if(!angular.isString(n.messageId)||!angular.isString(n.threadId)||!angular.isString(n.mri))return void t.logger.error("Invalid starred message {0}, {1}",e.id,n);if(n.isDeleted||_.includes(t.deletedCache,e.id))return;var s=SkypeX.Services.StarredItemType.Message,a=t.conversationsService.getConversation(n.threadId);if(a&&a.isChat()&&(s=SkypeX.Services.StarredItemType.Chat),!t.createLinkToChannel(n.threadId))return void t.messageService.markStarredMessageAsDeleted(e.conversationId,e.id);var o={message:e,content:t.$sce.trustAsHtml(t.htmlSanitizer.sanitizeHtml(e.content)),type:s,creatorMri:n.mri,creatorUpn:null,imdisplayname:e.imdisplayname||n.imdisplayname,conversationId:n.threadId,messageId:n.messageId,messageComposeTime:n.originalComposeTime,parentMessageId:n.parentMessageId,link:t.createLinkToChannel(n.threadId),isDeleted:n.isDeleted,messagePreview:"",attachments:e.attachments,isUnresolvedEmailUser:n.isUnresolvedEmailUser,creatorType:n.creatorType},c=t.constants.outgoingWebhooks.interceptorBotMris.includes(o.creatorMri)||o.creatorType===t.constants.atMentions.type.webhook,l=SkypeX.Services.ChatServiceUtils.isConnectorMri(o.creatorMri)||o.creatorType===t.constants.connectors.type;c||l?o.imageUri=n.imageUri:i[o.creatorMri]=null,o.link&&r.push(o)}}else t.logger.error("Invalid starred message, no starred micro-data found {0}",e.id)}),_.chunk(_.keys(i),25).forEach(function(e){n.push(t.peopleService.getAllPeopleProfile(e,"starred-items-store").then(function(e){return e.forEach(function(e){return i[e.mri]=e})}))}),this.utilityService.whenAllAllowFailures(n).then(function(){return r.filter(function(e){if(e.type===SkypeX.Services.StarredItemType.Message||e.type===SkypeX.Services.StarredItemType.Chat){var n=e,r=i[n.creatorMri];if(r)n.creatorUpn=r.userPrincipalName,n.imdisplayname=r.displayName;else if(!n.imdisplayname)return t.logger.error("Unable to resolve displayname for user {0} in starred message: {1}",n.creatorMri,n.message.id),!1;return!0}return!1})})},t.prototype.appendBookmarkedCacheMessages=function(e){Date.now()>this.bookmarkedCache.lastModified+this.constants.timeInMiliseconds.tenMinutes&&(this.bookmarkedCache.savedMessages={},this.bookmarkedCache.lastModified=Date.now());var t=[];for(var i in this.bookmarkedCache.savedMessages)if(this.bookmarkedCache.savedMessages[i]){var n=this.bookmarkedCache.savedMessages[i];t.push(n)}var r=_.unionWith(e,t,function(e,t){return e.id===t.id});return t.length>0&&this.logger.debug("Found {0} cached messages. Before union messages had {1} messages, and after union it has {2} messages.",t.length,e.length,r.length),r},t.prototype.addToBookmarkedCache=function(e){e.clientId=e.clientId||SkypeX.Services.Utilities.newClientMessageId(),this.bookmarkedCache.savedMessages[e.messageId]=this.messageService.createTempMessage(e)},t.prototype.removeFromBookmarkedCache=function(e){this.bookmarkedCache.savedMessages[e]&&(this.bookmarkedCache.savedMessages[e]=null)},t.prototype.clearDeletedCache=function(){this.deletedCache=[]},t.prototype.removeFromDeletedCache=function(e){this.deletedCache=_.pull(this.deletedCache,e)},t.prototype.addToDeletedCache=function(e){this.deletedCache=_.concat(this.deletedCache,e)},t.prototype.createLinkToChannel=function(e){var t=this.conversationsService.getConversation(e);if(!t)return this.logger.error("Unable to resolve bookmarked conversation {0}",e),null;if(t.isChat())return{label:this.$translate.instant(this.resources.strings.chats_title),state:this.constants.states.appConversation,params:{middlePane:this.constants.messages.panes.conversations,slug:t.id,ctx:this.constants.navigation.context.chat,navCtx:this.navCtx}};var i=this.channelService.getChannelByObjectId(e);if(!i)return this.logger.error("Unable to resolve channel {0}",e),null;var n=this.channelService.getTeamByObjectId(i.parentTeamId);return n?{label:n.displayName+"/"+i.displayName,state:this.constants.states.appConversation,params:{middlePane:this.constants.messages.panes.conversations,slug:i.displayName,groupName:n.displayName,threadId:i.objectId,ctx:this.constants.navigation.context.channel,navCtx:this.navCtx}}:(this.logger.error("Unable to resolve team {0} ",i.parentTeamId),null)},t.prototype.navigateToDefaultStarredItem=function(){var e=this;this.getStarredItems().then(function(t){t&&t.length>0?e.navigateToStarredItem(t[0]):e.navigateToEmptyState()})},t.prototype.navigateToStarredItem=function(e){var t=this.getContextMessageConversationType(e.type)===teamspace.components.ContextMessageConversationType.Group;this.navigationService.navigateToSavedMessage(this.$rootScope,e.message.originalarrivaltime,e.conversationId,e.messageId,e.parentMessageId,e.message.clientmessageid,this.navCtx,e.link.params.groupName,t?e.link.params.slug:e.imdisplayname,e.type)},t.prototype.navigateToEmptyState=function(){this.navigationService.navigate(this.$rootScope,this.constants.states.appAppsAppSection,{appId:this.constants.appId.saved,middlePane:this.constants.messages.panes.saved,navCtx:this.navCtx})},t.prototype.getContextMessageConversationType=function(e){return e===SkypeX.Services.StarredItemType.Chat?teamspace.components.ContextMessageConversationType.OneToOne:e===SkypeX.Services.StarredItemType.Message?teamspace.components.ContextMessageConversationType.Group:void this.logger.error("Error mapping starred item type to conversation type:{0}",SkypeX.Services.StarredItemType[e])},t}(SkypeX.Services.SXStoreBase);t.StarredItemsStore=r,angular.module("skypeX.starredItemsStore",["teamspace.locales","teamspace.htmlSanitizer","pascalprecht.translate","skypeX.messageStore","teamspace.loggingService","teamspace.peopleService","teamspace.channelService","teamspace.utilityService","teamspace.navigationService","skypeX.chatSyncService","teamspace.messageService"]).service("starredItemsStore",r)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n,r,s,a,o,c){var l=e.call(this)||this;return l.$q=t,l.chatServiceClient=i,l.clientDatabase=n,l.constants=r,l.loggingService=s,l.authenticationService=a,l.orchestrationService=o,l.settingsService=c,l.preferences={},l.isFirstLogin=!1,l.lastTimeUserSettingFetched=0,l.getRecentUserPreferences=function(e){return SkypeX.Services.SyncTasks.preventConcurrent(function(){return _.isNil(e)&&(e=l.constants.timeInMiliseconds.fiveMinutes),Date.now()<l.lastTimeUserSettingFetched+e?l.fetchUserPreferencesFromLocalStore():l.syncUserPreferencesFromServer()})()},l.syncUserPreferencesFromServer=SkypeX.Services.SyncTasks.preventConcurrent(function(){return l.authenticationService.isAnonymous()?l.$q.when({}):l.chatServiceClient.getMyProperties().then(function(e){l.lastTimeUserSettingFetched=Date.now();var t=l.convertPropertiesToPreferences(e);_.isEqual(t,l.preferences)||(l.logger.info("Assigning the user preference from server"),l.preferences=t,l.preferences.firstLoginInformation&&l.preferences.firstLoginInformation[l.constants.firstLoginDeviceKeys.web]||(l.isFRE=!0),l.addOrUpdateUserPreferencesToLocalStore(l.preferences),l.trigger(l.constants.MyUserPreferencesStore.Type_UserPreference))})}),l.logger=l.loggingService.newLogger("UserPreferences"),l.initLoadDeferred=l.$q.defer(),l.orchestrationService.registerAction(l.constants.actions.userPreferences.startup,function(){return l.startup().toNgPromise(t)}),l.disablePinnedSync=l.settingsService.valueAsBoolean("disablePinnedSync"),l}return n(t,e),t.$inject=["$q","chatServiceClient","clientDatabase","constants","loggingService","authenticationService","orchestrationService","settingsService"],t.prototype.startup=function(){var e=this;return this.fetchUserPreferencesFromLocalStore().then(function(t){if(!t||_.isEmpty(t))return e.syncUserPreferencesFromServer().then(function(){},function(t){return 404==t.statusCode?(e.logger.error("Couldn't find user settings for the current user"),SkypeX.Services.SyncTasks.Resolved()):(t.errorMessage&&!0===t.errorMessage.isHandled&&(t.shouldCancelOrchestrationStepScenario=!0),e.logger.error("Couldn't fetch preferences from the server: {0}",t),SkypeX.Services.SyncTasks.Rejected(t))});t.firstLoginInformation&&t.firstLoginInformation[e.constants.firstLoginDeviceKeys.web]||(e.logger.error("Preference exist in index db but first login is not set"),e.isFRE=!0),e.preferences=t,!e.preferences.pinned&&e.preferences[s.Pinned]&&(e.preferences.pinned=t[s.Pinned])},function(t){return e.logger.error("Couldn't fetch preferences: {0}",t),SkypeX.Services.SyncTasks.Rejected(t)}).finally(function(){return e.initLoadDeferred.resolve()})},t.prototype.handleUserPreferenceDeltaUpdates=function(e){var t=this,i=[];_.each(e,function(e,n){if(i.push(n),t.disablePinnedSync&&n===s.Pinned)return!1;t.assignPropertyToPreferences(n,e,t.preferences)}),this.addOrUpdateUserPreferencesToLocalStore(this.preferences),this.trigger(this.constants.MyUserPreferencesStore.Type_UserPreference,null,i)},t.prototype.getUserPreferences=function(){return this.preferences},t.prototype.getFirstWebLogin=function(){var e=moment(),t=this.getUserPreferences();return t&&t.firstLoginInformation&&t.firstLoginInformation[this.constants.firstLoginDeviceKeys.web]&&(e=moment(t.firstLoginInformation[this.constants.firstLoginDeviceKeys.web])),e},t.prototype.setUserPreference=function(e,t){var i=this;return(this.disablePinnedSync&&e===s.Pinned?SkypeX.Services.SyncTasks.Resolved():this.chatServiceClient.setMyProperty(e,t)).then(function(){i.assignPropertyToPreferences(e,t,i.preferences),i.trigger(i.constants.MyUserPreferencesStore.Type_UserPreference,null,[e])})},Object.defineProperty(t.prototype,"isFRE",{get:function(){return this.isFirstLogin},set:function(e){this.isFirstLogin=e},enumerable:!0,configurable:!0}),t.prototype.waitForPreferenceStoreToInitialize=function(){return this.initLoadDeferred.promise},t.prototype.fetchUserPreferencesFromLocalStore=function(){return this.clientDatabase.provider.get(this.clientDatabase.schema.stores.internaldata.name,this.constants.MyUserPreferencesStore.Key_Internal_Prefs).then(function(e){return e?e.value:null})},t.prototype.addOrUpdateUserPreferencesToLocalStore=function(e){return this.clientDatabase.provider.put(this.clientDatabase.schema.stores.internaldata.name,[{id:this.constants.MyUserPreferencesStore.Key_Internal_Prefs,value:e}])},t.prototype.convertPropertiesToPreferences=function(e){var t=this,i={};return _.each(e,function(e,n){t.assignPropertyToPreferences(n,e,i)}),i},t.prototype.assignPropertyToPreferences=function(e,t,i){switch(e){case s.DogfoodUser:case s.HideShareWithTeamWarning:i[e]="True"==t||"true"==t;break;case s.Pinned:i.pinned=JSON.parse(t);break;case s.FirstLoginInformation:case s.BannerDismissalCounts:case s.PersonalFileSite:case s.PersonalNoteBook:case s.PersonalSharedNoteBook:case s.SuggestedContacts:case s.TeamsOrder:case s.UserDetails:case s.UserPersonalSettings:case s.RoutingSettingsInformationalDialog:case s.ExternalFilesProviders:case s.CortanaSettings:i[e]=JSON.parse(t);break;case s.LastReportedTime:i[e]=new Date(t);break;case s.Locale:case s.FRESent:case s.MobileNudgeSent:case s.WhoBotNudgeSent:case s.TBotNotificationBlocked:case s.ReadReceiptsEnabled:default:i[e]=t}},t}(SkypeX.Services.SXStoreBase);t.MyUserPreferencesStore=r;var s=function(){function e(){}return e.None="none",e.BannerDismissalCounts="bannerDismissalCounts",e.DogfoodUser="dogfoodUser",e.ExternalFilesProviders="externalFilesProviders",e.Pinned="favorites",e.FirstLoginInformation="firstLoginInformation",e.LastReportedTime="lastReportedTime",e.PersonalFileSite="personalFileSite",e.PersonalNoteBook="personalNoteBook",e.PersonalSharedNoteBook="personalSharedNoteBook",e.SuggestedContacts="suggestedContacts",e.TeamsOrder="teamsOrder",e.UserDetails="userDetails",e.UserPersonalSettings="userPersonalSettings",e.Locale="locale",e.FRESent="freSent",e.WhoBotNudgeSent="whoBotNudgeSent",e.MobileNudgeSent="mobileNudgeSent",e.TBotNotificationBlocked="tbotNotificationBlocked",e.HideShareWithTeamWarning="hideShareWithTeamWarning",e.CortanaSettings="cortanaSettings",e.RoutingSettingsInformationalDialog="routingSettingsInformationalDialog",e.ReadReceiptsEnabled="readReceiptsEnabled",e}();t.MyUserPreferenceStorageKey=s,angular.module("skypeX.myUserPreferencesStore",["skypeX.chatServiceClient","skypeX.clientDatabase"]).service("myUserPreferencesStore",r)},function(e,t,i){"use strict";function n(e){var t=e+"";return("0000000000000000"+t).substr(t.length)}function r(e){return{threadIds:_.uniq(_.map(e,function(e){return e.conversationId})),versionRange:e.length?{max:_.maxBy(e,function(e){return e.versionNumber}).versionNumber,min:_.minBy(e,function(e){return e.versionNumber}).versionNumber}:void 0}}var s=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=SkypeX.Services.MessageStoreConstants,o=SkypeX.Services.SkypeMessageDB,c=SkypeX.Services.SkypeMessageLocal,l=SkypeX.Services.SkypeMessageSource,p=SkypeX.Services.SyncTasks,u=i(78),h=function(){function e(e,t,i){this.conversationId=e,this.parentMessageId=t,this.messages={},this.isInsideChat=i?"true":"false",this.latestDeliveryTime=""}return e.fromMessages=function(t,i){var n=new e(t[0].conversationId,t[0].parentMessageId,i);return e.putMessages(n,t),n},e.putMessages=function(t,i,n){void 0===n&&(n=!1);for(var r=0;r<i.length;r++){var s=i[r],a=e.replyChainMessageKey(s),l=t.messages[a];!s.translation&&l&&l.translation&&(s.translation=l.translation),n&&e.mergeVersionHistory(l,s),s._skypeMessage?(t.messages[a]=s instanceof o?s:new o(s),s instanceof c&&delete s._skypeMessage):t.messages[a]=s}e.processMessages(t)},e.processMessages=function(e){var t=_.values(e.messages),i=_.maxBy(t,function(e){return e.originalArrivalTimeUtc||Date.parse(e.originalarrivaltime)});e.latestDeliveryTime=n(i.originalArrivalTimeUtc||Date.parse(i.originalarrivaltime))},e.replyChainMessageKey=function(e){return e.idUnion+","+e.creator},e.getMessageVersionEntry=function(e){return{version:e.versionNumber,source:e.source,timestamp:e.clientArrivalTime}},e.mergeVersionHistory=function(t,i){var n=e.getMessageVersionEntry(i),r=t&&t.versionHistory||[],s=!_.find(r,function(e){return e&&e.timestamp===n.timestamp}),a=n.source===l.LongPoll&&r.length>0;s&&!a&&r.push(n),i.versionHistory=r},e}();t.StoreReplyChain=h;var d=function(e){function t(t,i,n,r,s,a,o,c,l,p,u){var h=e.call(this)||this;h.$injector=t,h.clientDatabase=i,h.constants=n,h.conversationsStore=r,h.eventingService=s,h.$q=a,h.loggingService=o,h.messageSanitizingService=c,h.resourceManager=l,h.skypeModelFactory=p,h.settingsService=u,h.disableMessageWrites=!1,h.logger=h.loggingService.newLogger("MessageStore"),h.triggerLogger=function(e){return h.logger.error("trigger error: {0}",e)};var d=h.settingsService.valueAsBoolean("throttleMessageWrites")?250:void 0;return h.writeActions=new SkypeX.Services.ThrottledActions(d),h.disableMessageWrites=h.settingsService.valueAsBoolean("disableMessageWrites"),h.boldLogic2=h.settingsService.valueAsBoolean(h.constants.settings.names.boldLogic2),h.resourceManager.subscribe(function(){h.resourceManager.currentPriority===teamspace.services.TaskPriority.RealTime?h.writeActions.pause():h.writeActions.resume()},h.resourceManager.Type_CurrentPriority),h}return s(t,e),t.$inject=["$injector","clientDatabase","constants","conversationsStore","eventingService","$q","loggingService","messageSanitizingService","resourceManager","skypeModelFactory","settingsService"],Object.defineProperty(t.prototype,"messageService",{get:function(){return this._messageService=this._messageService||this.$injector.get("messageService"),this._messageService},enumerable:!0,configurable:!0}),t.prototype.getMessage=function(e,t){var i=this;return this.clientDatabase.provider.get(this.clientDatabase.schema.stores.messages.name,[e,t]).then(function(n){return n&&n.parentMessageId?i.clientDatabase.provider.get(i.clientDatabase.schema.stores.replychains.name,[e,n.parentMessageId]).then(function(e){var n=_.find(e&&e.messages,function(e){return e.id===t});return i.createSafeSkypeMessageLocal(n,SkypeX.Services.MessageStorageState.Local,e.creatorProfiles)}):null}).toNgPromise(this.$q)},t.prototype.getParentMessageIdByMessageId=function(e,t){return this.clientDatabase.provider.get(this.clientDatabase.schema.stores.messages.name,[e,t]).then(function(e){return e&&e.parentMessageId}).toNgPromise(this.$q)},t.prototype.isMessagePresent=function(e,t,i,n){return this.clientDatabase.provider.getOnly(this.clientDatabase.schema.stores.messages.name,this.clientDatabase.schema.stores.messages.indexes.idunion.name,[t,e,i]).then(function(e){var t=e&&e.length>0;return n?t&&!teamspace.services.MessagingUtilities.isClientLie(e[0].id):t}).toNgPromise(this.$q)},t.prototype.getWriteActionsQueue=function(){return this.writeActions},t.prototype.getLatestMessageInConversation=function(e){return this.clientDatabase.provider.getRange(this.clientDatabase.schema.stores.replychains.name,this.clientDatabase.schema.stores.replychains.indexes.latestdeliverytime.name,[e,0],[e,t.getSortableDateTime(Date.now())],!1,!1,!0,1).then(function(e){var t=e[0]&&e[0].messages?_.values(e[0].messages):[],i=_.maxBy(t,function(e){return e.originalArrivalTimeUtc||Date.parse(e.originalarrivaltime)});return i&&(i.messageStorageState=SkypeX.Services.MessageStorageState.Local),i}).toNgPromise(this.$q)},t.prototype.putMessages=function(e,t,i){return void 0===t&&(t=!1),void 0===i&&(i=!0),e&&0!==e.length?(this.logger.debug("putMessages, messages.length: {0}",e.length),this.broadcastPutMessages(e,t),i?this.putMessagesToDb(e):SkypeX.Services.SyncTasks.Resolved()):i?this.writeActions.schedule(function(){return p.Resolved()}):p.Resolved()},t.prototype.getRecentReplyChains=function(e,i,n,r,s){var a=this;return this.clientDatabase.provider.getRangeWithCriteria(this.clientDatabase.schema.stores.replychains.name,this.clientDatabase.schema.stores.replychains.indexes.latestdeliverytimebyconversationtype.name,e,["false",t.getSortableDateTime(n)],["false",t.getSortableDateTime(i)],!1,!1,!0,r,s).then(function(e){if(!e||!e.results.length)return null;var t=_.map(e.results,function(e){return new SkypeX.Services.SkypeReplyChain(_.map(e.messages,function(t){return a.createSafeSkypeMessageLocal(t,SkypeX.Services.MessageStorageState.Local,e.creatorProfiles)}))});return{nextPageOffset:e.nextPageOffset,results:t}})},t.getSafeKey=function(e){return e&&e<Number.MAX_VALUE?t.getSortableDateTime(e):t.Max_ReplyChain_LatestDeliveryTimeIndex},t.prototype.getMessagesForReplyChains=function(e,t,i){var n=this;return this.getReplyChainsByLastDeliveryTimeInternal(e,t,i).then(function(e){if(!e||!e.length)return{messages:[],replyChainsByLatestDeliveryTime:[],hasMore:!1};var i=parseInt(_.minBy(e,function(e){return e.latestDeliveryTime}).latestDeliveryTime);return{messages:n.createSafeSkypeMessageLocalsFromDbReplyChains(e),replyChainsByLatestDeliveryTime:_.map(e,function(e){return{parentMessageId:e.parentMessageId,latestDeliveryTimeUtc:parseInt(e.latestDeliveryTime)}}),hasMore:e.length===t,token:i}})},t.prototype.getReplyChainsByLastDeliveryTime=function(e,t,i){var n=this;return this.getReplyChainsByLastDeliveryTimeInternal(e,t,i).then(function(e){return _.map(e,function(e){return n.createSafeSkypeReplyChain(e)})})},t.prototype.getReplyChainsByLastDeliveryTimeInternal=function(e,i,n){var r=this,s=t.getSafeKey(n);return this.clientDatabase.provider.getRange(this.clientDatabase.schema.stores.replychains.name,this.clientDatabase.schema.stores.replychains.indexes.latestdeliverytime.name,[e,"0"],[e,s],!1,!0,!0,i).then(function(t){return r.removeNullReplyChains(t,e,!0)}).toNgPromise(this.$q)},t.prototype.createSafeSkypeMessageLocalsFromDbReplyChains=function(e){var t=this,i=[];return _.forEach(e,function(e){var n=_.map(e.messages,function(i){return t.createSafeSkypeMessageLocal(i,SkypeX.Services.MessageStorageState.Local,e.creatorProfiles)});i=i.concat(n)}),i},t.prototype.getReplyChains=function(e,t){var i=this;if(!e||!t)return SkypeX.Services.SyncTasks.Resolved([]);var n=_.map(t,function(t){return[e,t.parentMessageId]});return this.clientDatabase.provider.getMultiple(this.clientDatabase.schema.stores.replychains.name,n).then(function(t){if(!(t=i.removeNullReplyChains(t,e))||!t.length)return[];var n=[];return _.each(t,function(e){var t=_.map(e.messages,function(t){return i.createSafeSkypeMessageLocal(t,SkypeX.Services.MessageStorageState.Local,e.creatorProfiles)});n.push(new SkypeX.Services.SkypeReplyChain(t))}),n})},t.prototype.getMessagesForConversationAndReplyChainDeliveryTimeRange=function(e,i,n){var r=this,s=t.getSortableDateTime(i),a=t.getSortableDateTime(n);return this.clientDatabase.provider.getRange(this.clientDatabase.schema.stores.replychains.name,this.clientDatabase.schema.stores.replychains.indexes.latestdeliverytime.name,[e,s],[e,a]).then(function(t){return t=r.removeNullReplyChains(t,e,!0),r.createSafeSkypeMessageLocalsFromDbReplyChains(t)}).toNgPromise(this.$q)},t.prototype.getMessagesForReplyChain=function(e,t){var i=this;return this.clientDatabase.provider.get(this.clientDatabase.schema.stores.replychains.name,[e,t]).then(function(e){return _.map(e&&e.messages,function(t){return i.createSafeSkypeMessageLocal(t,SkypeX.Services.MessageStorageState.Local,e.creatorProfiles)})}).toNgPromise(this.$q)},t.prototype.getMessagesForReplyChainByExternalId=function(e,t){var i=this,n=this.loggingService.newScenario("byExternalId");return this.clientDatabase.provider.getOnly(this.clientDatabase.schema.stores.messages.name,this.clientDatabase.schema.stores.messages.indexes.convidexternalid.name,[e,t]).then(function(t){return t&&0!==t.length?i.clientDatabase.provider.get(i.clientDatabase.schema.stores.replychains.name,[e,t[0].parentMessageId]).then(function(e){var t=e&&e.messages||[];return _.map(t,function(t){return i.createSafeSkypeMessageLocal(t,SkypeX.Services.MessageStorageState.Local,e.creatorProfiles)})}):(n.incomplete(),[])}).toNgPromise(this.$q)},t.prototype.handleSyncedMessages=function(e,t,i){var n=this;void 0===i&&(i=!0);var r=i&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableSkypeMessageDBModel),s=_.map(e,function(e){return n.skypeModelFactory.createLocalMessage(e,SkypeX.Services.MessageStorageState.Network,r)});if(s.forEach(function(e){if(e.clientArrivalTime=(new Date).toISOString(),e.source=t,n.boldLogic2){var i=e.getConversationIdFromConversationLink();!n.conversationsStore.revertFakeConsumptionHorizon(i,e)&&e.isFromMe&&n.conversationsStore.keepChannelReadForMessage(i,e)}}),!this.settingsService.valueAsBoolean(this.constants.settings.names.sanitizeDuringRender)){var a=performance.now();_.each(s,function(e){n.messageSanitizingService.sanitizeMessage(e),e._skypeMessage&&(e._skypeMessage.content=e.content,e._skypeMessage.messagetype=e.messagetype)}),this.logger.debug("Total Messages: {0} Time taken for Sanitization: {1}",s.length,performance.now()-a)}return this.conversationsStore.ensureLastMessage(s),this.putMessages(s,t===SkypeX.Services.SkypeMessageSource.LongPoll,i)},t.prototype.removeMessages=function(e,t){return t?this.removeSomeMessages(e,t):this.removeAllMessages(e)},t.prototype.removeAllMessages=function(e){var t=this,i=[this.clientDatabase.provider.removeRange(this.clientDatabase.schema.stores.messages.name,void 0,[e,""],[e,"A"]),this.clientDatabase.provider.removeRange(this.clientDatabase.schema.stores.replychains.name,void 0,[e,""],[e,"A"])];if(this.settingsService.valueAsBoolean("enableReplyChainApi")){var n=this.clientDatabase.provider.remove(this.clientDatabase.schema.stores.internaldata.name,u.getReplyChainViewId(e));n.then(function(){return t.triggerWithLogging(t.triggerLogger,a.EventType_ReplyChainsView,e)}),i.push(n)}return SkypeX.Services.SyncTasks.whenAll(i).then(function(){})},t.prototype.removeMessagesRcApiSupported=function(e,t){var i=this;if(!t)return this.removeAllMessages(e);var n=[],r=0;return this.clientDatabase.provider.get(this.clientDatabase.schema.stores.internaldata.name,u.getReplyChainViewId(e)).then(function(e){if(e){var n=_.reject(e.value.replyChainIndexes,t),s=_.minBy(n,function(e){return Number(e.parentMessageId)});return r=s?Number(s.parentMessageId):Number.MAX_SAFE_INTEGER,e.value.replyChainIndexes=n,i.clientDatabase.provider.put(i.clientDatabase.schema.stores.internaldata.name,e)}}).then(function(){i.triggerWithLogging(i.triggerLogger,a.EventType_ReplyChainsView,e)}).then(function(){return i.clientDatabase.provider.removeRange(i.clientDatabase.schema.stores.replychains.name,void 0,[e,""],[e,r.toString()],!1,!0)}).then(function(){return i.clientDatabase.provider.iterate(i.clientDatabase.schema.stores.messages.name,void 0,{keyRange:{low:[e,""],high:[e,"A"]},writeNeeded:!0,func:function(e){var t=e.value;t&&Number(t.parentMessageId)<r&&(n.push({id:t.id,version:t.version}),e.delete())}})}).then(function(){return n})},t.prototype.removeSomeMessages=function(e,t){var i=this,n=[],r=[];return this.clientDatabase.provider.iterate(this.clientDatabase.schema.stores.replychains.name,this.clientDatabase.schema.stores.replychains.indexes.latestdeliverytime.name,{keyRange:{low:[e,""],high:[e,"Z"]},writeNeeded:!0,func:function(e){if(e.value&&e.value.messages){var s=e.value,a=_.values(s.messages),o=_.partition(a,t),c=o[0],l=o[1];if(c.length>0){if(n.push.apply(n,_.map(c,function(e){return{id:e.id,version:e.version}})),0===l.length)return e.delete(),void r.push(s.parentMessageId);if(s.messages={},!!!_.find(l,function(e){return s.parentMessageId===e.id})){var p=_.first(l).conversationId;l.push(i.skypeModelFactory.createFakeRootMessage(p,s.parentMessageId))}h.putMessages(s,l),e.update(s)}}}}).then(function(){return i.clientDatabase.provider.remove(i.clientDatabase.schema.stores.messages.name,_.map(n,function(t){return[e,t.id]}))}).then(function(){if(r.length>0)return i.clientDatabase.provider.get(i.clientDatabase.schema.stores.internaldata.name,u.getReplyChainViewId(e)).then(function(e){if(e)return e.value.replyChainIndexes=_.reject(e.value.replyChainIndexes,function(e){return r.includes(e.parentMessageId)}),i.clientDatabase.provider.put(i.clientDatabase.schema.stores.internaldata.name,e)}).then(function(){return i.triggerWithLogging(i.triggerLogger,a.EventType_ReplyChainsView,e)})}).then(function(){return n})},t.prototype.removeClientLieMessage=function(e,t,i){var n=this,r=[];return this.conversationsStore.isCSAReplyChainApiSupported(e)&&(r.push(this.clientDatabase.provider.remove(this.clientDatabase.schema.stores.messages.name,[e,i])),teamspace.services.MessagingUtilities.isClientLie(t)?r.push(this.clientDatabase.provider.remove(this.clientDatabase.schema.stores.replychains.name,[e,t])):r.push(this.clientDatabase.provider.get(this.clientDatabase.schema.stores.replychains.name,[e,t]).then(function(e){if(e){var t=_.find(e.messages,function(e){return e.idUnion===i&&teamspace.services.MessagingUtilities.isClientLie(e.id)});if(t){var r=t.idUnion+","+t.creator;return delete e.messages[r],n.clientDatabase.provider.put(n.clientDatabase.schema.stores.replychains.name,e)}}}))),SkypeX.Services.SyncTasks.whenAll(r).then(function(){})},t.prototype.putMessagesToDb=function(e){var t=this,i=this.settingsService.valueAsBoolean("enableSyncMessageVersionLogging"),n=_.sortBy(_.values(_.groupBy(e,"parentMessageId")),function(e){return e[0].parentMessageId}),s=this.loggingService.newScenario("messagestoreputmessages");s.eventData.data=JSON.stringify(r(e));var a=_.keyBy(e,function(e){return e.id});return this.getCreatorProfiles(e).then(function(r){return t.writeActions.schedule(function(){return t.clientDatabase.provider.openTransaction(t.clientDatabase.schema.stores.replychains.name,!0).then(function(s){var o=s.store,c=_.map(n,function(e){return[e[0].conversationId,e[0].parentMessageId]});return o.getMultiple(c).then(function(s){for(var c=_.sortBy(_.filter(s),function(e){return e.parentMessageId}),l=0;l<n.length;l++){var p=c[l],u=n[l];p&&p.parentMessageId===u[0].parentMessageId||(p=new h(u[0].conversationId,u[0].parentMessageId,t.conversationsStore.isConversationChat(e[0].conversationId)),c.splice(l,0,p)),h.putMessages(p,u,i)}return _.each(c,function(e){_.each(e.messages,function(i){if(i.replyChainLatestDeliveryTime=Number(e.latestDeliveryTime),i.parentMessageId!==e.parentMessageId&&t.logger.error("putMessages found bad reply chain merge {0} in {1}",i.parentMessageId,e.parentMessageId),!_.isEmpty(r)){e.creatorProfiles=e.creatorProfiles||{};var n=a[i.id]&&a[i.id].creatorProfileKey;n&&_.isEmpty(e.creatorProfiles[n])&&!_.isEmpty(r[n])&&(e.creatorProfiles[n]=r[n])}})}),o.put(c)})}).then(function(){if(!t.disableMessageWrites||0!==(e=_.filter(e,function(e){return!!e.externalid})).length){var i=_.map(e,function(e){return t.getMessageIndexObject(e)});return t.clientDatabase.provider.put(t.clientDatabase.schema.stores.messages.name,i)}t.logger.debug("skipping message writes")}).then(function(){_.forEach(e,function(e){e.messageStorageState=SkypeX.Services.MessageStorageState.Local}),s.stop()}).catch(function(e){return s.fail({error:e}),p.Rejected(e)})})})},t.prototype.getCreatorProfiles=function(e){var t=this;if(!this.settingsService.valueAsBoolean(this.constants.settings.names.enableHydrationBeforeWriteToDb))return p.Resolved(null);var i=SkypeX.Services.SyncTasks.Defer();return this.messageService.getCreatorProfiles(e,!1).then(function(e){i.resolve(e)},function(e){t.logger.error("Failed to resolve sender profiles"),i.resolve(null)}),i.promise()},t.prototype.removeNullReplyChains=function(e,t,i){if(!e||!e.length)return e;var n=_.remove(e,function(e){return!e}).length;if(n){var r=n+" reply chains not found in conversation: "+t;i?this.logger.error(r):this.logger.debug(r)}return e},t.prototype.broadcastPutMessages=function(e,t){var i=this;this.eventingService.$emit(this.constants.events.pushEvents.messageStore.createOrUpdateMessage,{messages:e,isFromLongPoll:t}),_.each(e,function(e){return i.triggerWithLogging(i.triggerLogger,SkypeX.Services.MessageStoreConstants.EventType_All,e.conversationId,e)}),_.each(_.groupBy(e,function(e){return e.conversationId}),function(e,t){i.triggerWithLogging(i.triggerLogger,SkypeX.Services.MessageStoreConstants.EventType_Batched,t,e)})},t.prototype.createSafeSkypeMessageLocal=function(e,t,i){if(!e)return null;var n=e._skypeMessage?this.createLocalMessageFromDbMessage(e,t):new SkypeX.Services.SkypeMessageLocal(e,t);return!_.isEmpty(i)&&i[n.creatorProfileKey]&&(n.creatorProfile=i[n.creatorProfileKey]),n},t.prototype.createSafeSkypeReplyChain=function(e){var t=this;return new SkypeX.Services.SkypeReplyChain(_.map(e.messages,function(e){return t.createSafeSkypeMessageLocal(e,SkypeX.Services.MessageStorageState.Local)}))},t.prototype.createLocalMessageFromDbMessage=function(e,t){var i=this.skypeModelFactory.createLocalMessage(e._skypeMessage,t);for(var n in e)e.hasOwnProperty(n)&&i.hasOwnProperty(n)&&(i[n]=e[n]);return i.hasOwnProperty("_skypeMessage")&&delete i._skypeMessage,i},t.prototype.getMessageIndexObject=function(e){var t={conversationId:e.conversationId,id:e.id,creator:e.creator,idUnion:e.idUnion,parentMessageId:e.parentMessageId||e.id};return e.externalid&&(t.externalid=e.externalid),t},t.getSortableDateTime=function(e){return n(e)},t.Max_ReplyChain_LatestDeliveryTimeIndex="9999999999999999",t}(SkypeX.Services.SXStoreBase);t.MessageStore=d,angular.module("skypeX.messageStore",[]).service("messageStore",d)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=SkypeX.Services.SyncTasks,s=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d){var g=e.call(this)||this;return g.constants=t,g.$injector=i,g.loggingService=n,g.eventingService=r,g.conversationsStore=s,g.messageStore=a,g.skypeModelFactory=o,g.userResourcesSettingsStore=c,g.persistenceService=l,g.messageSanitizingService=p,g.settingsService=u,g.messagingTelemetryService=h,g.syncStateService=d,g.enableSfBGateway=!1,g.logger=g.loggingService.newLogger("ReplyChainStore"),g.preventDuplicates=!g.settingsService.valueAsBoolean("disableMessageDeduping"),g.boldLogic2=g.settingsService.valueAsBoolean(g.constants.settings.names.boldLogic2),g.enableSfBGateway=g.settingsService.valueAsBoolean(g.constants.settings.names.enableSfBGateway),g.views={},g.replyChains={},g}return n(t,e),t.$inject=["constants","$injector","loggingService","eventingService","conversationsStore","messageStore","skypeModelFactory","userResourcesSettingsStore","persistenceService","messageSanitizingService","settingsService","messagingTelemetryService","syncStateService"],t.prototype.startup=function(){return this.chatSyncService=this.$injector.get("chatSyncService"),this.messageProcessingService=this.$injector.get("messageProcessingService"),this.isRunning=!0,this.conversationsStore.subscribe(this.onFavoriteConversationChanged.bind(this),SkypeX.Services.ConversationsStoreEvents.Type_FavoriteChanged),this.messageStore.subscribe(this.onReplyChainsViewEvent.bind(this),SkypeX.Services.MessageStoreConstants.EventType_ReplyChainsView),SkypeX.Services.SyncTasks.Resolved()},t.prototype.loadHeadView=function(e,t){var i=this;if(!e||!e.conversationId)return SkypeX.Services.SyncTasks.Rejected("invalid parameters");var n=e.conversationId,r=SkypeX.Services.ChatServiceUtils.parseActivityId(n),s=r.isValid?r.topicId:n;return t=_.isUndefined(t)?0:t,this.initializeViewFromPersistence(n).then(function(n){n.headViewOptions=e;var r=i.ensureReplyChainEntry(s);if(!i.isDatabaseLoadRequired(e,r,t))return SkypeX.Services.SyncTasks.Resolved();if(n.replyChainIndexes){var a=_.findIndex(n.replyChainIndexes,function(e){return null!=n.cursorToken&&e.parentMessageId===n.cursorToken})+1,o=a+n.headViewOptions.count,c=n.replyChainIndexes.slice(a,Math.min(o,n.replyChainIndexes.length)),l=_.filter(c,function(e){return!r[e.parentMessageId]||!r[e.parentMessageId].isReadFromDB});if(l.length>0)return e.scenario&&i.messagingTelemetryService.decorateWithDataSource(e.scenario,teamspace.services.ConversationDataSource.indexedDB),i.persistenceService.getReplyChains(s,l).then(function(a){var o=_.difference(_.map(l,function(e){return e.parentMessageId}),_.map(a,function(e){return e.parentMessageId}));if(_.each(o,function(e){r[e]?r[e].isReadFromDB=!0:(i.chatSyncService.syncRelatedMessages(s,e),i.loggingService.event("replychainstore_corrupt_view"))}),a.length>0){var p=_.flatten(_.map(a,function(e){return e.messages}));_.each(p,function(e){teamspace.services.MessagingUtilities.isClientLie(e.id)&&(e.state=teamspace.services.MessageSendState.Error)}),i.putMessages(p,{syncSource:SkypeX.Services.SkypeMessageSource.Local,isReadFromDB:!0},!1,!1).then(function(){var s=_.map(c,function(e){return r[e.parentMessageId]}).filter(function(e){return e});s.length>0&&(n.cursorToken=_.minBy(s,function(e){return e.lastMessageTimeUtc}).parentMessageId);var a=i.numValidReplyChains(s,n.headViewOptions,t);if(a<e.count)return i.loadHeadView(e,a)})}else i.logger.warn("Unable to retreive replychains from indexedDB. threadId: "+s+" replyChainIndexesCount: "+c.length)});c.length>0&&(n.cursorToken=_.minBy(c,function(e){return e.lastMessageTimeUtc}).parentMessageId)}return SkypeX.Services.SyncTasks.Resolved()})},t.prototype.isDatabaseLoadRequired=function(e,t,i){var n=e.conversationId,r=this.conversationsStore.isPersisted(n),s=this.views[n];if(r&&(!s||!s.cursorToken))return!0;var a=_.find(s.replyChainIndexes,function(e){return e.parentMessageId===s.cursorToken}),o=a?a.lastMessageTimeUtc:Number.MAX_VALUE,c=e.startTime||Number.MAX_VALUE,l=_.filter(s.replyChainIndexes,function(e){return e.lastMessageTimeUtc>=o&&e.lastMessageTimeUtc<c}),p=_.map(l,function(e){return t[e.parentMessageId]}).filter(function(e){return e});return this.numValidReplyChains(p,e,i)<=e.count&&!this.isDatabaseExhausted(n)},t.prototype.numValidReplyChains=function(e,t,i){return _.reduce(e,function(e,i){return _.filter(i.messages,t.messageFilter).length>0?e+1:e},i)},t.prototype.isDatabaseExhausted=function(e){var t=this.views[e],i=this.conversationsStore.isPersisted(e),n=!1;return t&&t.replyChainIndexes&&(n=_.findIndex(t.replyChainIndexes,function(e){return e.parentMessageId===t.cursorToken})<t.replyChainIndexes.length-1),!i||!n},t.prototype.getHeadView=function(e){var t=this;if(!e||!this.views[e])return null;var i=[],n=SkypeX.Services.ChatServiceUtils.parseActivityId(e),r=n.isValid?n.topicId:e,s=this.views[e],a=this.ensureReplyChainEntry(r);if(s&&s.replyChainIndexes&&a){var o=s.replyChainIndexes;if(s.cursorToken){var c=_.findIndex(s.replyChainIndexes,function(e){return!_.isUndefined(s.cursorToken)&&e.parentMessageId===s.cursorToken});o=s.replyChainIndexes.slice(0,c+1)}i=_.map(o,function(e){return a[e.parentMessageId]}).filter(function(e){return e})}return _.each(i,function(e){_.each(e.messages,function(e){e.state=teamspace.services.MessagingUtilities.isClientLie(e.id)?e.state:teamspace.services.MessageSendState.Received})}),{conversationId:e,replyChains:i,loadMore:function(){var n=t.conversationsStore.getConversation(e),r=t.conversationsStore.getConversationSyncState(e),s=r&&!r.isSyncedToStartOfTime,a=!1;if(a=n&&!s&&0===i.length&&!!n.lastMessage,s||a){var o=t.views[e],c=o&&o.headViewOptions.scenario;t.chatSyncService.extendMessageHistoryStartTime(e)&&c&&c.mark("expanding_sync_window")}return SkypeX.Services.SyncTasks.Resolved()}}},t.prototype.getReplyChainView=function(e){return this.views[e]},t.prototype.getReplyChainsForLogging=function(e){return _.map(this.replyChains[e])},t.prototype.isReplyChainLoaded=function(e,t){return!!this.ensureReplyChainEntry(e)[t]},t.prototype.isViewCached=function(e){return this.views[e]&&!!this.views[e].replyChainIndexes},t.prototype.getMessagesByConversationId=function(e,t){var i=this.ensureReplyChainEntry(e);return _.reduce(i,function(e,i){return _.concat(e,t?_.filter(i.messages,t):i.messages)},[])},t.prototype.getMessageByClientMessageId=function(e,t){return _.first(this.getMessagesByConversationId(e,function(e){return e.clientmessageid===t}))},t.prototype.handleSyncedMessages=function(e,t,i,n){void 0===i&&(i=!0);var r=this.processSyncedMessages(e,t.syncSource,i);if(!_.isEmpty(n)){var s={};_.forEach(n,function(e){return s[e.mri]=e}),_.forEach(r,function(e){return e.creatorProfile=s[e.creatorProfileKey]})}return t.isReadFromDB=t.syncSource===SkypeX.Services.SkypeMessageSource.CSAReplyChain,this.putMessages(r,t,i)},t.prototype.putMessages=function(e,t,i,n){var s=this;if(void 0===i&&(i=!0),void 0===n&&(n=!0),!e||0===e.length)return i?this.messageStore.getWriteActionsQueue().schedule(function(){return r.Resolved()}):r.Resolved();var a=this.settingsService.valueAsBoolean(this.constants.settings.names.enableFullInputExtensions),o=t.syncSource,c=t.messageViewType===SkypeX.Services.MessageViewType.Messages&&t.syncSource===SkypeX.Services.SkypeMessageSource.SyncRelated,l=[],p=_.groupBy(e,function(e){return e.conversationId});return _.each(p,function(e,r){s.preventDuplicates&&(e=s.dedupeIncomingMessages(r,e));var p=s.initializeViewFromPersistence(r).then(function(l){var p=[],u=_.values(_.groupBy(e,"parentMessageId"));return _.each(u,function(e){var n=e&&e.length>0&&e[0].parentMessageId,u=!0;if(n){var h=void 0,d=s.ensureReplyChainEntry(r),g=s.findExistingReplyChain(d,e,i);g?(_.each(e,function(e){g.addOrUpdateMessage(e)}),g.source!==SkypeX.Services.SkypeMessageSource.Sync&&(g.source=o),g.messageViewType=t.messageViewType):((h=new SkypeX.Services.SkypeReplyChain(e)).source=o,h.messageViewType=t.messageViewType,l&&l.earliestReplyChainDeliveryTime&&(o===SkypeX.Services.SkypeMessageSource.LongPoll||o===SkypeX.Services.SkypeMessageSource.SyncRelated)&&((u=h.lastMessageTimeUtc>l.earliestReplyChainDeliveryTime)||s.logger.info("skip processing ReplyChain. convId: "+h.conversationId+" parentMessageId: "+h.parentMessageId+". source: "+o+" lastMsgTime: "+h.lastMessageTimeUtc+". earliestRCDeliveryTime: "+l.earliestReplyChainDeliveryTime)),(u||c)&&(d[n]=h));var v=d[n];if(v){t.isReadFromDB&&(v.isReadFromDB=!0),_.each(v.messages,function(e){if(!teamspace.services.MessagingUtilities.isClientLie(e.id)){var t=o===SkypeX.Services.SkypeMessageSource.LongPoll||a&&e.hasCardsProperties();s.messageProcessingService.processRenderContent(e,t)}s.updateClientLieItemsWithOriginalArrivalTime(r,e.idUnion,e.originalArrivalTimeUtc)});var m=o===SkypeX.Services.SkypeMessageSource.LongPoll||o===SkypeX.Services.SkypeMessageSource.Sync||o===SkypeX.Services.SkypeMessageSource.SyncRelated,f=s.conversationsStore.getConversation(r),S=s.conversationsStore.getConversationSyncState(r);if(m){var y=SkypeX.Services.ChatServiceUtils.formatActivityId(r,n);f&&s.syncStateService.isReplyChainSynced(f,y)?v.isSynced=!0:o===SkypeX.Services.SkypeMessageSource.LongPoll&&(s.logger.info("trigger syncRelatedMessages for "+r+" "+n),s.chatSyncService.syncRelatedMessages(r,n,SkypeX.Services.MessageViewType.ReplyChains,teamspace.services.ReplyChainIdType.ParentMessageId))}else o===SkypeX.Services.SkypeMessageSource.CSAReplyChain&&(v.isSynced=!0);if(v.isSynced||o===SkypeX.Services.SkypeMessageSource.Local)p.push(h||new SkypeX.Services.SkypeReplyChain(e));else{var C=S?S.messageHistoryStartTime:"";s.logger.info("skip as ReplyChain not synced: convId: "+v.conversationId+" parentMessageId: "+v.parentMessageId+". source: "+o+" conv.messageHistoryStartTime: "+C)}}}}),n?(c&&p.length>0&&(r=SkypeX.Services.ChatServiceUtils.formatActivityId(r,p[0].parentMessageId)),s.updateView(r,t,p,i).fail(function(e){throw s.logger.error("UpdateView failed for "+r+". "+e),e})):SkypeX.Services.SyncTasks.Resolved()});l.push(p)}),SkypeX.Services.SyncTasks.whenAll(l).then(function(){})},t.prototype.findExistingReplyChain=function(e,t,i){var n=this,r=(t=_.sortBy(t,function(e){return e.originalArrivalTimeUtc})||[])[0];if(!r)return null;var s=r.parentMessageId,a=e[s];if(a)return a;var o=_.filter(e,function(e){return teamspace.services.MessagingUtilities.isClientLie(e.parentMessageId)});if(a=_.find(o,function(e){return e.firstMessage.clientmessageid===r.clientmessageid})){var c=a.parentMessageId;e[s]=a,delete e[c];var l=this.views[a.conversationId];_.remove(l.replyChainIndexes,function(e){return e.parentMessageId===c}),i&&this.persistenceService.putReplyChainsView(a.conversationId,l).then(function(e){n.persistenceService.removeClientLieMessage(r.conversationId,c,r.clientmessageid)}).catch(function(e){n.logger.error("Failed to persist client lie changes to "+a.conversationId+"_"+c+"_"+r.clientmessageid)})}return a},t.prototype.updateView=function(e,t,i,n){var r=this;if(!i||0===i.length)return SkypeX.Services.SyncTasks.Resolved();var s=this.updateReplyChainIndexes(e,t);if(s.length>0&&(i=_.intersectionBy(i,s,function(e){return e.parentMessageId})).length>0){var a=this.initializeViewEntry(e);if(this.broadcastPutReplyChains(e,i,t.syncSource===SkypeX.Services.SkypeMessageSource.LongPoll),n)return this.persistenceService.putReplyChains(i).then(function(){return r.persistenceService.putReplyChainsView(e,a)})}return SkypeX.Services.SyncTasks.Resolved()},t.prototype.updateReplyChainIndexes=function(e,t){var i=[],n=e;if(t.messageViewType===SkypeX.Services.MessageViewType.Messages&&t.syncSource===SkypeX.Services.SkypeMessageSource.SyncRelated){var r=SkypeX.Services.ChatServiceUtils.parseActivityId(e);n=r.isValid?r.topicId:e}var s=this.views[e];if(s){var a=this.ensureReplyChainEntry(n);i=_.filter(_.values(a),function(e){return(e.isSynced||e.source===SkypeX.Services.SkypeMessageSource.Local)&&e.messageViewType===t.messageViewType}),i=s.headViewOptions&&s.headViewOptions.filter?_.filter(i,s.headViewOptions.filter):i,i=_.sortBy(i,function(e){return-e.lastMessageTimeUtc});var o=function(e){return e.syncSource===SkypeX.Services.SkypeMessageSource.CSAReplyChain||e.syncSource===SkypeX.Services.SkypeMessageSource.Local||e.syncSource===SkypeX.Services.SkypeMessageSource.SyncRelated&&e.messageViewType===SkypeX.Services.MessageViewType.Messages};if(o(t)){var c=_.filter(i,function(e){return o({syncSource:e.source,messageViewType:e.messageViewType})});s.earliestReplyChainDeliveryTime=_.minBy(c,function(e){return e.lastMessageTimeUtc}).lastMessageTimeUtc}(i=s.earliestReplyChainDeliveryTime?_.filter(i,function(e){return e.lastMessageTimeUtc>=s.earliestReplyChainDeliveryTime}):[]).length>0?(s.replyChainIndexes=this.mergeReplyChainIndexes(s.replyChainIndexes,i),s.replyChainIndexes=_.sortBy(s.replyChainIndexes,function(e){return-e.lastMessageTimeUtc})):s.replyChainIndexes=void 0}return i},t.prototype.mergeReplyChainIndexes=function(e,t){var i={};_.each(e,function(e){i[e.parentMessageId]=e});var n=_.map(t,function(e){return{parentMessageId:e.parentMessageId,lastMessageTimeUtc:e.lastMessageTimeUtc}});return _.each(n,function(e){var t=i[e.parentMessageId];i[e.parentMessageId]=t?e.lastMessageTimeUtc>t.lastMessageTimeUtc?e:t:e}),_.values(i)},t.prototype.broadcastPutReplyChains=function(e,t,i){this.eventingService.$emit(this.constants.events.pushEvents.messageStore.createOrUpdateMessage,{messages:_.flatten(_.map(t,function(e){return e.messages})),isFromLongPoll:i}),this.trigger(SkypeX.Services.ReplyChainStoreConstants.EventType_Batched,e,t)},t.prototype.updateReplyChainOnSyncComplete=function(e){var t=this,i=SkypeX.Services.ChatServiceUtils.parseActivityId(e);if(i.isValid){var n=this.ensureReplyChainEntry(i.topicId)[i.itemId];if(n){n.isSynced=!0;var r=i.topicId;n.messageViewType===SkypeX.Services.MessageViewType.Messages&&(this.initializeViewEntry(e),r=e),this.updateView(r,{syncSource:SkypeX.Services.SkypeMessageSource.SyncRelated,messageViewType:n.messageViewType},[n],this.conversationsStore.isPersisted(i.topicId)).fail(function(i){throw t.logger.error("UpdateView failed for "+e+" - "+i),i})}else this.logger.warn("replyChain: "+e+" is missing from replyChainEntry.")}else this.logger.warn("ActivityId is invalid: "+e)},t.prototype.getLastMessage=function(e){var t,i=this.ensureReplyChainEntry(e),n=_.flatten(_.map(i,function(e){return e.messages}));return this.settingsService.valueAsBoolean("bugFix72133")?t=_.maxBy(n,"originalArrivalTimeUtc"):(n=_.filter(n,function(e){return!teamspace.services.MessagingUtilities.isClientLie(e.id)}),t=_.maxBy(n,"createdTime")),t},t.prototype.updateClientLieItemsWithOriginalArrivalTime=function(e,t,i){var n=this.getClientLieMessages(e),r=_.findIndex(n,function(e){return e.idUnion===t});r>=0&&_.forEach(n,function(e,t){e.originalarrivaltime=moment(new Date(i+t-r)).toISOString()})},t.prototype.removeHeadView=function(e,t){var i=this,n=SkypeX.Services.ChatServiceUtils.parseActivityId(e),r=n.isValid?n.topicId:e,s=this.ensureReplyChainEntry(r),a=!1,o=!1;return _.each(s,function(e){return _.each(e.messages,function(e){a=!0;var i=e.messageStorageState===SkypeX.Services.MessageStorageState.Network||e.messageStorageState===SkypeX.Services.MessageStorageState.None;return!(o=i&&!t||teamspace.services.MessagingUtilities.isClientLie(e.id))}),!o}),!(o||!a)&&(this.replyChains[r]={},_.each(_.keys(this.views),function(e){e.indexOf(r)>-1&&delete i.views[e]}),!0)},t.prototype.getHeadViewReplyChainsCount=function(e){return(this.views[e]?SkypeX.Services.SyncTasks.Resolved(this.views[e]):this.persistenceService.getReplyChainsView(e)).then(function(e){return e&&e.replyChainIndexes?e.replyChainIndexes.length:0})},t.prototype.getClientLieMessages=function(e){var t=this.ensureReplyChainEntry(e),i=_.flatten(_.map(t,function(e){return e.messages}));return _.filter(i,function(e){return teamspace.services.MessagingUtilities.isClientLie(e.id)})},t.prototype.initializeViewEntry=function(e){if(e)return this.views[e]||(this.views[e]={replyChainIndexes:void 0,earliestReplyChainDeliveryTime:void 0,headViewOptions:{count:t.defaultReplyChainRequestCount,conversationId:e},cursorToken:null}),this.views[e];throw"Cannot ensure view cache entry for falsy id: "+e},t.prototype.initializeViewFromPersistence=function(e,t){var i=this;return t||!this.views[e]?this.conversationsStore.isPersisted(e)?this.persistenceService.getReplyChainsView(e).then(function(t){return t?i.updateViewEntry(e,t):i.initializeViewEntry(e)}):SkypeX.Services.SyncTasks.Resolved(this.initializeViewEntry(e)):SkypeX.Services.SyncTasks.Resolved(this.views[e])},t.prototype.updateViewEntry=function(e,t){if(e){var i=this.initializeViewEntry(e);return i.headViewOptions=t.headViewOptions,i.replyChainIndexes=t.replyChainIndexes,i.earliestReplyChainDeliveryTime=t.earliestReplyChainDeliveryTime,i.cursorToken=null,i}return null},t.prototype.ensureReplyChainEntry=function(e){return this.replyChains[e]||(this.replyChains[e]={}),this.replyChains[e]},t.prototype.onFavoriteConversationChanged=function(e,t){var i=this,n=this.views[e];if(!t.oldVal&&t.newVal&&n&&this.conversationsStore.isPersisted(e)){var r=this.updateReplyChainIndexes(e,{syncSource:SkypeX.Services.SkypeMessageSource.Local,messageViewType:void 0});r.length>0&&this.persistenceService.putReplyChains(r).then(function(){return i.persistenceService.putReplyChainsView(e,n)}).catch(function(t){i.logger.error("Failed to write reply chains to indexedDB. "+e+", "+t)})}},t.prototype.onReplyChainsViewEvent=function(e){this.removeHeadView(e),this.initializeViewFromPersistence(e,!0)},t.prototype.processSyncedMessages=function(e,t,i){var n=this;this.enableSfBGateway&&teamspace.services.SfBInteropUtilsService.isSfbEligible(this.userResourcesSettingsStore)||_.remove(e,function(e){return e.threadtype===SkypeX.Services.ChatServiceUtils.ThreadType_SfbInteropChat});var r=i&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableSkypeMessageDBModel),s=_.map(e,function(e){return n.skypeModelFactory.createLocalMessage(e,SkypeX.Services.MessageStorageState.Network,r)});if(_.each(s,function(e){if(e.clientArrivalTime=(new Date).toISOString(),e.source=t,n.boldLogic2){var i=e.getConversationIdFromConversationLink();!n.conversationsStore.revertFakeConsumptionHorizon(i,e)&&e.isFromMe&&n.conversationsStore.keepChannelReadForMessage(i,e)}}),!this.settingsService.valueAsBoolean(this.constants.settings.names.sanitizeDuringRender)){var a=performance.now();_.each(s,function(e){n.messageSanitizingService.sanitizeMessage(e),e._skypeMessage&&(e._skypeMessage.content=e.content,e._skypeMessage.messagetype=e.messagetype)}),this.logger.debug("Total Messages: {0} Time taken for Sanitization: {1}",s.length,performance.now()-a)}return this.conversationsStore.ensureLastMessage(s),s},t.prototype.dedupeIncomingMessages=function(e,t){var i=_.reduce(t,function(e,t){return e.add(t.getDeduplicationKey())},new Set),n=this.getMessagesByConversationId(e,function(e){return i.has(e.getDeduplicationKey())}).concat(t),r=_.groupBy(n,function(e){return e.getDeduplicationKey()});return _.map(r,function(e){return _.maxBy(e,function(e){return e.versionNumber})})},t}(SkypeX.Services.SXStoreBase);t.ReplyChainStore=s,angular.module("skypeX.replyChainStore",[]).service("replyChainStore",s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r){var s=this;this.conversationsStore=e,this.eventingService=t,this.constants=i,this.sxConfig=n,this.chatSyncService=r,this._pendingCallbacks={},this.conversationsStore.subscribe(function(e){if(s._pendingCallbacks[e]){var t=s.conversationsStore.getConversation(e);s._resolveItems([t],!0)}},SkypeX.Services.ConversationsStoreEvents.Type_Conversation)}return e.$inject=["conversationsStore","eventingService","constants","sxConfig","chatSyncService"],e.prototype._resolveItems=function(e,t){var i=this,n=!1;_.each(e,function(e){var r=i._pendingCallbacks[e.id];if(r){for(var s=0;s<r.length;){var a=r[s];a.isConversation&&t&&(!a.onlyWhenJoined||e.isUserMember(i.sxConfig.getCurrentSkypeMri()))||!a.isConversation&&a.conversationId===e.conversationId?(_.defer(function(){a.syncTask.resolve(e)}),r.splice(s,1),n=!0):s++}0===r.length&&delete i._pendingCallbacks[e.id]}}),n&&this._recalcTimer()},e.prototype._recalcTimer=function(){var e=this;this._timer&&(clearInterval(this._timer),this._timer=null);var t=Date.now(),i=0;_.each(this._pendingCallbacks,function(n,r){for(var s=0;s<n.length;){var a=n[s];if(a.expirationTime<=t){if(a.kickedSync){a.syncTask.reject(),n.splice(s,1);continue}e.chatSyncService.isCurrentlySyncing()||e.chatSyncService.startConversationListSync(),a.kickedSync=!0,a.expirationTime=Date.now()+15e3}var o=a.expirationTime-t;(!i||o<i)&&(i=o),s++}0===n.length&&delete e._pendingCallbacks[r]}),i&&(this._timer=setInterval(function(){e._recalcTimer()},i))},e.prototype.waitForKnowledgeOfConversation=function(e,t){var i=this.conversationsStore.getConversation(e);return!i||t&&!i.isUserMember(this.sxConfig.getCurrentSkypeMri())?this._waitForKnowledgeOfId(e,e,!0,t):SkypeX.Services.SyncTasks.Resolved(i)},e.prototype._waitForKnowledgeOfId=function(e,t,i,n){var r={id:t,conversationId:e,isConversation:i,onlyWhenJoined:n,syncTask:SkypeX.Services.SyncTasks.Defer(),expirationTime:Date.now()+5e3,kickedSync:!1};return this._pendingCallbacks[r.id]?this._pendingCallbacks[r.id].push(r):this._pendingCallbacks[r.id]=[r],this._recalcTimer(),r.syncTask.promise()},e.prototype.waitForConversationSync=function(e){var t=SkypeX.Services.SyncTasks.Defer(),i=!1,n=null,r=_.once(function(){n(),t.resolve(void 0)});return n=this.eventingService.unsafeOn(this.constants.events.syncService.syncTargetsUpdated,function(t,n){var s=n,a=_.includes(s,e);i?a||(i=!1,r()):i=a}),this.chatSyncService.waitForInitialConversationListSync().then(function(){i||r()}),t.promise()},e.prototype.waitForConversationDetailsSync=function(e){var t,i=this,n=SkypeX.Services.SyncTasks.Defer(),r=function(){var t=i.conversationsStore.dangerousGetConversationMutable(e);return t&&t.detailsVersion>=t.threadVersion};return r()?n.resolve(void 0):t=this.conversationsStore.subscribe(function(e){r()&&(n.resolve(void 0),i.conversationsStore.unsubscribe(t))},SkypeX.Services.ConversationsStoreEvents.Type_Conversation),n.promise()},e}();t.NotifyAfterSyncService=n,angular.module("skypeX.notifyAfterSyncService",["teamspace.eventingService","skypeX.conversationsStore","teamspace.constants","skypeX.chatSyncService"]).service("notifyAfterSyncService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S,y,C,b,T){var I=this;this.$qNoApply=t,this.$q=i,this.$translate=n,this.$timeout=r,this.$window=s,this.chatServiceClient=a,this.unifiedPresenceService=o,this.appStateService=c,this.constants=l,this.eventingService=p,this.settingsService=u,this.exceptionUtilityService=h,this.loggingService=d,this.longPollService=g,this.endpointService=v,this.unifiedPresenceEndpointService=m,this.presenceManagerService=f,this.presenceSyncService=S,this.resources=y,this.sxConfig=C,this.slashCommandsService=b,this.uiOrchestrator=T,this.isEndpointConnectedPromiseResolved=!0,this.isUnifiedEndpointConnectedPromiseResolved=!0,this.presenceTrackingInfos=[],this.trackingMris={},this.isStartupPoll=!0,this.debounceRestoreMyStatus=_.debounce(function(){return I.restoreMyStatus()},this.constants.userPresence.settings.restoreMyStatusDebounceTime),this.logger=this.loggingService.newLogger("PresenceService"),this.isMachineActivityCheckEnabled=this.$window.desktopEnvironment&&this.$window.desktopEnvironment.enableMachineActivityCheck,this.isMachineActivityCheckEnabled&&(delete e.DefaultStatusByAppState[teamspace.services.ApplicationState.Interactive],delete e.DefaultStatusByAppState[teamspace.services.ApplicationState.Inactive]),this.pollFromChatServiceEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.pollPresenceFromChatService),this.postToChatServiceEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.postPresenceToChatService),this.isAutoIdleEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePresenceAutoIdle),this.isAutoIdleEnabled&&delete e.DefaultStatusByAppState[teamspace.services.ApplicationState.Inactive],this.isPresencePutSubscriptionEnabled=u.valueAsBoolean(l.settings.names.enablePresencePutSubscription),this.startRebuildTimer=this.isPresencePutSubscriptionEnabled?angular.noop:_.debounce(function(){return I.uiOrchestrator.nextFrame(teamspace.services.UiOrchestratorPriority.Low,function(){return I.isEndpointConnected("PresenceService.constructor").then(function(){return I.rebuildPresencePoll()})})},1500),this.parsePresenceMessagesOnNextUIFrame=function(e){return I.uiOrchestrator.nextFrame(teamspace.services.UiOrchestratorPriority.Low,function(){return I.parsePresenceMessages(e)})},this.subscribeEndpointServiceEvents();var w={id:this.constants.slashCommands.commandIds.available,name:this.resources.strings.slash_command_avail_name,descriptionResource:this.resources.strings.slash_command_avail_description,preExecute:function(e){e.setExecutionStatus(I.resources.strings.slash_command_available_success,void 0,"online",!0)},execute:function(){return I.setMyStatus(SkypeX.Services.UserStatus.Online,!0)}};this.slashCommandsService.registerSlashCommand(w);var k={id:this.constants.slashCommands.commandIds.away,name:this.resources.strings.slash_command_away_name,descriptionResource:this.resources.strings.slash_command_away_description,preExecute:function(e){e.setExecutionStatus(I.resources.strings.slash_command_away_success,void 0,"away",!0)},execute:function(){return I.setMyStatus(SkypeX.Services.UserStatus.Away,!0)}};this.slashCommandsService.registerSlashCommand(k);var P={id:this.constants.slashCommands.commandIds.busy,name:this.resources.strings.slash_command_busy_name,descriptionResource:this.resources.strings.slash_command_busy_description,preExecute:function(e){e.setExecutionStatus(I.resources.strings.slash_command_busy_success,void 0,"busy",!0)},execute:function(){return I.setMyStatus(SkypeX.Services.UserStatus.Busy,!0)}};if(this.slashCommandsService.registerSlashCommand(P),this.isUnfiedPresenceStatesEnabled()){var A={id:this.constants.slashCommands.commandIds.brb,name:this.resources.strings.slash_command_brb_name,descriptionResource:this.resources.strings.slash_command_brb_description,preExecute:function(e){e.setExecutionStatus(I.resources.strings.slash_command_brb_success,void 0,"be-right-back",!0)},execute:function(){return I.setMyStatus(SkypeX.Services.UserStatus.BeRightBack,!0)}};this.slashCommandsService.registerSlashCommand(A)}var M={id:this.constants.slashCommands.commandIds.dnd,name:this.resources.strings.slash_command_dnd_name,descriptionResource:this.resources.strings.slash_command_dnd_description,preExecute:function(e){e.setExecutionStatus(I.resources.strings.slash_command_dnd_success,void 0,"do-not-disturb",!0)},execute:function(){return I.setMyStatus(SkypeX.Services.UserStatus.OutToLunch,!0)}};this.slashCommandsService.registerSlashCommand(M)}return e.$inject=["$qNoApply","$q","$translate","$timeout","$window","chatServiceClient","unifiedPresenceService","appStateService","constants","eventingService","settingsService","exceptionUtilityService","loggingService","longPollService","endpointService","unifiedPresenceEndpointService","presenceManagerService","presenceSyncService","resources","sxConfig","slashCommandsService","uiOrchestrator"],Object.defineProperty(e.prototype,"myMRI",{get:function(){return this._myMRI||(this._myMRI=this.sxConfig.getCurrentSkypeMri()),this._myMRI},enumerable:!0,configurable:!0}),e.prototype.isUnfiedPresenceStatesEnabled=function(){return!this.postToChatServiceEnabled&&this.unifiedPresenceService.isPostToUpsEnabled()},e.prototype.startup=function(){var e=this;return this.isEndpointConnected("PresenceService.startup").then(function(){return e.getMyInitPresence()}).finally(function(){e.isPresencePutSubscriptionEnabled?e.presenceSyncService.startPresencePoll():e.buildMyPresencePoll(),e.subscribeEventListeners()}),SkypeX.Services.SyncTasks.whenAll([])},e.prototype.subscribeEventListeners=function(){var e=this;this.eventingService.unsafeOn(this.constants.events.appState.changed,function(){e.settingsService.valueAsBoolean(e.constants.settings.names.enableExtraMachineStateLogging)&&e.logger.info("Restoring status due to: appStateChanged. AppState {0}, MachineState {1}",teamspace.services.ApplicationState[e.appStateService.current],teamspace.services.MachineState[e.appStateService.machineState]),e.debounceRestoreMyStatus()}),this.isMachineActivityCheckEnabled&&this.eventingService.unsafeOn(this.constants.events.appState.machineStateChanged,function(){e.settingsService.valueAsBoolean(e.constants.settings.names.enableExtraMachineStateLogging)&&e.logger.info("Restoring status due to: machineStateChanged. AppState {0}, MachineState {1}",teamspace.services.ApplicationState[e.appStateService.current],teamspace.services.MachineState[e.appStateService.machineState]),e.debounceRestoreMyStatus()}),this.isAutoIdleEnabled||this.unifiedPresenceService.isPostToUpsEnabled()||this.eventingService.unsafeOn(this.constants.events.presence.myStatusChanged,function(){e.settingsService.valueAsBoolean(e.constants.settings.names.enableExtraMachineStateLogging)&&e.logger.info("Restoring status due to: myStatusChanged. AppState {0}, MachineState {1}",teamspace.services.ApplicationState[e.appStateService.current],teamspace.services.MachineState[e.appStateService.machineState]),e.reevaluateMyStatusWhenEnteringBRB()}),this.debounceRestoreMyStatus()},e.prototype.getMyInitPresence=function(){var e,t=this,i=this.sxConfig.getCurrentSkypeMri();return this.unifiedPresenceService.isPollFromUpsEnabled()?(e=this.loggingService.newScenario(this.constants.scenarios.unifiedPresence.startup.myLoginStatus),this.unifiedPresenceService.getMyPresence().toNgPromise(this.$qNoApply).then(function(n){t.updatePresence(n,i,!0),t.logger.info("[getMyInitPresence] Successfully get my initial presence status from unified service."),e.stop()},function(i){t.logger.error("[getMyInitPresence] Unable to get my initial presence status from Unified service. Error: {0}.",i&&i.message||"unknown"),e.fail({error:JSON.stringify(i)})})):(e=this.loggingService.newScenario(this.constants.scenarios.presence.startup.myLoginStatus),this.chatServiceClient.getMyPresence().toNgPromise(this.$qNoApply).then(function(n){t.updatePresence(n,i,!1),t.logger.info("[getMyInitPresence] Successfully get my initial presence status from chat service."),e.stop()},function(i){t.logger.error("[getMyInitPresence] Unable to get my initial presence status from chat service. Error: {0}.",i&&i.message||"unknown"),e.fail({error:JSON.stringify(i)})}))},e.prototype.updatePresence=function(e,t,i){var n=SkypeX.Services.ChatServiceUtils.parseAvailability(e.availability),r=SkypeX.Services.ChatServiceUtils.parseStatus(e.status),s=i?e.unifiedPresenceCapabilities:e.capabilities.split("|").map(function(e){return e.trim()}),a=e.calendarData?e.calendarData:null,o={};o.mri=t,o.status=r,o.availability=n,o.capabilities=s,o.lastSeenAt=new Date,o.calendarData=a,o.isUnifiedPresence=i,this.presenceManagerService.updatePresence(o)},e.prototype.buildMyPresencePoll=function(){this.rebuildPresencePoll()},e.prototype.reevaluateMyStatusWhenEnteringBRB=function(){var e=this.isPresencePutSubscriptionEnabled?this.presenceManagerService.getPresence(this.myMRI):this.getPresenceTrackingInfo(this.myMRI).presence,t=this.isMachineActivityCheckEnabled?this.appStateService.machineState===teamspace.services.MachineState.MachineActive:this.appStateService.current===teamspace.services.ApplicationState.Interactive;this.logger.log("reevaluateMyStatusWhenEnteringBRB isActive = {0}, status = {1}",t,e.status),t&&e.status===SkypeX.Services.UserStatus.BeRightBack&&this.debounceRestoreMyStatus()},e.prototype.restoreMyStatus=function(){var t=!!e.DefaultStatusByAppState[this.appStateService.current],i=this.isMachineActivityCheckEnabled&&e.DefaultStatusByMachineState[this.appStateService.machineState];if(t||i){var n,r=this.isPresencePutSubscriptionEnabled?this.presenceManagerService.getPresence(this.myMRI):this.getPresenceTrackingInfo(this.myMRI).presence,s=(n=this.isMachineActivityCheckEnabled?e.DefaultStatusByAppState[this.appStateService.current]||e.DefaultStatusByMachineState[this.appStateService.machineState]:e.DefaultStatusByAppState[this.appStateService.current])===SkypeX.Services.UserStatus.Online&&(r.status===SkypeX.Services.UserStatus.OnThePhone||r.status===SkypeX.Services.UserStatus.OutToLunch||r.status===SkypeX.Services.UserStatus.Presenting);this.logger.info("restoreMyStatus with appState {0}, machineState {1}, isForced={2}, currentStatus={3}, newStatus={4}",teamspace.services.ApplicationState[this.appStateService.current],teamspace.services.MachineState[this.appStateService.machineState],s,SkypeX.Services.UserStatus[r.status],SkypeX.Services.UserStatus[n]),this.setMyStatus(n,s,!0,!0)}},e.prototype.setMyStatus=function(e,t,i,n){var r=this;void 0===t&&(t=!1),void 0===i&&(i=!0),void 0===n&&(n=!1);var s=[];this.postToChatServiceEnabled&&s.push(this.setMyStatusInternal(e,!1,t,i)),t=!n&&t;var a=e===SkypeX.Services.UserStatus.BeRightBack||e===SkypeX.Services.UserStatus.Away;return this.unifiedPresenceService.isPostToUpsEnabled()&&(t||!a)&&s.push(this.setMyStatusInternal(e,!0,t,i)),this.$q.all(s).then(function(){return r.$q.resolve()}).catch(function(e){return r.$q.reject(e)})},e.prototype.setMyStatusInternal=function(t,i,n,r){var s=this;return void 0===n&&(n=!1),void 0===r&&(r=!0),this.logger.info("Trying to set status, isUnifiedPresenceService={0}, isForced={1}, isRetriable={2}, status={3} ",i,n,r,SkypeX.Services.UserStatus[t]),this.isEndpointConnected("PresenceService.setMyStatus").then(function(){var a,o=s.isPresencePutSubscriptionEnabled?s.presenceManagerService.getPresence(s.myMRI):s.getPresenceTrackingInfo(s.myMRI).presence,c=s.appStateService.machineState,l=s.appStateService.current,p={data:JSON.stringify({isForced:n,isRetriable:r,newStatus:SkypeX.Services.UserStatus[t],newStatusRank:e.StatusRank[t],oldStatus:SkypeX.Services.UserStatus[o.status],oldStatusRank:e.StatusRank[o.status]})};if(a=i?n?s.loggingService.newScenario(s.constants.scenarios.presence.myStatus.explicitSwitchUnifiedPresence):s.loggingService.newScenario(s.constants.scenarios.presence.myStatus.implicitSwitchUnifiedPresence):n?s.loggingService.newScenario(s.constants.scenarios.presence.myStatus.explicitSwitch):s.loggingService.newScenario(s.constants.scenarios.presence.myStatus.implicitSwitch),i||o.status!==t&&(n||e.StatusRank[t]>=e.StatusRank[o.status])){return(i?s.unifiedPresenceService.setMyPresenceStatus(t,n).toNgPromise(s.$q):s.chatServiceClient.setMyPresenceStatus(t).toNgPromise(s.$q)).then(function(){a&&(a.stop(p),a=null),s.isMachineActivityCheckEnabled&&s.eventingService.$emit(s.constants.events.desktopApp.logMachineState,{status:t,machineState:c,appState:l})}).catch(function(e){return s.logger.error('[setMyStatus] Unable to switch status from "'+SkypeX.Services.UserStatus[o.status]+'" to "'+SkypeX.Services.UserStatus[t]+'" for user, isUnifiedPresenceService = "'+i+'"'),a&&(p.error=JSON.stringify(e),r?a.cancel(p):s.exceptionUtilityService.failScenarioSelectively(a,e,p,[]),a=null),s.$qNoApply.reject(e)})}return a&&(a.cancel(p),a=null),s.$qNoApply.resolve()}).catch(function(e){return r?s.$timeout(function(){return s.setMyStatus(t,n,!1)},1500):(s.logger.error("[setMyStatus] Unable to switch status for user because {0} end point is not available.",i?"Unified Presence Service":"Chat Service"),s.$qNoApply.reject(e))})},e.prototype.subscribe=function(e,t){if(void 0===t&&(t=SkypeX.Services.PresencePriority.Medium),this.isPresencePutSubscriptionEnabled)return this.presenceManagerService.trackPresence(e,t);if(!SkypeX.Services.ChatServiceUtils.isUserMri(e))return this.logger.error("[subscribe] The given MRI is not a valid MRI"),null;var i=this.getPresenceTrackingInfo(e);return this.trackPresence(i,t),i.presence},e.prototype.unsubscribe=function(e,t){if(void 0===t&&(t=SkypeX.Services.PresencePriority.Medium),this.isPresencePutSubscriptionEnabled)return this.presenceManagerService.untrackPresence(e,t);if(SkypeX.Services.ChatServiceUtils.isUserMri(e)){var i=this.getPresenceTrackingInfo(e);this.untrackPresence(i,t)}else this.logger.error("[unsubscribe] The given MRI is not a valid MRI")},e.prototype.GetTranslatedStatusText=function(t){return e.TranslatedStatusTexts||(e.TranslatedStatusTexts=(i={},i[SkypeX.Services.UserStatus.Offline]=this.$translate.instant(this.resources.strings.status_offline),i[SkypeX.Services.UserStatus.Online]=this.$translate.instant(this.resources.strings.status_online),i[SkypeX.Services.UserStatus.Busy]=this.$translate.instant(this.resources.strings.status_busy),i[SkypeX.Services.UserStatus.Away]=this.$translate.instant(this.resources.strings.status_away),i[SkypeX.Services.UserStatus.Idle]=this.$translate.instant(this.resources.strings.status_away),i[SkypeX.Services.UserStatus.OnThePhone]=this.$translate.instant(this.resources.strings.status_inACall),i[SkypeX.Services.UserStatus.OutToLunch]=this.$translate.instant(this.resources.strings.status_doNotDisturb),i[SkypeX.Services.UserStatus.BeRightBack]=this.$translate.instant(this.resources.strings.status_beRightBack),i[SkypeX.Services.UserStatus.Hidden]=this.$translate.instant(this.resources.strings.status_offline),i[SkypeX.Services.UserStatus.Disabled]=this.$translate.instant(this.resources.strings.status_disabled),i[SkypeX.Services.UserStatus.Unknown]=this.$translate.instant(this.resources.strings.status_unknown),i[SkypeX.Services.UserStatus.OutOfOffice]=this.$translate.instant(this.resources.strings.status_outOfOffice),i[SkypeX.Services.UserStatus.Presenting]=this.$translate.instant(this.resources.strings.status_presenting),i[SkypeX.Services.UserStatus.InAMeeting]=this.$translate.instant(this.resources.strings.status_inAMeeting),i)),e.TranslatedStatusTexts[t]||"";var i},e.prototype.getTranslatedStatusTextFromMri=function(e){var t=this.presenceManagerService.getPresence(e).status;return null!==t?this.GetTranslatedStatusText(t):this.$translate.instant(this.resources.strings.status_unknown)},e.prototype.isEndpointConnected=function(e){var t=[];return this.unifiedPresenceService.isPostToUpsEnabled()&&!this.unifiedPresenceEndpointService.isConnected()&&(this.isUnifiedEndpointConnectedDefer&&!this.isUnifiedEndpointConnectedPromiseResolved||(this.isUnifiedEndpointConnectedDefer=this.$qNoApply.defer(),this.isUnifiedEndpointConnectedPromiseResolved=!1),this.logger.warn("[isEndpointConnected] call initiated {0}while UPS endpoint is disconnected.",e?'by "'+e+'" ':""),t.push(this.isUnifiedEndpointConnectedDefer.promise)),this.postToChatServiceEnabled&&!this.endpointService.isConnected()&&(this.isEndpointConnectedDefer&&!this.isEndpointConnectedPromiseResolved||(this.isEndpointConnectedDefer=this.$qNoApply.defer(),this.isEndpointConnectedPromiseResolved=!1),this.logger.warn("[isEndpointConnected] call initiated {0}while chat service endpoint is disconnected.",e?'by "'+e+'" ':""),t.push(this.isEndpointConnectedDefer.promise)),this.$qNoApply.all(t)},e.prototype.subscribeEndpointServiceEvents=function(){var e=this;this.endpointService.subscribe(function(){e.isEndpointConnectedDefer&&e.endpointService.isConnected()&&(e.isEndpointConnectedDefer.resolve(),e.isEndpointConnectedPromiseResolved=!0)},this.endpointService.Type_Endpoint),this.unifiedPresenceEndpointService.subscribe(function(){e.isUnifiedEndpointConnectedDefer&&e.unifiedPresenceEndpointService.isConnected()&&(e.isUnifiedEndpointConnectedDefer.resolve(),e.isUnifiedEndpointConnectedPromiseResolved=!0)},this.unifiedPresenceEndpointService.Type_Unified_Presence)},e.prototype.longPollConnectionStateChanged=function(e){e&&this.eventingService.$emit(this.constants.events.pushEvents.presenceService.resyncRequired,null)},e.prototype.getPresenceTrackingInfo=function(e){var t=this.presenceTrackingInfos[e];return t||(t={mri:e,timestamp:Date.now(),counter:0,presence:e===this.myMRI?new r(e,this.constants,this.eventingService,this.loggingService):{mri:e,status:SkypeX.Services.UserStatus.Unknown,availability:SkypeX.Services.UserAvailability.Offline,capabilities:[],mobile:!1}},this.presenceTrackingInfos[e]=t,this.presenceTrackingInfos.push(t)),t},e.prototype.parsePresenceMessages=function(e){var t=this,i={};_.each(e,function(e){switch(e.resourceType){case SkypeX.Services.ChatServiceUtils.SkypeEventMessage_ResourceType_EndpointPresence:return;case SkypeX.Services.ChatServiceUtils.SkypeEventMessage_ResourceType_UserPresence:var n=e.resource,r=n?n.selfLink.split("/")[5]:null,s=n?SkypeX.Services.ChatServiceUtils.parseAvailability(n.availability):null,a=n?SkypeX.Services.ChatServiceUtils.parseStatus(n.status):null,o=n?n.capabilities.split("|").map(function(e){return e.trim()}):null,c=n&&n.lastSeenAt?new Date(n.lastSeenAt):null;if(!n||!_.isString(r)||_.isNull(s)||_.isNull(a)||!o)return void t.logger.error('[parseEventMessage] Failed to parse the presence event "'+e.id+'".');var l=t.getPresenceTrackingInfo(r);return l.presence.status=a,l.presence.availability=s,l.presence.capabilities=o,l.presence.mobile=_.includes(o,"IsMobile"),l.presence.lastSeenAt=c,void(i[r]=!0);default:return void t.logger.log('[parsePresenceMessage] The event "'+e.id+'" is not processed by PresenceService.')}}),this.otherPresencesStartupScenario&&(this.otherPresencesStartupScenario.stop({data:JSON.stringify({trackingMris:_.keys(this.trackingMris)})}),this.otherPresencesStartupScenario=null,this.isStartupPoll=!1),this.otherPresencesResyncScenario&&(this.otherPresencesResyncScenario.stop({data:JSON.stringify({trackingMris:_.keys(this.trackingMris)})}),this.otherPresencesResyncScenario=null)},e.prototype.trackPresence=function(e,t){e.timestamp=Date.now(),e.counter+=t,this.trackingMris[e.mri]||this.startRebuildTimer()},e.prototype.untrackPresence=function(e,t){e.counter&&(e.counter-=t),this.trackingMris[e.mri]&&this.startRebuildTimer()},e.prototype.rebuildPresencePoll=function(){var t=this;if(!this.isPresencePutSubscriptionEnabled){this.sortPresenceTrackingInfos();var i=this.getRequestingMris(),n=this.areTrackingMrisChanged(i);if(n&&(this.trackingMris=i),n||this.isStartupPoll){var r=_.keys(this.trackingMris);r.length>e.OptimalMrisToTrack&&this.logger.warn("[rebuildPresencePoll] There are "+r.length+" MRIs to be tracked, which is more than "+e.OptimalMrisToTrack+" of optimal"),this.isStartupPoll?(r.length>1||1===r.length&&!this.trackingMris[this.myMRI])&&(this.otherPresencesStartupScenario&&this.otherPresencesStartupScenario.cancel(),this.otherPresencesStartupScenario=this.loggingService.newScenario(this.constants.scenarios.presence.startup.otherStatuses)):(this.otherPresencesResyncScenario&&this.otherPresencesResyncScenario.cancel(),this.otherPresencesResyncScenario=this.loggingService.newScenario(this.constants.scenarios.presence.resyncOtherStatuses));var s=r.map(function(e){return t.convertMriToInterestedResource(e)}).concat(this.constants.userPresence.allContactInterestedResource);this.settingsService.valueAsBoolean(this.constants.settings.names.enableNewLongpollService)||this.longPollService.createNewSubscription(s,"Presence",this.parsePresenceMessagesOnNextUIFrame,function(e){return t.longPollConnectionStateChanged(e)})}}},e.prototype.getRequestingMris=function(){var t=_.filter(this.presenceTrackingInfos,function(e){return!!e.counter}).slice(0,e.MaxMrisToTrack);return _.reduce(t,function(e,t){return e[t.mri]=!0,e},{})},e.prototype.areTrackingMrisChanged=function(e){var t=_.keys(e),i=_.keys(this.trackingMris),n=_.difference(i,t),r=_.difference(t,i);return!!n.length||!!r.length},e.prototype.sortPresenceTrackingInfos=function(){this.presenceTrackingInfos.sort(function(e,t){return e.counter!==t.counter?t.counter-e.counter:t.timestamp-e.timestamp})},e.prototype.convertMriToInterestedResource=function(e){return this.constants.userPresence.interestedResourcePrefix+e},e.OptimalMrisToTrack=150,e.MaxMrisToTrack=650,e.StatusRank=(s={},s[SkypeX.Services.UserStatus.OnThePhone]=3,s[SkypeX.Services.UserStatus.OutToLunch]=3,s[SkypeX.Services.UserStatus.Presenting]=3,s[SkypeX.Services.UserStatus.Busy]=3,s[SkypeX.Services.UserStatus.InAMeeting]=3,s[SkypeX.Services.UserStatus.Hidden]=3,s[SkypeX.Services.UserStatus.Away]=3,s[SkypeX.Services.UserStatus.Online]=2,s[SkypeX.Services.UserStatus.BeRightBack]=2,s[SkypeX.Services.UserStatus.Idle]=2,s[SkypeX.Services.UserStatus.Offline]=2,s[SkypeX.Services.UserStatus.Unknown]=1,s),e.DefaultStatusByAppState=(a={},a[teamspace.services.ApplicationState.Presenting]=SkypeX.Services.UserStatus.OutToLunch,a[teamspace.services.ApplicationState.InCall]=SkypeX.Services.UserStatus.OnThePhone,a[teamspace.services.ApplicationState.Interactive]=SkypeX.Services.UserStatus.Online,a[teamspace.services.ApplicationState.Inactive]=SkypeX.Services.UserStatus.BeRightBack,a),e.DefaultStatusByMachineState=(o={},o[teamspace.services.MachineState.MachineActive]=SkypeX.Services.UserStatus.Online,o[teamspace.services.MachineState.MachineInactive]=SkypeX.Services.UserStatus.BeRightBack,o[teamspace.services.MachineState.MachineLocked]=SkypeX.Services.UserStatus.BeRightBack,o),e}();t.PresenceService=n;var r=function(){function e(e,t,i,n){this.constants=t,this.eventingService=i,this.loggingService=n,this._status=SkypeX.Services.UserStatus.Unknown,this.availability=SkypeX.Services.UserAvailability.Offline,this.capabilities=[],this.lastSeenAt=null,this.mobile=!1,this._mri=e,this.logger=this.loggingService.newLogger("MyUserPresence")}return Object.defineProperty(e.prototype,"mri",{get:function(){return this._mri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},set:function(e){if(this._status!==e){var t=this.loggingService.newScenario(this.constants.scenarios.presence.myStatus.isChanged),i={oldStatus:SkypeX.Services.UserStatus[this._status],newStatus:SkypeX.Services.UserStatus[e]};switch(this._status=e,e){case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.Unknown:this.logger.warn('[set status] Status of user "'+SkypeX.Services.ChatServiceUtils.scrubMri(this.mri)+'" has been changed to "'+SkypeX.Services.UserStatus[e]+'" while the user is still active.')}t.stop({data:JSON.stringify(i)}),t=null,this.eventingService.$emit(this.constants.events.presence.myStatusChanged,{status:this._status})}},enumerable:!0,configurable:!0}),e}();angular.module("skypeX.presenceService",["skypeX.chatServiceClient","skypeX.longPollSubscription","skypeX.unifiedPresenceEndpointService","teamspace.locales","teamspace.uiOrchestrator","teamspace.exceptionUtilityService","teamspace.presenceManagerService","teamspace.presenceSyncService"]).service("presenceService",n);var s,a,o},function(e,t,i){"use strict";function n(e){return!(e.maxMessageVersion||e.continuationToken||!(e.messageHistoryStartTime>1)||!e.isSyncedToStartOfTime)&&(e.isSyncedToStartOfTime=!1,e._syncstateresolve=(new Date).toISOString(),!0)}Object.defineProperty(t,"__esModule",{value:!0});var r=SkypeX.Services.SyncTasks,s=teamspace.services.SyncStateStorageTarget,a=SkypeX.Services.ChatServiceUtils;t.ResolvedBadSyncStateEvent="resolved_bad_sync_state";var o=function(){function e(e,t,i,n){this.$injector=e,this.clientDatabase=t,this.loggingService=i,this.settingsService=n,this.syncStatePrefix="SyncState:",this._syncStateMap={},this._replyChainSyncMaps={},this.logger=this.loggingService.newLogger("SyncStateService"),this.useSyncStateService=this.settingsService.valueAsBoolean("useSyncStateService")}return e.$inject=["$injector","clientDatabase","loggingService","settingsService"],e.prototype.startup=function(){var e=this,i=this.loggingService.newScenario("start_syncStateService");return this.getSyncStatesFromDb().then(function(r){var s=r&&r.length,a=0;e.logger.info("SyncStateService started with {0} sync states from internaldata store",s),_.forEach(r,function(t){t.isPersisted=!0,a+=n(t)?1:0,e._syncStateMap[t.id]=t}),i.stop(),a&&e.loggingService.event(t.ResolvedBadSyncStateEvent,{data:a})},function(e){i.fail({error:e})})},e.prototype.getSyncState=function(e){return this._syncStateMap[e]},e.prototype.getPersistedSyncState=function(e){var t=this.syncStatePrefix+e;return this.clientDatabase.provider.get(this.clientDatabase.schema.stores.internaldata.name,t)},e.prototype.addUpdateSyncState=function(e,t){var i=this;void 0===t&&(t=[s.Memory,s.Persistence]);var n=_.isArray(t)?t:[t];if(n.includes(s.Memory)&&e.forEach(function(e){i._syncStateMap[e.id]=e}),n.includes(s.Persistence)){var a=_.filter(e,function(e){return i.conversationsStore.isPersisted(e.id)&&!e.isFailed});if(a.length>0)return _.forEach(a,function(e){return e.isPersisted=!0}),this.clientDatabase.provider.put(this.clientDatabase.schema.stores.internaldata.name,a.map(function(e){return{id:i.syncStatePrefix+e.id,value:e}}))}return r.Resolved()},e.prototype.removeSyncState=function(e){return delete this._syncStateMap[e],this.clientDatabase.provider.remove(this.clientDatabase.schema.stores.internaldata.name,this.syncStatePrefix+e)},e.prototype.setFailed=function(e,t){var i=this.getSyncState(e);i&&(i.isFailed=t)},e.prototype.getReplyChainSyncMap=function(e){return this.useSyncStateService?this._replyChainSyncMaps[e.id]:e.replyChainSyncMap},e.prototype.updateReplyChainSyncState=function(e,t,i){this._replyChainSyncMaps[e]||(this._replyChainSyncMaps[e]={}),this._replyChainSyncMaps[e][t]=i},e.prototype.deleteReplyChainSyncState=function(e,t){this._replyChainSyncMaps[e]&&delete this._replyChainSyncMaps[e][t]},e.prototype.addReplyChainToSyncMaps=function(e,t){this._replyChainSyncMaps[e.id]||(this._replyChainSyncMaps[e.id]={}),this._replyChainSyncMaps[e.id][t]||(this._replyChainSyncMaps[e.id][t]={messagesStale:!0,syncState:"",replyChainId:t,syncStartTime:void 0}),e.replyChainSyncMap[t]||(e.replyChainSyncMap[t]={messagesStale:!0,syncState:"",replyChainId:t,syncStartTime:void 0})},e.prototype.isReplyChainSynced=function(e,t){var i=a.parseActivityId(t);if(!i||!i.isValid)return!1;var n=this.useSyncStateService?this._replyChainSyncMaps[e.id]:e.replyChainSyncMap;if(n){var r=n[t];if(r&&!r.messagesStale)return!0}var s=Number(i.itemId);if(this.useSyncStateService){var o=this.getSyncState(e.id);if(o&&o.messageHistoryStartTime&&s>=o.messageHistoryStartTime)return!0}else if(e.messageHistoryStartTime&&s>=e.messageHistoryStartTime)return!0;return!1},e.prototype.getCompleteReplyChains=function(e){return this.useSyncStateService?_.values(this._replyChainSyncMaps[e.id]):_.values(e.replyChainSyncMap)},e.prototype.getIncompleteReplyChains=function(e){var t=this;if(this.useSyncStateService)return(i=_.values(this._replyChainSyncMaps[e.id])).filter(function(i){return!t.isReplyChainSynced(e,i.replyChainId)});var i=_.values(e.replyChainSyncMap);return i.filter(function(i){return!t.isReplyChainSynced(e,i.replyChainId)})},e.prototype.getSyncStatesFromDb=function(){var e=this;return this.clientDatabase.provider.getAll(this.clientDatabase.schema.stores.internaldata.name).then(function(t){return _.filter(t,function(t){return t.id.startsWith(e.syncStatePrefix)}).map(function(e){return e.value})})},Object.defineProperty(e.prototype,"conversationsStore",{get:function(){return this.$injector.get("conversationsStore")},enumerable:!0,configurable:!0}),e}();t.SyncStateService=o,angular.module("skypeX.syncStateService",["skypeX.clientDatabase"]).service("syncStateService",o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u,h,d){var g=this;this.$q=t,this.$timeout=i,this.$translate=n,this.resources=r,this.constants=s,this.utilityService=a,this.eventingService=o,this.routeUtilityService=c,this.coachmarksService=l,this.settingsService=p,this.authenticationService=u,this.sfbTeamsUpgradeService=h,this.teamMembershipPropertiesService=d,this.eventingService.$on(e,this.constants.events.coachmarks.seen,function(e,t){for(var i=0,n=t||[];i<n.length;i++){var r=n[i];g.coachmarkDeregistrationMap[r]&&g.coachmarkDeregistrationMap[r]()}}),this.eventingService.$on(e,this.constants.events.coachmarks.hasData,function(e,t){for(var i=0,n=t||[];i<n.length;i++){var r=n[i];g.coachmarkDataDeregistrationMap[r]&&g.coachmarkDataDeregistrationMap[r]()}})}return e.$inject=["$rootScope","$q","$timeout","$translate","resources","constants","utilityService","eventingService","routeUtilityService","coachmarksService","settingsService","authenticationService","sfbTeamsUpgradeService","teamMembershipPropertiesService"],Object.defineProperty(e.prototype,"coachmarkDeregistrationMap",{get:function(){var e=this;return t={},t[teamspace.services.coachmarks.Coachmark.SyncedMeetings]=function(){e.markSyncedMeetingsShown=e.showSyncedMeetings=$.noop},t[teamspace.services.coachmarks.Coachmark.AssignedCallingNumber]=function(){e.showAssignedCallingNumber=$.noop},t[teamspace.services.coachmarks.Coachmark.ExploreAppsLeftRail]=function(){e.showExploreAppsLeftRail=$.noop},t[teamspace.services.coachmarks.Coachmark.ExploreTeamsAfterMigration]=function(){e.showExploreTeamsAfterMigration=$.noop},t[teamspace.services.coachmarks.Coachmark.StartChat]=function(){e.showStartChat=$.noop},t[teamspace.services.coachmarks.Coachmark.ReplyToMessage]=function(){e.showReplyToMessage=$.noop},t[teamspace.services.coachmarks.Coachmark.ExploreTeams]=function(){e.markExploreTeamsShown=e.showExploreTeams=$.noop},t[teamspace.services.coachmarks.Coachmark.SuggestedContacts]=function(){e.showSuggestedContacts=$.noop},t[teamspace.services.coachmarks.Coachmark.MigratedContacts]=function(){e.showMigratedContacts=$.noop},t[teamspace.services.coachmarks.Coachmark.CreateChannelWhenMember]=function(){e.markCreateChannelAsSeen=e.showCreateChannel=$.noop},t[teamspace.services.coachmarks.Coachmark.CreateChannelWhenOwner]=function(){e.markCreateChannelAsSeen=e.showCreateChannel=$.noop},t[teamspace.services.coachmarks.Coachmark.HolographicIntroduction]=function(){e.showHolographicIntroduction=$.noop},t[teamspace.services.coachmarks.Coachmark.HolographicToolbar]=function(){e.markHolographicToolbarAsSeen=e.showHolographicToolbar=$.noop},t[teamspace.services.coachmarks.Coachmark.HolographicStopEditing]=function(){e.showHolographicStopEditing=$.noop},t[teamspace.services.coachmarks.Coachmark.TurnOnVideoInBroadcast]=function(){e.showTurnOnVideoInBroadcast=$.noop},t[teamspace.services.coachmarks.Coachmark.SendToBroadcast]=function(){e.showSendToBroadcast=$.noop},t[teamspace.services.coachmarks.Coachmark.StartBroadcast]=function(){e.showStartBroadcast=$.noop},t[teamspace.services.coachmarks.Coachmark.SendToPreview]=function(){e.showSendToPreview=$.noop},t;var t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coachmarkDataDeregistrationMap",{get:function(){var e=this;return t={},t[teamspace.services.coachmarks.CoachmarkData.SentAChatMessage]=function(){e.markChatMessageSent=$.noop},t[teamspace.services.coachmarks.CoachmarkData.ExitedCallOrMeeting]=function(){e.markExitedCallOrMeeting=$.noop},t[teamspace.services.coachmarks.CoachmarkData.SkippedInitialTeamCreation]=function(){e.markSkippedInitialTeamCreation=$.noop},t;var t},enumerable:!0,configurable:!0}),e.prototype.showMigratedContacts=function(e,t){var i=this;this.settingsService.valueAsBoolean(this.constants.settings.names.enableSfbSpecificFre)&&e()&&this.sfbTeamsUpgradeService.getUpgradePolicyV2().then(function(e){return i.sfbTeamsUpgradeService.isUpgradedUserPolicy(e)}).then(function(e){e&&i.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.MigratedContacts,{element:t,content:i.$translate.instant(i.resources.strings.coachmark_migrated_contacts),placement:"right"})})},e.prototype.showTurnOnVideoInBroadcast=function(e){this.settingsService.valueAsBoolean(this.constants.settings.names.enableBroadcastCoachmark)&&this.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.TurnOnVideoInBroadcast,{element:e,content:this.$translate.instant(this.resources.strings.coachmark_turn_on_video),placement:"top"})},e.prototype.showSendToBroadcast=function(e){this.settingsService.valueAsBoolean(this.constants.settings.names.enableBroadcastCoachmark)&&this.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.SendToBroadcast,{element:e,content:this.$translate.instant(this.resources.strings.coachmark_send_to_broadcast),placement:"bottom"})},e.prototype.showStartBroadcast=function(e){this.settingsService.valueAsBoolean(this.constants.settings.names.enableBroadcastCoachmark)&&this.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.StartBroadcast,{element:e,content:this.$translate.instant(this.resources.strings.coachmark_start_broadcast),placement:"bottom"})},e.prototype.showSendToPreview=function(e){this.settingsService.valueAsBoolean(this.constants.settings.names.enableBroadcastCoachmark)&&this.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.SendToPreview,{element:e,content:this.$translate.instant(this.resources.strings.coachmark_pick_from_source_picker),placement:"top"})},e.prototype.showSuggestedContacts=function(e,t){var i=this;this.settingsService.valueAsBoolean(this.constants.settings.names.enableSfbSpecificFre)&&e()&&this.$timeout(0,!1).then(function(){return i.sfbTeamsUpgradeService.getUpgradePolicyV2()}).then(function(e){return i.sfbTeamsUpgradeService.isUpgradedUserPolicy(e)}).then(function(e){e&&i.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.SuggestedContacts,{element:t,content:i.$translate.instant(i.resources.strings.coachmark_suggested_contacts),placement:"right"})})},e.prototype.showSyncedMeetings=function(e,t,i,n,r){var s=this;if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableSfbSpecificFre)){var a=function(){var e=n.getCachedEvents();return e?s.$q.resolve(e):n.getEvents("CoachmarkEngine")},o=function(){var e=t.getFirstWebLogin().add(12,s.constants.momentjs.unitOfTime.hours),i=moment();return e.isAfter(i)?s.$q.resolve(!1):a().then(function(e){var t=moment().add(1,s.constants.momentjs.unitOfTime.days);return!!_(e).find(function(e){return moment(e.startTime).isBefore(t)})})};this.utilityService.waitFor(e).then(function(){return s.sfbTeamsUpgradeService.getUpgradePolicyV2()}).then(function(e){return s.sfbTeamsUpgradeService.isUpgradedUserPolicy(e)}).then(function(e){if(e)return(i.routedToAppBarItem||{itemType:void 0}).itemType===teamspace.services.AppBarItemType.Calendar?(s.markSyncedMeetingsShown(),!1):s.coachmarksService.for(teamspace.services.coachmarks.Coachmark.SyncedMeetings).if(function(){return o()}).showCoachmark(function(e){return{element:r,content:s.$translate.instant(s.resources.strings.coachmark_synced_meetings),placement:"right"}})})}},e.prototype.showExploreAppsLeftRail=function(e){var t=this;this.settingsService.valueAsBoolean(this.constants.settings.names.enableSfbSpecificFre)&&this.sfbTeamsUpgradeService.getUpgradePolicyV2().then(function(e){return t.sfbTeamsUpgradeService.isUpgradedUserPolicy(e)}).then(function(i){i&&t.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.ExploreAppsLeftRail,{element:e,content:t.$translate.instant(t.resources.strings.coachmark_explore_apps_left_rail),placement:"right",asModal:!0,primaryAction:{title:t.$translate.instant(t.resources.strings.coachmark_explore_apps_left_rail_button),onClick:function(){},trackOutcome:teamspace.components.PanelActionOutcome.dismiss,trackScenario:teamspace.components.PanelActionScenario.gotIt,trackName:teamspace.components.PanelModuleName.gotIt,trackSummary:"Got it"}})})},e.prototype.showExploreTeamsAfterMigration=function(e,t,i){var n=this;this.settingsService.valueAsBoolean(this.constants.settings.names.enableSfbSpecificFre)&&this.utilityService.waitFor(e).then(function(){return n.sfbTeamsUpgradeService.getUpgradePolicyV2()}).then(function(e){return n.sfbTeamsUpgradeService.isUpgradedUserPolicy(e)}).then(function(e){if(e){var r=t.getFirstWebLogin().add(n.constants.timeConversion.numHourInDay/2,n.constants.momentjs.unitOfTime.hours),s=moment(),a=r.valueOf()-s.valueOf();n.$timeout(function(){n.coachmarksService.for(teamspace.services.coachmarks.Coachmark.ExploreTeamsAfterMigration).if(function(){return n.coachmarksService.hasCoachmarkData([teamspace.services.coachmarks.CoachmarkData.ExitedCallOrMeeting,teamspace.services.coachmarks.CoachmarkData.SentAChatMessage],teamspace.services.coachmarks.LogicOperator.Or)}).showCoachmark(function(){return{element:i,content:n.$translate.instant(n.resources.strings.coachmark_explore_teams_after_migration),placement:"right"}})},Math.max(a,0),!1)}})},e.prototype.showAssignedCallingNumber=function(e){var t=this;this.settingsService.valueAsBoolean(this.constants.settings.names.enableSfbSpecificFre)&&this.sfbTeamsUpgradeService.getUpgradePolicyV2().then(function(e){return t.sfbTeamsUpgradeService.isUpgradedUserPolicy(e)}).then(function(i){i&&t.$timeout(function(){t.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.AssignedCallingNumber,{element:"#"+e,content:t.$translate.instant(t.resources.strings.coachmark_assigned_calling_number),placement:"top"})},0,!1)})},e.prototype.showReplyToMessage=function(e,t,i,n,r){var s=this;this.areCoachmarksEnabled&&(this.settingsService.valueAsBoolean(this.constants.settings.names.disableReplyToMessageCoachmark)||!e&&t&&i===this.constants.messages.types.newConversation&&r&&this.coachmarksService.for(teamspace.services.coachmarks.Coachmark.ReplyToMessage).if(function(){var e=r.getLatestThread(!0);return e&&e.firstMessage&&!e.firstMessage.isFromMe&&!e.firstMessage.isBotMessage&&e.canReplyToThread&&n()&&e.objectId}).showCoachmark(function(e){return{element:"#"+teamspace.services.MessagingUtilities.getFormattedThreadId(e)+' [data-tid="replyMessageButtonText"]',content:s.$translate.instant(s.resources.strings.coachmark_reply_to_message),placement:"right",className:"reply-to-message-coachmark"}}))},e.prototype.showExploreTeams=function(e,t,i,n){var r=this;this.areCoachmarksEnabled&&(this.settingsService.valueAsBoolean(this.constants.settings.names.disableExploreTeamsCoachmark)||this.utilityService.waitFor(e).then(function(){if((i.routedToAppBarItem||{itemType:void 0}).itemType===teamspace.services.AppBarItemType.Teams)return r.markExploreTeamsShown();var e=t.getFirstWebLogin().add(12,r.constants.momentjs.unitOfTime.hours),s=moment();e.valueOf()<=s.valueOf()&&r.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.ExploreTeams,{element:n,content:r.$translate.instant(r.resources.strings.coachmark_explore_teams),placement:"right"})}))},e.prototype.showStartChat=function(e,t,i,n){var r=this;if(this.areCoachmarksEnabled&&!this.settingsService.valueAsBoolean(this.constants.settings.names.disableStartChatCoachmark)){var s=10*this.constants.timeInMiliseconds.second;this.utilityService.waitFor(e).then(function(){return r.$timeout(s,!1)}).then(function(){return t.getTeams()}).then(function(e){e=e||[],!((r.routeUtilityService.getRootRouteParams()||{}).ctx===r.constants.navigation.context.chat)&&i()&&0===e.length&&r.coachmarksService.hasCoachmarkData(teamspace.services.coachmarks.CoachmarkData.SkippedInitialTeamCreation).then(function(e){e&&r.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.StartChat,{element:n,content:r.$translate.instant(r.resources.strings.coachmark_start_chat),placement:"right"})})})}},e.prototype.showAddedContact=function(e){var t=this;this.areCoachmarksEnabled&&this.$timeout(0,!1).then(function(){t.coachmarksService.showAdHocCoachmark({element:e,content:t.$translate.instant(t.resources.strings.added),placement:"right"})})},e.prototype.showCreateChannel=function(e,t){var i=this;if(this.areCoachmarksEnabled&&!this.settingsService.valueAsBoolean(this.constants.settings.names.disableCreateChannelWhenOwnerCoachmark)&&!this.settingsService.valueAsBoolean(this.constants.settings.names.disableCreateChannelWhenMemberCoachmark)&&e.selectedTeam&&this.utilityService.isLeftRailVisible()&&t&&!t.isChat&&!t.isEditMessage){!(this.teamMembershipPropertiesService.isAdmin(e.selectedTeam.objectId)||e.selectedTeam.teamSettings&&e.selectedTeam.teamSettings.createTopic)||e.isCurrentTeamSectionCollapsed||(e.selectedTeam.channels||[]).length>5||this.coachmarksService.for(teamspace.services.coachmarks.Coachmark.CreateChannelWhenMember).if(function(){var t='body [data-team-id="'+e.selectedTeam.objectId+'"]:first',n=angular.element(t);if(n&&n.length)return i.utilityService.scrollElementIntoView(n[0],"top",!0),t}).showCoachmark(function(e){return{element:e,content:i.$translate.instant(i.resources.strings.coachmark_create_channel),placement:"right"}})}},e.prototype.showHolographicIntroduction=function(e){var t=this;this.authenticationService.isAnonymous()||this.$timeout(0,!1).then(function(){t.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.HolographicIntroduction,{element:e,content:t.$translate.instant(t.resources.strings.coachmark_holographic_introduction),placement:"top"})})},e.prototype.showHolographicToolbar=function(e){var t=this;this.authenticationService.isAnonymous()||this.$timeout(0,!1).then(function(){t.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.HolographicToolbar,{element:e,content:t.$translate.instant(t.resources.strings.coachmark_holographic_toolbar),placement:"top"})})},e.prototype.showHolographicStopEditing=function(e){var t=this;this.authenticationService.isAnonymous()||this.$timeout(0,!1).then(function(){t.coachmarksService.showCoachmark(teamspace.services.coachmarks.Coachmark.HolographicStopEditing,{element:e,content:t.$translate.instant(t.resources.strings.coachmark_holographic_stop_editing),placement:"top"})})},e.prototype.dismissHolographicCoachmarks=function(){this.coachmarksService.dismissCoachmark(teamspace.services.coachmarks.Coachmark.HolographicIntroduction),this.coachmarksService.dismissCoachmark(teamspace.services.coachmarks.Coachmark.HolographicToolbar),this.coachmarksService.dismissCoachmark(teamspace.services.coachmarks.Coachmark.HolographicStopEditing)},e.prototype.markChatMessageSent=function(e,t){if(this.isDataCollectionEnabled){var i=e.getConversation(t);i&&i.isChat()&&this.coachmarksService.addCoachmarkData(teamspace.services.coachmarks.CoachmarkData.SentAChatMessage)}},e.prototype.markExitedCallOrMeeting=function(){this.isDataCollectionEnabled&&this.coachmarksService.addCoachmarkData(teamspace.services.coachmarks.CoachmarkData.ExitedCallOrMeeting)},e.prototype.markSkippedInitialTeamCreation=function(){this.isDataCollectionEnabled&&this.coachmarksService.addCoachmarkData(teamspace.services.coachmarks.CoachmarkData.SkippedInitialTeamCreation)},e.prototype.markExploreTeamsShown=function(){this.isDataCollectionEnabled&&(this.coachmarksService.markCoachmarkAsSeen(teamspace.services.coachmarks.Coachmark.ExploreTeams),this.markExploreTeamsShown=$.noop)},e.prototype.markSyncedMeetingsShown=function(){this.isDataCollectionEnabled&&(this.coachmarksService.markCoachmarkAsSeen(teamspace.services.coachmarks.Coachmark.SyncedMeetings),this.markSyncedMeetingsShown=$.noop)},e.prototype.markMigratedAndSuggestedContactsCoachmarksAsSeen=function(){this.isDataCollectionEnabled&&(this.coachmarksService.markCoachmarkAsSeen([teamspace.services.coachmarks.Coachmark.MigratedContacts,teamspace.services.coachmarks.Coachmark.SuggestedContacts]),this.markMigratedAndSuggestedContactsCoachmarksAsSeen=$.noop)},e.prototype.markCreateChannelAsSeen=function(){this.isDataCollectionEnabled&&(this.coachmarksService.markCoachmarkAsSeen([teamspace.services.coachmarks.Coachmark.CreateChannelWhenMember,teamspace.services.coachmarks.Coachmark.CreateChannelWhenOwner]),this.markCreateChannelAsSeen=$.noop)},e.prototype.markHolographicToolbarAsSeen=function(){this.isDataCollectionEnabled&&(this.coachmarksService.markCoachmarkAsSeen(teamspace.services.coachmarks.Coachmark.HolographicToolbar),this.markHolographicToolbarAsSeen=$.noop)},Object.defineProperty(e.prototype,"isDataCollectionEnabled",{get:function(){return!this.authenticationService.isAnonymous()&&(this.settingsService.valueAsBoolean(this.constants.settings.names.enableCoachmarkDataCollection)||this.settingsService.valueAsBoolean(this.constants.settings.names.enableCoachmarks))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"areCoachmarksEnabled",{get:function(){return!this.authenticationService.isAnonymous()&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableCoachmarks)},enumerable:!0,configurable:!0}),e}();t.CoachmarkEngine=n,angular.module("teamspace.coachmarkEngine",["pascalprecht.translate","teamspace.locales","teamspace.constants","teamspace.utilityService","teamspace.eventingService","teamspace.routeUtilityService","teamspace.coachmarksService","teamspace.settingsService","teamspace.authenticationService","teamspace.sfbTeamsUpgradeService"]).service("coachmarkEngine",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(232),r=function(){return function(e,t){this.coachmark=e,this.displayCoachmark=t}}(),s=function(){function e(e,t,i,n,r,s,a,o,c,l,p){this.$qNoApply=e,this.$rootScope=t,this.constants=i,this.settingsService=n,this.tooltipService=r,this.loggingService=s,this.dialogService=a,this.coachmarksRepository=o,this.analyticsService=c,this.$state=l,this.utilityService=p,this.coachmarkOverlayClass="coachmark-overlay",this.currentCoachmark=void 0,this.coachmarkQueue=[],this.lastTooltipId=null}return e.$inject=["$qNoApply","$rootScope","constants","settingsService","tooltipService","loggingService","dialogService","coachmarksRepository","analyticsService","$state","utilityService"],e.prototype.for=function(e){var t=this,i=this.loggingService.newScenario(this.constants.scenarios.onboarding.coachmarks.show);return i.eventData={coachmark:teamspace.services.coachmarks.Coachmark[e]},{if:function(n){return t.if(e,n,i)}}},e.prototype.showCoachmark=function(e,t){var i=this,n=this.loggingService.newScenario(this.constants.scenarios.onboarding.coachmarks.show);return n.eventData={coachmark:teamspace.services.coachmarks.Coachmark[e]},this.coachmarksRepository.hasNotSeenCoachmark(e).then(function(r){if(r)return i.displayCoachmark(e,t,n);var s=i.settingsService.valueAsBoolean(i.constants.settings.names.enableCoachmarks);return n.stop({message:s?"not shown - coachmark has already been seen":"coachmarks not enabled"}),!1},function(){return n.fail({message:"unable to determine if coachmark has been seen"})})},e.prototype.showAdHocCoachmark=function(e,t){var i=this,n=teamspace.services.coachmarks.Coachmark.AdHoc;return t=t||this.loggingService.newScenario(this.constants.scenarios.onboarding.coachmarks.show),t.eventData={coachmark:teamspace.services.coachmarks.Coachmark[n]},this._displayCoachmark(n,e,t,function(e){return i.$qNoApply.resolve(!0)},function(e){return i.$qNoApply.resolve()})},e.prototype.dismissCoachmark=function(e){var t=!1;this.currentCoachmark===e&&(this.clearCoachmark(),t=!0);var i=this.coachmarkQueue.length;return this.coachmarkQueue=this.coachmarkQueue.filter(function(t){return t.coachmark!==e}),t||i!==this.coachmarkQueue.length},e.prototype.markCoachmarkAsSeen=function(e){var t=this;if(this.coachmarksRepository.hasCachedCoachmark(e))return this.$qNoApply.resolve();var i=_.isArray(e)?e:[e],n=this.loggingService.newScenario(this.constants.scenarios.onboarding.coachmarks.markAsSeen);n.eventData={coachmarks:i.map(function(e){return teamspace.services.coachmarks.Coachmark[e]}).join(",")};for(var r=null,s=this.$qNoApply.resolve(),a=0,o=i;a<o.length;a++)!function(e){s=s.then(function(){return t.coachmarksRepository.addCoachmark(e)}).catch(function(i){n.mark(t.constants.scenarios.onboarding.coachmarks.steps.markAsSeen,{message:"failed to mark coachmark as seen",coachmark:teamspace.services.coachmarks.Coachmark[e],statusCode:(i||{}).statusCode}),r=i})}(o[a]);return s.finally(function(){if(r)return n.fail({message:"failed to mark coachmark(s) as seen",statusCode:(r||{}).statusCode}),t.$qNoApply.reject(r);n.stop()})},e.prototype.if=function(e,t,i){var n=this;return{showCoachmark:function(r){return n.coachmarksRepository.hasNotSeenCoachmark(e).then(function(s){if(s)return"function"==typeof t?n.$qNoApply.when(t()).then(function(t){return t?n.displayCoachmark(e,r(t),i):(i.stop({message:"not shown - predicate pre-condition not met"}),!1)}):n.displayCoachmark(e,r(null),i);var a=n.settingsService.valueAsBoolean(n.constants.settings.names.enableCoachmarks);return i.stop({message:a?"not shown - coachmark has already been seen":"coachmarks not enabled"}),!1}).catch(function(e){return i.fail({message:"failed to show coachmark",statusCode:(e||{}).statusCode}),n.$qNoApply.reject(e)})}}},e.prototype.displayCoachmark=function(e,t,i){var n=this;return this._displayCoachmark(e,t,i,function(e){return n.coachmarksRepository.hasNotSeenCoachmark(e)},function(e){return n.coachmarksRepository.addCoachmark(e)})},e.prototype._displayCoachmark=function(e,t,i,s,a){var o,c=this,l=this.$qNoApply.defer(),p=teamspace.services.coachmarks.Coachmark[e],u=!1;if(!_.isUndefined(this.currentCoachmark)){i.pause({reason:this.constants.scenarios.onboarding.coachmarks.steps.enqueue});var h=new r(e,function(){return i.resume(),s(e).then(function(n){return n?c._displayCoachmark(e,t,i,s,a):(i.stop({message:"not shown - coachmark has already been seen"}),!1)}).then(l.resolve).catch(l.reject)});return this.coachmarkQueue.push(h),l.promise}this.currentCoachmark=e,t.className=t.className||"",t.placement=_.trim(t.placement);var d=this.constants.popover.placement.bottom,g=this.constants.popover.placement.top;t.placement.startsWith(d+"-")&&(t.className=d+" "+t.className),t.placement.startsWith(g+"-")&&(t.className=g+" "+t.className);var v=t.primaryAction||t.secondaryAction;t.asModal&&!v&&(t.asModal=!1,this.loggingService.error("coachmark "+p+" cannot be modal as it has no actions")),t.asModal&&(t.className="modal-coachmark "+t.className);var m=t.trackData||{};m.coachmark=p;var f=angular.extend(this.$rootScope.$new(),{coachmarkName:p,className:t.className||"",content:t.content,panelRegion:teamspace.PanelRegion,asModal:!!t.asModal,panelType:t.panelType||teamspace.PanelType.coachmark,trackData:m});t.primaryAction&&(f.primaryAction={title:t.primaryAction.title,aria:t.primaryAction.aria,trackOutcome:t.primaryAction.trackOutcome,trackScenario:t.primaryAction.trackScenario,trackName:t.primaryAction.trackName,trackSummary:t.primaryAction.trackSummary,onClick:function(){t.primaryAction.onClick(),c.clearCoachmark()}}),t.secondaryAction&&(f.secondaryAction={title:t.secondaryAction.title,aria:t.secondaryAction.aria,trackOutcome:t.secondaryAction.trackOutcome,trackScenario:t.secondaryAction.trackScenario,trackName:t.secondaryAction.trackName,trackSummary:t.secondaryAction.trackSummary,onClick:function(){t.secondaryAction.onClick(),c.clearCoachmark()}}),this.lastTooltipId=f.$id.toString();var S=this.settingsService.valueAsBoolean(this.constants.settings.names.enableCoachmarkCounterFactualLogging)&&e!==teamspace.services.coachmarks.Coachmark.AdHoc,y=function(){return a(e).then(function(){return i.stop({message:"coachmark shown"})}).catch(function(e){return i.fail({message:"failed to add coachmark as seen",statusCode:(e||{}).statusCode})}).finally(function(){return l.notify()})},C=function(){c.currentCoachmark=void 0,c.coachmarkQueue.length&&c.coachmarkQueue.shift().displayCoachmark(),l.resolve(!u)},b={selector:t.element,tooltipType:teamspace.services.TooltipType.Popover,tooltipId:this.lastTooltipId,options:{autoClose:!t.asModal,animation:"coachmark-animation",template:n,trigger:"manual",container:"body",scope:f,placement:t.placement,show:!0,onShow:function(e){if(e){var i=$(b.selector).offset();o=setInterval(function(){var e=$(b.selector).offset();i&&e&&(i.left!=e.left||i.top!=e.top)&&(u=!0,c.clearCoachmark(),clearInterval(o))},c.constants.timeInMiliseconds.second)}t.asModal&&$("#coachmark-tooltip").after('<div class="'+c.coachmarkOverlayClass+' ngdialog-overlay"></div>'),y()},onHide:function(e){C(),clearInterval(o)}}};return $(b.selector).is(":visible")?t.viewport&&!this.utilityService.isElementInView($(b.selector),$(t.viewport))?(i.incomplete({message:"failed to show coachmark - HTML element is not within viewport"}),C(),this.$qNoApply.resolve(!1)):S?(this.emitCoachmarkSeenPanelViewForCounterFactualLogging(p),i.stop({message:"coachmark would have shown - counter factual logging is enbled"}),C(),this.coachmarksRepository.addSessionCoachmark(e),this.$qNoApply.resolve(!0)):(this.dialogService.isAnyDialogOpen()?(i.pause({reason:"waiting for existing dialog to close before showing coachmark"}),this.dialogService.onAllDialogsClosed().then(function(){i.resume(),c.tooltipService.showTooltip(b)})):this.tooltipService.showTooltip(b),l.promise):(i.incomplete({message:"failed to show coachmark - HTML element is not visible"}),C(),this.$qNoApply.resolve(!1))},e.prototype.addCoachmarkData=function(e){return this.coachmarksRepository.addCoachmarkData(e)},e.prototype.hasCoachmarkData=function(e,t){return this.coachmarksRepository.hasCoachmarkData(e,t)},e.prototype.clearCoachmark=function(){this.lastTooltipId&&(this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.lastTooltipId),$("."+this.coachmarkOverlayClass).remove(),this.lastTooltipId=null)},e.prototype.emitCoachmarkSeenPanelViewForCounterFactualLogging=function(e){this.analyticsService.sendPanelView({panel:{launchMethod:teamspace.components.LaunchMethod[teamspace.components.LaunchMethod.direct],previousUri:void 0,previousUriParams:void 0,region:teamspace.PanelRegion[teamspace.PanelRegion.popover],uri:this.$state.current.name,uriParams:this.loggingService.hashUriParamsPII(this.$state.params),viewId:this.utilityService.generateUUID(),type:teamspace.PanelType[teamspace.PanelType.coachmark]},dataBag:{coachmark:e,message:"coachmark counter factual logging only"}})},e}();t.CoachmarksService=s,angular.module("teamspace.coachmarksService",["teamspace.qNoApply","teamspace.tooltipService","teamspace.dialogService","teamspace.services.coachmarksRepository","teamspace.analyticsService","teamspace.utilityService"]).service("coachmarksService",s)},function(e,t){e.exports='<div id="coachmark-tooltip"\r\n    analytics-panel="{{::panelRegion.popover}}"\r\n    analytics-panel-view="{ panel: {type: {{::panelType}} }}"\r\n    track-data="trackData"\r\n    class="popover coachmark animated"\r\n    ng-class="::className"\r\n    acc-role="tab-handler-modal-coachmark"\r\n    role="tooltip">\r\n  <div class="arrow"></div>\r\n  <div class="popover-content">\r\n    <div class="coachmark-content" ng-bind-html="::content"></div>\r\n    <div class="coachmark-buttons" ng-if="::(primaryAction || secondaryAction)">\r\n        <button class="ts-btn ts-btn-coachmark-secondary inset-border"\r\n                aria-label="{{::secondaryAction.aria || secondaryAction.title}}"\r\n                ng-click="secondaryAction.onClick()"\r\n                track-gesture="{{::$root.trackConstants.trackGesture.click}}"\r\n                track-outcome="{{::secondaryAction.trackOutcome}}"\r\n                track-scenario="{{::secondaryAction.trackScenario}}"\r\n                track-scenario-type="{{::$root.trackConstants.trackScenarioType.coachmarkClick}}"\r\n                track-type="{{::$root.trackConstants.trackType.button}}"\r\n                track-name="{{::secondaryAction.trackName}}"\r\n                track-data="trackData"\r\n                track-summary="{{::secondaryAction.trackSummary}}"\r\n                ng-attr-acc-focus-default="{{::asModal && !primaryAction ? \'true\' : undefined }}"\r\n                ng-if="::secondaryAction">{{::secondaryAction.title}}</button>\r\n        <button class="ts-btn ts-btn-coachmark-primary inset-border"\r\n                aria-label="{{::primaryAction.aria || primaryAction.title}}"\r\n                ng-click="primaryAction.onClick()"\r\n                track-gesture="{{::$root.trackConstants.trackGesture.click}}"\r\n                track-outcome="{{::primaryAction.trackOutcome}}"\r\n                track-scenario="{{::primaryAction.trackScenario}}"\r\n                track-scenario-type="{{::$root.trackConstants.trackScenarioType.coachmarkClick}}"\r\n                track-type="{{::$root.trackConstants.trackType.button}}"\r\n                track-name="{{::primaryAction.trackName}}"\r\n                track-data="trackData"\r\n                track-summary="{{::primaryAction.trackSummary}}"\r\n                ng-attr-acc-focus-default="{{::asModal ? \'true\' : undefined }}"\r\n                ng-if="::primaryAction">{{::primaryAction.title}}</button>\r\n      </div>\r\n  </div>\r\n</div>\r\n'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,n,r,s,a,o,c,l){this.authenticationService=e,this.loggingService=t,this.$http=i,this.dataManagerService=n,this.constants=r,this.$q=s,this.utilityService=a,this.settingsService=o,this.resources=c,this.$translate=l,this.cachedCommandsByType={},this.rootUrl=this.settingsService.valueFor("middleTierConstants").newEndpointAddress,this.registerDataManagers()}return e.$inject=["authenticationService","loggingService","$http","dataManagerService","constants","$q","utilityService","settingsService","resources","$translate"],e.prototype.executeCommand=function(e,t,i){var n=this,r=this.$q.defer(),s=this.rootUrl+this.constants.urls.commands.executeCommand.replace("{commandId}",e);s=s.replace("{version}",t);var a=[];i.forEach(function(e,t){a.push({name:t,value:e})});var o=new teamspace.services.DataManagerRequestOptions;return o.httpConfigModifier=function(e){e.url=s,e.counter=n.constants.counters.commandExecute,e.context="execute command"},this.commandsDataManager.create(a,o).then(function(e){r.resolve(e)}),r.promise},e.prototype.getCommands=function(e,t){var i=this.$q.defer();angular.isDefined(t)&&t||(t="default");var n=e.toString()+"_"+t;if(this.cachedCommandsByType[n])return i.resolve(this.cachedCommandsByType[n]),i.promise;var r=[];return this.getClientSideCommands().forEach(function(e){r.push(e)}),r=this.filterSupportedCommands(r,e),this.cachedCommandsByType[n]=r,i.resolve(r),i.promise},e.prototype.registerDataManagers=function(){if(!this.commandsDataManager){var e=new teamspace.services.DataManagerOptions(this.constants.urls.commands.type,function(e){return e.commandId});e.isTransient=!0,e.createUrl=this.constants.urls.commands.executeCommand,this.commandsDataManager=this.dataManagerService.registerManager(e)}},e.prototype.filterSupportedCommands=function(e,t){var i=[];return e.forEach(function(e){t==teamspace.services.CommandMode.Powerbar?"CommandExtension"==e.type&&i.push(e):"CommandExtension"!=e.type&&e.isEnabled&&i.push(e)}),i},e.prototype.getClientSideCommands=function(){return[{type:"InputExtension",name:this.$translate.instant(this.resources.strings.extensioncatalog_cmdGiphyName),friendlyName:this.$translate.instant(this.resources.strings.extensioncatalog_cmdGiphyFriendlyName),description:this.$translate.instant(this.resources.strings.extensioncatalog_cmdGiphyDescription),icon:"http://teamspacewusprodms.blob.core.windows.net/agenticons/giphy_logo_laser.gif",namespace:"",scope:"System",token:"705c5ca5-003e-4f11-9f59-cdbb19e36f58",author:"Microsoft Corp.",teamSmtpAddress:"",tenantId:"",parameters:[{name:"query",description:this.$translate.instant(this.resources.strings.extensioncatalog_cmdGiphyQueryParam),required:!0,defaultValue:null,type:"Text"}],resultSchema:{isCollection:!0,resultSelector:"data",supportedTemplates:[{type:"Grid",fields:[{name:"title",value:"caption"},{name:"image",value:"images.original.url"},{name:"previewImage",value:"images.downsized.url"}]}],composeType:"Image",composeValueSelector:"images.original.url",composeValueHint:null},isEnabled:!0,menuIcons:{default:"/assets/commands/lg_Command_Todo.svg",selected:"/assets/commands/lg_Command_Todo_H.svg"},id:"com.microsoft.teamspace.inputextension.giphy",version:"1.0"}]},e}();t.CommandsService=n,angular.module("teamspace.commandsService",["teamspace.dataManagerService"]).service("commandsService",n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(235),i(236),i(79),i(80),i(237)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n,r,s,a,o,c,l){var p=e.call(this,r,n,s,t,i,a,o)||this;return p.$q=t,p.utilityService=c,p.loggingService=l,p.logger=p.loggingService.newLogger("PptSharingWopiDiscoveryService"),p}return n(t,e),t.$inject=["$q","$qNoApply","constants","settingsService","$http","authenticationService","appStateService","utilityService","loggingService"],t.prototype.getWacUrl=function(e){var t,i=this,n=this.utilityService.parseUrl(e),r=n.origin,s=decodeURIComponent(this.utilityService.getFileExtension(n.pathname));try{t=decodeURIComponent(this.parseSiteName(n.pathname))}catch(e){return this.$q.reject(this.getStandardizedError("Cannot get WAC URL: Cannot parse site URL from the file URL"))}this.setEndpointUrl(r);var a=new teamspace.services.PIIString("{siteUrl}/_api/SP.Utilities.WopiHostUtility.GetWebApplicationUrls(appNames=@a1,actions=@a2)?@a1=%27PowerPoint%27&@a2=%270%27").replace("{siteUrl}",new teamspace.services.PIIValue(t,microsoft.applications.telemetry.datamodels.PIIKind.GenericData)),o=this.utilityService.generateUUID(),c={callType:this.constants.urls.files.service.sharePoint.files.type,scrubbedApiPath:a.scrubbedValue,headers:(l={},l[this.constants.headers.sharePoint.SPRequestGuid]=o,l)};return this.performApiGetDetailed(a.value,c).toNgPromise(this.$q).catch(function(e){return i.$q.reject(i.getStandardizedError("Cannot get WAC URL: GetWebApplicationUrls API request failed",e,o))}).then(function(e){var t=e;if(!t.object||!t.object.value)return i.$q.reject(i.getErrorFromData("Cannot get WAC URL: Empty response",t,o));var n=_.find(t.object.value,function(e){return"PowerPoint"===e.App});if(!n)return i.$q.reject(i.getErrorFromData("Cannot get WAC URL: No data for PowerPoint",t,o));var r=_.find(n.ListByAction,function(e){return"View"===e.Action});if(!r)return i.$q.reject(i.getErrorFromData("Cannot get WAC URL: No data for View action",t,o));var a=_.find(r.UrlsByExt,function(e){return _.toLower(e.Ext)===s});return a?(i.logger.info("WAC URL successfuly retrieved"),{data:a.WacUrl,requestId:t.headers&&t.headers[i.constants.headers.sharePoint.SPRequestGuid.toLowerCase()]||o}):i.$q.reject(i.getErrorFromData("Cannot get WAC URL: No data for '"+s+"' file extension",t,o))});var l},t.prototype.parseSiteName=function(e){var t=e.split("/");if(t.length<3)throw new Error("cannot parse site name");return this.logger.info("Site name successfuly parsed"),"/"+t[1]+"/"+t[2]},t}(i(44).PptSharingSharePointClient);t.PptSharingWopiDiscoveryService=r,angular.module("teamspace.pptSharingWopiDiscoveryService",["teamspace.qAllSettled","teamspace.qNoApply","teamspace.constants","teamspace.settingsService","teamspace.authenticationService","teamspace.utilityService"]).service("pptSharingWopiDiscoveryService",r)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n,r,s,a,o,c,l){var p=e.call(this,r,n,s,t,i,a,o)||this;return p.$q=t,p.utilityService=c,p.loggingService=l,p.logger=p.loggingService.newLogger("PptSharingTokenService"),p}return n(t,e),t.$inject=["$q","$qNoApply","constants","settingsService","$http","authenticationService","appStateService","utilityService","loggingService"],t.prototype.getProofTokenUrl=function(e){var t=this,i=this.utilityService.parseUrl(e),n=i.origin;this.setEndpointUrl(n);var r=new teamspace.services.PIIValue(e,microsoft.applications.telemetry.datamodels.PIIKind.Uri).value,s=this.utilityService.generateUUID(),a={callType:this.constants.urls.files.service.sharePoint.files.type,url:r,headers:(o={},o[this.constants.headers.sharePoint.SPRequestGuid]=s,o)};return this.logger.info("Retrieving proofTokenUrl for file url "+i+"..."),this.performApiGetDetailed(r,a).toNgPromise(this.$q).catch(function(e){return t.$q.reject(t.getStandardizedError("/commands API request failed",e,s))}).then(function(e){return e&&e.object&&e.object.preAuthUrls&&e.object.preAuthUrls.proofTokenUrl?(t.logger.info("ProofTokenUrl successfully retrieved"),{data:e.object.preAuthUrls.proofTokenUrl,requestId:e.headers&&e.headers[t.constants.headers.sharePoint.SPRequestGuid.toLowerCase()]||s}):t.$q.reject(t.getErrorFromData("getProofTokenUrl: No valid proofTokenUrl in the response",e,s))});var o},t.prototype.getDownloadUrl=function(e){var t=this,i=this.utilityService.parseUrl(e).origin;this.setEndpointUrl(i);var n=new teamspace.services.PIIValue(e,microsoft.applications.telemetry.datamodels.PIIKind.Uri).value,r=this.utilityService.generateUUID(),s={callType:this.constants.urls.files.service.sharePoint.files.type,url:n,headers:(a={},a[this.constants.headers.sharePoint.SPRequestGuid]=r,a)};return this.performApiGetDetailed(n,s).toNgPromise(this.$q).catch(function(e){return t.$q.reject(t.getStandardizedError("proofToken API request failed",e,r))}).then(function(e){return e.object&&e.object["@content.downloadUrl"]?(t.logger.info("DownloadUrl successfully retrieved"),{data:e.object["@content.downloadUrl"],requestId:e.headers&&e.headers[t.constants.headers.sharePoint.SPRequestGuid.toLowerCase()]||r}):t.$q.reject(t.getErrorFromData("getDownloadUrl: No @content.downloadUrl in the response",e,r))});var a},t.prototype.getPptSharingTokens=function(e){var t=this;return this.getProofTokenUrl(e).then(function(e){return t.getDownloadUrl(e.data).then(function(t){return{fileGetUrl:t.data,proofTokenUrl:e.data,requestIds:{fileGetUrl:t.requestId,proofTokenUrl:e.requestId}}})})},t}(i(44).PptSharingSharePointClient);t.PptSharingTokenService=r,angular.module("teamspace.pptSharingTokenService",["teamspace.qAllSettled","teamspace.qNoApply","teamspace.constants","teamspace.settingsService","teamspace.authenticationService","teamspace.utilityService","teamspace.loggingService"]).service("pptSharingTokenService",r)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(238),r=i(79),s=i(80),a=teamspace.services.ContentSharingErrorCode,o=teamspace.services.CallingTelemetryService,c=teamspace.services.SessionUtils,l=function(){function e(e,t,i,a,o,c,l,p,u){this.$q=e,this.$translate=t,this.resources=i,this.constants=a,this.settingsService=o,this.utilityService=c,this.callingTelemetryService=l,this.providers={},this.logger=p.newLogger("ContentSharingService"),this.isPowerPointSharingEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePowerPointSharing),this.isIncomingPowerPointSharingEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enableIncomingPowerPointSharing),(this.isPowerPointSharingEnabled||this.isIncomingPowerPointSharingEnabled)&&this.registerProvider(u.instantiate(n.PPTSharingProvider)),this.isInvisionWhiteboardSharingEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enableInvisionWhiteboardSharing),this.isWhiteboardViewingEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enableIncomingWhiteboardViewing),this.isWhiteboardSharingEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enableWhiteboardSharing),(this.isWhiteboardViewingEnabled||this.isInvisionWhiteboardSharingEnabled)&&this.registerProvider(u.instantiate(r.InvisionWhiteboardProvider)),(this.isWhiteboardViewingEnabled||this.isWhiteboardSharingEnabled)&&this.registerProvider(u.instantiate(s.WhiteboardProvider))}return e.$inject=["$q","$translate","resources","constants","settingsService","utilityService","callingTelemetryService","loggingService","$injector"],e.prototype.init=function(e,t){var i=this;Object.keys(this.providers).length&&(this.activeContentSharingSessions=new Map,this.call=e,this.callbacks=t,this.handleAddedSessions(),this.onContentChangedSubscription=this.call.on("contentSharingChanged",function(){i.logger.info("Content changed"),i.handleAddedSessions(),i.handleRemovedSessions()}))},e.prototype.getActiveContentSharingSessionsTypes=function(){var e=[];return this.activeContentSharingSessions&&this.activeContentSharingSessions.forEach(function(t){e.push(t.type?t.type:void 0)}),e},e.prototype.handleAddedSessions=function(){var e=this;this.logger.info("Handling added sessions (if any)..."),_.differenceWith(this.call.contentSharingSessions,Array.from(this.activeContentSharingSessions.keys()),function(e,t){return e.contentSharingGuid===t}).forEach(function(t){2===t.contentSharingStatus?(e.logger.info("Handling new incoming session "+t.contentSharingGuid),e.handleNewIncomingSession(t)):_.includes([0,1],t.contentSharingStatus)?(e.logger.info("Handling new outgoing session "+t.contentSharingGuid+", status="+t.contentSharingStatus),e.handleNewOutgoingSession(t)):_.includes([4,3,5],t.contentSharingStatus)?(e.logger.info("Rejoining session "+t.contentSharingGuid+", status="+t.contentSharingStatus),e.handleRejoinedSession(t)):e.logger.warn("Ignoring session "+t.contentSharingGuid+" as it's in status "+t.contentSharingStatus)}),this.logger.info("Handling added sessions complete")},e.prototype.tryParseContentBasic=function(e){var t=this;return this.$q(function(i,n){var r=t.sharingContentDtoFromJson(e);return r.type?i(r):n("No type found in sharing blob")})},e.prototype.wrapError=function(e,t){var i=this;return e.then(function(e){return e},function(e){return i.rethrow(t,e)})},e.prototype.toNgPromise=function(e){return this.$q(function(t,i){return e.then(t,i)})},e.prototype.handleNewIncomingSession=function(e){var t=this,i=this.callingTelemetryService.newContentSharingScenario(this.call,this.constants.scenarios.contentSharing.viewerJoin,e.contentSharingGuid),n=this.addActiveContentSharingSession(e.contentSharingGuid),r=null,s=null,l=null;this.wrapError(this.toNgPromise(c.safeCall(function(){return e.joinContentSharing()})),a.SessionJoinContentSharingFailed).then(function(){return i.mark(t.constants.scenarios.contentSharing.steps.joinedSession),t.logger.info("Successfully joined content sharing session."),t.wrapError(t.tryParseContentBasic(e.contentSharingIdentity),a.ViewerFailedToParseSharingContent)}).then(function(n){return i.mark(t.constants.scenarios.contentSharing.steps.dtoParsed),r=n,t.logger.info("Content sharing information read."),i.appendEventData({type:n.type}),t.setActiveContentSharingSessionType(e.contentSharingGuid,r.type),(l=t.providers[r.type])?l.startIncomingSession(n,e):t.rethrow(a.NoProviderFound,"No provider for type '"+r.type+"' found")}).then(function(e){return i.mark(t.constants.scenarios.contentSharing.steps.sessionCreated),s=e,t.wrapError(t.sessionAdded(s),a.RendererInitFailed)}).then(function(){if(t.logger.info("Renderer successfully initialized"),i.mark(t.constants.scenarios.contentSharing.steps.sessionAdded),c.isDisconnected(s)){var o={code:a.Cancelled,message:t.translateErrorCode(a.Cancelled),cause:"Session ended"};i.incomplete({reason:o.cause,errorCode:o.code}),n.reject(o)}else t.updateParticipantToViewer(e,i,r,n)}).catch(function(s){t.logger.error("Failed to negotiate content sharing session: "+(s&&s.code)),t.handleErrorIfIsUnexpected(function(){l?l.handleError(s,e,i,t.call):i.fail({reason:o.getErrorMessage(s&&s.cause||s),errorCode:s&&s.code}),t.callbacks.sessionAddedWithError(r?r.type:void 0,e.contentSharingGuid,s)},s,i),n.reject(s)})},e.prototype.updateParticipantToViewer=function(e,t,i,n){var r=this,s=this.providers[i.type];return this.wrapError(this.toNgPromise(e.updateContentSharingParticipantStateToViewer()),a.SessionUpdateContentSharingParticipantStateToViewerFailed).then(function(){r.logger.info("Successfully updated content sharing session participant state to viewer."),n.resolve(),t.stop()}).catch(function(a){r.logger.error("Failed to update participant state to viewer: "+(a&&a.code)),r.handleErrorIfIsUnexpected(function(){s?s.handleError(a,e,t,r.call):t.fail({reason:o.getErrorMessage(a&&a.cause||a),errorCode:a&&a.code}),r.callbacks.sessionError(i.type,e.contentSharingGuid,a,!1)},a,t),n.reject(a)})},e.prototype.isExpected=function(e){return!!e&&e.code===teamspace.services.ContentSharingErrorCode.Cancelled||e.cause&&12===e.cause.terminatedReason},e.prototype.handleErrorIfIsUnexpected=function(e,t,i){this.isExpected(t)?i.incomplete({reason:t.message,errorCode:t.code,terminatedReason:t.cause&&t.cause.terminatedReason}):e()},e.prototype.sessionAdded=function(e){return this.callbacks.sessionAdded(e)},e.prototype.handleNewOutgoingSession=function(e){this.handleNewOutgoingOrRejoinedSession(e,this.constants.scenarios.contentSharing.presenterJoin)},e.prototype.handleRejoinedSession=function(e){this.handleNewOutgoingOrRejoinedSession(e,this.constants.scenarios.contentSharing.rejoin)},e.prototype.handleNewOutgoingOrRejoinedSession=function(e,t){var i=this,n=this.addActiveContentSharingSession(e.contentSharingGuid),r=null,s=null,c=null,l=this.callingTelemetryService.newContentSharingScenario(this.call,t,e.contentSharingGuid);this.wrapError(this.tryParseContentBasic(e.contentSharingIdentity),a.PresenterFailedToParseSharingContent).then(function(t){return l.mark(i.constants.scenarios.contentSharing.steps.dtoParsed),r=t,i.logger.info("Content sharing information read."),l.appendEventData({type:t.type}),i.setActiveContentSharingSessionType(e.contentSharingGuid,r.type),(s=i.providers[r.type])?s.startOutgoingSession(t,e):i.rethrow(a.NoProviderFound,"No provider for type '"+r.type+"' found")}).then(function(e){return l.mark(i.constants.scenarios.contentSharing.steps.sessionCreated),c=e,i.wrapError(i.sessionAdded(c),a.RendererInitFailed)}).then(function(){i.logger.info("Renderer successfully initialized"),l.mark(i.constants.scenarios.contentSharing.steps.sessionAdded),4!==e.contentSharingStatus?(i.logger.info("Content sharing session rejoin successfully completed"),n.resolve(),l.stop()):i.wrapError(i.toNgPromise(e.updateContentSharingParticipantStateToViewer()),a.SessionUpdateContentSharingParticipantStateToViewerFailed).then(function(){i.logger.info("Content sharing session rejoin successfully completed"),n.resolve(),l.stop()}).catch(function(t){i.logger.error("Failed to update participant state to viewer: "+(t&&t.code)),i.handleErrorIfIsUnexpected(function(){s?s.handleError(t,e,l,i.call):l.fail({reason:o.getErrorMessage(t&&t.cause||t),errorCode:t&&t.code}),i.callbacks.sessionError(r.type,e.contentSharingGuid,t,!1)},t,l),n.reject(t)})}).catch(function(t){i.logger.error("Failed to read content sharing information: "+o.getErrorMessage(t)),i.handleErrorIfIsUnexpected(function(){s?s.handleError(t,e,l,i.call):(i.stopContentSharing(e),l.fail({reason:o.getErrorMessage(t&&t.cause||t),errorCode:t&&t.code})),i.callbacks.sessionError(r?r.type:void 0,e.contentSharingGuid,t,!0)},t,l),n.reject(t)})},e.prototype.handleRemovedSessions=function(){var e=this;this.logger.info("Handling removed sessions (if any) ..."),_.differenceWith(Array.from(this.activeContentSharingSessions.keys()),this.call.contentSharingSessions,function(e,t){return t.contentSharingGuid===e}).forEach(function(t){var i=e.activeContentSharingSessions.get(t);e.logger.info("Removing session "+t+" from active sessions ..."),e.removeActiveContentSharingSession(t),i.readyPromise.finally(function(){e.callbacks.sessionRemoved(i.type,t),e.logger.info("Session "+t+" removed from active sessions")})}),this.logger.info("Handling removed sessions complete")},e.prototype.addActiveContentSharingSession=function(e){var t=this.$q.defer(),i={readyPromise:t.promise};return this.activeContentSharingSessions.set(e,i),t},e.prototype.setActiveContentSharingSessionType=function(e,t){var i=this.activeContentSharingSessions.get(e);i?i.type=t:this.logger.error("Trying to set type on session "+e+" that doesn't exist")},e.prototype.removeActiveContentSharingSession=function(e){this.activeContentSharingSessions.delete(e)},e.prototype.sharingContentDtoFromJson=function(e){return this.utilityService.tryParseJSON(SkypeX.Services.Utilities.base64DecodeToUTF8(e))},e.prototype.stringifySharingContent=function(e){return this.base64EncodeUTF8(JSON.stringify(e))},e.prototype.base64EncodeUTF8=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}))},e.prototype.rethrow=function(e,t){var i={code:e,message:this.translateErrorCode(e),cause:t};return this.$q.reject(i)},e.prototype.startSharingContent=function(e){var t=this,i=this.callingTelemetryService.newContentSharingScenario(this.call,this.constants.scenarios.contentSharing.start,void 0,e.type);try{var n=this.providers[e.type];return n?n.onContentShareStarting(e,i).then(function(){return n.contentShareToDto(e,i)}).then(function(e){return i.mark(t.constants.scenarios.contentSharing.steps.dtoCreated),t.call?t.wrapError(t.toNgPromise(t.call.createContentSharingSession(t.utilityService.generateUUID(),t.stringifySharingContent(e),n.dtoToSubject(e))),a.CallCreateContentSharingSessionFailed):(t.logger.warn("Content sharing service disposed - aborting content sharing ..."),t.rethrow(a.Cancelled,"Content sharing service disposed"))}).then(function(e){return i.appendEventData({correlationId:e.contentSharingGuid}),i.mark(t.constants.scenarios.contentSharing.steps.sessionCreated),t.logger.info("content sharing session "+e.contentSharingGuid+" has been created."),c.isDisconnected(e)?t.rethrow(a.Cancelled,"Session ended"):t.toNgPromise(e.startContentSharing()).catch(function(i){return t.stopContentSharing(e),t.rethrow(a.SessionStartContentSharingFailed,i)})}).then(function(){t.logger.info("created content sharing session has been started."),i.stop()}).catch(function(e){var r=o.getErrorMessage(e);return t.logger.error("An error occured while creating/starting content sharing session: "+r),n.handleStartError(e,i),t.$q.reject(e)}):(i.fail({reason:"No provider for type '"+e.type+"' found",errorCode:a.NoProviderFound}),this.rethrow(a.NoProviderFound,"No provider for type '"+e.type+"' found"))}catch(e){var r=o.getErrorMessage(e);return this.logger.error("An unexpected error occured while starting content sharing session: "+r),!e||e&&12!==e.terminatedReason?i.fail({reason:r,errorCode:e&&e.code}):i.incomplete({reason:r,errorCode:e.code,terminatedReason:e.terminatedReason}),this.$q.reject(e)}},e.prototype.stopContentSharing=function(e){var t=this.callingTelemetryService.newContentSharingScenario(this.call,this.constants.scenarios.contentSharing.stop,e.contentSharingGuid);c.terminateContentSharingSession(e,t,this.logger)},e.prototype.dispose=function(){this.onContentChangedSubscription&&(this.onContentChangedSubscription.dispose(),this.onContentChangedSubscription=null),delete this.activeContentSharingSessions,this.call=null,this.callbacks=null},e.prototype.registerProvider=function(e){this.providers[e.getProvidedType()]=e},e.prototype.translateErrorCode=function(e){switch(e){case a.CallCreateContentSharingSessionFailed:case a.SessionStartContentSharingFailed:case a.PresenterFailedToParseSharingContent:case a.DtoCreationFailed:return this.$translate.instant(this.resources.strings.calling_contentsharing_error_message_presenter_generic_error);case a.SessionJoinContentSharingFailed:return this.$translate.instant(this.resources.strings.calling_contentsharing_error_message_viewer_failed_to_display);case a.SessionUpdateContentSharingParticipantStateToViewerFailed:return this.$translate.instant(this.resources.strings.calling_contentsharing_error_message_viewer_cannot_update_status);case a.ViewerFailedToParseSharingContent:return this.$translate.instant(this.resources.strings.calling_contentsharing_error_message_viewer_has_no_access);case a.RendererInitFailed:default:return this.$translate.instant(this.resources.strings.calling_contentsharing_error_message_viewer_failed_to_display)}},e}();t.ContentSharingService=l,angular.module("teamspace.contentSharingService",["teamspace.constants","teamspace.loggingService","teamspace.settingsService","teamspace.utilityService","teamspace.pptSharingProvider","teamspace.invisionWhiteboardProvider","teamspace.whiteboardProvider"]).service("contentSharingService",l)},function(e,t,i){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var r,s=i(44),a=teamspace.services.ContentSharingErrorCode,o=teamspace.services.CallingTelemetryService,c=teamspace.services.WrsViewerError,l=teamspace.services.files.FilesError,p=teamspace.services.ErrorPayload,u=teamspace.services.ContentSharingError,h=teamspace.services.SessionUtils;!function(e){e[e.PresenterFailedToFetchContentSharingFields=1e3]="PresenterFailedToFetchContentSharingFields",e[e.FailedToFetchTempAuthToken=1003]="FailedToFetchTempAuthToken",e[e.FailedToGetWacUrl=1004]="FailedToGetWacUrl"}(r=t.PPTSharingErrorCode||(t.PPTSharingErrorCode={}));var d=function(){return function(e,t,i,n){this.errorMessage=e,this.httpResponseCode=t,this.contextId=i,this.internalErrorCode=n}}();t.PPTFileError=d;var g=function(){function e(e,t,i,n,r,s,a,o,c,l,p,u){this.$q=e,this.$translate=t,this.resources=i,this.utilityService=n,this.pptSharingTokenService=r,this.sharePointRepositoryDirect=s,this.settingsService=a,this.pptSharingWopiDiscoveryService=o,this.sharePointFileEntityFactory=c,this.constants=l,this.callingTelemetryService=p,this.logger=u.newLogger("PPTSharingProvider"),this.useReadonlySharerTokenForPowerPointSharing=this.settingsService.valueAsBoolean(this.constants.settings.names.useReadonlySharerTokenForPowerPointSharing)}return e.$inject=["$q","$translate","resources","utilityService","pptSharingTokenService","sharePointRepositoryDirect","settingsService","pptSharingWopiDiscoveryService","sharePointFileEntityFactory","constants","callingTelemetryService","loggingService"],e.prototype.getProvidedType=function(){return"ppt"},e.prototype.getShareContent=function(e){return this.$q.resolve([])},e.prototype.onContentShareStarting=function(e){return this.$q.resolve()},e.prototype.contentShareToDto=function(e,t){var i=this,n=this.sharingContentDtoFromSharingContent(e);return this.useReadonlySharerTokenForPowerPointSharing?this.getTempAuthTokenForContent(e).then(function(e){return i.handleScenarioData(t,e.meta),e.data}):this.checkAndRemoveLegacyTokens(n).then(function(e){return i.handleScenarioData(t,e.meta),e.data})},e.prototype.dtoToSubject=function(e){return e.name},e.prototype.startOutgoingSession=function(e,t){var i=this;return this.tryParseSharingContent({data:e}).then(function(e){return new teamspace.services.PPTSharingSession(e.data.type,t.contentSharingGuid,e.data,t,i.utilityService)})},e.prototype.startIncomingSession=function(e,t){var i=this;return this.tryParseSharingContent({data:e}).then(function(e){return new teamspace.services.PPTSharingSession(e.data.type,t.contentSharingGuid,e.data,t,i.utilityService)})},e.prototype.handleStartError=function(e,t){if(e&&e.code===a.Cancelled)this.logger.warn("start content sharing session cancelled: "+e.code),t.incomplete({reason:o.getErrorMessage(e.cause||"Operation cancelled"),errorCode:e.code});else if(e&&e.cause&&e.cause.terminatedReason){i={errorCode:e.code,reason:e.cause.errorMessage,terminatedReason:e.cause.terminatedReason};12===e.cause.terminatedReason?t.incomplete(i):t.fail(i)}else if(e&&e.cause instanceof d){var i={reason:e.cause.errorMessage,errorCode:e.code,contextId:e.cause.contextId,terminatedReason:e.cause.httpResponseCode,failureType:e.cause.internalErrorCode};if(e.cause.internalErrorCode===this.constants.errorCodes.networkOffline)this.logger.error("cannot start content sharing session: "+e.cause.internalErrorCode),t.incomplete(i);else switch(e.cause.httpResponseCode){case 401:case 403:case 404:this.logger.error("cannot start content sharing session: "+e.cause.httpResponseCode),t.incomplete(i);break;default:this.logger.error("cannot start content sharing session: "+(e&&e.code)+" ("+e.cause.httpResponseCode+")"),t.fail(i)}}else this.logger.error("cannot start content sharing session: "+(e&&e.code)),t.fail({reason:o.getErrorMessage(e&&e.cause||e),errorCode:e&&e.code})},e.prototype.handleError=function(e,t,i,n){if(e&&e.cause===teamspace.services.QCancelable.CancelID)i.incomplete({reason:"Operation cancelled",errorCode:e.code});else if(e&&e.cause instanceof c){r={reason:e.cause.errorMessage,correlationId:t&&t.contentSharingGuid,contextId:e.cause.uuid,errorCode:e.code,terminatedReason:e.cause.errorCode,failureType:e.cause.failureType};switch(e.cause.failureType){case 2:case 3:case 4:i.incomplete(r);break;default:i.fail(r)}}else if(e&&e.cause&&e.cause.terminatedReason){var r={errorCode:e.code,reason:e.cause.errorMessage,correlationId:t&&t.contentSharingGuid,terminatedReason:e.cause.terminatedReason,state:t&&t.contentSharingStatus};12===e.cause.terminatedReason?i.incomplete(r):i.fail(r)}else i.fail({reason:o.getErrorMessage(e&&e.cause||e),errorCode:e&&e.code,correlationId:t&&t.contentSharingGuid,state:t&&t.contentSharingStatus});h.isOutgoingSession(t)&&(this.logger.error("Error "+e.code+", terminating PPT sharing for session "+t.contentSharingGuid),this.terminateSession(e,t,n))},e.prototype.terminateSession=function(e,t,i){this.logger.error("Error "+e.code+", terminating PPT sharing for session "+t.contentSharingGuid);var n=this.callingTelemetryService.newContentSharingScenario(i,this.constants.scenarios.contentSharing.pptSharingStop,t.contentSharingGuid);h.terminateContentSharingSession(t,n,this.logger)},e.prototype.tryParseSharingContent=function(e){var t=this;return e.data.contentBundleUrl?this.$q.resolve(e):e.data.fileGetUrl?(e.data.contentBundleUrl=e.data.url,delete e.data.url,this.$q.resolve(e)):this.fetchMissingContentSharingFields(e).then(function(t){return delete e.data.url,t},function(e){return t.$q.reject(t.createPPTFileError(e,r.PresenterFailedToFetchContentSharingFields))})},e.prototype.sharingContentDtoFromSharingContent=function(e){return{data:{type:e.type,id:e.id,name:e.name,url:e.url,contentBundleUrl:e.contentBundleUrl,fileGetUrl:e.fileGetUrl,majorVersion:e.majorVersion,fileSize:e.fileSize}}},e.prototype.spGetFileDetailedInfo=function(e){var t=this;return this.sharePointRepositoryDirect.getFileDetailedInfo(e).catch(function(e){return t.logger.error("Failed to get file detailed info"),t.$q.reject(e)})},e.prototype.spGetPptSharingTokens=function(e){var t=this;return this.pptSharingTokenService.getPptSharingTokens(e).catch(function(e){return t.logger.error("Failed to get PPT Sharing tokens: "+teamspace.services.CallingTelemetryService.getErrorMessage(e)),t.$q.reject(e)})},e.prototype.spGetWacUrl=function(e){var t=this;return this.pptSharingWopiDiscoveryService.getWacUrl(e).catch(function(e){return t.logger.error("Failed to get WAC URL: "+teamspace.services.CallingTelemetryService.getErrorMessage(e)),t.$q.reject(e)})},e.prototype.getTempAuthTokenForContent=function(e){var t,i,s=this,a=h.safeCall(function(){return s.spGetFileDetailedInfo(e.url)}).then(function(e){if(e&&e.spFileDto&&e.spFileDto.spItemUrl){t=s.sharePointFileEntityFactory.create(e.spFileDto,void 0,e.spDto),i=e;var n=t.getFileCommandsUrl();return h.safeCall(function(){return s.spGetPptSharingTokens(n)}).then(function(e){return{fileInfoDto:i,pptSharingTokens:e}},function(e){return s.$q.reject(s.createPPTFileError(e,r.FailedToFetchTempAuthToken))})}return s.$q.reject(s.createPPTFileError("getFileDetailedInfo: No valid itemUrl in the response",r.PresenterFailedToFetchContentSharingFields))},function(e){return s.$q.reject(s.createPPTFileError(e,r.PresenterFailedToFetchContentSharingFields))}),o=h.safeCall(function(){return s.spGetWacUrl(e.url)}).then(function(e){return e},function(e){return s.$q.reject(s.createPPTFileError(e,r.FailedToGetWacUrl))});return this.$q.all([a,o]).then(function(i){var r=i[0],s=i[1],a=r.pptSharingTokens,o=r.fileInfoDto,c=s.wacUrl,l=n({},a.requestIds,{wacUrl:s.requestId});return{data:{type:e.type,id:e.id,name:e.name,url:e.url,contentBundleUrl:t.getContentBundleUrlForCustomFileUrlWithToken(a.proofTokenUrl),fileGetUrl:a.fileGetUrl,majorVersion:t.getMajorVersion(),fileSize:o.spFileDto.size,wacUrl:c},meta:l}})},e.prototype.fetchMissingContentSharingFields=function(e){var t=this;return void 0===e.data.contentBundleUrl&&void 0===e.data.fileGetUrl?this.sharePointRepositoryDirect.getFileDetailedInfo(e.data.url).then(function(i){var n=t.sharePointFileEntityFactory.create(i.spFileDto,void 0,i.spDto);return e.data.contentBundleUrl=n.getContentBundleUrl(),e.data.fileGetUrl=n.getFileGetUrl(),e.data.majorVersion=n.getMajorVersion(),e.data.fileSize=n.getSize(),t.logger.info("File details fetched."),e}).catch(function(e){return t.logger.error("Cannot get file Url"),t.$q.reject(e)}):(this.logger.info("File details already exist."),this.$q.resolve(e))},e.prototype.removeFieldsWithAccessToken=function(e){return(e.data.contentBundleUrl||""===e.data.contentBundleUrl)&&delete e.data.contentBundleUrl,(e.data.fileGetUrl||""===e.data.fileGetUrl)&&delete e.data.fileGetUrl,e},e.prototype.checkAndRemoveLegacyTokens=function(e){var t=this;return this.fetchMissingContentSharingFields(e).then(function(e){return t.logger.info("Missing content sharing fields fetched"),t.removeFieldsWithAccessToken(e)},function(e){return t.$q.reject(t.createPPTFileError(e,r.PresenterFailedToFetchContentSharingFields))})},e.prototype.createPPTFileError=function(e,t){return e instanceof p?new u(t,this.translateErrorCode(t),new d(e.message,e.status,e.headers&&e.headers(this.constants.headers.sharePoint.SPRequestGuid.toLowerCase()),e.code)):e instanceof l?new u(t,this.translateErrorCode(t),new d(e.userErrorMessage,e.httpResponseCode,e.correlationId,e.internalErrorCode)):e instanceof s.ErrorData?new u(t,this.translateErrorCode(t),new d(e.errorMessage,e.statusCode,e.contextId)):new u(t,this.translateErrorCode(t),new d(o.getErrorMessage(e)))},e.prototype.translateErrorCode=function(e){switch(e){case r.PresenterFailedToFetchContentSharingFields:case r.FailedToFetchTempAuthToken:case r.FailedToGetWacUrl:return this.$translate.instant(this.resources.strings.calling_contentsharing_error_message_presenter_has_no_access);default:return this.$translate.instant(this.resources.strings.calling_contentsharing_error_message_viewer_failed_to_display)}},e.prototype.handleScenarioData=function(e,t){e&&t&&e.appendEventData({contextId:JSON.stringify(t)})},e}();t.PPTSharingProvider=g,angular.module("teamspace.pptSharingProvider",["teamspace.utilityService","teamspace.pptSharingTokenService","teamspace.services.files.modules.sharePoint.sharePointRepositoryDirect","teamspace.services.files.modules.sharePoint.sharePointFileEntityFactory","teamspace.settingsService","teamspace.pptSharingWopiDiscoveryService","teamspace.constants","teamspace.loggingService"]).service("pptSharingProvider",g)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(240),i(241),i(242),i(243)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(16),s=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S,y,C,b,T){var I=e.call(this)||this;return I.$q=t,I.$translate=i,I.$interval=n,I.$injector=r,I.authenticationService=s,I.chatConversationFactory=a,I.chatServiceClient=o,I.chatSyncService=c,I.constants=l,I.conversationsStore=p,I.exceptionUtilityService=u,I.loggingService=h,I.peopleService=d,I.resources=g,I.settingsService=v,I.skypeXMembersService=m,I.sxConfig=f,I.syncStateService=S,I.userResourcesSettingsStore=y,I.utilityService=C,I.tenantSettingsStore=b,I.myUserPreferencesStore=T,I.conversationWaitList=[],I.pendingThreads={},I.conversationSuppressList={},I.shouldUseUniqueChatRosters=!1,I.boldLogic2=!1,I.enableSfBGateway=!1,I.logger=I.loggingService.newLogger("ConversationsService"),I.shouldUseUniqueChatRosters=I.settingsService.valueAsBoolean(I.constants.settings.names.uniqueRosterThread)&&!I.settingsService.valueAsBoolean("chatTestMode"),I.allowLeave=I.settingsService.valueAsBoolean(I.constants.settings.names.enableLeaveChat),I.enableShareChatHistory=I.settingsService.valueAsBoolean(I.constants.settings.names.enableShareChatHistory),I.chatTestMode=I.settingsService.valueAsBoolean("chatTestMode"),I.boldLogic2=I.settingsService.valueAsBoolean(I.constants.settings.names.boldLogic2),I.enableSfBGateway=I.settingsService.valueAsBoolean(I.constants.settings.names.enableSfBGateway),I.enableFederatedChat=I.settingsService.valueAsBoolean(I.constants.settings.names.enableFederatedChat),I.conversationsStore.subscribe(function(e,t){return I.trigger(teamspace.services.ConversationsServiceEvents.EventType_All,e,t)},SkypeX.Services.ConversationsStoreEvents.Type_Conversation),I.conversationsStore.subscribe(function(e,t){return I.trigger(teamspace.services.ConversationsServiceEvents.EventType_Batched,e,t)},SkypeX.Services.ConversationsStoreEvents.Type_List),I.conversationsStore.subscribe(function(e,t){var i=e,n=t;i&&n?I.setRemoteConsumptionHorizon(I.getConversation(i),n,!1):(i||I.logger.warn("No conversationId provided when attempting to set consumption horizon: "+n),n||I.logger.warn("No consumption horizon provided when attempting to set consumption horizon for conversation: "+i))},SkypeX.Services.ConversationsStoreEvents.Type_ConsumptionHorizon),I.propagate(I.conversationsStore,SkypeX.Services.ConversationsStoreEvents.Type_TopicChanged,teamspace.services.ConversationsServiceEvents.EventType_TopicChanged),I.propagate(I.conversationsStore,SkypeX.Services.ConversationsStoreEvents.Type_Resolve,teamspace.services.ConversationsServiceEvents.EventType_Resolve),I.conversationsStore.subscribe(I.checkWaitList.bind(I)),I.conversationListInitialSyncStarted=I.chatSyncService.waitForInitialConversationListSyncStart(),I.conversationListSynced=I.chatSyncService.waitForInitialConversationListSync(),I}return n(t,e),t.$inject=["$q","$translate","$interval","$injector","authenticationService","chatConversationFactory","chatServiceClient","chatSyncService","constants","conversationsStore","exceptionUtilityService","loggingService","peopleService","resources","settingsService","skypeXMembersService","sxConfig","syncStateService","userResourcesSettingsStore","utilityService","tenantSettingsStore","myUserPreferencesStore"],t.prototype.ensureConversationCreated=function(e){var t="string"==typeof e?e:e.id,i=this.getCorrespondingConversation(t);if(!i)throw"Unable to find conversation with id "+t;if(i.isLie()){var n=i.clone();return n.isSfB()?this.createSfBConversation(n):n.isFederated()?this.createFederatedConversation(n):this.createChatConversation(n)}return this.$q.when(i)},t.prototype.getChatConversationWith=function(e){if(e){var t=this.getChatConversationMris(e);if(t.length<2)throw this.constants.prependedErrorMessages.tooFewUsers+t.length;var i=this.findChatConversationWithRoster(t);if(!i){var n=t.map(function(e){return{id:e,isReader:!1}}),r=this.conversationsStore.createChatConversationLie(n);this.conversationsStore.addOrUpdateConversation(r),i=r}return this.chatConversationFactory.fromConversation(i,null)}return null},t.prototype.getPrivateChatUserMri=function(e,t,i){return void 0===i&&(i=!0),e?this.getUserChatMode(e,t,i)===teamspace.middletier.ChatMode.SfB?teamspace.services.SfBInteropUtilsService.asSfBMri(e.mri):e.mri:null},t.prototype.findConversationWith=function(e){if(!e||_.isArray(e)&&0===e.length)return null;var t=this.getChatConversationMris(e);return this.findChatConversationWithRoster(t)},t.prototype.findChatConversationWith=function(e){var t=this.findConversationWith(e);return t?this.chatConversationFactory.fromConversation(t,null):null},t.prototype.getConversationLieWith=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=!1);var n=null,r=[];if(e&&(r=[{id:this.sxConfig.getCurrentSkypeMri(),isReader:!1}],!_.isArray(e)&&SkypeX.Services.ChatServiceUtils.isMri(e)?r.push({id:e,isReader:!1}):_.isArray(e)&&_.forEach(e,function(e){SkypeX.Services.ChatServiceUtils.isMri(e)&&r.push({id:e,isReader:!1})})),r.length>1){var s=i?{threadType:SkypeX.Services.ChatServiceUtils.ThreadType_SfbInteropChat,isFederated:"true"}:void 0;n=t?this.conversationsStore.createChatConversationLie(r,{topic:t}):this.conversationsStore.createChatConversationLie(r,s),this.conversationsStore.addOrUpdateConversation(n,!1)}else this.logger.warn("Attempt to get a lie conversation with invalid mris: "+e);return n},t.prototype.getChatConversationMris=function(e){var t=_.uniq([].concat(e).concat(this.sxConfig.getCurrentSkypeMri()));return t.length>2?t.map(function(e){return teamspace.services.SfBInteropUtilsService.asTeamsMri(e)}):t},t.prototype.groupIdMatches=function(e,t){if(!this.enableFederatedChat&&e.isFederated())return!1;if(teamspace.services.SfBInteropUtilsService.isLegacySfBGatewayConversation(e.id))return!1;var i=this.settingsService.valueAsBoolean(this.constants.settings.names.enableSideloadedAppsInGroupChat);i&&t&&t.length>2&&(t=_.filter(t,function(e){return!SkypeX.Services.ChatServiceUtils.isBotMri(e)}));var n=(i&&e.members&&e.members.length>2?e.userMembers:e.members||[]).map(function(e){return e.id.toLowerCase()}).sort().join(","),r=t.map(function(e){return e.toLowerCase()}).sort().join(",");if(this.enableSfBGateway){if(t.some(function(e){return teamspace.services.SfBInteropUtilsService.isSfBMri(e)})&&e.isSfB()&&!e.isSfBLie())r=t.map(function(e){return teamspace.services.SfBInteropUtilsService.asTeamsMri(e).toLowerCase()}).sort().join(",");else if(t.every(function(e){return!teamspace.services.SfBInteropUtilsService.isSfBMri(e)}))return n===r&&!e.isSfB()}else if(teamspace.services.SfBInteropUtilsService.isSfBGatewayConversation(e.id))return!1;return n===r},t.prototype.findChatConversationWithRoster=function(e){var t=this;e=_.uniq(e.concat(this.sxConfig.getCurrentSkypeMri()));var i=this.conversationsStore.dangerousGetConversationsMutable().filter(function(e){return e.isChat()&&!e.isMeetingConversation()&&!e.isDeleted()&&!e.isThreadDead()}),n=null;return _.find(i,function(i){var r=!1;return t.groupIdMatches(i,e)&&((r=i.id.indexOf(t.constants.uniqueRosterSuffix)>=0)||n&&!(n&&i.lastMessageTimeUtc>=n.lastMessageTimeUtc)||2===e.length&&!i.isOneOnOne()||(n=i)),!t.chatTestMode&&r})||n},t.prototype.getCorrespondingConversation=function(e){var t=this.getConversation(e);return!t&&SkypeX.Services.SkypeConversationLocal.isLie(e)&&(t=_.find(this.conversationsStore.dangerousGetAllConversationsMutable(),function(t){return t.localClientId===e})||null),t},t.prototype.getConversation=function(e){return this.conversationsStore.getConversation(e)},t.prototype.getConversationSyncState=function(e){return this.conversationsStore.getConversationSyncState(e)},t.prototype.isConversationChat=function(e){return this.conversationsStore.isConversationChat(e)},t.prototype.isConversationGroupChat=function(e){return this.conversationsStore.isConversationGroupChat(e)},t.prototype.getConversations=function(e){var t=this.conversationsStore.dangerousGetConversationsMutable();e&&(t=t.filter(e));for(var i=0;i<t.length;++i)t[i]=this.conversationsStore.getConversation(t[i].id);return t},t.prototype.getAllConversations=function(e){var t=this.conversationsStore.dangerousGetAllConversations();return e&&(t=t.filter(e)),t},t.prototype.getChatConversations=function(){var e=this;return this.conversationsStore.dangerousGetConversationsMutable().filter(function(t){return t.isChat()&&(e.allowLeave||t.isUserMember(e.sxConfig.getCurrentSkypeMri()))&&t.members&&t.members.length>1})},t.prototype.getChatConversation=function(e,t){void 0===t&&(t=!0);var i=this.conversationsStore.dangerousGetConversationMutable(e);return i&&i.isChat()&&(t&&this.allowLeave||i.isUserMember(this.sxConfig.getCurrentSkypeMri()))?i:null},t.prototype.getCorrespondingChatConversation=function(e){var t=this.getCorrespondingConversation(e);return t&&(this.allowLeave||t.isUserMember(this.sxConfig.getCurrentSkypeMri()))?this.chatConversationFactory.fromConversation(t,null):null},t.prototype.getCallingConversation=function(e){return new teamspace.services.CallingConversation(e,this.$q,this,this.conversationsStore,this.settingsService)},t.prototype.waitForConversationsListInitialSyncStart=function(){return this.conversationListInitialSyncStarted},t.prototype.waitForConversationsSynced=function(){return this.conversationListSynced},t.prototype.addUsersToConversation=function(e,t,i){var n,r=this,s="string"==typeof t?[t]:t,a=this.conversationsStore.getConversation(e);return a&&(n=SkypeX.Services.SyncTasks.fromNgPromise(this.peopleService.getAllPeopleProfile(s,"conversationsService-addUser").then(function(t){var n;if(t.forEach(function(e){if(e){var t={id:e.mri,isReader:!1};a.isLie()||(t.role=e.userType===r.constants.userTypes.guest?r.constants.RoleConstants.Guest:r.constants.RoleConstants.Admin),(n=n||[]).push(t)}}),r.conversationsStore.patchConversation(a.id,function(e){e.members=e.members.concat(n)}),!a.isVirtual()){if(r.enableShareChatHistory){if(i<-1)return SkypeX.Services.SyncTasks.Rejected();_.isNil(i)&&(i=-1)}else i=void 0;return r.chatServiceClient.addMembersToThread(e,n,null,i).then(function(){},function(){r.conversationsStore.patchConversation(a.id,function(e){s.forEach(function(t){e.members=_.reject(e.members,function(e){return e.id===t})})})})}}))),n||SkypeX.Services.SyncTasks.Rejected("No conversation for id: "+e)},t.prototype.setRemoteConsumptionHorizon=function(e,t,i){var n=this;if(e)if(e.isVirtual())this.logger.warn("tried to set the remote consumptionHorizon for a local-only conversation: {0}",e.id);else if(this.authenticationService.isAnonymous())this.logger.log("Skipping setting horizon for anonymous users until it is supported on the server side.");else{var r=SkypeX.Services.SkypeConversationLocal.getConsumptionHorizonParts(t);if(!r)throw"Unable to parse consumptionHorizon: "+t;var s=e.getConsumptionHorizonOriginalArrivalTime(),a=r.originalArrivalTime;if(s<=a||i){var o=i?this.constants.scenarios.consumptionHorizonBookmark:this.constants.scenarios.consumptionHorizon,c=this.loggingService.newScenario(o);this.logger.debug("Setting consumption horizon for conversation id: {0} to: {1}",e.id,t),this.chatServiceClient.setConversationConsumptionHorizon(e.id,t,i).then(function(){c.stop()},function(i){n.logger.error("Error occured while updating the consumptionhorizon {0} for conversation {1}",t,e.id),n.exceptionUtilityService.failScenarioSelectively(c,i,null,[])})}else this.logger.warn("Tried to rollback the remote consumptionHorizon, which is disallowed: {0}",a)}else this.logger.warn("tried to set the consumptionHorizon for a non-exisiting conversation")},t.prototype.setConsumptionHorizon=function(e,t,i,n){var r=this;void 0===n&&(n=!1);var s=this.getConversation(e);if(s){var a=s.getConsumptionHorizonOriginalArrivalTime();if(!(a>=t)||n){var o,c,l,p;if(n?(o=SkypeX.Services.ChatServiceUtils.ConversationProp_ConsumptionHorizonBookmark,l=this.constants.scenarios.consumptionHorizonBookmarkClientOnly,c=this.constants.scenarios.consumptionHorizonBookmark):(o=SkypeX.Services.ChatServiceUtils.ConversationProp_ConsumptionHorizon,l=this.constants.scenarios.consumptionHorizonClientOnly,c=this.constants.scenarios.consumptionHorizon),this.boldLogic2)p=this.conversationsStore.setLocalConsumptionHorizon(e,t,i,n),this.setRemoteConsumptionHorizon(s,p,n);else{p=SkypeX.Services.SkypeConversationLocal.buildConsumptionHorizon(t,i);var u=this.loggingService.newScenario(l);if(this.conversationsStore.patchConversation(e,function(e){e.properties[o]=p}).then(function(){u.stop()},function(t){r.logger.error("Error occurred while updating consumption horizon for thread {0} locally on client: {1}",e,t),u.fail({error:t})}),!s.isVirtual()&&!this.authenticationService.isAnonymous()&&(n||a<t)){var h=this.loggingService.newScenario(c);this.logger.debug("Setting consumption horizon for conversation id: {0} to: {1}",s.id,p),this.chatServiceClient.setConversationConsumptionHorizon(s.id,p,n).then(function(){h.stop()},function(t){r.logger.error("Error occured while updating the consumptionhorizon {0} for conversation {1}",p,e),r.exceptionUtilityService.failScenarioSelectively(h,t,null,[])})}}}}},t.prototype.getActiveTeamsChannelsConversations=function(){var e=this;return _.filter(this.conversationsStore.dangerousGetAllConversationsMutable(),function(t){return e.isActiveTeamOrChannel(t)})},t.prototype.isTeam=function(e){return this.isSpaceThread(e)&&!this.isLinkedThread(e)},t.prototype.isLinkedChannel=function(e){return this.isSpaceThread(e)&&this.isLinkedThread(e)},t.prototype.isChannel=function(e){return e&&e.threadProperties&&e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]===SkypeX.Services.ChatServiceUtils.ThreadType_Topic||this.isLinkedChannel(e)},t.prototype.isActiveTeamOrChannel=function(e){return!(!this.isChannel(e)||this.isLinkedChannel(e))||!(!this.isTeam(e)&&!this.isLinkedChannel(e))&&e.isUserMember()},t.prototype.isPersisted=function(e){return this.conversationsStore.isPersisted(e)},t.prototype.isSynced=function(e,t){return void 0===t&&(t=SkypeX.Services.SyncStatusResource.Messages),this.conversationsStore.isSynced(e,t)},t.prototype.isLinkedThread=function(e){return e.threadProperties&&!!e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ParentSpaces]},t.prototype.isSpaceThread=function(e){return e&&e.threadProperties&&e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]===SkypeX.Services.ChatServiceUtils.ThreadType_Team},t.prototype.validateTopicAndGetError=function(e){var t=null;return e?(e.contains(":")&&(t=this.$translate.instant(this.resources.strings.chats_saveTitle_invalidChar,{invalidChar:":"})),e.length>this.constants.p2p.groupChat.maxChatNameLength&&(t=this.$translate.instant(this.resources.strings.chats_saveTitle_maxReached,{maximum:this.constants.p2p.groupChat.maxChatNameLength})),t):null},t.prototype.setTopic=function(e,t,i){var n=this;if(e){t&&""!==t.trim()||(t=null);var r=this.validateTopicAndGetError(t);if(r)return i&&i.mark("invalid_topic"),this.$q.reject(r);var s=this.conversationsStore.getConversation(e);return!s||s.topicName()!==t&&(t||s.topicName())?(i&&i.mark("setting_thread_property"),this.chatServiceClient.setThreadProperty(e,SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName,t).toNgPromise(this.$q).then(function(){i&&i.mark("thread_property_set");var r=n.conversationsStore.getConversation(e);return r&&n.conversationsStore.patchConversation(r.id,function(e){e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName]=t,i&&i.mark("lying_locally")}),n.$q.when(!0)},function(t){return n.logger.warn("Failed to set conversation "+e+". Error: "+JSON.stringify(t)),n.$q.when(!1)})):(i&&i.mark("topic_unchanged"),this.$q.when(!0))}return this.$q.when(!1)},t.prototype.setChatVisibility=function(e,t){var i=this,n=this.loggingService.newScenario(this.constants.scenarios.messaging.hideChat);if(n.eventData.conversationId=e,e){if(this.conversationsStore.getConversation(e)){var r=t?null:Date.now();return this.chatServiceClient.setConversationProperty(e,SkypeX.Services.ChatServiceUtils.ConversationProp_HiddenTime,r).toNgPromise(this.$q).then(function(){var t=i.conversationsStore.getConversation(e);return t&&i.conversationsStore.patchConversation(t.id,function(e){e.properties[SkypeX.Services.ChatServiceUtils.ConversationProp_HiddenTime]=r}),n.stop(),i.$q.when(!0)},function(s){var a="Failed to "+(t?"unhide":"hide")+" chat - "+s+". ConversationId: "+e+". HiddenTime: "+r;return i.logger.error(a),n.fail({error:"set_chat_visibility_error",errorInfo:a}),SkypeX.Services.SyncTasks.Rejected()})}var s="Failed to "+(t?"unhide":"hide")+" chat - invalid conversationId: "+e;return this.logger.error(s),n.fail({error:"set_chat_visibility_invalid_id",errorInfo:s}),SkypeX.Services.SyncTasks.Rejected()}return SkypeX.Services.SyncTasks.Rejected()},t.prototype.leaveConversation=function(e){var t=this,i=e?this.conversationsStore.getConversation(e):null;if(e&&i&&i.isChat()&&i.canUserLeaveGroupChat()){var n=Date.now();return this.conversationsStore.patchConversation(i.id,function(e){e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastLeaveAt]=n}),this.chatServiceClient.removeMemberFromThread(e,this.sxConfig.getCurrentSkypeMri()).toNgPromise(this.$q).then(function(){},function(n){return t.conversationsStore.patchConversation(i.id,function(e){e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastLeaveAt]=null}),t.logger.error("Error occured while leaving chat {0}",e),SkypeX.Services.SyncTasks.Rejected()})}return e&&i?i.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_LastLeaveAt]?(this.logger.error("leaveConversation: lastleaveat is already set, indication that user left this conversation"),SkypeX.Services.SyncTasks.Rejected()):(this.logger.error("leaveConversation: something went wrong"),SkypeX.Services.SyncTasks.Rejected()):(this.logger.error("leaveConversation: conversationId is invalid"),SkypeX.Services.SyncTasks.Rejected())},t.prototype.markThreadAsDeletedAndRemoveFromStore=function(e,t){return this.getConversation(e)?this.conversationsStore.markThreadAsDeletedAndRemoveFromStore(e,t):this.$q.when()},t.prototype.markConversationAsPending=function(e){var t=this.$q.when();if(SkypeX.Services.SkypeConversationLocal.isLie(e)){var i=this.getConversation(e);i&&(t=this.conversationsStore.patchConversation(i.id,function(e){e.isPending=!0}))}return t},t.prototype.postInvokeMessageWithUserInfo=function(e,t,i,n,s,a,o,c,l){var p=this;void 0===n&&(n="Unknow Caller");var u={threadId:e,botMri:t,value:i,clientMessageId:a,serverMessageId:o,messageType:c,text:l,name:s,imdisplayName:null},h=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.postInvoke);return h.eventData={caller:n},this.skypeXMembersService.getCurrentUser().then(function(e){var i=e.displayname||e.displayName;return u.imdisplayName=i,p.chatServiceClient.postInvoke(u).toNgPromise(p.$q).then(function(e){return h.stop(),e}).catch(function(e){var i={error:JSON.stringify(r.InvokeErrorHelper.scrubPayloadForLogging(e)),botId:t,caller:n};throw e&&e.errorCode&&(e.errorCode===SkypeX.Services.ChatServiceUtils.BotFailureErrorCode||e.errorCode===SkypeX.Services.ChatServiceUtils.SyncErrorCode_NoAccess)?h.stop(i):h.fail(i),e})},function(i){return p.logger.error("Error {0} occured while getting the imdisplayname for thread {1}",i,e),p.chatServiceClient.postInvoke(u).toNgPromise(p.$q).then(function(e){return h.stop(),e}).catch(function(e){var i={error:JSON.stringify(r.InvokeErrorHelper.scrubPayloadForLogging(e)),botId:t,caller:n};throw e&&e.errorCode&&(e.errorCode===SkypeX.Services.ChatServiceUtils.BotFailureErrorCode||e.errorCode===SkypeX.Services.ChatServiceUtils.SyncErrorCode_NoAccess)?h.stop(i):h.fail(i),e})})},t.prototype.updateLastMessage=function(e,t){var i=this.getConversation(e);i&&(t.originalArrivalTimeUtc>i.lastMessageTimeUtc||t.id===i.lastMessageId&&(t.editTime!==SkypeX.Services.SkypeMessageLocal.getEditTime(i.lastMessage)||t.deleteTime!==SkypeX.Services.SkypeMessageLocal.getDeleteTime(i.lastMessage)))&&this.conversationsStore.patchConversation(i.id,function(e){e.lastMessage=t.clone()})},t.prototype.updateNameHints=function(e,t){var i=this.conversationsStore.dangerousGetConversationMutable(e),n=!1;return i?(n=_.some(i.members,function(e){return!_.isNil(t[e.id])}))?this.conversationsStore.patchConversation(i.id,function(e){_.forEach(e.members,function(e){var i=t[e.id];i&&(e.nameHint=i)})},n):this.$q.when():this.$q.reject("Unknown conversation ID")},t.prototype.waitForConversationSynced=function(e){var t,i=this;if("string"==typeof e)t=function(){return i.conversationsStore.getConversation(e)};else{var n=e;t=function(){return _.find(i.conversationsStore.dangerousGetConversationsMutable(),n)}}var r=t();if(r)return this.$q.when(r);var s=this.$q.defer();return this.conversationWaitList.push({fetch:t,deferred:s}),s.promise},t.prototype.waitForChatConversationSynced=function(e){var t=this;return this.waitForConversationSynced(e).then(function(e){return e&&(t.allowLeave||e.isUserMember(t.sxConfig.getCurrentSkypeMri()))?t.chatConversationFactory.fromConversation(e,null):null})},t.prototype.initSyncState=function(e){var t=this.syncStateService.getSyncState(e.id)||new SkypeX.Services.Sync.TeamsObjectSyncState(e.id);t.messageHistoryStartTime=1,t.isSyncedToStartOfTime=!0,t.messagesStale=!1,this.syncStateService.addUpdateSyncState([t]),e.messageHistoryStartTime=1,e.isSyncedToStartOfTime=!0,e.messagesStale=!1},t.prototype.markConversationAsSynced=function(e){var t=this;return this.conversationsStore.patchConversation(e.id,function(e){t.initSyncState(e)}).then(function(){return t.conversationsStore.getConversation(e.id)})},t.prototype.suppressToast=function(e,t){var i=this;this.isToastSuppressed(e)&&this.cancelToastSuppression(e),this.conversationSuppressList[e]=this.$interval(function(){delete i.conversationSuppressList[e]},t,1)},t.prototype.isToastSuppressed=function(e){return angular.isObject(this.conversationSuppressList[e])},t.prototype.cancelToastSuppression=function(e){this.isToastSuppressed(e)&&(this.$interval.cancel(this.conversationSuppressList[e]),delete this.conversationSuppressList[e])},t.prototype.checkWaitList=function(){this.conversationWaitList.forEach(function(e){e.conversation=e.fetch()});for(var e=0;e<this.conversationWaitList.length;e++){var t=this.conversationWaitList[e];t.conversation&&(t.deferred.resolve(t.conversation),t.resolved=!0)}this.conversationWaitList=_.reject(this.conversationWaitList,"resolved")},t.prototype.createFederatedConversation=function(e){var t=this;if(this.enableFederatedChat){var i=this.sxConfig.getCurrentSkypeMri(),n=e.getOtherMembers(i);1!=n.length&&this.$q.reject("federated chat should have only 1 recipient");var r=void 0,s=teamspace.services.SfBInteropUtilsService.isTemporaryFederationUserMri(n[0]);if(s){var a=teamspace.services.SfBInteropUtilsService.getSipAddressFromTemporaryFederationUserMri(n[0]);r=this.peopleService.searchFederated(a,!1).resolvedProfile}else r=this.peopleService.searchFederatedUsersByMri([n[0]],"conversations-service");var o=!1;return r.then(function(i){if(o=!0,s){t.logger.info("Resolved external user : "+n[0]);var r=_.findIndex(e.members,function(e){return e.id===n[0]});e.members[r].id=i.mri,t.conversationsStore.addOrUpdateConversation(e)}return e.threadProperties||(e.threadProperties={}),e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]=SkypeX.Services.ChatServiceUtils.ThreadType_SfbInteropChat,e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_IsFederated]="true",t.createChatConversation(e)}).catch(function(e){return o?e&&403===e.statusCode&&206===e.errorCode&&(e._errorCode=t.constants.errorCodes.federatedConversationAclCheckFailed):(e&&(e._errorCode=t.constants.errorCodes.federatedUserResolutionFailed),t.logger.error("Error resolving external user : "+e)),t.$q.reject(e)})}return this.$q.reject("Cannot create federated conversation as federation chats feature is disabled")},t.prototype.createSfBConversation=function(e){if(this.enableSfBGateway)return e.threadProperties||(e.threadProperties={}),e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]=SkypeX.Services.ChatServiceUtils.ThreadType_SfbInteropChat,this.createChatConversation(e);var t=this.conversationsStore.getConversation(e.id).clone();t.id=teamspace.services.SfBInteropUtilsService.MriNamespace_SfBThread+this.utilityService.generateUUID()+"@"+this.constants.uniqueRosterSuffix;var i=_.map(e.members,function(e){return e.id.toLowerCase()}).sort().join(","),n={};return n[SkypeX.Services.ChatServiceUtils.ThreadProp_GroupId]=i,n[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]=SkypeX.Services.ChatServiceUtils.ThreadType_Chat,t.threadProperties=n,this.initSyncState(t),this.conversationsStore.resolveLie(e,t),this.$q.resolve(t)},t.prototype.createChatConversation=function(e){var t=this,i=SkypeX.Services.ChatServiceUtils.ThreadType_Chat,n=this.enableSfBGateway&&e.isSfB(),r=e.isFederated(),s=this.userResourcesSettingsStore.getSettingValue(SkypeX.Services.UserResourcesStorageKey.isSfbCloud),a=e.members.map(function(e){return!n&&s?e.id:teamspace.services.SfBInteropUtilsService.getOriginalId(e.id)}),o=function(e){return(e.members||[]).map(function(e){return e.id.toLowerCase()}).sort().join(",")},c=o(e);n?(c=(a||[]).map(function(e){return e.toLowerCase()}).sort().join(","),e.threadProperties&&e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]&&(i=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType])):r&&e.threadProperties&&e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]&&(i=e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]);var l=this.pendingThreads[c];if(!l){var p=null,u={};u[SkypeX.Services.ChatServiceUtils.ThreadProp_ThreadType]=i,u[SkypeX.Services.ChatServiceUtils.ThreadProp_P2PChatFilesIndexId]=SkypeX.Services.ChatServiceUtils.ThreadProp_P2PChatFilesIndexId_Value,r&&(u[SkypeX.Services.ChatServiceUtils.ThreadProp_IsFederated]="true"),this.shouldUseUniqueChatRosters&&e.isOneOnOne()&&(u[SkypeX.Services.ChatServiceUtils.ThreadProp_P2PChatUniqueRosterThread]="true",u[SkypeX.Services.ChatServiceUtils.ThreadProp_P2PChatFixedRosters]="true");var h=null;SkypeX.Services.SkypeConversationLocal.isLie(e.id)&&(h=e.threadProperties&&e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName]?e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName]:null);var d=this.waitForConversationSynced(function(e){var i=!0;if(!p||e.id!==p){var n=o(e);i=!e.isLie()&&0==t.getConversationSyncState(e.id).conversationVersion&&n===c}return i}).then(function(i){var n=i.clone();n.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TopicName]=h;var r=t.loggingService.newScenario("newchat_lie_to_real");return r.eventData={id:p},n&&n.getOtherMembers&&e&&e.getOtherMembers&&n.getOtherMembers.length!==e.getOtherMembers.length?r.fail({error:"mris do not match in the lie and real chat",lieChatMembersLength:e.getOtherMembers.length,realChatMembersLength:n.getOtherMembers.length}):r.stop(),t.conversationsStore.resolveLie(e,n),n}),g=this.peopleService.getAllPeopleProfile(a,"conversationsService-createChat").then(function(i){var n=_.map(i,function(e){var i;return e&&(i={id:e.mri,role:e.userType===t.constants.userTypes.guest?t.constants.RoleConstants.Guest:e.type===t.constants.pstn.userType?t.constants.RoleConstants.User:t.constants.RoleConstants.Admin}),i}),r=t.logCreateThreadInfo(n),s=(new Date).toISOString();return t.chatServiceClient.createThread(n,h,u).toNgPromise(t.$q).then(function(i){p=i.threadId;var n=(t.conversationsStore.getConversation(p)||t.conversationsStore.getConversation(e.id)).clone();return n.id=p,n&&n.isOneOnOne()&&r.mark("create_new_oneonone",{id:n.id,fetchTime:s,clientArrivalTime:n.clientArrivalTime}),r&&r.stop(),201===i.status&&t.initSyncState(n),t.conversationsStore.addOrUpdateConversation(n),p}).catch(function(e){return delete t.pendingThreads[c],e._errorCode=t.constants.errorCodes.threadCreationFailed,t.$q.reject(e)})});return(l=this.$q.all([g,d]).then(function(e){return e[1]})).then(function(){return delete t.pendingThreads[c]}),this.pendingThreads[c]=l,l}return l},t.prototype.getUserChatMode=function(e,t,i){if(!e||e.isFederated||!SkypeX.Services.ChatServiceUtils.isRealUserMri(e.mri))return this.logger.info("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or isFederated or is not a real user mri"),teamspace.middletier.ChatMode.Teams;var n=teamspace.services.SfBInteropUtilsService.isSfBMri(e.mri),r=e.skypeTeamsInfo&&e.skypeTeamsInfo.isSkypeTeamsUser,s=SkypeX.Services.ChatServiceUtils.isChatEnabledForUser(e),a=teamspace.services.SfBInteropUtilsService.isSfbEligible(this.userResourcesSettingsStore),o="getUserChatMode - callerInfo: "+t+", mri: "+e.mri+", isShortProfile: "+e.isShortProfile+", isSfbMri: "+n+", isTeamsChatEnabled: "+s+", hasLoggedInToTeams: "+r+", isSipDisabled: "+e.isSipDisabled;if(this.enableSfBGateway){var c=this.settingsService.valueAsBoolean(this.constants.settings.names.useChatsCoexistenceMode),l=e.featureSettings&&e.featureSettings.coExistenceMode,p=teamspace.services.SfbTeamsUpgradePolicyMode[l];if(i&&this.logger.info(o+" - coExistenceFeatureEnabled: "+c+", coExistenceMode: "+teamspace.services.SfbTeamsUpgradePolicyMode[p]+", MT coExistenceMode: "+l),teamspace.services.SfbTeamsUpgradePolicyMode[p]!==l&&this.logger.error("getUserChatMode - Mapping error - coExistenceMode : "+teamspace.services.SfbTeamsUpgradePolicyMode[p]+", MT coExistenceMode: "+l),c&&p){var u=[teamspace.services.SfbTeamsUpgradePolicyMode.SfBOnly,teamspace.services.SfbTeamsUpgradePolicyMode.SfBWithTeamsCollab,teamspace.services.SfbTeamsUpgradePolicyMode.SfBWithTeamsCollabAndMeetings],h=[teamspace.services.SfbTeamsUpgradePolicyMode.TeamsOnly,teamspace.services.SfbTeamsUpgradePolicyMode.Islands,teamspace.services.SfbTeamsUpgradePolicyMode.IslandsWithVoipDeepLinking];if(u.includes(p))return teamspace.middletier.ChatMode.SfB;if(h.includes(p))return teamspace.middletier.ChatMode.Teams}if((n||!r||!s)&&!e.isSipDisabled&&a)return teamspace.middletier.ChatMode.SfB}else{var d=teamspace.services.SfBInteropUtilsService.isInteropEnabled(this.constants,this.settingsService,this.tenantSettingsStore,this.myUserPreferencesStore,null);if(i&&this.logger.info(o+" - isInteropEnabled: "+d),d&&(n||!r||!s)&&!e.isSipDisabled&&a)return teamspace.middletier.ChatMode.SfB}return teamspace.middletier.ChatMode.Teams},t.prototype.logCreateThreadInfo=function(e){var t=this,i=this.loggingService.newScenario("createThread");if(i){console.log(e);var n,r=this.sxConfig.getCurrentSkypeMri(),s=_.partition(e,function(e){return!!e&&(e.id===r&&(n=e.role),e.role===t.constants.RoleConstants.Guest||e.role===t.constants.RoleConstants.User)}),a=s[0],o=s[1],c=_.partition(a,function(e){return!!e&&e.role===t.constants.RoleConstants.Guest}),l=c[0],p=c[1];i.mark("create_thread",{creator_role:n,num_admins:_.isEmpty(o)?0:o.length,num_guests:_.isEmpty(l)?0:l.length,num_users:_.isEmpty(p)?0:p.length})}else this.logger.warn("Unable to log information on creating the thread");return i},t.prototype.getTeamFromConversation=function(e){if(e){var t=this.getConversation(e);if(t){if(this.isTeam(t))return t;if(this.isChannel(t))return this.getConversation(t.teamId)}}},t.prototype.isConversationInDifferentTenant=function(e){var t=this;if(this.authenticationService.isAnonymous())return!0;var i=this.authenticationService.getLoggedInUser().profile.tid,n=this.callingService.getAllCalls();return n&&n.some(function(n){var r=t.callingService.getCallTenantId(n.teamsCallId);return r&&r!==i&&n.conversationId===e})},Object.defineProperty(t.prototype,"callingService",{get:function(){return this.$injector.get("callingService")},enumerable:!0,configurable:!0}),t}(SkypeX.Services.ObservableBase);t.ConversationsServiceImplementation=s,angular.module("teamspace.conversationsService",["pascalprecht.translate","teamspace.authenticationService","teamspace.callingService","teamspace.chatConversationFactory","skypeX.chatServiceClient","skypeX.chatSyncService","teamspace.constants","skypeX.conversationsStore","teamspace.exceptionUtilityService","teamspace.loggingService","teamspace.peopleService","teamspace.settingsService","skypeX.skypeXMembersService","skypeX.sxConfig","skypeX.userResourcesSettingsStore","teamspace.utilityService","skypeX.myUserPreferencesStore","skypeX.tenantSettingsStore","skypeX.mruChannelsService"]).service("conversationsService",s)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.NoTitle=0]="NoTitle",e[e.OldAndNotSelected=1]="OldAndNotSelected",e[e.FeatureDisabled=2]="FeatureDisabled",e[e.HiddenChat=3]="HiddenChat",e[e.HiddenPrivateMeeting=4]="HiddenPrivateMeeting",e[e.UserIsNotMemeber=5]="UserIsNotMemeber",e[e.InvalidChat=6]="InvalidChat"}(r||(r={}));var s;!function(e){e[e.GotTitle=0]="GotTitle",e[e.RecentOrSelected=1]="RecentOrSelected",e[e.FeatureEnabled=2]="FeatureEnabled",e[e.NoLongerHiddenChat=3]="NoLongerHiddenChat",e[e.NoLongerHiddenPrivateMeeting=4]="NoLongerHiddenPrivateMeeting",e[e.UserIsMemberAgain=5]="UserIsMemberAgain",e[e.ChatIsValid=6]="ChatIsValid"}(s||(s={}));var a=function(e){function t(i,n,r,s,a,o,c,l,p,u,h,d,g,v,m,f,S,y,C,b,T,I){var w=e.call(this)||this;w.$q=i,w.$translate=n,w.activeCallsService=r,w.botService=s,w.chatConversationFactory=a,w.chatServiceClient=o,w.chatSyncPriorityService=c,w.chatTitlesService=l,w.constants=p,w.conversationsService=u,w.dialogService=h,w.localMessageStorageService=d,w.loggingService=g,w.myUserPreferencesStore=v,w.userResourcesSettingsStore=m,w.peopleService=f,w.resources=S,w.settingsService=y,w.sxConfig=C,w.utilityService=b,w.notificationsStore=T,w.offlineActionService=I,w.allowSyncComplete=!1,w.selectedChatId="",w.hoistedChat=null,w.unreadCountFromChatList=0,w.shouldLogDisplayReasons=!1,w.enableFederatedChat=!1,w.rejectionMaps={},w.acceptanceMaps={},w.enableMessageSendFailureIndicator=!1,w.voiceAppsEnabled=!1,w.enableSfBGateway=!1,w.initialLoadCompleted=!1,w.logger=w.loggingService.newLogger("chatListService"),w.triggerLogger=function(e){return w.logger.error("trigger error: {0}",e?e.message:"")},w.chatsWithEmptyMembers=[],w.chatMaps=[],w.chatArrays=[];for(var k=teamspace.services.ChatListType.PINNED;k<teamspace.services.ChatListType.MAX;k++)w.chatMaps.push(null),w.chatArrays.push(null);return w.enableLocalFirstRendering=w.settingsService.valueAsBoolean(w.constants.settings.names.enableLocalFirstRendering),w.enableMultipleChatDrafts=y.valueAsBoolean(p.settings.names.enableMultipleChatDrafts),w.enableFederatedChat=y.valueAsBoolean(p.settings.names.enableFederatedChat),w.contactsInChatAvailable=w.settingsService.valueAsBoolean(p.settings.names.enableBuddyList),w.voiceAppsEnabled=w.settingsService.valueAsBoolean(w.constants.settings.names.enableVoiceApps),w.enableSfBGateway=w.settingsService.valueAsBoolean(w.constants.settings.names.enableSfBGateway),w.enableMessageSendFailureIndicator=w.settingsService.valueAsBoolean(p.settings.names.enableMessageSendFailureIndicator),w.minItems=-1,w.appStartChatConversations={},w.userHasChatDeferred=w.$q.defer(),w.maxPinned=w.settingsService.valueAsBoolean(w.constants.settings.names.lowerMaxPinned)?3:15,w.allowLeave=w.settingsService.valueAsBoolean(p.settings.names.enableLeaveChat),"8:null"===w.sxConfig.getCurrentSkypeMri()&&w.logger.warn("sxConfig returning bad MRI - may miss some chats"),w.conversationsService.subscribe(function(e,t){return w.resolveLie(t)},teamspace.services.ConversationsServiceEvents.EventType_Resolve),w.activeCallsService.subscribe(w.updateActiveCalls.bind(w),teamspace.services.ActiveCallsServiceEvents.Type_ActiveCallsChanged),w.settingsService.valueAsBoolean(w.constants.settings.names.enableMentionInChat)&&w.notificationsStore.subscribe(w.triggerUpdatesForUnreadMentions.bind(w),SkypeX.Services.NotificationsStore.Type_NewActivitiesNonHydrated),w.myUserPreferencesStore.subscribe(function(e,t){if(!t)return w.updatePinned(),void w.updateTbotBlocked();_.forEach(t,function(e){switch(e){case SkypeX.Services.MyUserPreferenceStorageKey.Pinned:w.updatePinned();break;case SkypeX.Services.MyUserPreferenceStorageKey.TBotNotificationBlocked:w.updateTbotBlocked()}})},w.constants.MyUserPreferencesStore.Type_UserPreference),w.enableLocalFirstRendering?w.conversationsService.waitForConversationsListInitialSyncStart().then(function(){w.syncScenario=w.loggingService.newScenario(w.constants.scenarios.sync.syncChatListLocalFirstRendering,null,function(){w.startupScenarioFinished()},36e4),w.startup().then(function(e){e||(w.syncScenario.mark("chatList_waiting_for_network"),w.waitForConversationsSynced("chatList_done_syncing_over_network","chatList_startup_over_network_complete"))})}):(w.conversationsService.waitForConversationsListInitialSyncStart().then(function(){w.syncScenario||(w.syncScenario=w.loggingService.newScenario(w.constants.scenarios.sync.syncChatList,null,function(){w.startupScenarioFinished()},36e4))}),w.waitForConversationsSynced("conversationsList_sync_complete","chatList_startup_complete")),t.UnreadCountChatListTypes=[teamspace.services.ChatListType.RECENTS,teamspace.services.ChatListType.PINNED],w.shouldLogDisplayReasons=w.settingsService.valueAsBoolean(w.constants.settings.names.chatListDisplayLogging),w}return n(t,e),t.$inject=["$q","$translate","activeCallsService","botService","chatConversationFactory","chatServiceClient","chatSyncPriorityService","chatTitlesService","constants","conversationsService","dialogService","localMessageStorageService","loggingService","myUserPreferencesStore","userResourcesSettingsStore","peopleService","resources","settingsService","sxConfig","utilityService","notificationsStore","offlineActionService"],t.prototype.waitForConversationsSynced=function(e,t){var i=this;this.conversationsService.waitForConversationsSynced().then(function(){i.syncScenario&&i.syncScenario.mark(e),i.startup(),i.syncScenario&&i.syncScenario.mark(t)},function(e){i.onChatSyncComplete(!1,null,e)})},t.prototype.onChatSyncComplete=function(e,t,i){var n;t=t||{},this.syncScenario&&(e?this.syncScenario.stop(t):(n="Unknown error during chat sync",i&&(n=i instanceof Error?i.message:i),this.syncScenario.appendEventData(t),this.syncScenario.fail({error:n})),this.syncScenario=null),this.initialLoadCompleted||(this.initialLoadCompleted=!0,this.triggerWithLogging(this.triggerLogger,teamspace.services.ChatListServiceEvents.EventType_LoadComplete,null,{success:e,error:n}))},t.prototype.startupScenarioFinished=function(){var e=this,t={};_.forEach(this.appStartChatConversations,function(i,n){if(!i.loaded){var r=e.existingChat(n);t[n]=r?{hasTitle:!(!r.title||""===r.title),hasCustomTitle:r.titleIsCustom,hadMembers:i.hadRoster,wasRecent:i.wasRecent,wasPinned:i.wasPinned,lastMessageTime:new Date(i.lastMessageTimeUniversalTimeCoordinated).toISOString(),numChatMembers:r.members&&r.members.length||0,numChatOtherMembers:r.otherMembers&&r.otherMembers.length||0}:{err:"Did not correspond to an existing chat in the chat list"}}});var i=!_.isEmpty(this.chatsWithEmptyMembers);if(!_.isEmpty(t)||i){var n=void 0;_.isEmpty(t)||(n=JSON.stringify({description:"These chats were never loaded in the chat list",chatsWithEmptyMembers:i,chatIds:_.keys(t),numChats:_.size(t),chats:t})),i&&(n=JSON.stringify({description:"These chats had [] members",chats:_.map(this.chatsWithEmptyMembers,function(e){return{id:e.id,clientArrivalTime:e.clientArrivalTime,clientUpdateTime:e.clientUpdateTime,isThreadDead:e.isThreadDead(),isUserMember:e.isUserMember(),detailsVersion:e.detailsVersion,version:e.version,numMembers:e.members?NaN:_.size(e.members)}})})),n&&(this.logger.error(n),this.syncScenarioTimeout=this.loggingService.newScenario(this.constants.scenarios.sync.syncChatListTimeout),this.syncScenarioTimeout.eventData={data:n},this.syncScenarioTimeout&&this.syncScenarioTimeout.stop())}},t.prototype.isChatTbot=function(e){var t=e&&e.isOneOnOne&&_.first(e.otherMembers);return t&&t.mri===SkypeX.Services.ChatServiceUtils.SkypeBot},t.prototype.triggerUpdatesForUnreadMentions=function(e,t){var i=this,n=_(t).filter(function(e){return e.notificationType===SkypeX.Services.NotificationType.MentionInChat&&e.isChat&&e.activity&&!e.isActivityRead}).map(function(e){var t=e.activity,n=_.cloneDeep(i.existingChat(t.sourceThreadId));return n?(n.showAtMention=!n.isRead,i.updateChat(n)?t.sourceThreadId:void 0):(i.logger.error("Got an unexpected null when cloning an existing chat: {0}",t.sourceThreadId),null)}).reject(_.isEmpty).value();_.isEmpty(n)||this.triggerBatchedChatListUpdateAndUpdatePillCount(null,n)},t.prototype.updateActiveCalls=function(e,t){var i=_.cloneDeep(this.existingChat(e));i&&(i.activeCallsCount=t?t.length:this.activeCallsService.getCallsCountByConversationId(e),this.updateChat(i)&&this.triggerBatchedChatListUpdateAndUpdatePillCount(null,[e]))},t.prototype.updateTbotBlocked=function(){var e=this,t=[];_.forEach(this.chatArrays,function(e){t=_.concat(t,e)}),_.forEach(t,function(t){if(e.isChatTbot(t)){var i=!!e.myUserPreferencesStore.getUserPreferences().tbotNotificationBlocked;t.isBotBlocked!==i&&(t.isBotBlocked=i,e.triggerWithLogging(e.triggerLogger,teamspace.services.ChatListServiceEvents.EventType_CheckBotChatBlock,null,{threadId:t.id,block:i}),e.triggerBatchedChatListUpdateAndUpdatePillCount(null,[t.id]))}})},t.prototype.updatePinned=function(){var e=this,t=this.myUserPreferencesStore.getUserPreferences().pinned||{},i=_.keys(t),n=this.getChatConversations(teamspace.services.ChatListType.PINNED),r=_.map(n,function(e){var i;return i=SkypeX.Services.SkypeConversationLocal.isLie(e.id)?e.otherMembers[0].mri:e.id,t[i]&&t[i]!==e.pinnedIndex?null:i});_.forEach(_.xor(r,i),function(t,i){t&&(e.isKeyMri(t)?e.refreshPinnedStatus(e.findPinnedLieId(t,n)):e.refreshPinnedStatus(t))})},t.prototype.findPinnedLieId=function(e,t){var i=_.find(t,function(t){return t.otherMembers[0].mri===e});return i||(i=this.conversationsService.getChatConversationWith(e)),i&&i.id},t.prototype.refreshPinnedStatus=function(e){this.insertOrUpdateConversation(this.conversationsService.getConversation(e))&&this.triggerBatchedChatListUpdateAndUpdatePillCount(null,[e])},t.prototype.getListForChat=function(e){var t;for(t=teamspace.services.ChatListType.PINNED;t<teamspace.services.ChatListType.MAX&&!this.getChatConversation(t,e);t++);return t===teamspace.services.ChatListType.MAX?null:t},t.prototype.isInitialLoadComplete=function(){return this.initialLoadCompleted},t.prototype.getChatConversation=function(e,t){return this.chatMaps&&this.chatMaps[e]&&this.chatMaps[e][t]||void 0},t.prototype.getChatConversations=function(e,t){void 0===t&&(t=!1);var i=this.chatArrays&&this.chatArrays[e];if(this.enableMultipleChatDrafts&&t){var n=_.filter(i,function(e){return!SkypeX.Services.SkypeConversationLocal.isLie(e.id)});return i?n:null}return i},t.prototype.chatIsRecent=function(e){var t;if(e){var i=void 0,n=(i=e instanceof teamspace.services.ChatConversation?e.isRead:e.isRead())?this.constants.p2p.chatListRecencyMs.read:this.constants.p2p.chatListRecencyMs.unread;t=e.lastMessageTimeUtc&&e.lastMessageTimeUtc>Date.now()-n}return!!t},t.prototype.getUnreadCountFromChatList=function(){return this.unreadCountFromChatList},t.prototype.setSelectedChatId=function(e){if(e!==this.selectedChatId){var t=this.existingChat(e),i=this.selectedChatId,n=this.conversationsService.getConversation(this.selectedChatId);if(this.selectedChatId=e,t||this.selectedChatId===this.constants.p2p.newChatId){var r=this.unHoistChat();if(this.enableMultipleChatDrafts&&SkypeX.Services.SkypeConversationLocal.isLie(i)&&this.getListForChat(i)!==teamspace.services.ChatListType.PINNED&&this.conversationsService.getConversation(i)&&!this.hasMessageDraft(i)){var s=r||this.removeChat(i);s&&this.discardChat(s.id)}}else{var a=this.conversationsService.getChatConversation(e),o=this.chatConversationFactory.fromConversation(a,null);this.chatBelongsInPinned(o)?this.insertOrUpdateChatInList(o,teamspace.services.ChatListType.PINNED):n&&this.conversationIsListableChat(n,!0)?this.insertOrUpdateChatInList(o,teamspace.services.ChatListType.RECENTS):this.hoistChat(o)}var c=this.existingChat(i);if(c){var l=this.conversationsService.getConversation(i);!l||c.isPending||this.conversationIsListableChat(l,!0)||this.removeChat(i,"previous chat is no longer listable")}this.triggerBatchedChatListUpdateAndUpdatePillCount(null,[i,this.selectedChatId])}},t.prototype.userHasChats=function(){return this.userHasChatDeferred.promise},t.prototype.reorderPinned=function(e){var t,i=this,n={};return _.forEach(e,function(e,r){var s=_.cloneDeep(i.getChatConversation(teamspace.services.ChatListType.PINNED,e)),a=r+1;s.pinnedIndex!==a&&(s.pinnedIndex=a,i.updateChat(s),t=!0),SkypeX.Services.SkypeConversationLocal.isLie(e)?n[i.getChatConversation(teamspace.services.ChatListType.PINNED,e).otherMembers[0].mri]=a:n[e]=a}),this.myUserPreferencesStore.setUserPreference(SkypeX.Services.MyUserPreferenceStorageKey.Pinned,JSON.stringify(n)),t||!1},t.prototype.pinChat=function(e){var t=!1;if(e)if(this.pinnedLimitReached())this.openMaxPinnedDialog();else{var i=this.myUserPreferencesStore.getUserPreferences().pinned||{},n=this.calculateNextValue(),r=_.cloneDeep(this.getChatConversation(teamspace.services.ChatListType.RECENTS,e));if(r){r.pinnedIndex=n;var s=this.updateChat(r);this.getChatConversation(teamspace.services.ChatListType.PINNED,e)?(s||this.logger.warn("Chat "+e+" was already pinned"),this.triggerBatchedChatListUpdateAndUpdatePillCount(teamspace.services.ChatListServiceEvents.EventKey_CheckPinned,[e]),SkypeX.Services.SkypeConversationLocal.isLie(e)?i[r.otherMembers[0].mri]=n:i[e]=n,this.myUserPreferencesStore.setUserPreference(SkypeX.Services.MyUserPreferenceStorageKey.Pinned,JSON.stringify(i)),t=!0):(s&&this.logger.error("Chat was incorrectly updated to be in list "+this.getListForChat(e)),this.logger.error("Failed to pin chat: "+e))}else{var a=this.getListForChat(e);_.isNil(a)?this.logger.error("Chat could not be pinned because it is not in any of the chat lists."):this.logger.error("Chat with id "+e+" was not present in the recents list. It was in the "+teamspace.services.ChatListType[a]+" list. Unable to pin.")}}return t},t.prototype.updateMuteChat=function(e,t){var i=this;if(e){var n=this.loggingService.newScenario(this.constants.scenarios.muteChat);n.cancelIfOffline=!0;var r={};r[this.constants.scenarioDataPropNames.data]="{ action:"+(t?"mute":"unmute")+"}",this.chatServiceClient.setConversationAlerts(e,!t).then(function(){n.stop(r)}).fail(function(e){r[i.constants.scenarioDataPropNames.error]="mute chat failed",n.cancel(r),i.logger.warn("mute chat failed")})}else this.logger.warn("failed to mute chat as chatId was not defined")},t.prototype.unpinChat=function(e){if(e){var t=_.cloneDeep(this.getChatConversation(teamspace.services.ChatListType.PINNED,e));if(t){t.pinnedIndex=void 0;var i=this.updateChat(t);if(this.getChatConversation(teamspace.services.ChatListType.PINNED,e))i&&this.logger.error("Chat was incorrectly updated to be in list "+this.getListForChat(e)),this.logger.error("Failed to unpin chat: "+e);else{i||this.logger.warn("Chat "+e+" was already unpinned"),SkypeX.Services.SkypeConversationLocal.isLie(e)&&e===this.selectedChatId&&this.hoistChat(this.existingChat(e)),this.triggerBatchedChatListUpdateAndUpdatePillCount(teamspace.services.ChatListServiceEvents.EventKey_CheckPinned,[e]);var n=this.myUserPreferencesStore.getUserPreferences().pinned||{},r=SkypeX.Services.SkypeConversationLocal.isLie(e)?t.otherMembers[0].mri:e;n=this.removePinned(r,n),this.myUserPreferencesStore.setUserPreference(SkypeX.Services.MyUserPreferenceStorageKey.Pinned,JSON.stringify(n))}}else{var s=this.getListForChat(e);_.isNil(s)?this.logger.error("Chat could not be unpinned because it is not in any of the chat lists."):this.logger.error("Chat with id "+e+" was not present in the pinned list. It was in the "+teamspace.services.ChatListType[s]+" list. Unable to unpin.")}}},t.prototype.discardChat=function(e){if(this.enableMultipleChatDrafts)if(e&&e===this.constants.p2p.newChatId)this.triggerWithLogging(this.triggerLogger,teamspace.services.ChatListServiceEvents.EventType_ClearNewChat);else if(e&&SkypeX.Services.SkypeConversationLocal.isLie(e)){if(this.getChatConversation(teamspace.services.ChatListType.PINNED,e)&&this.unpinChat(e),this.triggerWithLogging(this.triggerLogger,teamspace.services.ChatListServiceEvents.EventType_NavigateToNextSelectedChat,e),this.hasMessageDraft(e)){var t=this.localMessageStorageService.getLocalConversationItemByConversationId(e);this.localMessageStorageService.removeLocalConversationItem(t.clientId)}var i=this.loggingService.newScenario(this.constants.scenarios.sync.markThreadAsDead);i.eventData={data:JSON.stringify({source:"chatListService",id:e})},this.conversationsService.markThreadAsDeletedAndRemoveFromStore(e,!1),i.stop()}},t.prototype.hasMessageDraft=function(e){var t=this.localMessageStorageService.getLocalConversationItemByConversationId(e);return!(!t||!t.body)},t.prototype.setBotChatBlock=function(e,t,i){void 0===i&&(i=!1);var n,r=this.existingChat(e);if(r){if(i){var s=void 0;if(!t){var a=this.conversationsService.getConversation(e);s=a&&a.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_P2PMessagingDisabled]}i=!t&&!!s}var o=!!t!==r.isBotBlocked;if(i||o){var c=this.isChatTbot(r),l=!c;o&&c&&(this.myUserPreferencesStore.setUserPreference(SkypeX.Services.MyUserPreferenceStorageKey.TBotNotificationBlocked,t?(new Date).toUTCString():null),n=this.$q.resolve()),(l&&o||i)&&(n=this.setMessagingDisabledThreadProperty(e,t))}else n=this.$q.resolve()}else n=this.$q.reject("no chat exists with id "+e);return n},t.prototype.setMessagingDisabledThreadProperty=function(e,t){var i,n=this;if(this.botService.isOneOnOneConversationWithBot(e)){var r=function(t){var i=n.getChatConversation(teamspace.services.ChatListType.RECENTS,e)||n.getChatConversation(teamspace.services.ChatListType.PINNED,e),r=_.cloneDeep(i);r.isBotBlocked=t,n.updateChat(r),n.triggerWithLogging(n.triggerLogger,teamspace.services.ChatListServiceEvents.EventType_CheckBotChatBlock,null,{threadId:i.id,block:t}),n.triggerBatchedChatListUpdateAndUpdatePillCount(null,[i.id])};r(!!t);var s=SkypeX.Services.ChatServiceUtils.ThreadProp_P2PMessagingDisabled;i=this.chatServiceClient.setThreadProperty(e,s,t).toNgPromise(this.$q).catch(function(t){n.logger.error('can not block bot. Set thread property of "messagingDisabled" to chat service is failed. Error = '+t);var i=!!n.conversationsService.getConversation(e).threadProperties[s];return r(i),n.$q.reject(i)})}return i||this.$q.reject("id did not correspond to a 1:1 chat with a bot")},t.prototype.countUnreadVisibleChats=function(){var e=this,t=_.chain(this.getChatConversations(teamspace.services.ChatListType.RECENTS)).concat(this.getChatConversations(teamspace.services.ChatListType.PINNED)).filter(function(t){return t&&e.shouldDisplayChat(t,!0)&&!t.isRead&&!t.isMuted}).size().value();return this.updateUnreadCountFromChatList(t),t},t.prototype.updateUnreadCountFromChatList=function(e){this.unreadCountFromChatList!==e&&(this.unreadCountFromChatList=e,this.triggerWithLogging(this.triggerLogger,teamspace.services.ChatListServiceEvents.EventType_UnreadCount))},t.prototype.calculateNextValue=function(){var e=this.ensureArray(teamspace.services.ChatListType.PINNED);return(e[0]?_.last(e).pinnedIndex:0)+1},t.prototype.removePinned=function(e,t){var i=t[e];return delete t[e],_.mapValues(t,function(e){return e>i?e-1:e})},t.prototype.pinnedLimitReached=function(){return!(this.getChatConversations(teamspace.services.ChatListType.PINNED).length<this.maxPinned)},t.prototype.openMaxPinnedDialog=function(){var e={};e.isConfirmation=!0,e.confirmMessageHtmlBody=this.contactsInChatAvailable?this.$translate.instant(this.resources.strings.chats_maximumPinnedError):this.$translate.instant(this.resources.strings.chats_maximumFavoritesError),this.dialogService.open(this.constants.dialogs.confirmDialog,e)},t.prototype.addChat=function(e){var t=null;return e&&(this.chatBelongsInPinned(e)?t=this.insertOrUpdateChatInList(e,teamspace.services.ChatListType.PINNED):(!SkypeX.Services.SkypeConversationLocal.isLie(e.id)&&e.lastMessageTimeUtc||this.enableMultipleChatDrafts&&SkypeX.Services.SkypeConversationLocal.isLie(e.id)&&this.hasMessageDraft(e.id))&&(t=this.insertOrUpdateChatInList(e,teamspace.services.ChatListType.RECENTS)),t||(!SkypeX.Services.SkypeConversationLocal.isLie(e.id)&&e.lastMessageTimeUtc&&this.logger.error("Unable to add chat to either list: {0}. Pinned index: {1}. Last message time: {2}",e.id,e.pinnedIndex,e.lastMessageTimeUtc),this.markIgnoredChatAsLoaded(e))),t},t.prototype.membersAreDifferent=function(e,t){var i=!!e!=!!t||e&&e.length!==t.length;if(!i){var n=_.sortBy(e,function(e){return e.mri}),r=_.sortBy(t,function(e){return e.mri}),s=!1;_.forEach(n,function(e,t){return!(s=e.mri!==r[t].mri)}),i=s}return i},t.prototype.meetingInfoIsDifferent=function(e,t){return!(!e&&!t)&&(!e||!t||(e.startTime!==t.startTime||e.endTime!==t.endTime||e.isCancelled!==t.isCancelled||e.location!==t.location||e.subject!==t.subject||e.exchangeId!==t.exchangeId||e.iCalUid!==t.iCalUid))},t.prototype.chatsAreDifferent=function(e,t){return!!e!=!!t||e&&(e.isRead!==t.isRead||e.lastMessageTimeUtc!==t.lastMessageTimeUtc||e.title!==t.title||e.longTitle!==t.longTitle||e.isHoisted!==t.isHoisted||e.isPending!==t.isPending||e.pinnedIndex!==t.pinnedIndex||e.activeCallsCount!==t.activeCallsCount||e.showAtMention!=t.showAtMention||e.isBotBlocked!==t.isBotBlocked||e.isFederated!==t.isFederated||e.hiddenTime!==t.hiddenTime||e.isUserMember!==t.isUserMember||e.isMuted!==t.isMuted||e.hasFailedMessages!==t.hasFailedMessages||SkypeX.Services.SkypeMessageLocal.getEditTime(e.lastMessage)!==SkypeX.Services.SkypeMessageLocal.getEditTime(t.lastMessage)||SkypeX.Services.SkypeMessageLocal.getDeleteTime(e.lastMessage)!==SkypeX.Services.SkypeMessageLocal.getDeleteTime(t.lastMessage)||this.membersAreDifferent(e.otherMembers,t.otherMembers)||this.meetingInfoIsDifferent(e.meetingInfo,t.meetingInfo))},t.prototype.chatBelongsInPinned=function(e){return e&&e.pinnedIndex>=0},t.prototype.chatIsHoisted=function(e){return this.hoistedChat&&this.hoistedChat.id===e},t.prototype.ensureArray=function(e){var t;do{t=this.getChatConversations(e),this.chatArrays[e]=t||[]}while(!t);return t},t.prototype.ensureMap=function(e){var t;do{t=this.chatMaps[e],this.chatMaps[e]=t||{}}while(!t);return t},t.prototype.existingChat=function(e){var t=null;return _.forEach(this.chatMaps,function(i){return!(t=i&&i[e])}),t},t.prototype.getMaxUtcTime=function(e,t){return Math.max(e,t)||t||e},t.prototype.handleChatTitleUpdate=function(e,t){if(t)(e.title!==t.title||e.longTitle!==t.longTitle)&&(e.title=t.title,e.longTitle=t.longTitle,this.updateChatLoadStatus(e),this.triggerBatchedChatListUpdateAndUpdatePillCount(null,[e.id]));else if(this.logger.warn("Failed to generate title for chat "+e.id),this.appStartChatConversations&&this.appStartChatConversations[e.id]){var i=void 0;if(e.members)i=e.members.length<2,this.logger.warn("Chat "+e.id+" contains "+e.members.length+" members."),this.syncScenario&&this.syncScenario.mark("no_title",{data:JSON.stringify({hasTitle:!!t,numMembers:e.members&&e.members.length,numOtherMembers:e.otherMembers&&e.otherMembers.length})});else{var n=this.conversationsService.getConversation(e.id);i=n&&n.isThreadDead(),n&&n.isThreadDead()&&this.syncScenario&&this.syncScenario.mark("dead_thread",{data:JSON.stringify({chatId:e.id})})}i&&this.markIgnoredChatAsLoaded(e)}},t.prototype.hoistChat=function(e){var t=null;if(e&&!this.chatIsHoisted(e.id)){this.unHoistChat();var i=this.getListForChat(e.id);teamspace.services.ChatListType.PINNED===i&&(this.removeChat(e.id,"hoist from pinned"),i=this.getListForChat(e.id)),_.isNull(i)&&(this.hoistedChat=e,this.setSelectedChatId(this.hoistedChat?this.hoistedChat.id:null),this.hoistedChat=this.insertOrUpdateChatInList(this.hoistedChat,teamspace.services.ChatListType.RECENTS),(t=this.hoistedChat)&&(this.hoistedChat.isHoisted=!0))}return t},t.prototype.insertChatIntoList=function(e,t){var i=this,n=null;if(e){var r=this.ensureArray(t),s=void 0;switch(t){case teamspace.services.ChatListType.RECENTS:s=this.chatIsHoisted(e.id)?0:_.findIndex(r,function(t){var n=e.lastMessageTimeUtc>t.lastMessageTimeUtc,r=i.chatIsHoisted(t.id);return i.enableMultipleChatDrafts?(SkypeX.Services.SkypeConversationLocal.isLie(e.id)||!SkypeX.Services.SkypeConversationLocal.isLie(t.id)&&n)&&!r:n&&!r});break;case teamspace.services.ChatListType.PINNED:s=_.findIndex(r,function(t){return e.pinnedIndex<t.pinnedIndex})}s>=0&&(r.splice(s,0,e),n=r[s]),n||(r.push(e),n=_.last(r))}return n},t.prototype.insertOrUpdateChatInList=function(e,t){var i=this,n=null;if(e){var r=this.ensureMap(t),s=r[e.id];s?(e.id=s.id,n=this.updateChatInList(e,t)):n=this.insertChatIntoList(e,t),n&&(r[e.id]=n,this.chatTitlesService.buildChatTitles(e.id).then(function(e){i.handleChatTitleUpdate(n,e)}).catch(function(e){i.handleChatTitleUpdate(n,null)}))}return n},t.prototype.insertOrUpdateChat=function(e,t){var i=null;if(e&&!e.isHidden){var n=this.existingChat(e.id),r=n?n.hiddenTime:null;_.isUndefined(t)&&(t=!!n),i=t?this.updateChat(e):this.addChat(e),t&&i&&!_.isNil(i.hiddenTime)&&n&&i.hiddenTime!==r&&this.triggerWithLogging(this.triggerLogger,teamspace.services.ChatListServiceEvents.EventType_HideChat,i.id),e.title&&this.updateChatLoadStatus(e)}return i},t.prototype.insertOrUpdateConversation=function(e){var t=null,i=null,n=null;return i=this.existingChat(e.id),t=this.chatConversationFactory.fromConversation(e,i),n=this.insertOrUpdateChat(t,!!i),t&&t.title&&t.longTitle?n:null},t.prototype.onConversationsUpdated=function(e){var t=this,i=[],n=this.sxConfig.getCurrentSkypeMri(),r=!1;_.forEach(e,function(e){if(e)if(t.conversationIsListableChat(e,!0)){i.push(e.id);var s=t.allowLeave||e.isUserMember(n)?t.insertOrUpdateConversation(e):t.removeConversation(e);r=!!s||r}else t.existingChat(e.id)?r=!!t.removeConversation(e):t.appStartChatConversations&&t.appStartChatConversations[e.id]&&t.markIgnoredChatAsLoaded(e)}),r&&this.triggerBatchedChatListUpdateAndUpdatePillCount(null,i)},t.prototype.removeConversation=function(e){var t=null;return e.id&&(t=this.removeChat(e.id,"deleted")),this.markIgnoredChatAsLoaded(e),t},t.prototype.markIgnoredChatAsLoaded=function(e){this.appStartChatConversations&&e&&this.appStartChatConversations[e.id]&&(delete this.appStartChatConversations[e.id],_.isNil(this.appStartRemainingSyncCount)||this.appStartRemainingSyncCount--,this.updateChatLoadStatus(null))},t.prototype.removeChatFromMap=function(e,t){var i=this.getChatConversation(t,e);return i&&delete this.chatMaps[t][e],i},t.prototype.removeChat=function(e,t){var i=this,n=null;return e&&_.forEach(this.chatArrays,function(t,r){return n=i.removeChatFromMap(e,r),t&&t.length>0&&(_.last(t).id===e||n&&_.last(t).id===n.id?t.pop():_.remove(t,function(t){return t.id===e||n&&n.id===t.id})),!n}),n},t.prototype.resolveLie=function(e){var t=this;if(e&&e.lie&&e.real){this.logger.info("Resolving lie {0} to real {1}",e.lie.id,e.real.id);var i=this.existingChat(e.lie.id);i&&(this.removeChat(e.real.id,"lie resolved"),i.id=e.real.id,i.isPending=!1),_.forEach(this.chatMaps,function(n,r){t.getChatConversation(r,e.lie.id)&&(n[e.real.id]=i)}),i&&(this.selectedChatId===e.lie.id&&this.setSelectedChatId(e.real.id),this.convertPinnedLieToPinnedChat(e),this.triggerWithLogging(this.triggerLogger,teamspace.services.ChatListServiceEvents.EventType_Resolved,e.lie.id,e.real.id))}},t.prototype.convertPinnedLieToPinnedChat=function(e){if(this.myUserPreferencesStore.getUserPreferences().pinned&&e&&e.lie&&e.lie.members){var t=this.sxConfig.getCurrentSkypeMri(),i=this.myUserPreferencesStore.getUserPreferences().pinned||{},n=e.lie.getOtherMembers(t)[0];i[n]&&(i[e.real.id]=i[n],delete i[n],this.myUserPreferencesStore.setUserPreference(SkypeX.Services.MyUserPreferenceStorageKey.Pinned,JSON.stringify(i)))}},t.prototype.isKeyMri=function(e){return e.startsWith(SkypeX.Services.ChatServiceUtils.BotPrefix)||e.startsWith(SkypeX.Services.ChatServiceUtils.MriNamespace_SkypeSpacesUser)},t.prototype.checkForPinnedReordering=function(e){return _.max(_.values(e))>this.maxPinned?this.editPinnedDictionary(e):e},t.prototype.editPinnedDictionary=function(e){var t=_.keys(e),i=[];return _.forEach(t,function(n){var r=1;_.forEach(t,function(t){e[n]>e[t]&&r++}),i.push(r)}),_.forEach(t,function(t,n){return e[t]=i[n]}),this.myUserPreferencesStore.setUserPreference(SkypeX.Services.MyUserPreferenceStorageKey.Pinned,JSON.stringify(e)),e},t.prototype.conversationIsListableChat=function(e,t,i){void 0===t&&(t=!1);var n=this.settingsService.valueAsBoolean(this.constants.settings.names.disableTBot),s=this.sxConfig.getCurrentSkypeMri(),a=this.isSkypeBotChat(e),o=null;return e&&e.isChat()?n&&a?o=r.FeatureDisabled:a||e.getPinnedIndex(this.sxConfig.getCurrentSkypeMri(),this.myUserPreferencesStore)>=0||this.chatIsRecent(e)||e.id===this.selectedChatId||this.enableMultipleChatDrafts&&SkypeX.Services.SkypeConversationLocal.isLie(e.id)&&this.hasMessageDraft(e.id)?this.allowLeave||t||e.isUserMember(s)?this.settingsService.valueAsBoolean(this.constants.settings.names.hideLegacySfBThread)&&teamspace.services.SfBInteropUtilsService.isLegacySfBGatewayConversation(e.id)?o=r.FeatureDisabled:!this.enableSfBGateway&&teamspace.services.SfBInteropUtilsService.isSfBGatewayConversation(e.id)?o=r.FeatureDisabled:!teamspace.services.SfBInteropUtilsService.isSfbEligible(this.userResourcesSettingsStore)&&teamspace.services.SfBInteropUtilsService.isSfBGatewayConversation(e.id)?o=r.FeatureDisabled:e.id!==this.selectedChatId&&!_.isNil(e.hiddenTime())&&e.lastMessageTimeUtc<e.hiddenTime()?o=r.HiddenChat:e.isHidden()?o=r.HiddenPrivateMeeting:!this.enableFederatedChat&&e.isFederated()?o=r.FeatureDisabled:!this.voiceAppsEnabled&&e.containsVoiceApp()&&(o=r.FeatureDisabled):o=r.UserIsNotMemeber:o=r.OldAndNotSelected:o=r.InvalidChat,this.shouldLogDisplayReasons&&!_.isNull(o)&&this.addDisplayReason(i,e,o),_.isNull(o)},t.prototype.startup=function(){var e=this;this.syncScenario&&this.syncScenario.mark("chatList_startup_started");var i={};i=this.myUserPreferencesStore.getUserPreferences().pinned||{},i=this.checkForPinnedReordering(i),_.forEach(_.keys(i),function(t){e.isKeyMri(t)&&e.conversationsService.getChatConversationWith(t)}),this.syncScenario&&this.syncScenario.mark("pinned_setup_complete");var n=this.sxConfig.getCurrentSkypeMri(),r=this.conversationsService.getConversations(function(t){return e.conversationIsListableChat(t,!1)}),s=0;if(this.appStartChatConversations={},r.forEach(function(t){var n=t.isThreadDead(),r=!!t.members,a=e.chatIsRecent(t),o=!_.isUndefined(i[t.id]);!n&&(o||r||a)&&(!(t.isMeetingConversation()||t.topicName())&&t.members&&0===t.members.length?e.chatsWithEmptyMembers.push(t):(e.appStartChatConversations[t.id]={hadRoster:r,wasRecent:a,lastMessageTimeUniversalTimeCoordinated:t.lastMessageTimeUtc,wasPinned:o,loaded:!1},t.members||s++))}),this.appStartRemainingSyncCount=_.size(this.appStartChatConversations),!this.enableLocalFirstRendering||this.appStartRemainingSyncCount>0){this.syncScenario&&this.syncScenario.mark("conversation_roster_statuses_determined");var a=[function(t){return e.getPinnedIndex(i,t)},function(e){return e.lastMessageTimeUtc}],o=_.orderBy(_.filter(r,function(t){return e.allowLeave||t.isUserMember(n)}),a,["asc","desc"]);this.syncScenario&&this.syncScenario.mark("initial_shown_chats_determined");var c=_.take(_.map(o,function(e){return e.id}),t.NumPrioritizedChatsForMessages);if(this.chatSyncPriorityService.setPrioritizedConversations(c),this.syncScenario&&(this.syncScenario.mark("initial_shown_chats_prioritized"),this.syncScenario.mark("list_loaded",{chat_count:r.length,chats_pending_roster:s})),0===r.length)this.logger.debug("No chat conversations found"),this.onChatSyncComplete(!0),this.userHasChatDeferred.resolve(!1);else{this.allowSyncComplete=!0;var l=_.some(r,function(e){return!SkypeX.Services.SkypeConversationLocal.isLie(e.id)});this.userHasChatDeferred.resolve(l)}var p=_.partition(r,function(e){return e.isFederated()}),u=p[0],h=p[1],d=this.getChatMemberMris(h),g=this.enableFederatedChat?this.getChatMemberMris(_.filter(u,function(e){return!e.isLie()})):[],v=this.getPeopleProfileData(d,g);return this.utilityService.getPromiseWithTimeout(v,10*this.constants.timeInMiliseconds.second,this.$q,"timeout",!0).catch(function(t){"timeout"===t&&(e.syncScenario&&e.syncScenario.mark("getAllShortPeopleProfiles_timeout"),e.logger.warn("peopleService.getAllShortPeopleProfiles took more than 10 seconds to complete, so continuing on."))}).finally(function(){e.loadConversationsFromStartup(),e.conversationsService.subscribe(function(t,i){return e.onConversationsUpdated(i)},teamspace.services.ConversationsServiceEvents.EventType_Batched);var t=e.getChatConversations(teamspace.services.ChatListType.PINNED),i=e.getChatConversations(teamspace.services.ChatListType.RECENTS),n=t?t.length:0,r={numPinnedChats:n,numChats:n+(i?i.length:0)};e.loggingService.customEvent(teamspace.services.TelemetryKind.Heartbeat,"numChats",r),e.enableMessageSendFailureIndicator&&e.offlineActionService.subscribe(function(t){return e.onConversationsUpdated([e.conversationsService.getConversation(t)])},SkypeX.Services.OfflineActionServiceEvents.Type_ConversationHasFiledMessageUpdated)}).then(function(){return e.userHasChats()})}return this.userHasChatDeferred.resolve(!1),this.$q.resolve(!1)},t.prototype.getChatMemberMris=function(e){var t=this;return _.uniq(_.flatten(_.map(e,function(e){return e.getOtherMembers(t.sxConfig.getCurrentSkypeMri())})))},t.prototype.getPeopleProfileData=function(e,t){var i=this;void 0===t&&(t=[]);var n=performance.now(),r=t.length>0?this.peopleService.searchFederatedUsersByMri(t,"chat-list-service"):this.$q.resolve([]);return this.$q.all([this.peopleService.getAllShortPeopleProfile(e,"chat-list-service",!1,new teamspace.services.PeoplePickerFilters),r]).then(function(r){var s=e.concat(t);i.logger.info("People profile - Members requested: {0}, Federated Members requested: {1}, Members loaded {2}, Time taken:{3}",s.length,t.length,r&&_.flatten(r).length,performance.now()-n),i.syncScenario&&i.syncScenario.mark("people_loaded",{member_count:s.length,federatedusers_count:t.length})},function(e){i.syncScenario&&i.syncScenario.mark("getAllShortPeopleProfiles_failed"),i.logger.error("loading people profile failed: Error: {0}",e&&_.isString(e)?e:JSON.stringify(e))})},t.prototype.getPinnedIndex=function(e,t){return t?e[SkypeX.Services.SkypeConversationLocal.isLie(t.id)?t.getOtherMembers(this.sxConfig.getCurrentSkypeMri())[0]:t.id]:null},t.prototype.loadConversationsFromStartup=function(){var e=this;this.onConversationsUpdated(this.conversationsService.getConversations()),_.forEach(this.chatArrays,function(t,i){e.ensureArray(i),e.ensureMap(i)})},t.prototype.unHoistChat=function(){var e=null;return this.enableMultipleChatDrafts&&this.hoistedChat?SkypeX.Services.SkypeConversationLocal.isLie(this.hoistedChat.id)&&this.hasMessageDraft(this.hoistedChat.id)||(e=this.removeChat(this.hoistedChat.id,"unhoisted")):this.hoistedChat&&(e=this.removeChat(this.hoistedChat.id,"unhoisted")),this.hoistedChat=null,e},t.prototype.updateChatInList=function(e,t){var i=null,n=this.getChatConversation(t,e.id);if(e&&n&&this.chatsAreDifferent(e,n)){var r=e.lastMessageTimeUtc>n.lastMessageTimeUtc,s=e.pinnedIndex!=n.pinnedIndex;if(e.lastMessageTimeUtc!==n.lastMessageTimeUtc){var a=e.lastMessageTimeUtc;e.lastMessageTimeUtc=this.getMaxUtcTime(n.lastMessageTimeUtc,e.lastMessageTimeUtc),e.lastMessageTimeUtc===n.lastMessageTimeUtc&&this.logger.warn("incoming chat {0} version {1} had a lastMessageTime of {2}, which was older than the local chat {3} with version {4}'s lastMessageTime of {5}. Updating the chat may fail.",e.id,a,e.chatVersion,n.id,e.chatVersion,n.lastMessageTimeUtc)}i=this.updateChatProperties(n,e),this.chatIsHoisted(i.id)&&r&&(this.hoistedChat=null,i.isHoisted=!1),(r&&t!==teamspace.services.ChatListType.PINNED||s&&t===teamspace.services.ChatListType.PINNED)&&(this.removeChat(e.id,"moving"),this.insertChatIntoList(i,t))}return i},t.prototype.updateChatLoadStatus=function(e){if(void 0===e&&(e=null),this.appStartChatConversations){if(e){var t=this.appStartChatConversations[e.id];t&&!t.loaded&&(t.hasRoster=!!e.members,t.hasTitles=t.hasTitles||_.isString(e.title),(t.hasRoster&&t.hasTitles||!t.hasRoster&&e.title&&""!==e.title)&&(this.appStartRemainingSyncCount--,t.loaded=!0))}this.allowSyncComplete&&0===this.appStartRemainingSyncCount&&(this.onChatSyncComplete(!0,{chat_count:_.values(this.appStartChatConversations).length}),this.logger.debug("Completed sync_chat_list"),delete this.appStartChatConversations,this.appStartRemainingSyncCount=null)}},t.prototype.updateChat=function(e){var t=this,i=null;return e&&_.forEach(this.chatMaps,function(n,r){var s=t.getChatConversation(r,e.id);if(s)if(t.chatsAreDifferent(e,s))if(e.chatVersion>=s.chatVersion){if(e.id=s.id,e.lastMessageTimeUtc!==s.lastMessageTimeUtc){var a=e.lastMessageTimeUtc;e.lastMessageTimeUtc=t.getMaxUtcTime(s.lastMessageTimeUtc,e.lastMessageTimeUtc),e.lastMessageTimeUtc===s.lastMessageTimeUtc&&t.logger.warn("incoming chat {0} version {1} had a lastMessageTime of {2}, which was older than the local chat {3} with version {4}'s lastMessageTime of {5}. Updating the chat may fail.",e.id,a,e.chatVersion,s.id,e.chatVersion,s.lastMessageTimeUtc)}var o=void 0,c=r;switch(r){case teamspace.services.ChatListType.PINNED:t.chatBelongsInPinned(e)||(o="unpinned",!SkypeX.Services.SkypeConversationLocal.isLie(e.id)||t.enableMultipleChatDrafts&&t.hasMessageDraft(e.id)?c=teamspace.services.ChatListType.RECENTS:(t.selectedChatId===e.id&&(i=t.hoistChat(e)),c=null));break;case teamspace.services.ChatListType.RECENTS:t.chatBelongsInPinned(e)&&(t.chatIsHoisted(e.id)?t.unHoistChat():o="pinned",c=teamspace.services.ChatListType.PINNED)}var l=void 0;o&&!t.chatIsHoisted(s.id)&&(l=t.removeChat(s.id,o),t.enableMultipleChatDrafts&&_.isNull(c)&&SkypeX.Services.SkypeConversationLocal.isLie(l.id)&&!t.hasMessageDraft(l.id)&&t.discardChat(l.id),l||(t.logger.warn("Unable to remove chat {0} from list {1}. Has title: {1}",e.id,r,!!e.longTitle),c=null)),_.isNull(c)||(i=t.insertOrUpdateChatInList(e,c))||t.logger.warn("Unable to add chat {0} to list {1}. Has title?: {2}",e.id,c,!!e.longTitle),i=i||l}else t.logger.warn("Skipping update of "+s.id+" because its version is newer than the incoming chat's version");else t.chatIsHoisted(s.id)&&(t.logger.debug("Hoisted chat {0} is being updated, but nothing changed about it, so unhoist and insert",s.id),t.unHoistChat(),(i=t.insertOrUpdateChat(e))||t.selectedChatId!==e.id?i?t.logger.debug("Chat {0} was inserted into list {1}",s.id,t.getListForChat(i.id)):t.logger.debug("Chat {0} was unhoisted and removed from all lists",s.id):(t.logger.debug("Chat {0} still needs to be hoisted",s.id),i=t.hoistChat(e)));else s&&t.logger.warn("Skipping the update of "+s.id+" because the update would not change the existing chat");return s||!i}),i},t.prototype.updateChatProperties=function(e,t){if(t.isPending&&!e.isPending&&this.hoistedChat&&this.hoistedChat.id===e.id){var i=this.unHoistChat(),n=_.head(this.ensureArray(teamspace.services.ChatListType.RECENTS)),r=n?n.lastMessageTimeUtc+1:Date.now();e.lastMessageTimeUtc=r,t.lastMessageTimeUtc=e.lastMessageTimeUtc,this.insertOrUpdateChatInList(i,teamspace.services.ChatListType.RECENTS)}return _.assign(e,t)},t.prototype.shouldDisplayChat=function(e,t,i){var n=e?this.conversationsService.getConversation(e.id):null,s=null;if(e.containsVoiceApp&&(t=!1),n&&n.isChat())if(e.title||e.longTitle){if(!t)return this.conversationIsListableChat(n,!0,i)}else s=r.NoTitle;else s=r.InvalidChat;return this.shouldLogDisplayReasons&&this.addDisplayReason(i,n,s),_.isNull(s)},t.prototype.isSkypeBotChat=function(e){var t=this.sxConfig.getCurrentSkypeMri(),i=e&&e.isOneOnOne()&&e.getOtherMembers(t);return i&&1===i.length&&SkypeX.Services.ChatServiceUtils.isSkypeBotMri(i[0])},t.prototype.addDisplayReason=function(e,t,i){var n=this;if(e){var s=!_.isNil(i),a=s?r[i]:this.getAcceptanceReason(_.find(_.keys(this.rejectionMaps),function(e){return n.rejectionMaps[e][t.id]}));if(a){s&&!this.rejectionMaps[a]?this.rejectionMaps[a]={}:s||this.acceptanceMaps[a]||(this.acceptanceMaps[a]={});var o=(s?this.rejectionMaps:this.acceptanceMaps)[a];o[t.id]||(e[a]||(e[a]=[]),i===r.NoTitle?e[a].push(t.id):t instanceof teamspace.services.ChatConversation&&e[a].push(t.id+":"+(t.longTitle&&t.longTitle?t.longTitle.length:0)),_.forEach(_.values(this.acceptanceMaps),function(e){return e[t.id]=!1}),_.forEach(_.values(this.rejectionMaps),function(e){return e[t.id]=!1}),o[t.id]=!0)}}},t.prototype.getAcceptanceReason=function(e){return s[r[e]]},t.prototype.triggerBatchedChatListUpdateAndUpdatePillCount=function(e,t){this.triggerWithLogging(this.triggerLogger,teamspace.services.ChatListServiceEvents.EventType_Batched,e,t),this.debouncedCountUnreadVisibleChats||(this.debouncedCountUnreadVisibleChats=_.debounce(this.countUnreadVisibleChats.bind(this),100,{leading:!0,trailing:!0})),this.debouncedCountUnreadVisibleChats()},t.NumPrioritizedChatsForMessages=6,t}(SkypeX.Services.ObservableBase);t.ChatListService=a,angular.module("teamspace.chatListService",["pascalprecht.translate","teamspace.activeCallsService","teamspace.botService","teamspace.chatConversationFactory","skypeX.chatServiceClient","skypeX.chatSyncPriorityService","teamspace.chatTitlesService","teamspace.constants","teamspace.conversationsService","teamspace.dialogService","teamspace.localMessageStorageService","teamspace.loggingService","skypeX.myUserPreferencesStore","teamspace.peopleService","teamspace.locales","teamspace.settingsService","skypeX.sxConfig","teamspace.utilityService","skypeX.notificationsStore"]).service("chatListService",a)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=function(e){function t(t,i,n,r,s,a,o,c,l,p,u){var h=e.call(this)||this;return h.$q=t,h.utilityService=i,h.$translate=n,h.constants=r,h.conversationsService=s,h.loggingService=a,h.settingsService=o,h.peopleService=c,h.resources=l,h.conversationsStore=p,h.sxConfig=u,h.enableFederatedChat=!1,h.logger=h.loggingService.newLogger("ChatTitlesService"),h.membersCache={},h.enableFederatedChat=h.settingsService.valueAsBoolean(h.constants.settings.names.enableFederatedChat),h.doNotShowGoToLink=h.settingsService.valueAsBoolean(h.constants.settings.names.doNotShowGoToLink),h.translateReady=h.$translate.onReady().then(function(){h.titleFinalJoiner=n.instant(h.resources.strings.chat_titleFinalJoiner),h.unknownUserName=n.instant(h.resources.strings.chat_unknownUserDefaultName),h.userStringJoiner=n.instant(h.resources.strings.chat_userStringJoiner)}),h}return n(t,e),t.$inject=["$q","utilityService","$translate","constants","conversationsService","loggingService","settingsService","peopleService","resources","conversationsStore","sxConfig"],t.prototype.getChat=function(e){var t=this.conversationsService.getConversation(e);return t&&t.isChat()?t:null},t.prototype.getMeetingTitle=function(e){var t;if(e){var i=e&&e.getMeetingInfo(),n=e.topicName()||i&&i.subject;n||(e.topicName()||this.logger.warn("meeting chat cannot get the title from chat.topicName because chat.topicName is null"),i?i.subject||this.logger.warn("meeting chat cannot get the title from meetingInfo.subject because meetingInfo.subject is null"):this.logger.warn("meeting chat cannot get the title from meetingInfo because meetingInfo is null")),n||(n=this.$translate.instant(this.resources.strings.quick_calendar_invite_no_title));var r=i&&i.isCancelled?this.$translate.instant(this.resources.strings.meeting_cancelled_message_title_format,{title:n}):n;t={title:r,longTitle:r,needsRebuild:!1}}return t||null},t.prototype.getChatConversationTitles=function(e){var t=this.getChat(e);return t&&t.isMeetingConversation()?this.getMeetingTitle(t):this.getCachedTitles(t)},t.prototype.getCustomChatConversationTitles=function(e,t){var i=this,n=this.getChat(e);if(n&&t){var r=t(n.getOtherMembers(this.sxConfig.getCurrentSkypeMri()));return this.peopleService.getAllShortPeopleProfile(r,"chat-titles-service",!1,new teamspace.services.PeoplePickerFilters).then(function(e){if(e){var t=_.map(e,function(e){if(e)return{displayName:e.displayName,mri:e.mri}});return t&&t.length>0?{title:i.getShortTitleForMembers(t),longTitle:i.getLongTitleForMembers(t),needsRebuild:!1}:null}})}return this.$q.when(null)},t.getChatMembersForProfilePicture=function(e){var t=_.map(e,function(e){if(null!=e)return{userId:e.mri,displayName:e.displayName}});return _.chain(t).sortBy(function(e){return e.displayName}).slice(0,3).value()},t.prototype.buildAndCacheTitles=function(e,t){var i=this;void 0===t&&(t=!1);var n=this.buildMembersCacheEntry(e,t);return this.$q.all([n]).then(function(t){var n=t[0];i.updateMembersCacheEntry(e,n)})},t.prototype.buildChatTitles=function(e){var i=this,n=this.$q.defer(),r=this.getChat(e);if(r){var s=this.getChatConversationTitles(e);s&&!s.needsRebuild?n.resolve(s):this.membersCache[this.hashForMembers(r)]?(this.logger.error("Invalid chat state: should not have members cache entry if getChatConversationTitles returned a falsy value. ChatId: "+r.id),n.reject("Invalid title state for chat: "+r.id)):n.promise=this.buildAndCacheTitles(r,r.isFederated()).then(function(){return i.getChatConversationTitles(r.id)})}else n.resolve(t.createEmptyTitles());return n.promise},t.prototype.precacheTitle=function(e){var t=this,i=new SkypeX.Services.SkypeConversationLocal,n=!1,r=this.sxConfig.getCurrentSkypeMri();i.members=_.map(e,function(e){var t={id:e.mri,nameHint:e.nameHint};return t.id===r&&(n=!0),t}),n||i.members.push({id:r});var s=_.filter(e,function(e){return e.mri!==t.sxConfig.getCurrentSkypeMri()}),a=s&&1===s.length&&(s[0].isFederated||teamspace.services.SfBInteropUtilsService.isTemporaryFederationUserMri(s[0].mri));this.buildAndCacheTitles(i,a)},t.prototype.updateMembersCacheEntry=function(e,t){if(e){var i=this.hashForMembers(e);this.membersCache[i]=_.clone(t)}},t.prototype.getCachedTitles=function(e){var t=this.hashForMembers(e),i=this.membersCache[t],n=null;if(i){var r=i?i.longTitle:"",s=i?i.names:{},a=i?i.pictureMembers:[],o=i?i.shortTitle:"";n={longTitle:r,names:s,pictureMembers:a,title:e.topicName()||o,needsRebuild:!i,oneToOneUserId:this.doNotShowGoToLink?s&&t:void 0}}return n},t.prototype.buildNameHintsDictionaryFromMembers=function(e){var i=this,n={},r=!!(e&&e.length>0);return _.forEach(e,function(e){if(e&&e.id!==i.sxConfig.getCurrentSkypeMri()){var s=t.hasValidNameHint(e);n[e.id]||(n[e.id]=e.nameHint),r=r&&s}}),{dictionary:n,areAllValid:r}},t.prototype.buildMembersCacheEntry=function(e,i){var n=this;void 0===i&&(i=!1);var r,s=this.buildNameHintsDictionaryFromMembers(e.members);if(s.areAllValid)r=this.$q.resolve(_.map(s.dictionary,function(e,t){return _.assign({},e,{mri:t})}));else if(_.isEmpty(s.dictionary))r=this.$q.resolve(void 0);else{var a=this.settingsService.valueAsBoolean("useChatSvcAggStartup")&&!this.settingsService.valueAsBoolean(this.constants.settings.names.persistPeopleProfilesFromStartup)&&!i,o=i&&!teamspace.services.SfBInteropUtilsService.isTemporaryFederationUserMri(e.getOtherMembers(this.sxConfig.getCurrentSkypeMri())[0]),c=_.keys(s.dictionary),l=this.loggingService.newScenario("chat_buildtitles_profilefetch");l.eventData={id:e.id},c.length!==e.members.length-1&&(this.logger.error("Mismatch between other members and mris to request"),l.mark("other_members_to_mris_mismatch",{errorInfo:JSON.stringify({description:"length of otherMembers does not match length of mris sent to peopleService",userIds:_.map(c,function(e){return SkypeX.Services.ChatServiceUtils.hideMriIfApplicable(e)}),otherMemberMris:_.map(e.getOtherMembers(this.sxConfig.getCurrentSkypeMri()),function(e){return SkypeX.Services.ChatServiceUtils.hideMriIfApplicable(e)})})})),o&&c.length>1&&(this.logger.error("Too many other members ({0}) in federated chat. Only the first one will be used",c.length),l.mark("federated_group_chat",{errorInfo:JSON.stringify({description:"2 or more other members in federated chat. This is not allowed. Only the first one will be used",userIds:_.map(c,function(e){return SkypeX.Services.ChatServiceUtils.hideMriIfApplicable(e)}),userIdUsed:SkypeX.Services.ChatServiceUtils.hideMriIfApplicable(c[0]),otherMemberMris:_.map(e.getOtherMembers(this.sxConfig.getCurrentSkypeMri()),function(e){return SkypeX.Services.ChatServiceUtils.hideMriIfApplicable(e)})})}),c=[_.head(c)]),r=(a?this.usersFromConversationsStore(c):o?this.peopleService.searchFederatedUsersByMri(c,"chat-titles-service"):this.peopleService.getAllShortPeopleProfile(c,"chat-titles-service",!1,new teamspace.services.PeoplePickerFilters)).then(function(t){if(t&&t.length===c.length)l.stop();else{var i=c,r=_.map(t,function(e){return e.mri});l.fail({errorInfo:JSON.stringify({description:"number of requested users does not match number of returned user profiles",numRequestedUsers:i.length,numReceivedProfiles:r.length})}),n.logger.error("number of requested users does not match number of returned user profiles. number requested: {0}, number received: {1}",i.length,r.length)}return s.dictionary=n.buildNameHintsFromProfiles(e,t),s.areAllValid=t&&!!t.length,s.areAllValid&&n.conversationsService.updateNameHints(e.id,s.dictionary),t},function(e){l.fail({errorInfo:JSON.stringify({description:"peopleService rejected the promise",error:e})}),n.logger.error("getAllLatestPeopleProfile - failed getting the data from people service")})}return r.then(function(i){return n.buildMemberTitles(i).then(function(r){var a=n.settingsService.valueAsBoolean(n.constants.settings.names.enableGroupChatProfilePicture);return r&&{longTitle:r.longTitle,shortTitle:r.shortTitle,names:e&&e.members&&2===e.members.length?s.dictionary:null,pictureMembers:a?t.getChatMembersForProfilePicture(i):void 0}})})},t.prototype.usersFromConversationsStore=function(e){var t=this,i=[],n=[],r=this.$translate.instant(this.resources.strings.guest_user_postfix);return _.forEach(e,function(e){var s=t.conversationsStore.users[e];if(s){var a=_.assign({mri:s.mri},s,{guestlessDisplayName:s.displayName});s.type===t.constants.userTypes.guest&&(a.displayName=s.displayName+" "+r),n.push(a)}else i.push(e)}),i.length>0?this.peopleService.getAllShortPeopleProfile(i,"chat-titles-service",!1,new teamspace.services.PeoplePickerFilters).then(function(e){return _.concat(n,e)}):this.$q.when(n)},t.prototype.buildMemberTitles=function(e){var t=this;return this.translateReady.then(function(){return(e=_.sortBy(e,function(e){return e&&e.displayName&&e.displayName.toLowerCase()}))&&e.length?{longTitle:t.getLongTitleForMembers(e),shortTitle:t.getShortTitleForMembers(e)}:void 0})},t.prototype.buildNameHintsFromProfiles=function(e,t){for(var i={},n=this.sxConfig.getCurrentSkypeMri(),r=this.$translate.instant(this.resources.strings.unknown_user),s=0;s<e.members.length;s++){var a=e.members[s].id;if(a!==n){var o=_.find(t,{mri:a});o&&(i[a]={displayName:o.displayName,guestlessDisplayName:o.guestlessDisplayName,expiration:o.$$expires||Date.now()+this.constants.database.defaultCacheExpiration,givenName:o.givenName,surname:o.surname,upn:o.userPrincipalName},o.displayName===r&&(i[a].expiration=Date.now()+this.constants.timeInMiliseconds.hour))}}return i},t.hasValidNameHint=function(e){var t=e&&e.nameHint;return!!(t&&(t.expiration||0)>Date.now()&&t.displayName&&t.upn)},t.prototype.hashForMembers=function(e){var t=e&&e.getOtherMembers(this.sxConfig.getCurrentSkypeMri());return t?t.sort().join("_"):""},t.prototype.getLongTitleForMembers=function(e){var t=this;return this.utilityService.unleakString(_.reduce(e,function(e,i,n,r){var s=i.displayName||t.unknownUserName;return n>0&&(n+1===r.length?e+=(r.length>2?t.userStringJoiner:"")+" "+t.titleFinalJoiner+" ":e+=t.userStringJoiner+" "),e+s},""))},t.prototype.getShortTitleForMembers=function(e){var t=this;return this.utilityService.unleakString(_.transform(e,function(e,i,n,r){var s=i.displayName||t.unknownUserName,a=i.givenName,o=i.surname,c=s;if(r.length>1){c=a||i.guestlessDisplayName||c;var l=o&&o.substr(0,1),p=n>0&&r[n-1].displayName,u=n>0&&(r[n-1].givenName||p||t.unknownUserName),h=n+1<r.length&&r[n+1].displayName,d=n+1<r.length&&(r[n+1].givenName||h||t.unknownUserName);c!==u&&c!==d||(c=l?a+" "+l:s)}return n>0&&(c=n+1===r.length?(r.length>2?t.userStringJoiner:"")+" "+t.titleFinalJoiner+" "+c:t.userStringJoiner+" "+c),t.pushName(e,c,r)},[]).join(""))},t.prototype.pushName=function(e,t,i){var n=0;if(e.push(t),i.length>1){for(var r=this.constants.p2p.groupChat.titleMaxWidth,s=this.resources.strings.chat_leftRailOverflowTextNew,a=this.resources.strings.chat_leftRailOverflowTextPluralNew,o="",c=e.join("");c.length>r;){var l=e.pop();if(o="",n=i.length-e.length,0===e.length&&(n-=1),n>0){var p=1===n?s:a;if(o=this.userStringJoiner+" "+this.$translate.instant(p,{numberOfAdditionalMembers:n}),0===e.length){var u=_.truncate(l,{length:r-o.length});r=Math.max(r,u.length+o.length),e.push(u)}}c=e.join("")+o}""!==o&&e.push(o)}return 0===n},t.createEmptyTitles=function(){return{longTitle:"",title:"",names:{},pictureMembers:[],needsRebuild:!1}},t}(SkypeX.Services.ObservableBase);angular.module("teamspace.chatTitlesService",["pascalprecht.translate","teamspace.constants","teamspace.peopleService","skypeX.sxConfig"]).service("chatTitlesService",r)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.isBrandNewChatFlow=!1,this.id=e,this.title=t,this.newRecipientMembers=[],this.newRecipientChats=[]}return Object.defineProperty(e.prototype,"otherMembers",{get:function(){var e=[];return this.newRecipientMembers&&(e=this.newRecipientMembers),this.newRecipientChats&&this.newRecipientChats.forEach(function(t){e=e.concat(t.otherMembers)}),_.uniqBy(e,"mri")},enumerable:!0,configurable:!0}),e.prototype.setBrandNewChatState=function(e){this.isBrandNewChatFlow=e},e.prototype.getBrandNewChatState=function(){return this.isBrandNewChatFlow},Object.defineProperty(e.prototype,"recipientChats",{get:function(){return this.newRecipientChats||[]},enumerable:!0,configurable:!0}),e.prototype.isOneOnOneBotChat=function(){return(!this.newRecipientChats||0==this.newRecipientChats.length)&&this.newRecipientMembers&&1==this.newRecipientMembers.length&&SkypeX.Services.ChatServiceUtils.isBotMri(this.newRecipientMembers[0].mri)},e}();t.ChatConversationDraft=r;var s=function(e){function t(t,i,n,r,s,a,o,c,l,p,u,h,d){var g=e.call(this)||this;return g.$q=t,g.$rootScope=i,g.$translate=n,g.chatTitlesService=r,g.constants=s,g.conversationsService=a,g.chatConversationFactory=o,g.dialogService=c,g.localMessageStorageService=l,g.loggingService=p,g.navigationService=u,g.resources=h,g.settingsService=d,g.showGroupNameLine=!1,g.logger=g.loggingService.newLogger("NewChatService"),g.newChatDraftTitle=g.$translate.instant(g.resources.strings.chats_newChat),g.resetNavigationDeferred(),g}return n(t,e),t.$inject=["$q","$rootScope","$translate","chatTitlesService","constants","conversationsService","chatConversationFactory","dialogService","localMessageStorageService","loggingService","navigationService","resources","settingsService"],t.prototype.toggleGroupName=function(){this.switchBrandNewChatState(),this.showGroupNameLine=this.newChat&&this.newChat.getBrandNewChatState(),this.trigger(teamspace.services.NewChatServiceEvents.EventType_ReevaluateAllowedRecipients),this.triggerChatDraftViewUpdate(this.newChat)},t.prototype.switchBrandNewChatState=function(e){this.newChat&&this.newChat.setBrandNewChatState(e||!this.newChat.isBrandNewChatFlow)},t.prototype.setChatTitle=function(e){this.newChat&&(this.newChat.chatTitle=e)},t.prototype.createNewChat=function(){this.newChat=new r(this.constants.p2p.newChatId,this.newChatDraftTitle),this.showGroupNameLine=!1},t.prototype.getNewChat=function(){return this.newChat},t.prototype.isNewChatDraft=function(e){return!(!this.newChat||!(this.newChat.id===e||this.newChat.conversation&&this.newChat.conversation.id===e))},t.prototype.discardDraftIfEmpty=function(){var e=this.getNewChat();e&&_.isEmpty(e.newRecipientMembers)&&_.isEmpty(e.newRecipientChats)&&!this.newChatHasMessageDraft()&&this.clearNewChat()},t.prototype.newChatHasMessageDraft=function(){var e=null;return this.getNewChat()&&(e=this.localMessageStorageService.getLocalConversationItemByConversationId(this.constants.p2p.newChatId)),e&&(e.body||e.attachments&&e.attachments.length>0)},t.prototype.addMember=function(e,t,i){if(void 0===t&&(t=null),this.newChat){i&&i.mark("add_to_newChat",{chatId:this.constants.p2p.newChatId}),e&&this.addMemberHelper(e,i),t&&this.addChatHelper(t,i);var n=this.newChat.otherMembers;n&&this.chatTitlesService.precacheTitle(n),this.triggerChatDraftViewUpdate(this.newChat)}},t.prototype.addMemberHelper=function(e,t){this.newChat&&(this.newChat.newRecipientMembers||(this.newChat.newRecipientMembers=[]),0===this.newChat.newRecipientMembers.filter(function(t){return t.mri===e.mri}).length&&(this.newChat.newRecipientMembers.push(e),t&&t.mark("pushed_new_member",{data:"mri: "+e.mri+", newNumOthers: "+this.newChat.newRecipientMembers.length})))},t.prototype.addChatHelper=function(e,t){this.newChat&&(this.newChat.newRecipientChats||(this.newChat.newRecipientChats=[]),_.find(this.newChat.newRecipientChats,function(t){return t.id===e.id})||(this.newChat.newRecipientChats.push(e),t&&t.mark("pushed_new_chat",{data:"chatId: "+e.id+", newNumOtherChats: "+this.newChat.newRecipientChats.length})))},t.prototype.removeMember=function(e,t,i){if(void 0===t&&(t=null),this.newChat&&this.newChat.otherMembers&&this.newChat.otherMembers.length>0){i&&i.mark("remove_member_from_newChat"),e&&(this.newChat.newRecipientMembers=this.newChat.newRecipientMembers.filter(function(t){var n=t.mri!==e.mri;return n&&teamspace.services.SfBInteropUtilsService.isSfBMri(t.mri)&&(n=teamspace.services.SfBInteropUtilsService.asTeamsMri(t.mri)!==e.mri),i&&!n&&i.mark("filtering_out_member",{data:e.mri}),n})),t&&this.newChat.newRecipientChats&&(this.newChat.newRecipientChats=this.newChat.newRecipientChats.filter(function(e){var n=e.id!==t.id;return i&&!n&&i.mark("filtering_out_member",{data:t.id}),n}));var n=this.newChat.otherMembers;i&&n&&i.mark("new_chat_member_length",{data:n.length}),this.newChat.conversation=null,this.triggerChatDraftViewUpdate(this.newChat)}},t.prototype.triggerChatDraftHeaderUpdate=function(e){var t=e.id,i=e.otherMembers;e.conversation&&(i=_.uniqBy(i.concat(e.conversation.otherMembers),"mri")),e.id===this.constants.p2p.newChatId&&e.conversation&&(t=e.conversation.id),t.startsWith("19:preview")&&(this.trigger(teamspace.services.NewChatServiceEvents.EventType_UpdateChatHeader,t,i),this.trigger(teamspace.services.NewChatServiceEvents.EventType_UpdateChatPane,t))},t.prototype.triggerChatDraftViewUpdate=function(e){var t=null;if(e.newRecipientChats.length>0){var i=this.conversationsService.getChatConversation(e.newRecipientChats[0].id,!1);t=this.chatConversationFactory.fromConversation(i,null)}else{var n=e.conversation&&e.conversation.otherMembers?e.otherMembers.concat(e.conversation.otherMembers):e.otherMembers.slice(),r=_.uniqBy(n,function(e){return e.mri}),s=this.getConversationMemberMris(r);s&&s.length>0&&!this.newChat.isBrandNewChatFlow&&(t=this.conversationsService.findChatConversationWith(s))}if(t&&t.id&&t.otherMembers&&1===t.otherMembers.length&&(!e.newRecipientChats||0===e.newRecipientChats.length)){var a=this.conversationsService.getConversation(t.id);a.isLie()||a.isOneOnOne()||(t=void 0)}e.conversation=t||null,this.trigger(teamspace.services.NewChatServiceEvents.EventType_RecipientsUpdateInNewChat,e.id)},t.prototype.focusOnAddLine=function(e){e&&this.dialogService.isDialogOpen(e)&&this.trigger(teamspace.services.NewChatServiceEvents.EventType_FocusOnToLine)},t.prototype.focusOnToLine=function(){this.trigger(teamspace.services.NewChatServiceEvents.EventType_FocusOnToLine)},t.prototype.getConversationMemberMris=function(e){var t=(i=teamspace.services.ChatConversationMemberConverter).toUsers.apply(i,e);return 1===t.length&&!teamspace.services.SfBInteropUtilsService.isTemporaryFederationUserMri(t[0].mri)&&(teamspace.services.SfBInteropUtilsService.isSfBMri(t[0].mri)||teamspace.services.SfBInteropUtilsService.isSfBMri(this.conversationsService.getPrivateChatUserMri(t[0],"newChatService")))?t.map(function(e){return teamspace.services.SfBInteropUtilsService.asSfBMri(e.mri)}):t.map(function(e){return teamspace.services.SfBInteropUtilsService.asTeamsMri(e.mri)});var i},t.prototype.triggerChatMessageSend=function(e){this.trigger(teamspace.services.NewChatServiceEvents.EventType_MessageSend,e)},t.prototype.setOpenDialogResult=function(e){this.openDialogResult=e},t.prototype.getOpenDialogResult=function(){return this.openDialogResult},t.prototype.clearNewChat=function(e){if(void 0===e&&(e=!0),this.newChat){var t=this.localMessageStorageService.getLocalConversationItemByConversationId(this.newChat&&this.newChat.id);t&&this.localMessageStorageService.removeLocalConversationItem(t.clientId),this.newChat=null,this.showGroupNameLine=!1,e&&this.trigger(teamspace.services.NewChatServiceEvents.EventType_DeleteNewChat)}},t.prototype.updateChatPane=function(){var e=this.newChat.conversation?this.newChat.conversation.id:this.newChat.id;this.clearNewChat(),this.trigger(teamspace.services.NewChatServiceEvents.EventType_UpdateChatPane,e)},t.prototype.resolveNewChat=function(){var e=this.getNewChat();if(e){var t=e.otherMembers;if(!e.isBrandNewChatFlow&&t&&t.length>0||e.isBrandNewChatFlow&&t&&t.length>1){var i="",n=1==t.length&&(t[0].isFederated||teamspace.services.SfBInteropUtilsService.isTemporaryFederationUserMri(t[0].mri));if(e.conversation&&e.conversation.id)i=e.conversation.id;else{var r=this.getConversationMemberMris(t),s=void 0;i=(s=e.isBrandNewChatFlow&&!_.isEmpty(e.chatTitle)?this.conversationsService.getConversationLieWith(r,e.chatTitle):this.conversationsService.getConversationLieWith(r,void 0,n))&&s.id;var a=this.loggingService.newScenario("newchat_resolves_to_lie");if(a.eventData={id:i},s){var o=s.members?s.members.length-1:0;t.length!==o?a.fail({errorInfo:JSON.stringify({description:"mris do not match in the chat draft and lie",draftChatMembersLength:t.length,lieChatMembersLength:o})}):a.stop()}else a.fail({error:"conversationsService failed to create a lie conversation"})}if(i){var c=void 0;this.settingsService.valueAsBoolean(this.constants.settings.names.disablePerfTableLogging)||(c=this.loggingService.newCounter("draft_before_recipients",{conversationId:i}));var l=this.localMessageStorageService.getLocalConversationItemByConversationId(this.constants.p2p.newChatId),p=this.localMessageStorageService.getLocalConversationItemByConversationId(i),u=SkypeX.Services.Utilities.newClientMessageId();l?(p&&(c&&c.mark("draft_conflict"),u=p.clientId||u),l.conversationId=i,this.localMessageStorageService.replaceLocalConversationItem(u,u,l)):p||(u=null),c&&c.stop(),this.clearNewChat(),this.logger.log("triggering chat draft to lie resolution event. Chat lie id is: "+i),this.trigger(teamspace.services.NewChatServiceEvents.EventType_ResolveNewChat,i,u),this.trigger(teamspace.services.NewChatServiceEvents.EventType_ResetChatPeoplePickerReadOnlyProperty,null,!0)}else this.logger.log("failed to resolve chat draft to lie: id is invalid")}else this.logger.log("failed to resolve chat draft to lie. isBrandNewChat is : "+e.isBrandNewChatFlow+" and number of selected members is "+t.length),this.navigationResolved()}},t.prototype.resetNavigationDeferred=function(){this.navigationDeferred=this.$q.defer()},t.prototype.navigationResolved=function(){this.navigationDeferred&&(this.navigationDeferred.resolve(),this.resetNavigationDeferred())},t.prototype.navigationComplete=function(){return this.navigationDeferred.promise},t.prototype.navigateToNewChat=function(e,t,i){var n=this;void 0===t&&(t=""),void 0===i&&(i=!1);var r={slug:this.constants.p2p.newChatId,middlePane:this.constants.messages.panes.conversations,groupName:this.newChatDraftTitle,threadId:void 0,messageId:void 0,ctx:this.constants.navigation.context.chat,navCtx:e,lm:t};return this.navigationService.navigatePromise(this.$rootScope,this.constants.states.appConversation,r,i).then(function(e){e===teamspace.services.NavigationResultType.None&&n.trigger(teamspace.services.NewChatServiceEvents.EventType_FocusOnToLine)})},t}(SkypeX.Services.ObservableBase);t.NewChatService=s,angular.module("teamspace.newChatService",["pascalprecht.translate","teamspace.chatTitlesService","teamspace.chatConversationFactory","teamspace.constants","teamspace.conversationsService","teamspace.dialogService","teamspace.locales","teamspace.localMessageStorageService","teamspace.loggingService","teamspace.navigationService","teamspace.settingsService"]).service("newChatService",s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(245),i(253),i(254),i(255),i(256),i(257),i(258),i(259),i(260),i(261),i(262),i(263),i(264),i(265),i(266),i(267),i(268),i(283),i(284),angular.module("teamspace.cortanaService",["teamspace.cortanaJSService"]).factory("cortanaService",["$injector",function(e){return e.get("cortanaJSService")}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(246),r=function(){function e(e,t,i){var n=this;this.constants=e,this.deviceManagerService=t,this.loggingService=i,this.logger=this.loggingService.newLogger("AudioMediaDeviceService"),this.devices=new Map,this.deviceManagerService.subscribe(function(){return n.updateCurrentDevice()},this.constants.events.calling.devicesChanged)}return e.$inject=["constants","deviceManagerService","loggingService"],e.prototype.getAudioMediaDevice=function(t,i){if(t=t||this.currentAduioSourceDeviceId||e.defaultDeviceId,i=i||this.currentAduioSinkDeviceId||e.defaultDeviceId,!t||!i)return this.logger.error("getAudioMediaDevice error: missing devices"),null;var r=this.getDeviceKey(t,i);if(this.devices.has(r))return this.devices.get(r);var s=new n.AudioMediaDevice(t,this.logger);return this.devices.set(r,s),s},e.prototype.getDeviceKey=function(e,t){return e+"-"+t},e.prototype.updateCurrentDevice=function(){var e=this.deviceManagerService.getSelectedDevices();e?(this.currentAduioSourceDeviceId=e.microphone||"",this.currentAduioSinkDeviceId=e.speaker||"",this.logger.info("Cortana audio in: {0} audio out: {1}",this.currentAduioSourceDeviceId,this.currentAduioSinkDeviceId)):this.logger.error("failed to get selected devices")},e.defaultDeviceId="default",e}();t.AudioMediaDeviceService=r,angular.module("teamspace.audioMediaDeviceService",["teamspace.deviceManagerService","teamspace.loggingService"]).service("audioMediaDeviceService",r)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(247),r=i(248),s=i(249),a=i(251),o=function(){function e(e,t){this.deviceId=e,this.logger=t,this.audioStreamInput=null,this.recorder=null,this.player=new a.PCMPlayer}return e.prototype.startListening=function(e){var t=this;if(!this.deviceId)return this.logger.error("cannot start listening: no device"),Promise.resolve(null);if(r.AudioSourceFormat.PCM16k16bitRiff,this.audioStreamInput)return Promise.resolve(this.audioStreamInput.stream.getReader());if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return this.logger.error("navigator.mediaDevices or getUserMedia not available"),Promise.resolve(null);var i=this.createAudioContext();return i?new Promise(function(e,r){t.logger.debug("getUserMedia for device id {0}",t.deviceId),navigator.mediaDevices.getUserMedia({audio:{deviceId:t.deviceId},video:!1}).then(function(a){t.audioStreamInput={audioCtx:i,mediaStream:a,stream:new n.Stream(t.deviceId)},t.recorder=new s.PCMRecorder;try{t.recorder.record(t.audioStreamInput)}catch(e){t.cleanUpInputAudioStream(),r(e)}e(t.audioStreamInput.stream.getReader())},function(e){t.logger.error("getUserMedia error"),t.closeAudioContext(i),r(e)})}):Promise.resolve(null)},e.prototype.stopListening=function(){this.deviceId&&this.audioStreamInput&&this.cleanUpInputAudioStream()},e.prototype.playFromBuffer=function(e){var t=this;if(!this.player||!e||0===e.length)return Promise.resolve(!1);if(this.audioStreamOutput)return this.logger.warn("previous playback has not completed yet"),Promise.resolve(!1);var i=this.createAudioContext();return i?(this.audioStreamOutput={audioCtx:i},this.player.playFromBuffer(this.audioStreamOutput,e).then(function(){return t.cleanUpOutputAudioStream(),!0}).catch(function(){return t.cleanUpOutputAudioStream(),!1})):Promise.resolve(!1)},e.prototype.stopPlaying=function(){this.player&&this.audioStreamOutput&&this.player.stop(this.audioStreamOutput)},e.prototype.cleanUpInputAudioStream=function(){this.cleanUpAudioStream(this.audioStreamInput,this.recorder,null),this.audioStreamInput=null,this.recorder=null},e.prototype.cleanUpOutputAudioStream=function(){this.cleanUpAudioStream(this.audioStreamOutput,null,this.player),this.audioStreamOutput=null},e.prototype.cleanUpAudioStream=function(e,t,i){e&&(e.stream&&(e.stream.getReader().close(),e.stream.close(),e.stream=null),t&&t.releaseMediaResources(e),i&&i.releaseMediaResources(e),e.mediaStream=null,e.audioBufferSourceNode&&(e.audioBufferSourceNode.stop(),e.audioBufferSourceNode.disconnect(),e.audioBufferSourceNode=null),this.closeAudioContext(e.audioCtx),e.audioCtx=null)},e.prototype.createAudioContext=function(){var e=window.AudioContext||window.webkitAudioContext||!1;return e?new e:(this.logger.error("failed to get AudioContext"),null)},e.prototype.closeAudioContext=function(e){e&&"close"in e&&e.close()},e}();t.AudioMediaDevice=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(22),r=i(81),s=function(){function e(e,t,i){this.isClosed=!1,this.readerQueue=t,this.onClose=i,this.streamId=e}return e.prototype.read=function(){var e=this;return this.isClosed?Promise.reject("StreamReader closed"):this.readerQueue.dequeue().then(function(t){return t.isEnd&&e.readerQueue.dispose("End of stream reached"),t})},e.prototype.close=function(){this.isClosed||(this.isClosed=!0,this.readerQueue.dispose("StreamReader closed"),this.onClose())},e}();t.StreamReader=s;var a=function(){function e(e){this.readerIdCounter=1,this.isEnded=!1,this.id=e||n.CortanaUtilities.createNoDashGuid(),this.streambuffer=[],this.readerQueues=new Map}return Object.defineProperty(e.prototype,"isClosed",{get:function(){return this.isEnded},enumerable:!0,configurable:!0}),e.prototype.write=function(e){this.throwIfClosed(),this.writeStreamChunk({buffer:e,isEnd:!1})},e.prototype.getReader=function(){var e=this,t=this.readerIdCounter++,i=new r.Queue;return this.readerQueues.set(t,i),this.streambuffer.forEach(function(e){i.enqueue(e)}),new s(this.id,i,function(){e.readerQueues.delete(t)})},e.prototype.close=function(){this.isEnded||(this.writeStreamChunk({buffer:null,isEnd:!0}),this.isEnded=!0)},e.prototype.writeStreamChunk=function(e){this.throwIfClosed(),this.streambuffer.push(e),this.readerQueues.forEach(function(t){if(!t.isDisposed())try{t.enqueue(e)}catch(e){}})},e.prototype.throwIfClosed=function(){if(this.isEnded)throw new Error("stream closed")},e}();t.Stream=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.PCM16k16bitRiff=0]="PCM16k16bitRiff"}(t.AudioSourceFormat||(t.AudioSourceFormat={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(250),r=function(){function e(){}return e.prototype.record=function(e){var t=function(){var t=0;try{return e.audioCtx.createScriptProcessor(t,1,1)}catch(n){t=2048;for(var i=e.audioCtx.sampleRate;t<16384&&i>=32e3;)t<<=1,i>>=1;return e.audioCtx.createScriptProcessor(t,1,1)}}(),i=new n.RiffPcmEncoder(e.audioCtx.sampleRate,16e3),r=!0;t.onaudioprocess=function(t){var n=t.inputBuffer.getChannelData(0);if(e.stream&&!e.stream.isClosed){var s=i.encode(n,r);s&&(e.stream.write(s),r=!1)}};var s=e.audioCtx.createMediaStreamSource(e.mediaStream),a=e.audioCtx.createBiquadFilter&&e.audioCtx.createBiquadFilter();a&&(a.type="lowpass",a.frequency.setValueAtTime(1e3,e.audioCtx.currentTime),a.Q.value=1),this.mediaResources={scriptProcessorNode:t,filterNode:a,source:s,stream:e.mediaStream},s.connect(t),a?(t.connect(a),a.connect(e.audioCtx.destination)):t.connect(e.audioCtx.destination)},e.prototype.releaseMediaResources=function(e){this.mediaResources&&(this.mediaResources.scriptProcessorNode&&(this.mediaResources.scriptProcessorNode.disconnect(this.mediaResources.filterNode?this.mediaResources.filterNode:e.audioCtx.destination),this.mediaResources.scriptProcessorNode=null),this.mediaResources.filterNode&&(this.mediaResources.filterNode.disconnect(e.audioCtx.destination),this.mediaResources.filterNode=null),this.mediaResources.source&&(this.mediaResources.source.disconnect(),this.mediaResources.stream.getTracks().forEach(function(e){return e.stop()}),this.mediaResources.source=null))},e}();t.PCMRecorder=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(82),r=function(){function e(e,t){this.channelCount=1,this.actualSampleRate=e,this.desiredSampleRate=t}return e.prototype.encode=function(e,t){if(!e)return null;var i=2*(e=this.downSampleAudioFrame(e,this.actualSampleRate,this.desiredSampleRate)).length;if(!t){var r=new ArrayBuffer(i),s=new DataView(r);return this.setFloatArrayToInt16(s,0,e),r}var a=n.RIFFConstants.headerLength-2,o=new ArrayBuffer(a+i),c=new DataView(o);return this.setString(c,n.RIFFHeadersOffset.riffHeaderId,n.RIFFConstants.riffChunkId),c.setUint32(n.RIFFHeadersOffset.fileSize,0,!0),this.setString(c,n.RIFFHeadersOffset.waveTag,"WAVEfmt "),c.setUint32(n.RIFFHeadersOffset.waveFormatChunkLength,16,!0),c.setUint16(n.RIFFHeadersOffset.formatTag,1,!0),c.setUint16(n.RIFFHeadersOffset.channelCount,this.channelCount,!0),c.setUint32(n.RIFFHeadersOffset.sampleRate,this.desiredSampleRate,!0),c.setUint32(n.RIFFHeadersOffset.avgBytesPerSec,this.desiredSampleRate*this.channelCount*2,!0),c.setUint16(n.RIFFHeadersOffset.blockAlign,2*this.channelCount,!0),c.setUint16(n.RIFFHeadersOffset.bitsPerSample,16,!0),this.setString(c,n.RIFFHeadersOffset.dataChunkId-2,n.RIFFConstants.dataChunkId),c.setUint32(n.RIFFHeadersOffset.dataChunkLength-2,0,!0),this.setFloatArrayToInt16(c,a,e),o},e.prototype.setString=function(e,t,i){for(var n=0;n<i.length;n++)e.setUint8(t+n,i.charCodeAt(n))},e.prototype.setFloatArrayToInt16=function(e,t,i){for(var n=0;n<i.length;n++,t+=2){var r=Math.max(-1,Math.min(1,i[n]));e.setInt16(t,r<0?32768*r:32767*r,!0)}},e.prototype.downSampleAudioFrame=function(e,t,i){if(i===t||i>t)return e;for(var n=t/i,r=Math.round(e.length/n),s=new Float32Array(r),a=0,o=0;o<r;){for(var c=Math.round((o+1)*n),l=0,p=0;a<c&&a<e.length;)l+=e[a++],p++;s[o++]=l/p}return s},e}();t.RiffPcmEncoder=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(252),r=function(){function e(){this.decoder=new n.RiffPcmDecoder}return e.prototype.playFromBuffer=function(e,t){var i=this;return e.audioCtx?new Promise(function(n,r){for(var s,a,o=0,c=0;c<t.length;c++){if(0===c){if(!(a=i.decoder.decode(t[c],!0)))return n(!1);s=e.audioCtx.createBuffer(i.decoder.channelCount,i.decoder.totalAudioSamples,i.decoder.sampleRate)}else a=i.decoder.decode(t[c],!1);a.byteLength/i.decoder.bytesPerSample+o>i.decoder.totalAudioSamples&&(a=a.subarray(0,i.decoder.totalAudioSamples-o)),s.getChannelData(0).set(a,o),o+=a.length}e.audioBufferSourceNode=e.audioCtx.createBufferSource(),e.audioBufferSourceNode.addEventListener("ended",function(){n(!0)}),e.audioBufferSourceNode.buffer=s,e.audioBufferSourceNode.connect(e.audioCtx.destination),e.audioBufferSourceNode.start()}):Promise.resolve(!1)},e.prototype.stop=function(e){e&&e.audioBufferSourceNode&&(e.audioBufferSourceNode.stop(),e.audioBufferSourceNode=null)},e.prototype.releaseMediaResources=function(e){e&&e.audioBufferSourceNode&&(e.audioBufferSourceNode.stop(),e.audioBufferSourceNode.disconnect(),e.audioBufferSourceNode=null)},e}();t.PCMPlayer=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(82),r=function(){function e(){}return e.prototype.decode=function(e,t){if(t){this.totalAudioSamples=0,this.hasNonAlignedBytes=!1;var i=new DataView(e);if(i.byteLength<n.RIFFConstants.headerLength)return null;var r=this.getString(i,n.RIFFHeadersOffset.riffHeaderId,4);i.getUint32(n.RIFFHeadersOffset.fileSize,!0),this.getString(i,n.RIFFHeadersOffset.waveTag,8),this.channelCount=i.getUint16(n.RIFFHeadersOffset.channelCount,!0),this.sampleRate=i.getUint32(n.RIFFHeadersOffset.sampleRate,!0);var s=i.getUint16(n.RIFFHeadersOffset.bitsPerSample,!0),a=this.getString(i,n.RIFFHeadersOffset.dataChunkId,4),o=i.getUint32(n.RIFFHeadersOffset.dataChunkLength,!0);if(!o)return null;if(r!==n.RIFFConstants.riffChunkId||a!==n.RIFFConstants.dataChunkId||16!==s)return null;this.bytesPerSample=s/8,this.totalAudioSamples=o/this.bytesPerSample}var c=new DataView(e,t?n.RIFFConstants.headerLength:0),l=Math.floor(((this.hasNonAlignedBytes?1:0)+c.byteLength)/this.bytesPerSample);if(!l)return null;var p=new Float32Array(l),u=this.hasNonAlignedBytes?1:0,h=this.hasNonAlignedBytes?1:0;if(this.hasNonAlignedBytes){this.hasNonAlignedBytes=!1;var d=new Uint8Array(this.bytesPerSample);d[0]=this.nonAlignedByte,d[1]=c.getUint8(0);var g=new DataView(d.buffer);p[0]=this.getFloatFromInt16(g,0)}for(;u<l;)p[u]=this.getFloatFromInt16(c,h),u++,h+=this.bytesPerSample;return h<c.byteLength&&(this.hasNonAlignedBytes=!0,this.nonAlignedByte=c.getInt8(h)),p},e.prototype.getFloatFromInt16=function(e,t){var i=e.getInt16(t,!0);return i>=32768?i/32768:i/32767},e.prototype.getString=function(e,t,i){var n="";if(t+i+e.byteOffset>e.byteLength)return n;for(var r=0;r<i;++r)n+=String.fromCharCode(e.getUint8(t+r));return n},e}();t.RiffPcmDecoder=r},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),s=function(e){function t(){return e.call(this,r.ClientSkillsId.communication)||this}return n(t,e),t.prototype.initialize=function(){return this.currentConfig={channelsSettings:{},preferences:{maxContactsForDisambig:6,preferredCallingChannel:"teams",preferredMessagingChannel:"teams"}},this.currentConfig.channelsSettings.teams={canSupplyContacts:!1,supportsCalling:!0,supportsCallingMultipleContacts:!1,supportsAddToCall:!0,supportsAddToCallMultipleContacts:!1,supportsHoldResume:!0,supportsTransferCall:!0,supportsFetchMessages:!1,supportsMarkMessages:!1,supportsSendMessage:!0},Promise.resolve(!0)},t.prototype.getConfig=function(){return this.currentConfig},t}(i(83).CortanaConfigProviderBase);t.CommunicationSkillConfigProvider=s,angular.module("teamspace.communicationSkillConfigProvider",[]).service("communicationSkillConfigProvider",s)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),s=function(e){function t(t,i,n,s){var a=e.call(this,r.ClientSkillsId.system)||this;return a.$rootScope=t,a.constants=i,a.myUserPreferencesStore=n,a.settingsService=s,a}return n(t,e),t.$inject=["$rootScope","constants","myUserPreferencesStore","settingsService"],t.prototype.initialize=function(){var e=this;return this.myUserPreferencesStore.waitForPreferenceStoreToInitialize().then(function(){return e.updateConfig(),e.myUserPreferencesStore.safeSubscribe(e.$rootScope,function(t,i){i&&_.find(i,function(e){return e===SkypeX.Services.MyUserPreferenceStorageKey.Locale})&&(e.updateConfig(),e.triggerConfigUpdated())},e.constants.MyUserPreferencesStore.Type_UserPreference),!0})},t.prototype.getConfig=function(){return this.currentConfig},t.prototype.updateConfig=function(){var e=this.myUserPreferencesStore.getUserPreferences().locale||"en-us",t=-(new Date).getTimezoneOffset(),i=this.settingsService.valueFor(this.constants.settings.names.cortanaConstants);this.currentConfig={sdk:null,language:e.toLowerCase(),region:"us",timezoneOffset:t,deviceId:i.deviceId,deviceName:i.deviceName,device:{manufacturer:i.deviceManufacturer,model:i.deviceName,version:this.settingsService.getVersion().clientVersion},os:{platform:"Teams",name:navigator.userAgent,version:navigator.appVersion}}},t}(i(83).CortanaConfigProviderBase);t.SystemSkillConfigProvider=s,angular.module("teamspace.systemSkillConfigProvider",["skypeX.myUserPreferencesStore","teamspace.constants","teamspace.settingsService"]).service("systemSkillConfigProvider",s)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),s=i(1),a=function(e){function t(t,i,n,a,o,c,l,p,u,h,d,g,v,m,f,S){var y=e.call(this,r.TeamsActionsId.callingAction)||this;return y.$state=t,y.callEscalationService=i,y.callForwardingSettingsService=n,y.callingPolicyStore=a,y.callingService=o,y.callingSupportService=c,y.callTogglingService=l,y.callTransferService=p,y.callingUserActionService=u,y.constants=h,y.conversationsService=d,y.loggingService=g,y.peopleService=v,y.pstnNumberService=m,y.sxConfig=f,y.userAppsStore=S,y.actionTypeToResultEventMap={},y.logger=y.loggingService.newLogger("CallingActionHandler"),y.actionTypeToResultEventMap[s.ClientSkillsActions.addToCall]="addToCallActionResult",y.actionTypeToResultEventMap[s.ClientSkillsActions.endCall]="endCallActionResult",y.actionTypeToResultEventMap[s.ClientSkillsActions.holdCall]="holdCallActionResult",y.actionTypeToResultEventMap[s.ClientSkillsActions.makeCall]="makeCallActionResult",y.actionTypeToResultEventMap[s.ClientSkillsActions.resumeCall]="resumeCallActionResult",y.actionTypeToResultEventMap[s.ClientSkillsActions.transferCall]="transferCallActionResult",y}return n(t,e),t.$inject=["$state","callEscalationService","callForwardingSettingsService","callingPolicyStore","callingService","callingSupportService","callTogglingService","callTransferService","callingUserActionService","constants","conversationsService","loggingService","peopleService","pstnNumberService","sxConfig","userAppsStore"],t.prototype.handleAction=function(e){var t=this,i=e;if(!i||!i.type)return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error));if(this.logger.info("calling type: {0}",i.type),!this.callingSupportService.isSupportedEnvironment()||!this.callingSupportService.isOneOnOneCallingEnabled())return this.logger.info("calling action is not supported"),Promise.resolve(this.callingActionResult(i.type,r.TeamsCortanaActionStatus.NotSupported));var n=null,a="";return this.isActionAllowed(i).then(function(e){if(!e)throw t.callingActionResult(i.type,r.TeamsCortanaActionStatus.TenantNotSupported);var n=i.contacts&&i.contacts[0]?i.contacts[0]:null;return n&&n.number&&(a=t.pstnNumberService.parseAndFormatNumber(i.contacts[0].number,libphonenumber.PhoneNumberFormat.E164)),n&&n.id?t.getProfileByContactId(n.id):null}).then(function(e){n=e;var o=t.getCurrentCall(i.callId);switch(i.type){case s.ClientSkillsActions.makeCall:return t.handleMakeCallAction(n,a);case s.ClientSkillsActions.forwardCalls:return t.handleForwardCallsAction(n,a);case s.ClientSkillsActions.resumeCall:return t.handleHoldResumeCallAction(o,!1);case s.ClientSkillsActions.holdCall:return t.handleHoldResumeCallAction(o,!0);case s.ClientSkillsActions.endCall:return t.handleEndCallAction(o);case s.ClientSkillsActions.muteCall:return t.handleMuteUnmuteCallAction(o,!0);case s.ClientSkillsActions.unmuteCall:return t.handleMuteUnmuteCallAction(o,!1);case s.ClientSkillsActions.transferCall:return t.handleTransferCallAction(o,n,a);case s.ClientSkillsActions.addToCall:return t.handleAddToCallAction(o,n,a)}return t.callingActionResult(i.type,r.TeamsCortanaActionStatus.Error)}).catch(function(e){return e&&e.status?e:t.callingActionResult(i.type,r.TeamsCortanaActionStatus.Error)})},t.prototype.getCurrentCall=function(e){var t;if(e&&(t=this.callingService.getCallByCallId(e)),t)return t;var i=this.$state.params&&this.$state.params.teamsCallId;return i&&(t=this.callingService.getCallByTeamsCallId(i)),t||this.callingService.getActiveCall()},t.prototype.isActionAllowed=function(e){var t=this;return this.getCallingPolicy().then(function(i){if(!i.isCallingEnabled)return t.logger.info("calling actions not allowed"),!1;if(e.type===s.ClientSkillsActions.addToCall&&!i.isGroupCallingEnabled)return t.logger.info("addToCall action not allowed"),!1;var n=e.contacts&&e.contacts[0]?e.contacts[0]:null;return!(!n||!n.id&&n.number&&!t.userAppsStore.hasApp(t.constants.appId.calling))}).catch(function(){return!1})},t.prototype.getCallingPolicy=function(){var e=this,t={isCallingEnabled:!1,isGroupCallingEnabled:!1};return Promise.all([this.callingPolicyStore.waitForSettingAndGetValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling),this.callingPolicyStore.waitForSettingAndGetValue(SkypeX.Services.CallingPolicyStorageKey.allowGroupCalling)]).then(function(e){return t.isCallingEnabled=e[0],t.isGroupCallingEnabled=e[1],t}).catch(function(i){return e.logger.error("failed to get calling policy, disable calling by default"),t})},t.prototype.handleMakeCallAction=function(e,t){return e?this.callContact(e):t?this.callPstnNumber(t):Promise.resolve(this.callingActionResult(s.ClientSkillsActions.makeCall,r.TeamsCortanaActionStatus.Error))},t.prototype.handleForwardCallsAction=function(e,t){var i=e&&e.mri;return!i&&t&&(i=SkypeX.Services.ChatServiceUtils.PstnPrefix.concat(t)),i?this.forwardCall(i):Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error))},t.prototype.handleHoldResumeCallAction=function(e,t){var i=this,n=t?s.ClientSkillsActions.holdCall:s.ClientSkillsActions.resumeCall;return e?t&&4!==e.state||!t&&4===e.state?this.callTogglingService.toggleHold(e,this.constants.scenarios.calling.context.callScreen).then(function(){return i.callingActionResult(n,r.TeamsCortanaActionStatus.Success)}).catch(function(){return i.callingActionResult(n,r.TeamsCortanaActionStatus.Error)}):Promise.resolve(this.callingActionResult(n,r.TeamsCortanaActionStatus.Success)):Promise.resolve(this.callingActionResult(n,r.TeamsCortanaActionStatus.Error))},t.prototype.handleMuteUnmuteCallAction=function(e,t){var i=this;return e?t&&!e.isMuted||!t&&e.isMuted?this.callTogglingService.toggleMuteAudio(e).then(function(){return i.actionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(){return i.actionResult(r.TeamsCortanaActionStatus.Error)}):Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success)):Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error))},t.prototype.handleEndCallAction=function(e){var t=this;return e?this.callingService.leaveCall(e,this.constants.scenarios.calling.context.callScreen).then(function(){return t.callingActionResult(s.ClientSkillsActions.endCall,r.TeamsCortanaActionStatus.Success)}).catch(function(){return t.callingActionResult(s.ClientSkillsActions.endCall,r.TeamsCortanaActionStatus.Error)}):Promise.resolve(this.callingActionResult(s.ClientSkillsActions.endCall,r.TeamsCortanaActionStatus.InvalidAction))},t.prototype.handleTransferCallAction=function(e,t,i){var n=this;return e?!t&&i?this.getProfileByContactNumber(i).then(function(t){return n.callTransferService.transferCall(e,t),Promise.resolve(n.callingActionResult(s.ClientSkillsActions.transferCall,r.TeamsCortanaActionStatus.Success))}).catch(function(){return Promise.resolve(n.callingActionResult(s.ClientSkillsActions.transferCall,r.TeamsCortanaActionStatus.Error))}):t?(this.callTransferService.transferCall(e,t),Promise.resolve(this.callingActionResult(s.ClientSkillsActions.transferCall,r.TeamsCortanaActionStatus.Success))):Promise.resolve(this.callingActionResult(s.ClientSkillsActions.transferCall,r.TeamsCortanaActionStatus.Success)):Promise.resolve(this.callingActionResult(s.ClientSkillsActions.transferCall,r.TeamsCortanaActionStatus.Error))},t.prototype.handleAddToCallAction=function(e,t,i){var n=this,a=s.ClientSkillsActions.addToCall;return e?(t?Promise.resolve(t):this.getProfileByContactNumber(i)).then(function(t){if(!t||!t.mri)return n.logger.error("failed to find call contact"),n.callingActionResult(a,r.TeamsCortanaActionStatus.UserNotFound);var i=n.conversationsService.getCallingConversation(e.conversationId);if(i.isMeeting())return n.callingActionResult(a,r.TeamsCortanaActionStatus.InvalidAction);var s=SkypeX.Services.ChatServiceUtils.isPstnMri(t.mri);return i.isOneToOne()?(n.callEscalationService.handleCallEscalation(t,s,e),n.callingActionResult(a,r.TeamsCortanaActionStatus.Success)):s||i.members.some(function(e){return e.id===t.mri})?(e.addParticipant(t.mri),n.callingActionResult(a,r.TeamsCortanaActionStatus.Success)):i.getId().then(function(e){return i.isChannel()?null:n.conversationsService.addUsersToConversation(e,t.mri)}).then(function(){return e.addParticipant(t.mri),n.callingActionResult(a,r.TeamsCortanaActionStatus.Success)})}).catch(function(){return n.callingActionResult(a,r.TeamsCortanaActionStatus.Error)}):Promise.resolve(this.callingActionResult(a,r.TeamsCortanaActionStatus.Error))},t.prototype.callPstnNumber=function(e){var t=this,i={dialoutNumber:e,dtmfPortion:"",withVideo:!1,muted:!1};return this.callingUserActionService.startPstnCall(i).then(function(){return t.callingActionResult(s.ClientSkillsActions.makeCall,r.TeamsCortanaActionStatus.Success)}).catch(function(){return t.callingActionResult(s.ClientSkillsActions.makeCall,r.TeamsCortanaActionStatus.Error)})},t.prototype.callContact=function(e){var t=this;return e&&e.mri?this.callingUserActionService.placeCall({messageId:null,conversationId:this.conversationsService.getChatConversationWith(e.mri).id,isStartMeetup:!1,withVideo:!1,titleText:"titleText",context:teamspace.services.CallTelemetryContext.ReplyChain}).then(function(e){return t.callingActionResult(s.ClientSkillsActions.makeCall,e&&e.callId?r.TeamsCortanaActionStatus.Success:r.TeamsCortanaActionStatus.Error)}).catch(function(){return t.callingActionResult(s.ClientSkillsActions.makeCall,r.TeamsCortanaActionStatus.Error)}):Promise.resolve(this.callingActionResult(s.ClientSkillsActions.makeCall,r.TeamsCortanaActionStatus.UserNotFound))},t.prototype.forwardCall=function(e){var t=this;return this.callForwardingSettingsService.getSettings().then(function(i){var n=i,r=n.callForwardingSettings;r.isEnabled=!0,r.forwardingType="immediate",r.targetType="singleTarget",r.target=e,r.delaySeconds=0;var s=t.sxConfig.getCurrentSkypeMri();return t.callForwardingSettingsService.addOrUpdateSettings(s,n)}).then(function(){return t.actionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(){return t.actionResult(r.TeamsCortanaActionStatus.Error)})},t.prototype.getProfileByContactId=function(e){var t=this;return e?this.peopleService.getPeopleProfile(e,"callingActionHandler",!0).then(function(e){return e&&e.mri?e:(t.logger.error("failed to find call contact by contactId"),null)}):null},t.prototype.getProfileByContactNumber=function(e){var t=this;if(!e)return null;var i={includePstn:!0};return this.peopleService.searchContacts(e,i).then(function(e){return e&&e.results&&e.results[0]?e.results[0]:(t.logger.error("failed to find call contact by pstn"),null)})},t.prototype.callingActionResult=function(e,t,i){return void 0===i&&(i=!0),{status:t,actionId:this.actionId,dismissOnAction:i,actionResponseData:this.getCallingResponseData(e,t===r.TeamsCortanaActionStatus.Success)}},t.prototype.getCallingResponseData=function(e,t,i){if(!e)return null;var n=this.actionTypeToResultEventMap[e];return n?{id:s.ClientSkillsId.communication,event:n,slots:{success:t,errorMessage:i||""}}:null},t}(r.TeamsCortanaActionHandlerBase);t.CallingActionHandler=a,angular.module("teamspace.callingActionHandler",["skypeX.policySettingsStore","skypeX.sxConfig","teamspace.callEscalationService","teamspace.callForwardingSettingsService","teamspace.callingService","teamspace.callingSupportService","teamspace.callingUserActionService","teamspace.callTogglingService","teamspace.callTransferService","teamspace.conversationsService","teamspace.loggingService","teamspace.peopleService","teamspace.pstnNumberService","teamspace.userAppsStore"]).service("callingActionHandler",a)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),s=function(e){function t(t,i,n,s){var a=e.call(this,r.TeamsActionsId.downloadFilesAction)||this;return a.$q=t,a.constants=i,a.downloadManagerService=n,a.filesActionService=s,a}return n(t,e),t.$inject=["$q","constants","downloadManagerService","filesActionService"],t.prototype.handleAction=function(e){var t=this,i=e;if(!i||!i.files||0===i.files.length)return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error));i.files=i.files?i.files:[i.file];var n=i.files,s=_.map(n,function(e){return{downloadUrl:e.objectUrl,objectId:e.objectId,objectUrl:e.objectUrl,title:e.title,type:e.type}});return this.downloadManagerService.download(s,function(e){return t.$q.resolve({serviceName:t.constants.files.serviceName.recent,objectUrl:e.objectUrl,title:e.title})}).then(function(e){return t.filesActionService.handleBatchResults(e,s,null,teamspace.services.EntityActionType.Download,t.constants.events.files.batchDownloadSuccess,t.constants.events.files.batchDownloadFailed,!1),t.actionResult(e?r.TeamsCortanaActionStatus.Success:r.TeamsCortanaActionStatus.Error)}).catch(function(){return t.actionResult(r.TeamsCortanaActionStatus.Error)})},t}(r.TeamsCortanaActionHandlerBase);t.DownloadFilesActionHandler=s,angular.module("teamspace.downloadFilesActionHandler",["teamspace.downloadManagerService","teamspace.filesActionService"]).service("downloadFilesActionHandler",s)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),s=function(e){function t(t,i){var n=e.call(this,r.TeamsActionsId.openFileAction)||this;return n.constants=t,n.navigationService=i,n}return n(t,e),t.$inject=["constants","navigationService"],t.prototype.handleAction=function(e){var t=this,i=e;if(!i||!i.file)return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error));var n=i.file,s={documentViewerParams:{baseUrl:null,ctx:"cortana",fileId:n.objectId,fileType:n.type,objectUrl:n.objectUrl,serviceName:"teams",viewerAction:"view"},viewerState:this.constants.states.appDocumentViewer};return this.navigationService.navigateToFileViewer(s).then(function(e){return t.actionResult(e?r.TeamsCortanaActionStatus.Success:r.TeamsCortanaActionStatus.Error)})},t}(r.TeamsCortanaActionHandlerBase);t.FileActionHandler=s,angular.module("teamspace.fileActionHandler",["teamspace.navigationService"]).service("fileActionHandler",s)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),s=i(1),a=function(e){function t(t,i,n,s,a,o,c){var l=e.call(this,r.TeamsActionsId.meetingAction)||this;return l.$state=t,l.callingService=i,l.callTogglingService=n,l.conversationsService=s,l.constants=a,l.loggingService=o,l.peopleService=c,l.logger=l.loggingService.newLogger("MeetingActionHandler"),l}return n(t,e),t.$inject=["$state","callingService","callTogglingService","conversationsService","constants","loggingService","peopleService"],t.prototype.handleAction=function(e){var t=e;this.logger.info("meeting action type: {0}",t.type);var i=t.conversationId||this.$state.params.conversationId,n=i&&this.conversationsService.getCallingConversation(i);if(!n||!n.isMeeting())return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.InvalidAction));var a=this.getCallFromConversationId(i);if(!a)return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.InvalidAction));switch(t.type){case s.ClientSkillsActions.meeting.addToMeeting:return this.handleAddToMeetingAction(a,t.contacts,i);case s.ClientSkillsActions.meeting.turnOnCamera:case s.ClientSkillsActions.meeting.turnOffCamera:return this.handleToggleCameraAction(a,t.type);case s.ClientSkillsActions.meeting.startRecording:case s.ClientSkillsActions.meeting.stopRecording:return this.handleToggleRecordingAction(a,t.type,n);case s.ClientSkillsActions.meeting.muteSelf:case s.ClientSkillsActions.meeting.unmuteSelf:return this.handleToggleMuteSelfAction(a,t.type);case s.ClientSkillsActions.meeting.muteSomeone:case s.ClientSkillsActions.meeting.muteAll:return this.handleMuteParticipantAction(a,t.type,t.contacts);case s.ClientSkillsActions.meeting.endMeeting:return this.handleEndMeetingAction(a)}return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.InvalidAction))},t.prototype.getCallFromConversationId=function(e){if(!e)return null;var t=_.find(this.callingService.getActiveCalls(),function(t){return t.conversationId&&t.conversationId==e});return t||(this.logger.error("error getting call object"),null)},t.prototype.handleAddToMeetingAction=function(e,t,i){var n=this;return t&&t[0]?(t[0].number?this.getProfileByContactNumber(t[0].number):this.getProfileByContactId(t[0].id)).then(function(t){return t&&t.mri?e.addParticipant(t.mri):(n.logger.error("failed to find call contact"),null)}).then(function(e){return n.actionResult(e?r.TeamsCortanaActionStatus.Success:r.TeamsCortanaActionStatus.Error)}).catch(function(){return n.actionResult(r.TeamsCortanaActionStatus.Error)}):(this.logger.info("no userPrincipalName"),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.InvalidParameters)))},t.prototype.getProfileByContactId=function(e){var t=this;return e?this.peopleService.getPeopleProfile(e,"callingActionHandler",!0).then(function(e){return e&&e.mri?e:(t.logger.error("failed to find call contact by contactId"),null)}):Promise.resolve(null)},t.prototype.getProfileByContactNumber=function(e){var t=this;if(!e)return Promise.resolve(null);var i={includePstn:!0};return this.peopleService.searchContacts(e,i).then(function(e){return e&&e.results&&e.results[0]?e.results[0]:(t.logger.error("failed to find call contact by pstn"),null)})},t.prototype.handleToggleCameraAction=function(e,t){var i=this;return this.callingService.getAdminSettings().isVideoEnabled||e?t===s.ClientSkillsActions.meeting.turnOnCamera&&!e.isVideoOn||t===s.ClientSkillsActions.meeting.turnOffCamera&&e.isVideoOn?this.callTogglingService.toggleVideo(e,this.constants.scenarios.calling.context.callScreen).then(function(){return i.actionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(){return i.actionResult(r.TeamsCortanaActionStatus.Error)}):Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success)):Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error))},t.prototype.handleToggleRecordingAction=function(e,t,i){var n=this,a=e.getRecordingStatus();return t===s.ClientSkillsActions.meeting.startRecording&&a!==teamspace.services.CallRecordingStatus.recording&&a!==teamspace.services.CallRecordingStatus.pending?e.startRecording(i).then(function(){return n.actionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(){return n.actionResult(r.TeamsCortanaActionStatus.Error)}):t===s.ClientSkillsActions.meeting.stopRecording?e.stopRecording().then(function(){return n.actionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(){return n.actionResult(r.TeamsCortanaActionStatus.Error)}):Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success))},t.prototype.handleToggleMuteSelfAction=function(e,t){var i=this;return t===s.ClientSkillsActions.meeting.muteSelf&&!e.isMuted||t===s.ClientSkillsActions.meeting.unmuteSelf&&e.isMuted?this.callTogglingService.toggleMuteAudio(e).then(function(){return i.actionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(){return i.actionResult(r.TeamsCortanaActionStatus.Error)}):Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success))},t.prototype.handleMuteParticipantAction=function(e,t,i){var n=this;if(t===s.ClientSkillsActions.meeting.muteAll)return e.muteParticipants(0,[]).then(function(){return n.actionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(){return n.actionResult(r.TeamsCortanaActionStatus.Error)});if(!i||!i[0])return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.InvalidParameters));var a=_.find(e.participants,function(e){e.id=i[0].id});return e.muteParticipants(1,[a]).then(function(){return n.actionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(){return n.actionResult(r.TeamsCortanaActionStatus.Error)})},t.prototype.handleEndMeetingAction=function(e){var t=this;return this.callingService.leaveCall(e,this.constants.scenarios.calling.context.callScreen).then(function(){return t.actionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(){return t.actionResult(r.TeamsCortanaActionStatus.Error)})},t}(r.TeamsCortanaActionHandlerBase);t.MeetingActionHandler=a,angular.module("teamspace.meetingActionHandler",["teamspace.callingService","teamspace.callTogglingService","teamspace.conversationsService","teamspace.loggingService","teamspace.peopleService"]).service("meetingActionHandler",a)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),s=function(e){function t(t,i,n,s,a,o,c,l,p,u,h){var d=e.call(this,r.TeamsActionsId.navigation)||this;return d.constants=t,d.$q=i,d.$state=n,d.brbV2FeedbackService=s,d.conversationsService=a,d.dialogService=o,d.helpService=c,d.navigationService=l,d.peopleService=p,d.shortcutService=u,d.teamActionDialogUtilityService=h,d}return n(t,e),t.$inject=["constants","$q","$state","brbV2FeedbackService","conversationsService","dialogService","helpService","navigationService","peopleService","shortcutService","teamActionDialogUtilityService"],t.prototype.handleAction=function(e){var t=e;if(!t||!t.destination&&!t.channelId)return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error));if(t.channelId)return this.navigationService.navigateToChannel(t.channelId,"cortana"),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success,!0,null,"channel"));var i;switch(t.destination){case r.NavigationDestinations.recentFiles:i=this.navigationResultToActionResult(this.navigationService.navigateToRecentFiles());break;case r.NavigationDestinations.activity:i=this.navigationResultToActionResult(this.navigationService.navigateToActivityFeed());break;case r.NavigationDestinations.atMentions:i=this.navigationResultToActionResult(this.navigationService.navigateToMentionsState());break;case r.NavigationDestinations.calendar:i=this.navigationResultToActionResult(this.navigationService.navigateToCalendar());break;case r.NavigationDestinations.createTeam:this.teamActionDialogUtilityService.openCreateTeamDialog(),i=Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success));break;case r.NavigationDestinations.downloads:i=this.navigationResultToActionResult(this.navigationService.navigateToDownloads());break;case r.NavigationDestinations.feedback:this.brbV2FeedbackService.openDialog(),i=Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success));break;case r.NavigationDestinations.joinTeam:this.$state.go(this.constants.states.appDiscover),i=Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success));break;case r.NavigationDestinations.myActivity:i=this.navigationResultToActionResult(this.navigationService.navigateToMyActivity());break;case r.NavigationDestinations.saved:i=this.navigationResultToActionResult(this.navigationService.navigateToDefaultMySavedState());break;case r.NavigationDestinations.unreadActivity:i=this.navigationResultToActionResult(this.navigationService.navigateToUnreadState());break;case r.NavigationDestinations.help:this.helpService.gotoHelp(),i=Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success));break;case r.NavigationDestinations.openSettings:this.dialogService.open(this.constants.dialogs.optionsSettingsDialog),i=Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success));break;case r.NavigationDestinations.keyboardShortcuts:this.shortcutService.executeCommand(teamspace.services.CommandIdentifier.ShowShortcuts),i=Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success));break;case r.NavigationDestinations.store:i=this.navigationResultToActionResult(this.navigationService.navigateToAppsView());break;case r.NavigationDestinations.otherPersonActivity:case r.NavigationDestinations.otherPersonChat:case r.NavigationDestinations.otherPersonOrganization:i=this.navigationResultToActionResult(this.handleOtherPersonNavigation(t));break;default:i=Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error))}return i.then(function(e){return e.actionInfo=t.destination,e})},t.prototype.navigationResultToActionResult=function(e){var t=this;return e?e.then(function(e){return e?t.actionResult(r.TeamsCortanaActionStatus.Success):t.actionResult(r.TeamsCortanaActionStatus.Error)}):Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error))},t.prototype.handleOtherPersonNavigation=function(e){var t=this;return e.userPrincipalName?e.destination===r.NavigationDestinations.otherPersonActivity?this.navigationService.navigateToPerson(e.userPrincipalName,this.constants.peopleTab.panes.activity):e.destination===r.NavigationDestinations.otherPersonOrganization?this.navigationService.navigateToPerson(e.userPrincipalName,this.constants.peopleTab.panes.organization):e.destination===r.NavigationDestinations.otherPersonChat?this.peopleService.getPeopleProfile(e.userPrincipalName,"navigationActionHandler",!0).then(function(e){var i=e.mri,n=t.conversationsService.getChatConversationWith(i),r=n?n.id:null;if(r){var s={slug:r,middlePane:t.constants.messages.panes.conversations,ctx:t.constants.navigation.context.chat,navCtx:"cortana"};return t.navigationService.navigateDirectPromise(t.constants.states.appConversation,s)}return t.$q.resolve(null)}):this.$q.resolve(null):this.$q.resolve(null)},t}(r.TeamsCortanaActionHandlerBase);t.NavigationActionHandler=s,angular.module("teamspace.navigationActionHandler",["teamspace.brbV2FeedbackService","teamspace.conversationsService","teamspace.dialogService","teamspace.helpService","teamspace.navigationService","teamspace.peopleService","teamspace.shortcutService","teamspace.teamActionDialogUtilityService"]).service("navigationActionHandler",s)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),s=i(1),a=function(e){function t(t,i,n,s,a,o,c){var l=e.call(this,r.TeamsActionsId.present)||this;return l.$state=t,l.callingService=i,l.constants=n,l.contentSharingService=s,l.conversationsService=a,l.eventingService=o,l.loggingService=c,l.logger=l.loggingService.newLogger("PresentActionHandler"),l}return n(t,e),t.$inject=["$state","callingService","constants","contentSharingService","conversationsService","eventingService","loggingService"],t.prototype.handleAction=function(e){var t=e;this.logger.info("present action type: {0}",t.type);var i=t.conversationId||this.$state.params.conversationId,n=i&&this.conversationsService.getCallingConversation(i);if(!n||!n.isMeeting())return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.InvalidAction));var a=this.getCallFromConversationId(i);if(!a)return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.InvalidAction));var o=a.callId;switch(t.type){case s.ClientSkillsActions.meeting.present:return this.presentDeck(t.deckName,t.deckUrl);case s.ClientSkillsActions.meeting.stopSharingDeck:return this.stopPresentingDeck(o);case s.ClientSkillsActions.meeting.nextSlide:return this.goToNextSlide(o);case s.ClientSkillsActions.meeting.previousSlide:return this.goToPreviousSlide(o);case s.ClientSkillsActions.meeting.goToSlide:return this.goToSlide(o,t.slideIndex);default:return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.InvalidAction))}},t.prototype.getCallFromConversationId=function(e){if(!e)return null;var t=_.find(this.callingService.getActiveCalls(),function(t){return t.conversationId&&t.conversationId===e});return t||(this.logger.error("error getting call object"),null)},t.prototype.presentDeck=function(e,t){var i=this;if(!t)return this.logger.info("no deckUrl"),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.InvalidParameters));var n={type:"ppt",id:void 0,name:e,url:t,contentBundleUrl:void 0,fileGetUrl:void 0,fileCommandsUrl:void 0,majorVersion:void 0,fileSize:void 0};return this.contentSharingService.startSharingContent(n).then(function(){return i.actionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(){return i.actionResult(r.TeamsCortanaActionStatus.Error)})},t.prototype.stopPresentingDeck=function(e){return this.eventingService.$emit(this.constants.events.calling.pptSharingOnHold,{callId:e}),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success))},t.prototype.goToNextSlide=function(e){return this.eventingService.$emit(this.constants.events.calling.pptSharingNext,{callId:e}),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success))},t.prototype.goToPreviousSlide=function(e){return this.eventingService.$emit(this.constants.events.calling.pptSharingPrev,{callId:e}),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success))},t.prototype.goToSlide=function(e,t){return this.eventingService.$emit(this.constants.events.calling.pptSharingGoTo,{callId:e,index:parseInt(t).toString()}),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success))},t}(r.TeamsCortanaActionHandlerBase);t.PresentActionHandler=a,angular.module("teamspace.presentActionHandler",["teamspace.callingService","teamspace.contentSharingService","teamspace.conversationsService","teamspace.eventingService","teamspace.loggingService"]).service("presentActionHandler",a)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),s=function(e){function t(t,i){var n=e.call(this,r.TeamsActionsId.search)||this;return n.constants=t,n.eventingService=i,n}return n(t,e),t.$inject=["constants","eventingService"],t.prototype.handleAction=function(e){var t=e;return t&&t.query?(this.eventingService.$emit(this.constants.events.search.performSearch,{searchStr:t.query}),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Success))):Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error))},t}(r.TeamsCortanaActionHandlerBase);t.SearchActionHandler=s,angular.module("teamspace.searchActionHandler",["teamspace.eventingService"]).service("searchActionHandler",s)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),s=i(1),a=function(e){function t(t,i,n,s,a,o,c){var l=e.call(this,r.TeamsActionsId.sendMessageAction)||this;return l.$q=t,l.conversationsService=i,l.htmlSanitizer=n,l.loggingService=s,l.messageService=a,l.peopleService=o,l.utilityService=c,l.logger=l.loggingService.newLogger("SendMessageActionHandler"),l}return n(t,e),t.$inject=["$q","conversationsService","htmlSanitizer","loggingService","messageService","peopleService","utilityService"],t.prototype.handleAction=function(e){var t=this,i=e;if(this.logger.info("send message invoked"),!i)return this.logger.info("empty send message action"),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error));var n=i.userPrincipalNames&&i.userPrincipalNames.length>0,s=i.conversationId;if(!n&&!s)return this.logger.info("missing missing upns and missing conversation"),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error));if(!i.message)return this.logger.info("message is missing"),Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error));var a;i.conversationId?(this.logger.info("invoking via conversation ID"),a=Promise.resolve(i.conversationId)):(this.logger.info("invoked with upn"),a=this.peopleService.getAllShortPeopleProfile(i.userPrincipalNames,"sendMessageActionHandler",!0).then(function(e){if(!e||!e.length)return t.logger.error("failed to find message contact by contactId"),null;var i=_.map(e,function(e){return e.mri}),n=t.conversationsService.getChatConversationWith(i);return n?n.id:""}));var o=this.utilityService.escapeHtml(i.message);return i.hyperlinks&&_.forEach(i.hyperlinks,function(e){o+="<br/><a href='"+e.href+"'>"+t.utilityService.escapeHtml(e.text)+"</a>"}),this.htmlSanitizer.sanitizeHtml(o),a.then(function(e){if(!e)return t.$q.reject("threadId is empty");var i=SkypeX.Services.Utilities.newClientMessageId();return t.messageService.createMessage({conversationId:e,replyChainId:null,messageSubject:null,messageBody:o,messagePreview:o,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!0,importance:null,clientId:i,externalId:null,draftObjectId:null,inlineImages:null})}).then(function(){return t.sendMessageActionResult(r.TeamsCortanaActionStatus.Success)}).catch(function(e){return t.logger.error(e),t.sendMessageActionResult(r.TeamsCortanaActionStatus.Error,e)})},t.prototype.sendMessageActionResult=function(e,t){return void 0===t&&(t=!0),{status:e,actionId:this.actionId,dismissOnAction:t,actionResponseData:this.getSendMessageResponseData(e===r.TeamsCortanaActionStatus.Success)}},t.prototype.getSendMessageResponseData=function(e,t){return{id:s.ClientSkillsId.communication,event:"sendMessageActionResult",slots:{success:e,errorMessage:t||""}}},t}(r.TeamsCortanaActionHandlerBase);t.SendMessageActionHandler=a,angular.module("teamspace.sendMessageActionHandler",["teamspace.conversationsService","teamspace.htmlSanitizer","teamspace.loggingService","teamspace.messageService","teamspace.peopleService","teamspace.utilityService"]).service("sendMessageActionHandler",a)},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),s=function(e){function t(t,i,n,s,a,o){var c=e.call(this,r.TeamsActionsId.channelAction)||this;return c.channelService=t,c.loggingService=i,c.peopleService=n,c.personalConversationService=s,c.teamMembershipService=a,c.teamMembershipPropertiesService=o,c.logger=c.loggingService.newLogger("TeamChannelActionHandler"),c}return n(t,e),t.$inject=["channelService","loggingService","peopleService","personalConversationService","teamMembershipService","teamMembershipPropertiesService"],t.prototype.handleAction=function(e){var t=this,i=e;if(!i||!i.type)return Promise.resolve(this.actionResult(r.TeamsCortanaActionStatus.Error)